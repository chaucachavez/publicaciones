(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{"+4LO":function(t,e){e.__esModule=!0,e.default={body:'<path d="M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z" fill="currentColor"/>',width:24,height:24}},Ldl7:function(t,e){e.__esModule=!0,e.default={body:'<path opacity=".3" d="M5 10h6v8H5z" fill="currentColor"/><path d="M15 16h4v2h-4zm0-8h7v2h-7zm0 4h6v2h-6zM3 18c0 1.1.9 2 2 2h6c1.1 0 2-.9 2-2V8H3v10zm2-8h6v8H5v-8zm5-6H6L5 5H2v2h12V5h-3z" fill="currentColor"/>',width:24,height:24}},QcxM:function(t,e){e.__esModule=!0,e.default={body:'<path opacity=".3" d="M5 5v14h14V7.83L16.17 5H5zm7 13c-1.66 0-3-1.34-3-3s1.34-3 3-3s3 1.34 3 3s-1.34 3-3 3zm3-8H6V6h9v4z" fill="currentColor"/><path d="M17 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm2 16H5V5h11.17L19 7.83V19zm-7-7c-1.66 0-3 1.34-3 3s1.34 3 3 3s3-1.34 3-3s-1.34-3-3-3zM6 6h9v4H6z" fill="currentColor"/>',width:24,height:24}},T7YG:function(t,e){e.__esModule=!0,e.default={body:'<path d="M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8l8-8z" fill="currentColor"/>',width:24,height:24}},kkQI:function(t,e){e.__esModule=!0,e.default={body:'<path d="M12 6v3l4-4l-4-4v3c-4.42 0-8 3.58-8 8c0 1.57.46 3.03 1.24 4.26L6.7 14.8A5.87 5.87 0 0 1 6 12c0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8c0 3.31-2.69 6-6 6v-3l-4 4l4 4v-3c4.42 0 8-3.58 8-8c0-1.57-.46-3.03-1.24-4.26z" fill="currentColor"/>',width:24,height:24}},m2C8:function(t,e){e.__esModule=!0,e.default={body:'<path opacity=".3" d="M4 8.25l7.51 1l-7.5-3.22zm.01 9.72l7.5-3.22l-7.51 1z" fill="currentColor"/><path d="M2.01 3L2 10l15 2l-15 2l.01 7L23 12L2.01 3zM4 8.25V6.03l7.51 3.22l-7.51-1zm.01 9.72v-2.22l7.51-1l-7.51 3.22z" fill="currentColor"/>',width:24,height:24}},p2va:function(t,e,o){"use strict";o.r(e),o.d(e,"VentasModule",(function(){return tc}));var a=o("tyNb"),i=o("3Pt+"),n=o("Kj3r"),c=o("vkgz"),r=o("eIep"),s=o("nYR2"),l=o("Iab2"),d=o("0IaG"),u=o("fXoL"),b=o("TgOq");let m=(()=>{class t{constructor(t,e,o,a){this.data=t,this.matDialogRef=e,this._matDialog=o,this._ventaService=a}ngOnInit(){this.loading=!1,this.url="http://apiifact.pe/temporal/20431738806-03-B004-1270.pdf"}}return t.\u0275fac=function(e){return new(e||t)(u.Qb(d.a),u.Qb(d.g),u.Qb(d.b),u.Qb(b.a))},t.\u0275cmp=u.Kb({type:t,selectors:[["vex-ventas-descarga"]],decls:1,vars:0,template:function(t,e){1&t&&u.Gc(0,"hola mundo")},styles:[".venta-descarga-dialog .mat-dialog-container{padding:0}.venta-descarga-dialog .dialog-content-wrapper{max-height:85vh;display:flex;flex-direction:column}"],encapsulation:2}),t})();var p=o("pI64"),f=o.n(p),v=o("yHIK"),h=o.n(v),g=o("5mnX"),V=o.n(g),C=o("MzEE"),x=o.n(C),W=o("ofXK"),w=o("6JgD"),F=o("XiUz"),y=o("bTqV"),I=o("Qu3c"),E=o("NFeN"),G=o("VX/1"),R=o("f0Cb"),S=o("jhN1");let k=(()=>{class t{constructor(t){this.domSanitizer=t}transform(t,e){return this.domSanitizer.bypassSecurityTrustResourceUrl(e+t)}}return t.\u0275fac=function(e){return new(e||t)(u.Qb(S.b))},t.\u0275pipe=u.Pb({name:"domseguro",type:t,pure:!0}),t})();function L(t,e){1&t&&u.Rb(0,"vex-loading")}function D(t,e){if(1&t){const t=u.Xb();u.Wb(0,"div"),u.Wb(1,"div",1),u.Wb(2,"h2",2),u.Gc(3),u.Vb(),u.Wb(4,"a",3),u.Rb(5,"mat-icon",4),u.Vb(),u.Wb(6,"button",5),u.ec("click",(function(){u.wc(t);const e=u.ic();return e.downloadPdf(e.venta.pdf)})),u.Rb(7,"mat-icon",4),u.Vb(),u.Wb(8,"button",6),u.ec("click",(function(){u.wc(t);const e=u.ic();return e.printPdf(e.venta.pdf)})),u.Rb(9,"mat-icon",4),u.Vb(),u.Wb(10,"button",7),u.Rb(11,"mat-icon",4),u.Vb(),u.Vb(),u.Rb(12,"mat-divider",8),u.Wb(13,"mat-dialog-content",9),u.Wb(14,"object",10),u.jc(15,"domseguro"),u.Gc(16,"Comunicarse con proveedor de servicios electr\xf3nicos"),u.Vb(),u.Vb(),u.Wb(17,"mat-dialog-actions",11),u.Wb(18,"button",12),u.Gc(19,"CERRAR"),u.Vb(),u.Vb(),u.Vb()}if(2&t){const t=u.ic();u.Cb(3),u.Kc("",t.venta.docnegocio.nombre," ",t.venta.serie," - ",t.venta.numero,""),u.Cb(1),u.oc("href",t.venta.pdf,u.zc),u.Cb(1),u.oc("icIcon",t.icCallMade),u.Cb(2),u.oc("icIcon",t.icCloudDownload),u.Cb(2),u.oc("icIcon",t.icPrint),u.Cb(2),u.oc("icIcon",t.icClose),u.Cb(3),u.oc("data",u.lc(15,9,t.venta.pdf,""),u.yc)}}let _=(()=>{class t{constructor(t,e,o){this.data=t,this.matDialogRef=e,this._ventaService=o,this.icCallMade=f.a,this.icPrint=h.a,this.icClose=V.a,this.icCloudDownload=x.a,this.show()}ngOnInit(){}show(){this.venta=this.data.venta}downloadPdf(t){const e=this.urlPdf(t);this._ventaService.downloadProxy(e).subscribe(e=>{const o=t.split("/").reverse()[0];Object(l.saveAs)(e,o)},t=>{})}printPdf(t){const e=this.urlPdf(t);this._ventaService.downloadProxy(e).subscribe(t=>{const e=new Blob([t],{type:"application/pdf"}),o=URL.createObjectURL(e),a=document.createElement("iframe");a.style.display="none",a.src=o,document.body.appendChild(a),a.contentWindow.print()},t=>{})}urlPdf(t){let e="";const o=t.split("/").reverse()[0],a=t.split("/").reverse()[1];return-1===t.indexOf("www.pse.pe")&&(e="/apiifact/public/"+a+"/"+o),-1!==t.indexOf("www.pse.pe")&&(e="/"+a+"/"+o),e}}return t.\u0275fac=function(e){return new(e||t)(u.Qb(d.a),u.Qb(d.g),u.Qb(b.a))},t.\u0275cmp=u.Kb({type:t,selectors:[["vex-ventas-pdf"]],decls:2,vars:2,consts:[[4,"ngIf"],["fxLayout","row","fxLayoutAlign","start center","mat-dialog-title",""],["fxFlex","auto",1,"headline","m-0"],["mat-icon-button","","target","_blank","matTooltip","Nueva pesta\xf1a",1,"text-secondary",3,"href"],[3,"icIcon"],["mat-icon-button","","type","button","matTooltip","Descargar",1,"text-secondary",3,"click"],["mat-icon-button","","type","button","matTooltip","Imprimir",1,"text-secondary",3,"click"],["mat-icon-button","","type","button","mat-dialog-close","","matTooltip","Cerrar",1,"text-secondary"],[1,"-mx-6","text-border"],["fxLayout","column"],["name","DocumentoPresupuesto","type","application/pdf","height","800",3,"data"],["align","end"],["mat-button","","mat-dialog-close","","type","button"]],template:function(t,e){1&t&&(u.Ec(0,L,1,0,"vex-loading",0),u.Ec(1,D,20,12,"div",0)),2&t&&(u.oc("ngIf",e.loading),u.Cb(1),u.oc("ngIf",!e.loading))},directives:[W.p,w.a,F.c,F.b,d.h,F.a,y.a,I.a,E.a,G.a,y.b,d.d,R.a,d.e,d.c],pipes:[k],styles:["@media (min-width:960px){.venta-pdf-dialog{width:960px}}"],encapsulation:2}),t})();var N=o("pN9m"),A=o.n(N),T=o("a84l"),O=o.n(T),P=o("6qw8"),q=o.n(P),j=o("+Chm"),M=o.n(j),Q=o("WT4w"),B=o.n(Q),$=o("kkQI"),z=o.n($),H=o("+tDV"),X=o.n(H),U=o("YMqD"),K=o("dNgK"),J=o("yCEk"),Y=o("STbY"),Z=o("/t3+"),tt=o("wZkO");const et=["tabGroup"];function ot(t,e){1&t&&u.Rb(0,"vex-loading")}function at(t,e){1&t&&u.Rb(0,"vex-loading")}function it(t,e){if(1&t&&(u.Wb(0,"span"),u.Gc(1),u.Vb()),2&t){const t=u.ic(2);u.Cb(1),u.Jc(" Factura Electr\xf3nica ",t.venta.serie," - ",t.venta.numero," ")}}function nt(t,e){if(1&t&&(u.Wb(0,"span"),u.Gc(1),u.Vb()),2&t){const t=u.ic(2);u.Cb(1),u.Jc(" Boleta de Venta Electr\xf3nica ",t.venta.serie," - ",t.venta.numero," ")}}function ct(t,e){if(1&t&&(u.Wb(0,"span"),u.Gc(1),u.Vb()),2&t){const t=u.ic(2);u.Cb(1),u.Jc(" Nota de D\xe9bito Electr\xf3nica ",t.venta.serie," - ",t.venta.numero," ")}}function rt(t,e){if(1&t&&(u.Wb(0,"span"),u.Gc(1),u.Vb()),2&t){const t=u.ic(2);u.Cb(1),u.Jc(" Nota de Cr\xe9dito Electr\xf3nica ",t.venta.serie," - ",t.venta.numero," ")}}function st(t,e){if(1&t){const t=u.Xb();u.Wb(0,"button",27),u.ec("click",(function(){u.wc(t);const e=u.ic(2);return e.estadoAnulacion(e.venta.idventa)})),u.Rb(1,"mat-icon",12),u.Vb()}if(2&t){const t=u.ic(2);u.Cb(1),u.oc("icIcon",t.icAutorenew)}}function lt(t,e){if(1&t){const t=u.Xb();u.Wb(0,"button",28),u.ec("click",(function(){return u.wc(t),u.ic(2).matDialogRef.close("regenerar")})),u.Rb(1,"mat-icon",12),u.Vb()}if(2&t){const t=u.ic(2);u.Cb(1),u.oc("icIcon",t.icAutorenew)}}function dt(t,e){if(1&t&&(u.Wb(0,"a",29),u.Rb(1,"mat-icon",12),u.Vb()),2&t){const t=u.ic(2);u.oc("href",t.venta.pdf,u.zc),u.Cb(1),u.oc("icIcon",t.icCallMade)}}function ut(t,e){if(1&t){const t=u.Xb();u.Wb(0,"button",30),u.ec("click",(function(){return u.wc(t),u.ic(2).matDialogRef.close("correo")})),u.Rb(1,"mat-icon",12),u.Vb()}if(2&t){const t=u.ic(2);u.Cb(1),u.oc("icIcon",t.icMail)}}function bt(t,e){if(1&t){const t=u.Xb();u.Wb(0,"button",31),u.ec("click",(function(){return u.wc(t),u.ic(2).matDialogRef.close("edit")})),u.Rb(1,"mat-icon",12),u.Vb()}if(2&t){const t=u.ic(2);u.Cb(1),u.oc("icIcon",t.icEdit)}}function mt(t,e){if(1&t){const t=u.Xb();u.Wb(0,"button",52),u.ec("click",(function(){u.wc(t);const e=u.ic(3);return e.downloadFile(e.venta.pdf)})),u.Rb(1,"ic-icon",53),u.Wb(2,"span"),u.Gc(3,"Descargar PDF"),u.Vb(),u.Vb()}if(2&t){const t=u.ic(3);u.Cb(1),u.oc("icon",t.icCloudDownload)}}function pt(t,e){if(1&t){const t=u.Xb();u.Wb(0,"button",54),u.ec("click",(function(){u.wc(t);const e=u.ic(3);return e.downloadFile(e.venta.xml)})),u.Rb(1,"ic-icon",53),u.Wb(2,"span"),u.Gc(3,"Descargar XML"),u.Vb(),u.Vb()}if(2&t){const t=u.ic(3);u.Cb(1),u.oc("icon",t.icCloudDownload)}}function ft(t,e){if(1&t){const t=u.Xb();u.Wb(0,"button",54),u.ec("click",(function(){u.wc(t);const e=u.ic(3);return e.downloadFile(e.venta.cdr)})),u.Rb(1,"ic-icon",53),u.Wb(2,"span"),u.Gc(3,"Descargar CDR"),u.Vb(),u.Vb()}if(2&t){const t=u.ic(3);u.Cb(1),u.oc("icon",t.icCloudDownload)}}function vt(t,e){1&t&&(u.Wb(0,"legend"),u.Gc(1," Factura Electr\xf3nica "),u.Vb())}function ht(t,e){1&t&&(u.Wb(0,"legend"),u.Gc(1," Boleta de Venta Electr\xf3nica "),u.Vb())}function gt(t,e){1&t&&(u.Wb(0,"legend"),u.Gc(1," Nota de D\xe9bito Electr\xf3nica "),u.Vb())}function Vt(t,e){1&t&&(u.Wb(0,"legend"),u.Gc(1," Nota de Cr\xe9dito Electr\xf3nica "),u.Vb())}function Ct(t,e){1&t&&(u.Wb(0,"span"),u.Gc(1,"Borrador"),u.Vb())}function xt(t,e){1&t&&(u.Wb(0,"span"),u.Gc(1,"Emitido"),u.Vb())}function Wt(t,e){1&t&&(u.Wb(0,"span"),u.Gc(1,"Anulado"),u.Vb())}function wt(t,e){1&t&&(u.Wb(0,"span"),u.Gc(1," S/ "),u.Vb())}function Ft(t,e){1&t&&(u.Wb(0,"span"),u.Gc(1," $ "),u.Vb())}function yt(t,e){1&t&&(u.Wb(0,"span"),u.Gc(1," \u20ac "),u.Vb())}function It(t,e){if(1&t&&(u.Wb(0,"span"),u.Rb(1,"mat-icon",55),u.Vb()),2&t){const t=u.ic(3);u.Cb(1),u.oc("icIcon",t.icCheck)}}function Et(t,e){if(1&t){const t=u.Xb();u.Wb(0,"span"),u.Wb(1,"mat-icon",56),u.ec("click",(function(){u.wc(t);const e=u.ic(3);return e.estadoComprobante(e.venta.idventa)})),u.Vb(),u.Vb()}if(2&t){const t=u.ic(3);u.Cb(1),u.oc("icIcon",t.icAutorenew)}}function Gt(t,e){if(1&t){const t=u.Xb();u.Wb(0,"span"),u.Wb(1,"mat-icon",56),u.ec("click",(function(){u.wc(t);const e=u.ic(3);return e.estadoComprobante(e.venta.idventa)})),u.Vb(),u.Vb()}if(2&t){const t=u.ic(3);u.Cb(1),u.oc("icIcon",t.icAutorenew)}}function Rt(t,e){if(1&t&&(u.Wb(0,"div",39),u.Gc(1),u.Vb()),2&t){const t=u.ic(3);u.Cb(1),u.Ic("Anulaci\xf3n (",t.venta.sunat_anulado_aceptado,")")}}function St(t,e){if(1&t&&(u.Wb(0,"span"),u.Rb(1,"mat-icon",55),u.Vb()),2&t){const t=u.ic(4);u.Cb(1),u.oc("icIcon",t.icCheck)}}function kt(t,e){if(1&t){const t=u.Xb();u.Wb(0,"span"),u.Wb(1,"mat-icon",56),u.ec("click",(function(){u.wc(t);const e=u.ic(4);return e.estadoAnulacion(e.venta.idventa)})),u.Vb(),u.Vb()}if(2&t){const t=u.ic(4);u.Cb(1),u.oc("icIcon",t.icAutorenew)}}function Lt(t,e){if(1&t&&(u.Wb(0,"div",41),u.Ec(1,St,2,1,"span",8),u.Ec(2,kt,2,1,"span",8),u.Vb()),2&t){const t=u.ic(3);u.oc("ngSwitch",t.venta.sunat_anulado_aceptado),u.Cb(1),u.oc("ngSwitchCase",1),u.Cb(1),u.oc("ngSwitchCase",0)}}function Dt(t,e){1&t&&(u.Wb(0,"span"),u.Gc(1,"DNI"),u.Vb())}function _t(t,e){1&t&&(u.Wb(0,"span"),u.Gc(1,"RUC"),u.Vb())}function Nt(t,e){1&t&&(u.Wb(0,"span"),u.Gc(1,"C.EXT."),u.Vb())}function At(t,e){1&t&&(u.Wb(0,"span"),u.Gc(1,"PASAP."),u.Vb())}function Tt(t,e){1&t&&(u.Wb(0,"span"),u.Gc(1,"SIN DOC."),u.Vb())}function Ot(t,e){1&t&&(u.Wb(0,"small"),u.Gc(1,"(Enviado)"),u.Vb())}function Pt(t,e){1&t&&(u.Wb(0,"small"),u.Gc(1,"(Pendiente)"),u.Vb())}function qt(t,e){if(1&t&&(u.Wb(0,"div",32),u.Wb(1,"div",49),u.Gc(2,"Modificado por"),u.Vb(),u.Wb(3,"div",57),u.Gc(4),u.Vb(),u.Wb(5,"div",49),u.Gc(6,"Fecha y hora"),u.Vb(),u.Wb(7,"div",50),u.Gc(8),u.Vb(),u.Vb()),2&t){const t=u.ic(3);u.Cb(4),u.Hc(null==t.venta.modificacion?null:t.venta.modificacion.name),u.Cb(4),u.Hc(t.venta.updated_at)}}function jt(t,e){if(1&t&&(u.Wb(0,"div"),u.Wb(1,"fieldset"),u.Wb(2,"legend"),u.Gc(3,"Archivos electr\xf3nicos"),u.Vb(),u.Wb(4,"div",32),u.Wb(5,"div",33),u.Wb(6,"div",34),u.Ec(7,mt,4,1,"button",35),u.Ec(8,pt,4,1,"button",36),u.Ec(9,ft,4,1,"button",36),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Wb(10,"div",37),u.Wb(11,"fieldset",38),u.Ec(12,vt,2,0,"legend",8),u.Ec(13,ht,2,0,"legend",8),u.Ec(14,gt,2,0,"legend",8),u.Ec(15,Vt,2,0,"legend",8),u.Wb(16,"div",32),u.Wb(17,"div",39),u.Gc(18,"N\xfamero"),u.Vb(),u.Wb(19,"div",40),u.Gc(20),u.Vb(),u.Wb(21,"div",39),u.Gc(22,"Moneda"),u.Vb(),u.Wb(23,"div",40),u.Gc(24),u.Vb(),u.Vb(),u.Wb(25,"div",32),u.Wb(26,"div",39),u.Gc(27,"F.Emisi\xf3n"),u.Vb(),u.Wb(28,"div",40),u.Gc(29),u.jc(30,"date"),u.Vb(),u.Wb(31,"div",39),u.Gc(32,"F.Venci."),u.Vb(),u.Wb(33,"div",40),u.Gc(34),u.jc(35,"date"),u.Vb(),u.Vb(),u.Wb(36,"div",32),u.Wb(37,"div",39),u.Gc(38,"Estado"),u.Vb(),u.Wb(39,"div",41),u.Ec(40,Ct,2,0,"span",8),u.Ec(41,xt,2,0,"span",8),u.Ec(42,Wt,2,0,"span",8),u.Vb(),u.Wb(43,"div",39),u.Gc(44,"Total"),u.Vb(),u.Wb(45,"div",41),u.Ec(46,wt,2,0,"span",8),u.Ec(47,Ft,2,0,"span",8),u.Ec(48,yt,2,0,"span",8),u.Gc(49),u.Vb(),u.Vb(),u.Wb(50,"div",32),u.Wb(51,"div",39),u.Gc(52),u.Vb(),u.Wb(53,"div",41),u.Ec(54,It,2,1,"span",8),u.Ec(55,Et,2,1,"span",8),u.Ec(56,Gt,2,1,"span",42),u.Vb(),u.Ec(57,Rt,2,1,"div",43),u.Ec(58,Lt,3,3,"div",44),u.Vb(),u.Vb(),u.Wb(59,"fieldset",45),u.Wb(60,"legend"),u.Gc(61,"Cliente"),u.Vb(),u.Wb(62,"div",32),u.Wb(63,"div",39),u.Gc(64,"Se\xf1or(es)"),u.Vb(),u.Wb(65,"div",46),u.Gc(66),u.Vb(),u.Vb(),u.Wb(67,"div",32),u.Wb(68,"div",47),u.Ec(69,Dt,2,0,"span",8),u.Ec(70,_t,2,0,"span",8),u.Ec(71,Nt,2,0,"span",8),u.Ec(72,At,2,0,"span",8),u.Ec(73,Tt,2,0,"span",8),u.Vb(),u.Wb(74,"div",46),u.Gc(75),u.Vb(),u.Vb(),u.Wb(76,"div",32),u.Wb(77,"div",39),u.Gc(78,"Direcci\xf3n"),u.Vb(),u.Wb(79,"div",46),u.Gc(80),u.Vb(),u.Vb(),u.Wb(81,"div",32),u.Wb(82,"div",39),u.Gc(83,"Correo"),u.Vb(),u.Wb(84,"div",46),u.Gc(85),u.Ec(86,Ot,2,0,"small",0),u.Ec(87,Pt,2,0,"small",0),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Wb(88,"fieldset",48),u.Wb(89,"legend"),u.Gc(90,"Registro"),u.Vb(),u.Wb(91,"div",32),u.Wb(92,"div",49),u.Gc(93,"Creado por"),u.Vb(),u.Wb(94,"div",50),u.Gc(95),u.Vb(),u.Wb(96,"div",49),u.Gc(97,"Fecha y hora"),u.Vb(),u.Wb(98,"div",50),u.Gc(99),u.Vb(),u.Vb(),u.Ec(100,qt,9,2,"div",51),u.Vb(),u.Vb()),2&t){const t=u.ic(2);u.Cb(7),u.oc("ngIf",t.venta.pdf),u.Cb(1),u.oc("ngIf",t.venta.xml),u.Cb(1),u.oc("ngIf",t.venta.cdr),u.Cb(2),u.oc("ngSwitch",t.venta.iddocumentofiscal),u.Cb(1),u.oc("ngSwitchCase",1),u.Cb(1),u.oc("ngSwitchCase",2),u.Cb(1),u.oc("ngSwitchCase",10),u.Cb(1),u.oc("ngSwitchCase",13),u.Cb(5),u.Jc("",t.venta.serie," - ",t.venta.numero,""),u.Cb(4),u.Hc(t.venta.moneda),u.Cb(5),u.Hc(u.lc(30,43,t.venta.fechaemision,"dd/MM/yyyy")),u.Cb(5),u.Hc(u.lc(35,46,t.venta.fechavencimiento,"dd/MM/yyyy")),u.Cb(5),u.oc("ngSwitch",t.venta.idestadodocumento),u.Cb(1),u.oc("ngSwitchCase",26),u.Cb(1),u.oc("ngSwitchCase",27),u.Cb(1),u.oc("ngSwitchCase",28),u.Cb(3),u.oc("ngSwitch",t.venta.moneda),u.Cb(1),u.oc("ngSwitchCase","PEN"),u.Cb(1),u.oc("ngSwitchCase","USD"),u.Cb(1),u.oc("ngSwitchCase","EUR"),u.Cb(1),u.Ic(" ",t.venta.total," "),u.Cb(3),u.Ic("Emisi\xf3n (",t.venta.sunat_aceptado,")"),u.Cb(1),u.oc("ngSwitch",t.venta.sunat_aceptado),u.Cb(1),u.oc("ngSwitchCase",1),u.Cb(1),u.oc("ngSwitchCase",0),u.Cb(2),u.oc("ngIf",t.venta.sunat_anulado_aceptado),u.Cb(1),u.oc("ngIf",t.venta.sunat_anulado_aceptado),u.Cb(8),u.Hc(t.venta.clientenombre),u.Cb(2),u.oc("ngSwitch",t.venta.clientedoc),u.Cb(1),u.oc("ngSwitchCase",1),u.Cb(1),u.oc("ngSwitchCase",2),u.Cb(1),u.oc("ngSwitchCase",3),u.Cb(1),u.oc("ngSwitchCase",4),u.Cb(1),u.oc("ngSwitchCase",5),u.Cb(2),u.Hc(t.venta.clientenumerodoc),u.Cb(5),u.Hc(t.venta.clientedireccion),u.Cb(5),u.Ic("",t.venta.cpecorreo," "),u.Cb(1),u.oc("ngIf","1"===t.venta.sendcorreo),u.Cb(1),u.oc("ngIf",!t.venta.sendcorreo),u.Cb(8),u.Hc(null==t.venta.creacion?null:t.venta.creacion.name),u.Cb(4),u.Hc(t.venta.created_at),u.Cb(1),u.oc("ngIf",t.venta.modificacion)}}function Mt(t,e){1&t&&(u.Wb(0,"div"),u.Gc(1," PDF no existe, porfavor comunicarse con soporte. "),u.Vb())}function Qt(t,e){if(1&t&&(u.Wb(0,"object",59),u.jc(1,"domseguro"),u.Gc(2,"Comunicarse con proveedor de servicios electr\xf3nicos"),u.Vb()),2&t){const t=u.ic(3);u.oc("data",u.lc(1,1,t.venta.pdf,""),u.yc)}}function Bt(t,e){if(1&t&&(u.Wb(0,"div",23),u.Ec(1,Mt,2,0,"div",0),u.Ec(2,Qt,3,4,"object",58),u.Vb()),2&t){const t=u.ic(2);u.Cb(1),u.oc("ngIf",!t.venta.pdf),u.Cb(1),u.oc("ngIf",t.venta.pdf)}}function $t(t,e){if(1&t){const t=u.Xb();u.Wb(0,"div"),u.Wb(1,"div",5),u.Wb(2,"mat-toolbar",6),u.Wb(3,"h2",7),u.Ec(4,it,2,2,"span",8),u.Ec(5,nt,2,2,"span",8),u.Ec(6,ct,2,2,"span",8),u.Ec(7,rt,2,2,"span",8),u.Vb(),u.Rb(8,"mat-divider"),u.Ec(9,st,2,1,"button",9),u.Ec(10,lt,2,1,"button",10),u.Wb(11,"button",11),u.ec("click",(function(){u.wc(t);const e=u.ic();return e.printPdf(e.venta.pdf)})),u.Rb(12,"mat-icon",12),u.Vb(),u.Ec(13,dt,2,2,"a",13),u.Wb(14,"button",14),u.ec("click",(function(){u.wc(t);const e=u.ic();return e.downloadFile(e.venta.pdf)})),u.Rb(15,"mat-icon",12),u.Vb(),u.Ec(16,ut,2,1,"button",15),u.Ec(17,bt,2,1,"button",16),u.Wb(18,"button",17),u.Rb(19,"mat-icon",12),u.Vb(),u.Wb(20,"button",18),u.Rb(21,"mat-icon",12),u.Vb(),u.Vb(),u.Wb(22,"mat-tab-group",19,20),u.ec("selectedTabChange",(function(e){return u.wc(t),u.ic().handleTabChange(e)})),u.Rb(24,"mat-tab",21),u.Rb(25,"mat-tab",22),u.Vb(),u.Vb(),u.Wb(26,"mat-dialog-content",23),u.Ec(27,jt,101,49,"div",0),u.Ec(28,Bt,3,2,"div",24),u.Vb(),u.Wb(29,"mat-dialog-actions",25),u.Wb(30,"button",26),u.Gc(31," CERRAR "),u.Vb(),u.Vb(),u.Vb()}if(2&t){const t=u.ic(),e=u.uc(4);u.Cb(3),u.oc("ngSwitch",t.venta.iddocumentofiscal),u.Cb(1),u.oc("ngSwitchCase",1),u.Cb(1),u.oc("ngSwitchCase",2),u.Cb(1),u.oc("ngSwitchCase",10),u.Cb(1),u.oc("ngSwitchCase",13),u.Cb(2),u.oc("ngIf",t.botones.canu),u.Cb(1),u.oc("ngIf",t.botones.rpdf),u.Cb(2),u.oc("icIcon",t.icPrint),u.Cb(1),u.oc("ngIf",t.botones.nvent),u.Cb(2),u.oc("icIcon",t.icCloudDownload),u.Cb(1),u.oc("ngIf",t.botones.mail),u.Cb(1),u.oc("ngIf",t.botones.edit),u.Cb(1),u.oc("matMenuTriggerFor",e),u.Cb(1),u.oc("icIcon",t.icMoreVert),u.Cb(2),u.oc("icIcon",t.icClose),u.Cb(1),u.oc("selectedIndex",t.activeTabIndex)("color","accent")("backgroundColor","primary"),u.Cb(5),u.oc("ngIf",0===t.activeTabIndex),u.Cb(1),u.oc("ngIf",1===t.activeTabIndex)}}function zt(t,e){if(1&t){const t=u.Xb();u.Wb(0,"button",60),u.ec("click",(function(){return u.wc(t),u.ic().matDialogRef.close("anular")})),u.Rb(1,"mat-icon",61),u.Gc(2," Anular "),u.Vb()}if(2&t){const t=u.ic();u.Cb(1),u.oc("icIcon",t.icBlock)}}function Ht(t,e){if(1&t){const t=u.Xb();u.Wb(0,"button",60),u.ec("click",(function(){return u.wc(t),u.ic().matDialogRef.close("regenerar")})),u.Rb(1,"mat-icon",12),u.Gc(2," Regenerar PDF "),u.Vb()}if(2&t){const t=u.ic();u.Cb(1),u.oc("icIcon",t.icAutorenew)}}function Xt(t,e){if(1&t){const t=u.Xb();u.Wb(0,"button",60),u.ec("click",(function(){return u.wc(t),u.ic().matDialogRef.close("Notadecredito")})),u.Rb(1,"mat-icon",12),u.Gc(2," Nota de cr\xe9dito "),u.Vb()}if(2&t){const t=u.ic();u.Cb(1),u.oc("icIcon",t.icInsertDriveFile)}}function Ut(t,e){if(1&t){const t=u.Xb();u.Wb(0,"button",60),u.ec("click",(function(){return u.wc(t),u.ic().matDialogRef.close("Notadedebito")})),u.Rb(1,"mat-icon",12),u.Gc(2," Nota de d\xe9bito "),u.Vb()}if(2&t){const t=u.ic();u.Cb(1),u.oc("icIcon",t.icInsertDriveFile)}}function Kt(t,e){if(1&t&&(u.Wb(0,"button",62),u.Rb(1,"mat-icon",12),u.Gc(2," Guia de remisi\xf3n "),u.Vb()),2&t){const t=u.ic();u.Cb(1),u.oc("icIcon",t.icInsertDriveFile)}}let Jt=(()=>{class t{constructor(t,e,o,a,i,n,c){this.data=t,this.matDialogRef=e,this._matDialog=o,this._ventaService=a,this._utils=i,this.snackBar=n,this._entidadService=c,this.activeTabIndex=void 0,this.icEdit=A.a,this.icBlock=O.a,this.icPrint=h.a,this.icClose=V.a,this.icCallMade=f.a,this.icCloudDownload=x.a,this.icMail=q.a,this.icMoreVert=M.a,this.icInsertDriveFile=B.a,this.icAutorenew=z.a,this.icCheck=X.a,this.submitted=!1,this.show(),this.botones=t.botones,console.log(this.botones)}ngOnInit(){}ngAfterViewInit(){this.activeTabIndex="COMPROBANTE"===this.data.pestana?1:0}handleTabChange(t){this.activeTabIndex=t.index}show(){this.loading=!0,this._ventaService.show(this.data.idventa,{conRecurso:"ventadet.producto,creacion,modificacion"}).subscribe(t=>{this.venta=t.data,console.log("this.venta",this.venta),this.loading=!1},t=>{this.loading=!1})}estadoAnulacion(t){this.submitted=!0,this._ventaService.estadoAnulacion(t).subscribe(t=>{this.venta.sunat_anulado_aceptado="1",this.submitted=!1,this.snackBar.open(t.data,"Cerrar")},t=>{this.submitted=!1;const e=this._utils.convertError(t);this.snackBar.open(e,"Cerrar",{panelClass:["error-dialog"]})})}estadoComprobante(t){this.submitted=!0,this._ventaService.estadoComprobante(t).subscribe(t=>{this.venta.sunat_aceptado="1",this.submitted=!1,this.snackBar.open(t.data,"Cerrar")},t=>{this.submitted=!1;const e=this._utils.convertError(t);this.snackBar.open(e,"Cerrar",{panelClass:["error-dialog"]})})}downloadFile(t){const e=this.urlPdf(t);this._ventaService.downloadProxy(e).subscribe(e=>{const o=t.split("/").reverse()[0];Object(l.saveAs)(e,o)},t=>{})}printPdf(t){const e=this.urlPdf(t);this._ventaService.downloadProxy(e).subscribe(t=>{const e=new Blob([t],{type:"application/pdf"}),o=URL.createObjectURL(e),a=document.createElement("iframe");a.style.display="none",a.src=o,document.body.appendChild(a),a.contentWindow.print()},t=>{})}urlPdf(t){console.log(t);const e=t.split("/").reverse()[0],o=t.split("/").reverse()[1];return"localhost"===location.hostname?"/empresa/"+this._entidadService.settings.idempresa+"/"+o+"/"+e:"/api/public/empresa/"+this._entidadService.settings.idempresa+"/"+o+"/"+e}}return t.\u0275fac=function(e){return new(e||t)(u.Qb(d.a),u.Qb(d.g),u.Qb(d.b),u.Qb(b.a),u.Qb(U.a),u.Qb(K.b),u.Qb(J.a))},t.\u0275cmp=u.Kb({type:t,selectors:[["vex-venta-show"]],viewQuery:function(t,e){var o;1&t&&u.Nc(et,!0),2&t&&u.tc(o=u.fc())&&(e.tabGroup=o.first)},decls:10,vars:8,consts:[[4,"ngIf"],["xPosition","before","yPosition","below"],["settingsMenu","matMenu"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-menu-item","",4,"ngIf"],["mat-dialog-title","","fxLayout","column"],["color","primary","fxLayout","row","fxLayoutAlign","start center"],["fxFlex","auto",1,"headline","m-0",3,"ngSwitch"],[4,"ngSwitchCase"],["mat-icon-button","","type","button","class","text-secondary","matTooltip","Consultar anulaci\xf3n",3,"click",4,"ngIf"],["mat-icon-button","","type","button","class","text-secondary","matTooltip","Regenerar PDF",3,"click",4,"ngIf"],["mat-icon-button","","type","button","matTooltip","Imprimir",1,"text-secondary",3,"click"],[3,"icIcon"],["mat-icon-button","","target","_blank","class","text-secondary","matTooltip","Nueva pesta\xf1a",3,"href",4,"ngIf"],["mat-icon-button","","type","button","matTooltip","Descargar PDF",1,"text-secondary",3,"click"],["class","text-secondary","mat-icon-button","","type","button","matTooltip","Enviar correo",3,"click",4,"ngIf"],["class","text-secondary","type","button","mat-icon-button","","matTooltip","Editar",3,"click",4,"ngIf"],["mat-icon-button","","type","button","matTooltip","M\xe1s acciones",1,"text-secondary",3,"matMenuTriggerFor"],["mat-icon-button","","type","button","mat-dialog-close","","matTooltip","Cerrar",1,"text-secondary"],["fxFlex","auto",3,"selectedIndex","color","backgroundColor","selectedTabChange"],["tabGroup",""],["label","VENTA"],["label","COMPROBANTE",1,"p-0","m-0"],["fxLayout","column"],["fxLayout","column",4,"ngIf"],["align","end"],["mat-button","","mat-dialog-close","","aria-label","CERRAR"],["mat-icon-button","","type","button","matTooltip","Consultar anulaci\xf3n",1,"text-secondary",3,"click"],["mat-icon-button","","type","button","matTooltip","Regenerar PDF",1,"text-secondary",3,"click"],["mat-icon-button","","target","_blank","matTooltip","Nueva pesta\xf1a",1,"text-secondary",3,"href"],["mat-icon-button","","type","button","matTooltip","Enviar correo",1,"text-secondary",3,"click"],["type","button","mat-icon-button","","matTooltip","Editar",1,"text-secondary",3,"click"],["fxLayout","row","fxLayout.xs","column","fxLayoutAlign","start start"],["fxFlex","70"],["fxLayout","row","fxLayout.xs","column","fxLayoutAlign","start start","fxLayoutGap","6px"],["mat-raised-button","","type","button","color","primary","class","rounded-full",3,"click",4,"ngIf"],["mat-raised-button","","type","button","color","accent","class","rounded-full",3,"click",4,"ngIf"],["fxLayout","row","fxLayout.lt-sm","column","fxLayoutGap","16px","fxLayoutGap.lt-sm","0"],["fxFlex","50",1,"mt-4",3,"ngSwitch"],["fxFlex","20"],["fxFlex","30"],["fxFlex","30",3,"ngSwitch"],[4,"ngSwitchDefault"],["fxFlex","20",4,"ngIf"],["fxFlex","30",3,"ngSwitch",4,"ngIf"],["fxFlex","50",1,"mt-4"],["fxFlex","80"],["fxFlex","20",3,"ngSwitch"],[1,"mt-4"],["fxFlex","15"],["fxFlex","35"],["fxLayout","row","fxLayout.xs","column","fxLayoutAlign","start start",4,"ngIf"],["mat-raised-button","","type","button","color","primary",1,"rounded-full",3,"click"],["inline","true","size","24px",1,"ltr:-ml-1","rtl:-mr-1","ltr:mr-2","rtl:ml-2",3,"icon"],["mat-raised-button","","type","button","color","accent",1,"rounded-full",3,"click"],["size","18px","color","primary",3,"icIcon"],["size","18px","color","warn",3,"icIcon","click"],["fxFlex","85"],["name","DocumentoPresupuesto","type","application/pdf","height","600","width","100%",3,"data",4,"ngIf"],["name","DocumentoPresupuesto","type","application/pdf","height","600","width","100%",3,"data"],["mat-menu-item","",3,"click"],["color","warn",3,"icIcon"],["mat-menu-item",""]],template:function(t,e){1&t&&(u.Ec(0,ot,1,0,"vex-loading",0),u.Ec(1,at,1,0,"vex-loading",0),u.Ec(2,$t,32,20,"div",0),u.Wb(3,"mat-menu",1,2),u.Ec(5,zt,3,1,"button",3),u.Ec(6,Ht,3,1,"button",3),u.Ec(7,Xt,3,1,"button",3),u.Ec(8,Ut,3,1,"button",3),u.Ec(9,Kt,3,1,"button",4),u.Vb()),2&t&&(u.oc("ngIf",e.loading),u.Cb(1),u.oc("ngIf",e.submitted),u.Cb(1),u.oc("ngIf",!e.loading),u.Cb(3),u.oc("ngIf",e.botones.anu),u.Cb(1),u.oc("ngIf",e.botones.rpdf),u.Cb(1),u.oc("ngIf",e.botones.nc),u.Cb(1),u.oc("ngIf",e.botones.nd),u.Cb(1),u.oc("ngIf",e.botones.gr))},directives:[W.p,Y.d,w.a,d.h,F.c,Z.a,F.b,F.a,W.r,W.s,R.a,y.b,I.a,E.a,G.a,Y.c,d.d,tt.b,tt.a,d.e,d.c,y.a,F.d,W.t,Y.a],pipes:[W.e,k],styles:["@media (min-width:960px){.venta-show-dialog{width:960px}}.venta-show-dialog .mat-dialog-container{padding:0;margin:0}.venta-show-dialog .mat-dialog-content{padding:0 16px;margin:0}.venta-show-dialog .mat-dialog-actions{padding:16px 24px;margin:0}.venta-show-dialog table{width:100%}.venta-show-dialog table td{padding:4px}.venta-show-dialog fieldset{border:1px solid #ccc;border-radius:8px;line-height:24px;padding:8px}.venta-show-dialog fieldset legend{padding:0 8px}"],encapsulation:2}),t})();function Yt(t,e){1&t&&u.Rb(0,"vex-loading")}function Zt(t,e){if(1&t){const t=u.Xb();u.Wb(0,"div",2),u.Wb(1,"div",3),u.Wb(2,"mat-toolbar",4),u.Wb(3,"mat-toolbar-row",5),u.Wb(4,"span"),u.Gc(5,"PDF"),u.Vb(),u.Wb(6,"div",6),u.Wb(7,"button",7),u.Wb(8,"mat-icon"),u.Gc(9,"print"),u.Vb(),u.Vb(),u.Wb(10,"button",8),u.ec("click",(function(){return u.wc(t),u.ic().matDialogRef.close()})),u.Wb(11,"mat-icon"),u.Gc(12,"close"),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Wb(13,"div",9),u.Wb(14,"div",10),u.Wb(15,"div",11),u.Wb(16,"object",12),u.jc(17,"domseguro"),u.Gc(18,"Esto no est\xe1 funcionando como se esperaba"),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Wb(19,"div",13),u.Wb(20,"button",14),u.ec("click",(function(){return u.wc(t),u.ic().matDialogRef.close()})),u.Gc(21," CERRAR "),u.Vb(),u.Vb(),u.Vb()}if(2&t){const t=u.ic();u.Cb(16),u.oc("data",u.lc(17,1,t.url,"http://apiclinicanet.pe/"),u.yc)}}let te=(()=>{class t{constructor(t,e,o,a){this.data=t,this.matDialogRef=e,this._matDialog=o,this._ventaService=a}ngOnInit(){this.loading=!1,this.url="temporal/s2qWQ4fJg8j6nzcw.pdf"}}return t.\u0275fac=function(e){return new(e||t)(u.Qb(d.a),u.Qb(d.g),u.Qb(d.b),u.Qb(b.a))},t.\u0275cmp=u.Kb({type:t,selectors:[["vex-venta-dowloand"]],decls:2,vars:2,consts:[[4,"ngIf"],["class","dialog-content-wrapper",4,"ngIf"],[1,"dialog-content-wrapper"],["mat-dialog-title","",1,"m-0"],[1,"primary"],["fxFlex","","fxLayout","row","fxLayoutAlign","space-between center"],["fxLayout","row","fxLayoutAlign","end center"],["mat-icon-button","","type","button","aria-label","Imprimir","matTooltip","Imprimir"],["mat-icon-button","","type","button","matTooltip","Cerrar",3,"click"],["mat-dialog-content","","fusePerfectScrollbar","",1,"p-0","m-0"],["fxLayout","column","fxFlex",""],[1,"p-24"],["name","DocumentoPresupuesto","type","application/pdf","width","100%","height","800",3,"data"],["mat-dialog-actions","","fxLayout","row","fxLayoutAlign","end center",1,"p-16","m-0"],["mat-button","","aria-label","CERRAR","color","accent",3,"click"]],template:function(t,e){1&t&&(u.Ec(0,Yt,1,0,"vex-loading",0),u.Ec(1,Zt,22,4,"div",1)),2&t&&(u.oc("ngIf",e.loading),u.Cb(1),u.oc("ngIf",!e.loading))},directives:[W.p,w.a,d.h,Z.a,Z.c,F.a,F.c,F.b,y.b,I.a,E.a,d.e,d.c],pipes:[k],styles:[".venta-download-dialog .mat-dialog-container{padding:0}.venta-download-dialog .dialog-content-wrapper{max-height:85vh;display:flex;flex-direction:column}"],encapsulation:2}),t})();var ee=o("eUUZ"),oe=o("kmnG"),ae=o("qFsG");const ie=["motivo"];function ne(t,e){1&t&&u.Rb(0,"vex-loading")}let ce=(()=>{class t{constructor(t,e,o,a,i,n){this._data=t,this.matDialogRef=e,this._ventaService=o,this.snackBar=a,this._utils=i,this._datainicial=n,this.formatos=this._datainicial.formatos,this.operaciones=this._datainicial.operaciones,this.icClose=V.a,this.submitted=!1,this._data=this._data.venta}ngOnInit(){this.anularForm=this.createForm(),setTimeout(()=>{this.motivoElement.nativeElement.focus()},0)}createForm(){let t;switch(this._data.iddocumentofiscal){case 1:t="Factura";break;case 2:t="Boleta de venta";break;case 10:t="Nota de d\xe9bito";break;case 13:t="Nota de cr\xe9dito"}return new i.h({comprobante:new i.e({value:`${t} ${this._data.serie} - ${this._data.numero}`,disabled:!1}),motivoanulacion:new i.e(null)})}save(){let t,e={};switch(e=this.anularForm.getRawValue(),this._data.iddocumentofiscal){case 1:t="Factura";break;case 2:t="Boleta de venta";break;case 10:t="Nota de d\xe9bito";break;case 13:t="Nota de cr\xe9dito"}const o=`${t} ${this._data.serie} - ${this._data.numero}`;this.submitted=!0,this._ventaService.anular(this._data.idventa,e).subscribe(t=>{this.submitted=!1,this.snackBar.open(`${o} anulado.`,"Cerrar"),this.matDialogRef.close(t)},t=>{this.submitted=!1;const e=this._utils.convertError(t);this.snackBar.open(e,"Cerrar",{panelClass:["error-dialog"]})})}}return t.\u0275fac=function(e){return new(e||t)(u.Qb(d.a),u.Qb(d.g),u.Qb(b.a),u.Qb(K.b),u.Qb(U.a),u.Qb(ee.a))},t.\u0275cmp=u.Kb({type:t,selectors:[["vex-ventas-anular"]],viewQuery:function(t,e){var o;1&t&&u.Nc(ie,!0),2&t&&u.tc(o=u.fc())&&(e.motivoElement=o.first)},decls:23,vars:6,consts:[[4,"ngIf"],[3,"formGroup","ngSubmit"],["fxLayout","row","fxLayoutAlign","start center","mat-dialog-title",""],["fxFlex","auto",1,"headline","m-0"],["mat-dialog-close","","mat-icon-button","","type","button",1,"text-secondary"],[3,"icIcon"],[1,"-mx-6","text-border"],["fxLayout","column"],["appearance","standard"],["matInput","","formControlName","comprobante",3,"readonly"],["appearance","fill",3,"floatLabel"],["matInput","","formControlName","motivoanulacion"],["motivo",""],["align","end"],["mat-button","","mat-dialog-close","","type","button"],["color","primary","mat-raised-button","","type","submit",3,"disabled"]],template:function(t,e){1&t&&(u.Ec(0,ne,1,0,"vex-loading",0),u.Wb(1,"form",1),u.ec("ngSubmit",(function(){return e.save()})),u.Wb(2,"div",2),u.Wb(3,"h2",3),u.Gc(4,"Anulaci\xf3n"),u.Vb(),u.Wb(5,"button",4),u.Rb(6,"mat-icon",5),u.Vb(),u.Vb(),u.Rb(7,"mat-divider",6),u.Wb(8,"mat-dialog-content",7),u.Wb(9,"mat-form-field",8),u.Wb(10,"mat-label"),u.Gc(11,"Comprobante"),u.Vb(),u.Rb(12,"input",9),u.Vb(),u.Wb(13,"mat-form-field",10),u.Wb(14,"mat-label"),u.Gc(15,"Motivo de anulaci\xf3n (Opcional)"),u.Vb(),u.Rb(16,"input",11,12),u.Vb(),u.Vb(),u.Wb(18,"mat-dialog-actions",13),u.Wb(19,"button",14),u.Gc(20,"CERRAR"),u.Vb(),u.Wb(21,"button",15),u.Gc(22,"SI, ANULAR"),u.Vb(),u.Vb(),u.Vb()),2&t&&(u.oc("ngIf",e.submitted),u.Cb(1),u.oc("formGroup",e.anularForm),u.Cb(5),u.oc("icIcon",e.icClose),u.Cb(6),u.oc("readonly",!0),u.Cb(1),u.oc("floatLabel","always"),u.Cb(8),u.oc("disabled",e.anularForm.invalid||e.submitted))},directives:[W.p,i.w,i.q,i.i,F.c,F.b,d.h,F.a,y.b,d.d,E.a,G.a,R.a,d.e,oe.d,oe.h,ae.b,i.b,i.p,i.g,d.c,w.a],styles:["@media (min-width:960px){.ventasanular-form-dialog{width:400px}}"],encapsulation:2}),t})();const re=["correo"];function se(t,e){1&t&&u.Rb(0,"vex-loading")}function le(t,e){1&t&&(u.Wb(0,"mat-error"),u.Gc(1," Es requerido "),u.Vb())}function de(t,e){1&t&&(u.Wb(0,"mat-error"),u.Gc(1," Correo inv\xe1lido! "),u.Vb())}let ue=(()=>{class t{constructor(t,e,o,a,i,n){this._data=t,this.matDialogRef=e,this._ventaService=o,this.snackBar=a,this._utils=i,this._datainicial=n,this.icClose=V.a,this.icMail=q.a,this.submitted=!1,this._data=this._data.venta}ngOnInit(){this.correoForm=this.createForm(),setTimeout(()=>{this.correoElement.nativeElement.focus()},0)}createForm(){let t;switch(this._data.iddocumentofiscal){case 1:t="Factura";break;case 2:t="Boleta de venta";break;case 10:t="Nota de d\xe9bito";break;case 13:t="Nota de cr\xe9dito"}return new i.h({comprobante:new i.e({value:`${t} ${this._data.serie} - ${this._data.numero}`,disabled:!1}),cpecorreo:new i.e(null,[i.v.required,i.v.email])})}save(){let t,e={};switch(e=this.correoForm.getRawValue(),this._data.iddocumentofiscal){case 1:t="Factura";break;case 2:t="Boleta de venta";break;case 10:t="Nota de d\xe9bito";break;case 13:t="Nota de cr\xe9dito"}const o=`${t} ${this._data.serie} - ${this._data.numero}`;this.submitted=!0,this._ventaService.correoEnvio(this._data.idventa,e).subscribe(t=>{this.submitted=!1,this.snackBar.open(`${o} enviado.`,"Cerrar"),this.matDialogRef.close(t)},t=>{this.submitted=!1;const e=this._utils.convertError(t);this.snackBar.open(e,"Cerrar",{panelClass:["error-dialog"]})})}}return t.\u0275fac=function(e){return new(e||t)(u.Qb(d.a),u.Qb(d.g),u.Qb(b.a),u.Qb(K.b),u.Qb(U.a),u.Qb(ee.a))},t.\u0275cmp=u.Kb({type:t,selectors:[["vex-ventas-correo"]],viewQuery:function(t,e){var o;1&t&&u.Nc(re,!0),2&t&&u.tc(o=u.fc())&&(e.correoElement=o.first)},decls:26,vars:9,consts:[[4,"ngIf"],[3,"formGroup","ngSubmit"],["fxLayout","row","fxLayoutAlign","start center","mat-dialog-title",""],["fxFlex","auto",1,"headline","m-0"],["mat-dialog-close","","mat-icon-button","","type","button",1,"text-secondary"],[3,"icIcon"],[1,"-mx-6","text-border"],["fxLayout","column"],["appearance","standard"],["matInput","","formControlName","comprobante",3,"readonly"],["appearance","fill",3,"floatLabel"],["matInput","","formControlName","cpecorreo","required",""],["correo",""],["matPrefix","",1,"mr-2",3,"icIcon"],["align","end"],["mat-button","","mat-dialog-close","","type","button"],["color","primary","mat-raised-button","","type","submit",3,"disabled"]],template:function(t,e){1&t&&(u.Ec(0,se,1,0,"vex-loading",0),u.Wb(1,"form",1),u.ec("ngSubmit",(function(){return e.save()})),u.Wb(2,"div",2),u.Wb(3,"h2",3),u.Gc(4,"Env\xedo a correo"),u.Vb(),u.Wb(5,"button",4),u.Rb(6,"mat-icon",5),u.Vb(),u.Vb(),u.Rb(7,"mat-divider",6),u.Wb(8,"mat-dialog-content",7),u.Wb(9,"mat-form-field",8),u.Wb(10,"mat-label"),u.Gc(11,"Comprobante"),u.Vb(),u.Rb(12,"input",9),u.Vb(),u.Wb(13,"mat-form-field",10),u.Wb(14,"mat-label"),u.Gc(15,"Correo electr\xf3nico"),u.Vb(),u.Rb(16,"input",11,12),u.Rb(18,"mat-icon",13),u.Ec(19,le,2,0,"mat-error",0),u.Ec(20,de,2,0,"mat-error",0),u.Vb(),u.Vb(),u.Wb(21,"mat-dialog-actions",14),u.Wb(22,"button",15),u.Gc(23,"Cancelar"),u.Vb(),u.Wb(24,"button",16),u.Gc(25,"Enviar"),u.Vb(),u.Vb(),u.Vb()),2&t&&(u.oc("ngIf",e.submitted),u.Cb(1),u.oc("formGroup",e.correoForm),u.Cb(5),u.oc("icIcon",e.icClose),u.Cb(6),u.oc("readonly",!0),u.Cb(1),u.oc("floatLabel","always"),u.Cb(5),u.oc("icIcon",e.icMail),u.Cb(1),u.oc("ngIf",e.correoForm.get("cpecorreo").hasError("required")),u.Cb(1),u.oc("ngIf",e.correoForm.get("cpecorreo").hasError("email")),u.Cb(4),u.oc("disabled",e.correoForm.invalid||e.submitted))},directives:[W.p,i.w,i.q,i.i,F.c,F.b,d.h,F.a,y.b,d.d,E.a,G.a,R.a,d.e,oe.d,oe.h,ae.b,i.b,i.p,i.g,i.u,oe.i,d.c,w.a,oe.c],styles:["@media (min-width:960px){.ventascorreo-form-dialog{width:400px}}"],encapsulation:2}),t})();var be=o("sF+I"),me=o.n(be),pe=o("7wwx"),fe=o.n(pe),ve=o("e3EN"),he=o.n(ve),ge=o("uQ9D"),Ve=o.n(ge),Ce=o("p+k2"),xe=o.n(Ce),We=o("rwX0"),we=o.n(We),Fe=o("+4LO"),ye=o.n(Fe),Ie=o("Fck7"),Ee=o.n(Ie),Ge=o("d3UM"),Re=o("FKr1");function Se(t,e){1&t&&u.Rb(0,"vex-loading")}function ke(t,e){if(1&t&&(u.Wb(0,"mat-option",17),u.Gc(1),u.Vb()),2&t){const t=e.$implicit;u.oc("value",t.id),u.Cb(1),u.Ic(" ",t.nombre," ")}}function Le(t,e){1&t&&(u.Wb(0,"mat-error"),u.Gc(1," Es requerido "),u.Vb())}let De=(()=>{class t{constructor(t,e,o,a,i,n){this._data=t,this.matDialogRef=e,this._ventaService=o,this.snackBar=a,this._utils=i,this._datainicial=n,this.formatos=this._datainicial.formatos,this.icClose=V.a,this.icPictureAsPdf=Ee.a,this.submitted=!1,this._data=this._data.venta}ngOnInit(){this.regenerarForm=this.createForm()}createForm(){return new i.h({comprobante:new i.e({value:`${this._data.docnegocio.nombre} ${this._data.serie} - ${this._data.numero}`,disabled:!1}),pdfformato:new i.e(null,[i.v.required])})}save(){const t={pdfformato:this.regenerarForm.get("pdfformato").value},e=`${this._data.docnegocio.nombre} ${this._data.serie} - ${this._data.numero}`;this.submitted=!0,this._ventaService.regenerarPdf(this._data.idventa,t).subscribe(t=>{this.submitted=!1,this.snackBar.open(`PDF de ${e} regenerado.`,"Cerrar"),this.matDialogRef.close(t)},t=>{this.submitted=!1;const e=this._utils.convertError(t);this.snackBar.open(e,"Cerrar",{panelClass:["error-dialog"]})})}}return t.\u0275fac=function(e){return new(e||t)(u.Qb(d.a),u.Qb(d.g),u.Qb(b.a),u.Qb(K.b),u.Qb(U.a),u.Qb(ee.a))},t.\u0275cmp=u.Kb({type:t,selectors:[["vex-ventas-regenerar"]],decls:25,vars:9,consts:[[4,"ngIf"],[3,"formGroup","ngSubmit"],["fxLayout","row","fxLayoutAlign","start center","mat-dialog-title",""],["fxFlex","auto",1,"headline","m-0"],["mat-dialog-close","","mat-icon-button","","type","button",1,"text-secondary"],[3,"icIcon"],[1,"-mx-6","text-border"],["fxLayout","column"],["appearance","standard"],["matInput","","formControlName","comprobante",3,"readonly"],["appearance","fill",3,"floatLabel"],["formControlName","pdfformato","required",""],[3,"value",4,"ngFor","ngForOf"],["matPrefix","",1,"mr-2",3,"icIcon"],["align","end"],["mat-button","","mat-dialog-close","","type","button"],["color","primary","mat-raised-button","","type","submit",3,"disabled"],[3,"value"]],template:function(t,e){1&t&&(u.Ec(0,Se,1,0,"vex-loading",0),u.Wb(1,"form",1),u.ec("ngSubmit",(function(){return e.save()})),u.Wb(2,"div",2),u.Wb(3,"h2",3),u.Gc(4,"Regenerar PDF"),u.Vb(),u.Wb(5,"button",4),u.Rb(6,"mat-icon",5),u.Vb(),u.Vb(),u.Rb(7,"mat-divider",6),u.Wb(8,"mat-dialog-content",7),u.Wb(9,"mat-form-field",8),u.Wb(10,"mat-label"),u.Gc(11,"Comprobante"),u.Vb(),u.Rb(12,"input",9),u.Vb(),u.Wb(13,"mat-form-field",10),u.Wb(14,"mat-label"),u.Gc(15,"Formato impresi\xf3n"),u.Vb(),u.Wb(16,"mat-select",11),u.Ec(17,ke,2,2,"mat-option",12),u.Vb(),u.Rb(18,"mat-icon",13),u.Ec(19,Le,2,0,"mat-error",0),u.Vb(),u.Vb(),u.Wb(20,"mat-dialog-actions",14),u.Wb(21,"button",15),u.Gc(22,"CERRAR"),u.Vb(),u.Wb(23,"button",16),u.Gc(24,"ACEPTAR"),u.Vb(),u.Vb(),u.Vb()),2&t&&(u.oc("ngIf",e.submitted),u.Cb(1),u.oc("formGroup",e.regenerarForm),u.Cb(5),u.oc("icIcon",e.icClose),u.Cb(6),u.oc("readonly",!0),u.Cb(1),u.oc("floatLabel","always"),u.Cb(4),u.oc("ngForOf",e.formatos),u.Cb(1),u.oc("icIcon",e.icPictureAsPdf),u.Cb(1),u.oc("ngIf",e.regenerarForm.get("pdfformato").hasError("required")),u.Cb(4),u.oc("disabled",e.regenerarForm.invalid||e.submitted))},directives:[W.p,i.w,i.q,i.i,F.c,F.b,d.h,F.a,y.b,d.d,E.a,G.a,R.a,d.e,oe.d,oe.h,ae.b,i.b,i.p,i.g,Ge.a,i.u,W.o,oe.i,d.c,w.a,Re.n,oe.c],styles:["@media (min-width:960px){.ventasregenerar-form-dialog{width:400px}}"],encapsulation:2}),t})();var _e=o("+0xr"),Ne=o("ZuBe"),Ae=o("uwSD"),Te=o("Z998"),Oe=o("znSr"),Pe=o("C0s9"),qe=o("/1cH"),je=o("iadO"),Me=o("Dh3D"),Qe=o("M9IT"),Be=o("Xa2L"),$e=o("0CBe");const ze=["pagVenta"],He=["sortVenta"];function Xe(t,e){if(1&t&&(u.Wb(0,"mat-option",16),u.Gc(1),u.Vb()),2&t){const t=e.$implicit;u.oc("value",t.value),u.Cb(1),u.Ic(" ",t.nombre," ")}}function Ue(t,e){if(1&t){const t=u.Xb();u.Wb(0,"mat-option",66),u.ec("keyup.enter",(function(){return u.wc(t),u.ic().index(!0)})),u.Rb(1,"mat-spinner",67),u.Vb()}}function Ke(t,e){if(1&t&&(u.Wb(0,"mat-option",16),u.Rb(1,"img",69),u.jc(2,"imagen"),u.Wb(3,"span",70),u.Gc(4),u.Vb(),u.Wb(5,"span",71),u.Gc(6),u.Vb(),u.Vb()),2&t){const t=e.$implicit;u.oc("value",t),u.Cb(1),u.oc("src",u.lc(2,4,t.imgperfil,t.sexo),u.zc),u.Cb(3),u.Hc(t.entidad),u.Cb(2),u.Hc(t.numerodoc)}}function Je(t,e){if(1&t&&(u.Ub(0),u.Ec(1,Ke,7,7,"mat-option",17),u.Wb(2,"div",68),u.Wb(3,"p"),u.Gc(4),u.Vb(),u.Vb(),u.Tb()),2&t){const t=u.ic();u.Cb(1),u.oc("ngForOf",t.searchResult.data),u.Cb(3),u.Jc("Mostrando ",t.searchResult.to," de ",t.searchResult.total," resultados.")}}function Ye(t,e){if(1&t&&(u.Wb(0,"button",72),u.Rb(1,"mat-icon",21),u.Vb()),2&t){const t=u.ic();u.Cb(1),u.oc("icIcon",t.icSearch)}}function Ze(t,e){if(1&t){const t=u.Xb();u.Wb(0,"button",73),u.ec("click",(function(){return u.wc(t),u.ic().cliente.setValue("")})),u.Rb(1,"mat-icon",21),u.Vb()}if(2&t){const t=u.ic();u.Cb(1),u.oc("icIcon",t.icClose)}}function to(t,e){1&t&&(u.Wb(0,"div",74),u.Rb(1,"mat-spinner"),u.Vb())}function eo(t,e){1&t&&(u.Wb(0,"th",75),u.Gc(1,"F.EMISI\xd3N"),u.Vb())}const oo=function(t){return{through:t}};function ao(t,e){if(1&t&&(u.Wb(0,"td",76),u.Gc(1),u.Vb()),2&t){const t=e.$implicit;u.oc("ngClass",u.qc(2,oo,28===t.idestadodocumento)),u.Cb(1),u.Ic(" ",t.fechaemision," ")}}function io(t,e){1&t&&(u.Wb(0,"th",75),u.Gc(1,"DNI/RUC/."),u.Vb())}function no(t,e){if(1&t&&(u.Wb(0,"td",76),u.Gc(1),u.Vb()),2&t){const t=e.$implicit;u.oc("ngClass",u.qc(2,oo,28===t.idestadodocumento)),u.Cb(1),u.Ic(" ",t.clientenumerodoc," ")}}function co(t,e){1&t&&(u.Wb(0,"th",77),u.Gc(1,"CLIENTE"),u.Vb())}function ro(t,e){if(1&t&&(u.Wb(0,"td",78),u.Gc(1),u.Vb()),2&t){const t=e.$implicit;u.oc("ngClass",u.qc(2,oo,28===t.idestadodocumento)),u.Cb(1),u.Ic(" ",t.clientenombre," ")}}function so(t,e){1&t&&(u.Wb(0,"th",77),u.Gc(1,"DIRECCI\xd3N"),u.Vb())}function lo(t,e){if(1&t&&(u.Wb(0,"td"),u.Gc(1),u.Vb()),2&t){const t=e.$implicit;u.Cb(1),u.Ic(" ",t.direccion,"")}}function uo(t,e){1&t&&(u.Wb(0,"th",75),u.Gc(1,"COMPROBANTE"),u.Vb())}function bo(t,e){if(1&t&&(u.Wb(0,"td",76),u.Gc(1),u.Vb()),2&t){const t=e.$implicit;u.oc("ngClass",u.qc(2,oo,28===t.idestadodocumento)),u.Cb(1),u.Ic(" ",t.docnegocio.nombre," ")}}function mo(t,e){1&t&&(u.Wb(0,"th",75),u.Gc(1,"SERIE"),u.Vb())}function po(t,e){if(1&t&&(u.Wb(0,"td",76),u.Gc(1),u.Vb()),2&t){const t=e.$implicit;u.oc("ngClass",u.qc(2,oo,28===t.idestadodocumento)),u.Cb(1),u.Ic(" ",t.serie," ")}}function fo(t,e){1&t&&(u.Wb(0,"th",75),u.Gc(1,"NUMERO"),u.Vb())}function vo(t,e){if(1&t&&(u.Wb(0,"td",76),u.Gc(1),u.Vb()),2&t){const t=e.$implicit;u.oc("ngClass",u.qc(2,oo,28===t.idestadodocumento)),u.Cb(1),u.Ic(" ",t.numero," ")}}function ho(t,e){1&t&&(u.Wb(0,"th",75),u.Gc(1,"ESTADO"),u.Vb())}function go(t,e){1&t&&(u.Wb(0,"span"),u.Gc(1,"Pendiente"),u.Vb())}function Vo(t,e){1&t&&(u.Wb(0,"span"),u.Gc(1,"Pagado"),u.Vb())}function Co(t,e){1&t&&(u.Wb(0,"span"),u.Gc(1,"Anulado"),u.Vb())}function xo(t,e){if(1&t&&(u.Wb(0,"td",76),u.Wb(1,"div",79),u.Ec(2,go,2,0,"span",80),u.Ec(3,Vo,2,0,"span",80),u.Ec(4,Co,2,0,"span",80),u.Vb(),u.Vb()),2&t){const t=e.$implicit;u.oc("ngClass",u.qc(5,oo,28===t.idestadodocumento)),u.Cb(1),u.oc("ngSwitch",t.idestadodocumento),u.Cb(1),u.oc("ngSwitchCase",26),u.Cb(1),u.oc("ngSwitchCase",27),u.Cb(1),u.oc("ngSwitchCase",28)}}function Wo(t,e){1&t&&(u.Wb(0,"th",75),u.Gc(1,"TOTAL"),u.Vb())}function wo(t,e){if(1&t&&(u.Wb(0,"td",76),u.Gc(1),u.Vb()),2&t){const t=e.$implicit;u.oc("ngClass",u.qc(2,oo,28===t.idestadodocumento)),u.Cb(1),u.Ic(" ",t.total," ")}}function Fo(t,e){1&t&&(u.Wb(0,"th",75),u.Gc(1,"Sunat"),u.Vb())}function yo(t,e){if(1&t&&(u.Wb(0,"td",81),u.Rb(1,"mat-icon",82),u.Vb()),2&t){const t=u.ic();u.Cb(1),u.oc("icIcon",t.icCheck)}}function Io(t,e){1&t&&(u.Wb(0,"th",75),u.Gc(1,"Correo"),u.Vb())}function Eo(t,e){if(1&t&&(u.Wb(0,"td",81),u.Rb(1,"mat-icon",82),u.Vb()),2&t){const t=u.ic();u.Cb(1),u.oc("icIcon",t.icCheck)}}function Go(t,e){1&t&&(u.Wb(0,"th",75),u.Gc(1," ACCIONES "),u.Vb())}function Ro(t,e){if(1&t){const t=u.Xb();u.Wb(0,"button",93),u.ec("click",(function(e){u.wc(t);const o=u.ic().$implicit,a=u.ic();return e.stopPropagation(),a.printPdf(o.pdf)})),u.Rb(1,"mat-icon",82),u.Vb()}if(2&t){const t=u.ic(2);u.Cb(1),u.oc("icIcon",t.icPrint)}}function So(t,e){if(1&t){const t=u.Xb();u.Wb(0,"button",94),u.ec("click",(function(e){u.wc(t);const o=u.ic().$implicit,a=u.ic();return e.stopPropagation(),a.showVenta(o,"COMPROBANTE")})),u.Rb(1,"mat-icon",82),u.Vb()}if(2&t){const t=u.ic(2);u.Cb(1),u.oc("icIcon",t.icPictureAsPdf)}}function ko(t,e){if(1&t){const t=u.Xb();u.Wb(0,"button",95),u.ec("click",(function(e){u.wc(t);const o=u.ic().$implicit,a=u.ic();return e.stopPropagation(),a.downloadPdf(o.pdf)})),u.Rb(1,"mat-icon",82),u.Vb()}if(2&t){const t=u.ic(2);u.Cb(1),u.oc("icIcon",t.icCloudDownload)}}function Lo(t,e){if(1&t){const t=u.Xb();u.Wb(0,"button",90),u.ec("click",(function(){u.wc(t);const e=u.ic().$implicit;return u.ic().nuevoComprobante(e,"Notadecredito")})),u.Rb(1,"mat-icon",82),u.Gc(2," Nota de cr\xe9dito "),u.Vb()}if(2&t){const t=u.ic(2);u.Cb(1),u.oc("icIcon",t.icInsertDriveFile)}}function Do(t,e){if(1&t){const t=u.Xb();u.Wb(0,"button",90),u.ec("click",(function(){u.wc(t);const e=u.ic().$implicit;return u.ic().nuevoComprobante(e,"Notadedebito")})),u.Rb(1,"mat-icon",82),u.Gc(2," Nota de d\xe9bito "),u.Vb()}if(2&t){const t=u.ic(2);u.Cb(1),u.oc("icIcon",t.icInsertDriveFile)}}const _o=function(){return[1,2]};function No(t,e){if(1&t){const t=u.Xb();u.Wb(0,"td",81),u.Wb(1,"div",83),u.Ec(2,Ro,2,1,"button",84),u.Ec(3,So,2,1,"button",85),u.Ec(4,ko,2,1,"button",86),u.Wb(5,"button",87),u.ec("click",(function(o){u.wc(t);const a=e.$implicit,i=u.ic();return o.stopPropagation(),i.nuevoComprobante(a.idventa)})),u.Rb(6,"mat-icon",82),u.Vb(),u.Wb(7,"button",88),u.ec("click",(function(e){return u.wc(t),e.stopPropagation()})),u.Rb(8,"mat-icon",82),u.Vb(),u.Wb(9,"mat-menu",null,89),u.Wb(11,"button",90),u.ec("click",(function(){u.wc(t);const o=e.$implicit;return u.ic().anularVenta(o)})),u.Rb(12,"mat-icon",91),u.Gc(13," Anular "),u.Vb(),u.Wb(14,"button",90),u.ec("click",(function(){u.wc(t);const o=e.$implicit;return u.ic().correoVenta(o)})),u.Rb(15,"mat-icon",82),u.Gc(16," Enviar "),u.Vb(),u.Rb(17,"mat-divider"),u.Ec(18,Lo,3,1,"button",92),u.Ec(19,Do,3,1,"button",92),u.Rb(20,"mat-divider"),u.Wb(21,"button",90),u.ec("click",(function(){u.wc(t);const o=e.$implicit;return u.ic().regenerarPDF(o)})),u.Rb(22,"mat-icon",82),u.Gc(23," Regenerar "),u.Vb(),u.Vb(),u.Vb(),u.Vb()}if(2&t){const t=e.$implicit,o=u.uc(10),a=u.ic();u.Cb(2),u.oc("ngIf",t.pdf),u.Cb(1),u.oc("ngIf",t.pdf&&-1===t.pdf.indexOf("www.pse.pe")),u.Cb(1),u.oc("ngIf",t.pdf&&-1!==t.pdf.indexOf("www.pse.pe")),u.Cb(2),u.oc("icIcon",a.icEdit),u.Cb(1),u.oc("matMenuTriggerFor",o),u.Cb(1),u.oc("icIcon",a.icMoreVert),u.Cb(4),u.oc("icIcon",a.icBlock),u.Cb(3),u.oc("icIcon",a.icMail),u.Cb(3),u.oc("ngIf",-1!==u.pc(11,_o).indexOf(t.iddocumentofiscal)),u.Cb(1),u.oc("ngIf",-1!==u.pc(12,_o).indexOf(t.iddocumentofiscal)),u.Cb(3),u.oc("icIcon",a.icAutorenew)}}function Ao(t,e){1&t&&(u.Wb(0,"mat-footer-cell"),u.Gc(1," No hay registros. "),u.Vb())}function To(t,e){1&t&&u.Rb(0,"tr",96)}function Oo(t,e){if(1&t){const t=u.Xb();u.Wb(0,"tr",97),u.ec("click",(function(){u.wc(t);const o=e.$implicit;return u.ic().showVenta(o)})),u.Vb()}}const Po=function(t){return{hide:t}};function qo(t,e){if(1&t&&u.Rb(0,"tr",98),2&t){const t=u.ic();u.oc("ngClass",u.qc(1,Po,t.rLengthVenta>0||t.loadVenta))}}const jo=function(){return["Ventas"]},Mo=function(){return["/ventas/nuevo","Factura"]},Qo=function(){return["/ventas/nuevo","Boletadeventa"]},Bo=function(){return["/ventas/nuevo","Notadecredito"]},$o=function(){return["/ventas/nuevo","Notadedebito"]},zo=function(){return{nombre:"Factura",value:1}},Ho=function(){return{nombre:"Boleta de venta",value:2}},Xo=function(){return{nombre:"Nota de cr\xe9dito",value:13}},Uo=function(){return{nombre:"Nota de d\xe9bito",value:10}},Ko=function(t,e,o,a){return[t,e,o,a]},Jo=function(){return["empty"]};let Yo=(()=>{class t{constructor(t,e,o,a,n,c){this.router=t,this._matDialog=e,this._entidadService=o,this._ventaService=a,this._utils=n,this.snackBar=c,this.pipeDate=new W.e("es-Pe"),this.searchResult={data:null,to:null,total:null},this.isLoadingSearch=!1,this.idsede=new i.e,this.fechaemisionFrom=new i.e,this.fechaemisionTo=new i.e,this.cliente=new i.e,this.icSearch=me.a,this.icAdd=fe.a,this.icEdit=A.a,this.icDelete=he.a,this.icClose=V.a,this.icVisibility=Ve.a,this.icCheckBoxOutlineBlank=xe.a,this.icCheck=X.a,this.icAutorenew=z.a,this.icPeople=we.a,this.icMoreVert=M.a,this.icCloudDownload=x.a,this.icFilterList=ye.a,this.icPictureAsPdf=Ee.a,this.icInsertDriveFile=B.a,this.icMail=q.a,this.icBlock=O.a,this.icPrint=h.a,this.dcVenta=["acciones","fechaemision","numerodoc","entidad","iddocumentofiscal","serie","numero","idestadodocumento","total","sunat","estado"],this.dsVenta=new _e.o,this.loadVenta=!0,this.rLengthVenta=0,this.pSizeVenta=20,this.pSizeOptVenta=[10,20,50],this.idsede.setValue(this._entidadService.sedeDefault||"")}ngOnInit(){this.searchForm=this.createSearchForm(),this.searchForm.controls.iddocumentofiscal.valueChanges.subscribe(t=>{console.log("searchForm iddocumentofiscal",t),this.index()}),this.fechaemisionFrom.valueChanges.subscribe(t=>{this.index()}),this.fechaemisionTo.valueChanges.subscribe(t=>{this.index()}),this.cliente.valueChanges.pipe(Object(n.a)(300),Object(c.a)(()=>this.isLoadingSearch=!0),Object(r.a)(t=>{if(""===t&&this.index(!0),t&&"string"==typeof t){const e={page:1,pageSize:10,orderName:"entidad",orderSort:"asc"};return parseFloat(t)>0?e.likeNumerodoc=t:e.likeEntidad=t,this._entidadService.index(e).pipe(Object(s.a)(()=>this.isLoadingSearch=!1))}return this.isLoadingSearch=!1,[]})).subscribe(t=>{this.searchResult=t}),this.sortVenta.sortChange.subscribe(()=>{this.pagVenta.pageIndex=0,this.index()}),this.pagVenta.page.subscribe(()=>{this.index()}),this.index()}createSearchForm(){return new i.h({iddocumentofiscal:new i.e,serie:new i.e,numero:new i.e})}index(t){t&&(this.pagVenta.pageIndex=0);const e={page:this.pagVenta.pageSize?this.pagVenta.pageIndex+1:1,pageSize:this.pagVenta.pageSize?this.pagVenta.pageSize:this.pSizeVenta,orderName:this.sortVenta.active?this.sortVenta.active:"idventa",orderSort:this.sortVenta.direction?this.sortVenta.direction:"desc",conRecurso:"sede,docnegocio"};this.idsede.value&&(e.idsede=this.idsede.value),this.fechaemisionFrom.value&&(e.fechaemisionFrom=this.pipeDate.transform(this.fechaemisionFrom.value,"yyyy-MM-dd")),this.fechaemisionTo.value&&(e.fechaemisionTo=this.pipeDate.transform(this.fechaemisionTo.value,"yyyy-MM-dd")),this.cliente.value&&(e.idcliente=this.cliente.value.identidad);const o=this.searchForm.getRawValue();this.clean(o),Object.assign(e,o),this.loadVenta=!0,this._ventaService.index(e).subscribe(t=>{t.data.forEach(t=>{t.pdf=this.urlPdf(t.pdf)}),this.dsVenta.data=t.data,this.loadVenta=!1,this.rLengthVenta=t.total,console.log("this.rLengthVenta",this.rLengthVenta)},t=>{this.loadVenta=!1;const e=this._utils.convertError(t);this.snackBar.open(e,"Cerrar",{panelClass:["error-dialog"]})})}clean(t){for(const e in t)null!=t[e]&&""!==t[e]||delete t[e]}showVenta(t,e){this._matDialog.open(Jt,{panelClass:"venta-show-dialog",data:{idventa:t.idventa,pestana:e,botones:{canu:!1,rpdf:!1,nvent:!0,edit:!1,anu:!0,mail:!0,nc:!1,nd:!1,gr:!0}},autoFocus:!1,disableClose:!0}).afterClosed().subscribe(e=>{console.log("response: ",e),e&&("anular"===e&&this.anularVenta(t),"correo"===e&&this.correoVenta(t),"regenerar"===e&&this.regenerarPDF(t),"Notadecredito"===e&&this.nuevoComprobante(t,"Notadecredito"),"Notadedebito"===e&&this.nuevoComprobante(t,"Notadecredito"))})}downloadVenta(){this._matDialog.open(te,{panelClass:"venta-download-dialog",data:{}}).afterClosed().subscribe(t=>{})}descargar(){this._matDialog.open(m,{panelClass:"venta-descarga-dialog",data:{item:null},autoFocus:!1}).afterClosed().subscribe(t=>{t&&this.index()})}pdf(t){this._matDialog.open(_,{panelClass:"venta-pdf-dialog",data:{venta:t},autoFocus:!1}).afterClosed().subscribe(t=>{t&&this.index()})}anularVenta(t){this._matDialog.open(ce,{panelClass:"ventasanular-form-dialog",data:{venta:t},autoFocus:!1}).afterClosed().subscribe(t=>{t&&this.index()})}correoVenta(t){this._matDialog.open(ue,{panelClass:"ventascorreo-form-dialog",data:{venta:t},autoFocus:!1}).afterClosed().subscribe(t=>{t&&this.index()})}regenerarPDF(t){this._matDialog.open(De,{panelClass:"ventasregenerar-form-dialog",data:{venta:t},autoFocus:!1}).afterClosed().subscribe(e=>{e&&(this.index(),this.showVenta(t,"COMPROBANTE"))})}displaySearchEntidad(t){return t?t.entidad:null}nuevoComprobante(t,e){if(!e)switch(t.iddocumentofiscal){case 1:e="Factura";break;case 2:e="Boletadeventa";break;case 13:e="Notadecredito";break;case 10:e="Notadedebito"}this.router.navigate(["/ventas/emitir/"+e,{venta:t.idventa}])}resetForm(){this.searchForm.reset({},{emitEvent:!1}),this.index()}downloadPdf(t){const e=this.urlPdf(t);this._ventaService.downloadProxy(e).subscribe(e=>{const o=t.split("/").reverse()[0];Object(l.saveAs)(e,o)},t=>{})}printPdf(t){const e=this.urlPdf(t);this._ventaService.downloadProxy(e).subscribe(t=>{const e=new Blob([t],{type:"application/pdf"}),o=URL.createObjectURL(e),a=document.createElement("iframe");a.style.display="none",a.src=o,document.body.appendChild(a),a.contentWindow.print()},t=>{})}urlPdf(t){let e="";if(t){const o=t.split("/").reverse()[0],a=t.split("/").reverse()[1];-1===t.indexOf("www.pse.pe")&&(e="/api/public/"+a+"/"+o),-1!==t.indexOf("www.pse.pe")&&(e="/"+a+"/"+o)}return e}}return t.\u0275fac=function(e){return new(e||t)(u.Qb(a.f),u.Qb(d.b),u.Qb(J.a),u.Qb(b.a),u.Qb(U.a),u.Qb(K.b))},t.\u0275cmp=u.Kb({type:t,selectors:[["vex-ventas"]],viewQuery:function(t,e){var o;1&t&&(u.Cc(ze,!0),u.Cc(He,!0)),2&t&&(u.tc(o=u.fc())&&(e.pagVenta=o.first),u.tc(o=u.fc())&&(e.sortVenta=o.first))},decls:110,vars:55,consts:[["fxLayout","column","fxLayoutAlign","center start",1,"pb-16"],[1,"w-full","flex","flex-col","sm:flex-row","justify-between","px-gutter"],[1,"title","mt-0","mb-1"],[3,"crumbs"],["mat-raised-button","","matTooltip","Descargar Excel","fxHide","","fxShow.gt-xs","",3,"click"],[3,"icIcon"],["mat-icon-button","","fxShow","","fxHide.gt-xs",""],["mat-raised-button","","fxHide","","fxShow.gt-xs","",1,"ml-1",3,"matMenuTriggerFor"],["mat-icon-button","","type","button","fxShow","","fxHide.gt-xs","",3,"matMenuTriggerFor"],["menuAdd","matMenu"],["mat-menu-item","",3,"routerLink"],[1,"-mt-6","px-gutter"],[1,"card","overflow-auto","-mt-16"],["fxLayout","row","fxLayoutAlign","start center",1,"bg-app-bar","px-6","h-16","border-b","sticky","left-0"],["fxFlex","400px","fxFlex.lt-md","auto","fxHide.xs","","fxLayout","row","fxLayoutAlign","start center",1,"bg-card","rounded-full","border","px-4",3,"formGroup","ngSubmit"],["placeholder","Comprobante","name","iddocumentofiscal","formControlName","iddocumentofiscal",1,"px-4","py-3","border-0","outline-none","w-full","bg-transparent"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["matInput","","placeholder","Serie","name","serie","formControlName","serie",1,"px-4","py-3","border-0","outline-none","w-full","bg-transparent"],["matInput","","placeholder","N\xfamero","name","numero","formControlName","numero",1,"px-4","py-3","border-0","outline-none","w-full","bg-transparent"],["mat-icon-button","","type","submit","matTooltip","Buscar"],["size","20px",3,"icIcon"],["fxFlex","","fxFlex.lt-md","auto","fxHide.xs","","fxLayout","row","fxLayoutAlign","start center",1,"bg-card","rounded-full","border","px-4"],["matInput","","placeholder","Cliente o  DNI/RUC",1,"px-4","py-3","border-0","outline-none","w-full","bg-transparent",3,"matAutocomplete","formControl"],["nombreERef",""],[3,"displayWith","optionSelected"],["auto","matAutocomplete"],[3,"keyup.enter",4,"ngIf"],[4,"ngIf"],["mat-icon-button","","matSuffix","","type","button",4,"ngIf"],["mat-icon-button","","matSuffix","","type","button",3,"click",4,"ngIf"],["fxFlex","290px","fxFlex.lt-md","auto","fxHide.xs","","fxLayout","row","fxLayoutAlign","start center",1,"bg-card","rounded-full","border","px-4"],["matInput","","placeholder","Desde","name","fechaemisionFrom",1,"px-4","py-3","border-0","outline-none","w-full","bg-transparent",3,"formControl","matDatepicker"],["matSuffix","",3,"for"],["fechaFromDatePicker",""],["matInput","","placeholder","Hasta","name","fechaemisionTo",3,"formControl","matDatepicker"],["fechaToDatePicker",""],[1,"loading-container"],["class","loading-shade",4,"ngIf"],["mat-table","","matSort","","matSortActive","idventa","matSortDisableClear","","matSortDirection","desc",1,"w-full",3,"dataSource"],["table","","sortVenta","matSort"],["matColumnDef","fechaemision"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",3,"ngClass",4,"matCellDef"],["matColumnDef","numerodoc"],["matColumnDef","entidad"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],[3,"ngClass",4,"matCellDef"],["matColumnDef","direccion"],[4,"matCellDef"],["matColumnDef","iddocumentofiscal"],["matColumnDef","serie"],["matColumnDef","numero"],["matColumnDef","idestadodocumento"],["matColumnDef","total"],["matColumnDef","sunat"],["mat-cell","",4,"matCellDef"],["matColumnDef","estado"],["matColumnDef","acciones"],["matColumnDef","empty"],[4,"matFooterCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","hover:bg-hover trans-ease-out cursor-pointer","mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",3,"ngClass",4,"matFooterRowDef"],[1,"sticky","left-0",3,"length","pageSizeOptions","pageSize"],["pagVenta",""],[3,"keyup.enter"],["diameter","50"],["fxLayout","row","fxLayoutAlign","start center"],[1,"align-middle","mr-4","shadow-6","h-6","inline-block",3,"src"],[1,"body-1"],[1,"caption","text-secondary","ml-4"],["mat-icon-button","","matSuffix","","type","button"],["mat-icon-button","","matSuffix","","type","button",3,"click"],[1,"loading-shade"],["mat-header-cell",""],["mat-cell","",3,"ngClass"],["mat-header-cell","","mat-sort-header",""],[3,"ngClass"],[3,"ngSwitch"],[4,"ngSwitchCase"],["mat-cell",""],["size","18px",3,"icIcon"],["fxLayout","row","fxLayoutAlign","center center"],["type","button","mat-icon-button","","matTooltip","Imprimir","class","w-8 h-8 leading-none flex items-center justify-center hover:bg-hover",3,"click",4,"ngIf"],["type","button","mat-icon-button","","matTooltip","PDF","class","w-8 h-8 leading-none flex items-center justify-center ml-1 hover:bg-hover",3,"click",4,"ngIf"],["type","button","mat-icon-button","","matTooltip","Descargar","class","w-8 h-8 leading-none flex items-center justify-center ml-1 hover:bg-hover",3,"click",4,"ngIf"],["type","button","mat-icon-button","","matTooltip","Editar",1,"w-8","h-8","leading-none","flex","items-center","justify-center","ml-1","hover:bg-hover",3,"click"],["type","button","mat-icon-button","",1,"w-8","h-8","leading-none","flex","items-center","justify-center","ml-1","hover:bg-hover",3,"matMenuTriggerFor","click"],["menumore","matMenu"],["mat-menu-item","",3,"click"],["color","warn","size","18px",3,"icIcon"],["mat-menu-item","",3,"click",4,"ngIf"],["type","button","mat-icon-button","","matTooltip","Imprimir",1,"w-8","h-8","leading-none","flex","items-center","justify-center","hover:bg-hover",3,"click"],["type","button","mat-icon-button","","matTooltip","PDF",1,"w-8","h-8","leading-none","flex","items-center","justify-center","ml-1","hover:bg-hover",3,"click"],["type","button","mat-icon-button","","matTooltip","Descargar",1,"w-8","h-8","leading-none","flex","items-center","justify-center","ml-1","hover:bg-hover",3,"click"],["mat-header-row",""],["mat-row","",1,"hover:bg-hover","trans-ease-out","cursor-pointer",3,"click"],["mat-footer-row","",3,"ngClass"]],template:function(t,e){if(1&t&&(u.Wb(0,"vex-page-layout"),u.Wb(1,"vex-page-layout-header",0),u.Wb(2,"div",1),u.Wb(3,"div"),u.Wb(4,"h1",2),u.Gc(5,"Ventas"),u.Vb(),u.Rb(6,"vex-breadcrumbs",3),u.Vb(),u.Wb(7,"div"),u.Wb(8,"button",4),u.ec("click",(function(){return e.descargar()})),u.Rb(9,"mat-icon",5),u.Gc(10," Descargar "),u.Vb(),u.Wb(11,"button",6),u.Rb(12,"mat-icon",5),u.Vb(),u.Wb(13,"button",7),u.Rb(14,"mat-icon",5),u.Gc(15," Nuevo "),u.Vb(),u.Wb(16,"button",8),u.Rb(17,"mat-icon",5),u.Vb(),u.Wb(18,"mat-menu",null,9),u.Wb(20,"button",10),u.Rb(21,"mat-icon",5),u.Gc(22," Factura "),u.Vb(),u.Wb(23,"button",10),u.Rb(24,"mat-icon",5),u.Gc(25," Boleta de venta "),u.Vb(),u.Wb(26,"button",10),u.Rb(27,"mat-icon",5),u.Gc(28," Nota de cr\xe9dito "),u.Vb(),u.Wb(29,"button",10),u.Rb(30,"mat-icon",5),u.Gc(31," Nota de d\xe9bito "),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Wb(32,"vex-page-layout-content",11),u.Wb(33,"div",12),u.Wb(34,"div",13),u.Wb(35,"form",14),u.ec("ngSubmit",(function(){return e.index(!0)})),u.Wb(36,"mat-select",15),u.Wb(37,"mat-option",16),u.Gc(38,"Todos"),u.Vb(),u.Ec(39,Xe,2,2,"mat-option",17),u.Vb(),u.Rb(40,"input",18),u.Rb(41,"input",19),u.Wb(42,"button",20),u.Rb(43,"mat-icon",21),u.Vb(),u.Vb(),u.Wb(44,"div",22),u.Rb(45,"input",23,24),u.Wb(47,"mat-autocomplete",25,26),u.ec("optionSelected",(function(){return e.index(!0)})),u.Ec(49,Ue,2,0,"mat-option",27),u.Ec(50,Je,5,3,"ng-container",28),u.Vb(),u.Ec(51,Ye,2,1,"button",29),u.Ec(52,Ze,2,1,"button",30),u.Vb(),u.Wb(53,"div",31),u.Rb(54,"input",32),u.Rb(55,"mat-datepicker-toggle",33),u.Rb(56,"mat-datepicker",null,34),u.Rb(58,"input",35),u.Rb(59,"mat-datepicker-toggle",33),u.Rb(60,"mat-datepicker",null,36),u.Vb(),u.Vb(),u.Wb(62,"div",37),u.Ec(63,to,2,0,"div",38),u.Wb(64,"table",39,40),u.Ub(67,41),u.Ec(68,eo,2,0,"th",42),u.Ec(69,ao,2,4,"td",43),u.Tb(),u.Ub(70,44),u.Ec(71,io,2,0,"th",42),u.Ec(72,no,2,4,"td",43),u.Tb(),u.Ub(73,45),u.Ec(74,co,2,0,"th",46),u.Ec(75,ro,2,4,"td",47),u.Tb(),u.Ub(76,48),u.Ec(77,so,2,0,"th",46),u.Ec(78,lo,2,1,"td",49),u.Tb(),u.Ub(79,50),u.Ec(80,uo,2,0,"th",42),u.Ec(81,bo,2,4,"td",43),u.Tb(),u.Ub(82,51),u.Ec(83,mo,2,0,"th",42),u.Ec(84,po,2,4,"td",43),u.Tb(),u.Ub(85,52),u.Ec(86,fo,2,0,"th",42),u.Ec(87,vo,2,4,"td",43),u.Tb(),u.Ub(88,53),u.Ec(89,ho,2,0,"th",42),u.Ec(90,xo,5,7,"td",43),u.Tb(),u.Ub(91,54),u.Ec(92,Wo,2,0,"th",42),u.Ec(93,wo,2,4,"td",43),u.Tb(),u.Ub(94,55),u.Ec(95,Fo,2,0,"th",42),u.Ec(96,yo,2,1,"td",56),u.Tb(),u.Ub(97,57),u.Ec(98,Io,2,0,"th",42),u.Ec(99,Eo,2,1,"td",56),u.Tb(),u.Ub(100,58),u.Ec(101,Go,2,0,"th",42),u.Ec(102,No,24,13,"td",56),u.Tb(),u.Ub(103,59),u.Ec(104,Ao,2,0,"mat-footer-cell",60),u.Tb(),u.Ec(105,To,1,0,"tr",61),u.Ec(106,Oo,1,0,"tr",62),u.Ec(107,qo,1,3,"tr",63),u.Vb(),u.Rb(108,"mat-paginator",64,65),u.Vb(),u.Vb(),u.Vb(),u.Vb()),2&t){const t=u.uc(19),o=u.uc(48),a=u.uc(57),i=u.uc(61);u.Cb(6),u.oc("crumbs",u.pc(40,jo)),u.Cb(3),u.oc("icIcon",e.icCloudDownload),u.Cb(3),u.oc("icIcon",e.icCloudDownload),u.Cb(1),u.oc("matMenuTriggerFor",t),u.Cb(1),u.oc("icIcon",e.icAdd),u.Cb(2),u.oc("matMenuTriggerFor",t),u.Cb(1),u.oc("icIcon",e.icAdd),u.Cb(3),u.oc("routerLink",u.pc(41,Mo)),u.Cb(1),u.oc("icIcon",e.icInsertDriveFile),u.Cb(2),u.oc("routerLink",u.pc(42,Qo)),u.Cb(1),u.oc("icIcon",e.icInsertDriveFile),u.Cb(2),u.oc("routerLink",u.pc(43,Bo)),u.Cb(1),u.oc("icIcon",e.icInsertDriveFile),u.Cb(2),u.oc("routerLink",u.pc(44,$o)),u.Cb(1),u.oc("icIcon",e.icInsertDriveFile),u.Cb(5),u.oc("formGroup",e.searchForm),u.Cb(2),u.oc("value",null),u.Cb(2),u.oc("ngForOf",u.sc(49,Ko,u.pc(45,zo),u.pc(46,Ho),u.pc(47,Xo),u.pc(48,Uo))),u.Cb(4),u.oc("icIcon",e.icSearch),u.Cb(2),u.oc("matAutocomplete",o)("formControl",e.cliente),u.Cb(2),u.oc("displayWith",e.displaySearchEntidad),u.Cb(2),u.oc("ngIf",e.isLoadingSearch),u.Cb(1),u.oc("ngIf",!e.isLoadingSearch),u.Cb(1),u.oc("ngIf",!e.cliente.value),u.Cb(1),u.oc("ngIf",e.cliente.value),u.Cb(2),u.oc("formControl",e.fechaemisionFrom)("matDatepicker",a),u.Cb(1),u.oc("for",a),u.Cb(3),u.oc("formControl",e.fechaemisionTo)("matDatepicker",i),u.Cb(1),u.oc("for",i),u.Cb(4),u.oc("ngIf",e.loadVenta),u.Cb(1),u.oc("dataSource",e.dsVenta),u.Cb(41),u.oc("matHeaderRowDef",e.dcVenta),u.Cb(1),u.oc("matRowDefColumns",e.dcVenta),u.Cb(1),u.oc("matFooterRowDef",u.pc(54,Jo)),u.Cb(1),u.oc("length",e.rLengthVenta)("pageSizeOptions",e.pSizeOptVenta)("pageSize",e.pSizeVenta)}},directives:[Ne.a,Ae.a,F.c,F.b,Te.a,y.b,I.a,Oe.b,E.a,G.a,Y.c,Y.d,Y.a,a.g,Pe.a,i.w,i.q,F.a,i.i,Ge.a,i.p,i.g,Re.n,W.o,ae.b,i.b,qe.c,i.f,qe.a,W.p,je.b,je.d,oe.j,je.a,_e.n,Me.a,_e.c,_e.i,_e.b,_e.e,_e.k,_e.m,_e.g,Qe.a,Be.b,_e.h,_e.a,Oe.a,W.m,Me.b,W.r,W.s,R.a,_e.d,_e.j,_e.l,_e.f],pipes:[$e.a],styles:["vex-ventas .loading-container{position:relative}vex-ventas .loading-shade{position:absolute;top:0;left:0;bottom:56px;right:0;background:rgba(0,0,0,.15);z-index:1;display:flex;align-items:center;justify-content:center}vex-ventas .hide{display:none}"],encapsulation:2}),t})();var Zo=o("JX91"),ta=o("lJxs"),ea=o("0np6"),oa=o("1jcm");function aa(t,e){if(1&t&&(u.Wb(0,"mat-option",20),u.Gc(1),u.Vb()),2&t){const t=e.$implicit;u.oc("value",t.id),u.Cb(1),u.Ic(" ",t.nombre," ")}}let ia=(()=>{class t{constructor(t,e,o){this._data=t,this.matDialogRef=e,this._datainicial=o,this.formatos=this._datainicial.formatos,this.icClose=V.a,this._data=this._data.venta}ngOnInit(){this.generalForm=this.createForm()}createForm(){return new i.h({tipocambio:new i.e(this._data.tipocambio),placavehiculo:new i.e(this._data.placavehiculo),pdfformato:new i.e(this._data.pdfformato),detraccion:new i.e(this._data.detraccion),selvaproducto:new i.e(this._data.selvaproducto),selvaservicio:new i.e(this._data.selvaservicio),guiatransportista:new i.e(this._data.guiatransportista)})}save(){let t={};t=this.generalForm.getRawValue(),this.matDialogRef.close(t)}}return t.\u0275fac=function(e){return new(e||t)(u.Qb(d.a),u.Qb(d.g),u.Qb(ee.a))},t.\u0275cmp=u.Kb({type:t,selectors:[["vex-ventas-general"]],decls:40,vars:4,consts:[[3,"formGroup","ngSubmit"],["fxLayout","row","fxLayoutAlign","start center","mat-dialog-title",""],["fxFlex","auto",1,"headline","m-0"],["mat-dialog-close","","mat-icon-button","","type","button",1,"text-secondary"],[3,"icIcon"],[1,"-mx-6","text-border"],["fxLayout","column"],["fxLayout","row","fxLayout.lt-sm","column","fxLayoutGap","16px","fxLayoutGap.lt-sm","0"],["appearance","standard","fxFlex","auto"],["matInput","","formControlName","placavehiculo"],["formControlName","pdfformato"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","guiatransportista"],["matInput","","type","number","formControlName","tipocambio"],["formControlName","detraccion"],["formControlName","selvaproducto"],["formControlName","selvaservicio"],["align","end"],["mat-button","","mat-dialog-close","","type","button"],["color","primary","mat-raised-button","","type","submit",3,"disabled"],[3,"value"]],template:function(t,e){1&t&&(u.Wb(0,"form",0),u.ec("ngSubmit",(function(){return e.save()})),u.Wb(1,"div",1),u.Wb(2,"h2",2),u.Gc(3,"Datos generales"),u.Vb(),u.Wb(4,"button",3),u.Rb(5,"mat-icon",4),u.Vb(),u.Vb(),u.Rb(6,"mat-divider",5),u.Wb(7,"mat-dialog-content",6),u.Wb(8,"div",7),u.Wb(9,"mat-form-field",8),u.Wb(10,"mat-label"),u.Gc(11,"Placa de veh\xedculo"),u.Vb(),u.Rb(12,"input",9),u.Vb(),u.Wb(13,"mat-form-field",8),u.Wb(14,"mat-label"),u.Gc(15,"Formato impresi\xf3n"),u.Vb(),u.Wb(16,"mat-select",10),u.Ec(17,aa,2,2,"mat-option",11),u.Vb(),u.Vb(),u.Vb(),u.Wb(18,"div",7),u.Wb(19,"mat-form-field",8),u.Wb(20,"mat-label"),u.Gc(21,"Gu\xeda transportista"),u.Vb(),u.Rb(22,"input",12),u.Vb(),u.Wb(23,"mat-form-field",8),u.Wb(24,"mat-label"),u.Gc(25,"Tipo de cambio"),u.Vb(),u.Rb(26,"input",13),u.Vb(),u.Vb(),u.Wb(27,"fieldset"),u.Wb(28,"div",6),u.Wb(29,"mat-slide-toggle",14),u.Gc(30," Comprobante sujeto a detracci\xf3n? "),u.Vb(),u.Wb(31,"mat-slide-toggle",15),u.Gc(32," Bienes regi\xf3n selva? "),u.Vb(),u.Wb(33,"mat-slide-toggle",16),u.Gc(34," Servicios regi\xf3n selva? "),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Wb(35,"mat-dialog-actions",17),u.Wb(36,"button",18),u.Gc(37,"CERRAR"),u.Vb(),u.Wb(38,"button",19),u.Gc(39,"ACEPTAR"),u.Vb(),u.Vb(),u.Vb()),2&t&&(u.oc("formGroup",e.generalForm),u.Cb(5),u.oc("icIcon",e.icClose),u.Cb(12),u.oc("ngForOf",e.formatos),u.Cb(21),u.oc("disabled",e.generalForm.invalid))},directives:[i.w,i.q,i.i,F.c,F.b,d.h,F.a,y.b,d.d,E.a,G.a,R.a,d.e,F.d,oe.d,oe.h,ae.b,i.b,i.p,i.g,Ge.a,W.o,i.s,oa.a,d.c,Re.n],styles:["@media (min-width:960px){.ventasgeneral-form-dialog{width:480px}}.ventasgeneral-form-dialog fieldset{border:1px solid #ccc;border-radius:8px;padding:8px}.ventasgeneral-form-dialog fieldset legend{padding:0 8px}"],encapsulation:2}),t})(),na=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=u.Kb({type:t,selectors:[["vex-ventas-guia"]],decls:2,vars:0,template:function(t,e){1&t&&(u.Wb(0,"p"),u.Gc(1," ventas-guia works!\n"),u.Vb())},styles:[""]}),t})(),ca=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=u.Kb({type:t,selectors:[["vex-ventas-formato"]],decls:2,vars:0,template:function(t,e){1&t&&(u.Wb(0,"p"),u.Gc(1," ventas-formato works!\n"),u.Vb())},styles:[""]}),t})();const ra=["producto"];function sa(t,e){if(1&t&&(u.Wb(0,"mat-option",21),u.Wb(1,"div",33),u.Wb(2,"small",34),u.Gc(3),u.jc(4,"uppercase"),u.Vb(),u.Wb(5,"small",35),u.Gc(6),u.Vb(),u.Wb(7,"small",35),u.Gc(8),u.Vb(),u.Vb(),u.Vb()),2&t){const t=e.$implicit;u.oc("value",t),u.Cb(3),u.Hc(u.kc(4,4,t.nombre)),u.Cb(3),u.Hc(t.codigo),u.Cb(2),u.Ic("S/. ",t.precio,"")}}function la(t,e){if(1&t&&u.Rb(0,"mat-icon",36),2&t){const t=u.ic();u.oc("icIcon",t.icSearch)}}function da(t,e){if(1&t){const t=u.Xb();u.Wb(0,"mat-icon",37),u.ec("click",(function(){return u.wc(t),u.ic().itemForm.get("producto").setValue("")})),u.Vb()}if(2&t){const t=u.ic();u.oc("icIcon",t.icClose)}}function ua(t,e){1&t&&(u.Wb(0,"mat-error"),u.Gc(1," Requerido! "),u.Vb())}function ba(t,e){if(1&t&&(u.Wb(0,"mat-option",21),u.Gc(1),u.Vb()),2&t){const t=e.$implicit;u.oc("value",t.idimpuesto),u.Cb(1),u.Ic(" ",t.nombre," ")}}function ma(t,e){1&t&&(u.Wb(0,"mat-error"),u.Gc(1," Requerido! "),u.Vb())}function pa(t,e){1&t&&(u.Wb(0,"mat-error"),u.Gc(1," Requerido! "),u.Vb())}function fa(t,e){1&t&&(u.Wb(0,"mat-error"),u.Gc(1," Requerido! "),u.Vb())}function va(t,e){1&t&&(u.Wb(0,"mat-error"),u.Gc(1," Requerido! "),u.Vb())}let ha=(()=>{class t{constructor(t,e,o){this._data=t,this.matDialogRef=e,this._utils=o,this.productos=[],this.stock=new i.e({value:null,disabled:!0}),this.icClose=V.a,this.icSearch=me.a}ngOnInit(){this.itemForm=this.createForm(),this.itemForm.controls.idimpuesto.valueChanges.subscribe(t=>{const e=this.itemForm.get("idimpuesto").value||0,o=this.itemForm.get("preciounit").value||0,a=this.itemForm.get("cantidad").value||0,i=this.itemForm.get("descuento").value||0;this.calculoItem(e,o,a,i)}),this.itemForm.controls.cantidad.valueChanges.subscribe(t=>{const e=this.itemForm.get("idimpuesto").value||0,o=this.itemForm.get("preciounit").value||0,a=t||0,i=this.itemForm.get("descuento").value||0;this.calculoItem(e,o,a,i)}),this.itemForm.controls.preciounit.valueChanges.subscribe(t=>{const e=this.itemForm.get("idimpuesto").value||0,o=t||0,a=this.itemForm.get("cantidad").value||0,i=this.itemForm.get("descuento").value||0;this.calculoItem(e,o,a,i)}),this.itemForm.controls.descuento.valueChanges.subscribe(t=>{const e=this.itemForm.get("idimpuesto").value||0,o=this.itemForm.get("preciounit").value||0,a=this.itemForm.get("cantidad").value||0;this.calculoItem(e,o,a,t||0)}),this.filteredOptions=this.itemForm.controls.producto.valueChanges.pipe(Object(Zo.a)(""),Object(ta.a)(t=>"string"==typeof t||null===t?t:t.nombre),Object(ta.a)(t=>t?this._filterStates(t):this._data.productos.slice())),this.itemForm.controls.producto.valueChanges.subscribe(t=>{console.log("ValueChange: ",t),"string"==typeof t&&(this.itemForm.get("idimpuesto").setValue(null,{emitEvent:!1}),this.itemForm.get("cantidad").setValue(null,{emitEvent:!1}),this.itemForm.get("preciounit").setValue(null,{emitEvent:!1}),this.itemForm.get("valorunit").setValue(null,{emitEvent:!1}),this.itemForm.get("descuento").setValue(null,{emitEvent:!1}),this.itemForm.get("valorventa").setValue(null,{emitEvent:!1}),this.itemForm.get("montototalimpuestos").setValue(null,{emitEvent:!1}),this.itemForm.get("total").setValue(null,{emitEvent:!1}),this.stock.setValue(null))}),this._data.item.producto&&setTimeout(()=>{this.itemForm.get("producto").updateValueAndValidity()},100),this._data.item.producto||setTimeout(()=>{},300)}_filterStates(t){const e=t.toLowerCase();return console.log("filterValue: ",e),this._data.productos.filter(t=>0===t.nombre.toLowerCase().indexOf(e))}calculoItem(t,e,o,a){const i=this._utils.calculoLinea(t,e,o,a);this.itemForm.get("valorunit").setValue(i.valorunit,{emitEvent:!1}),this.itemForm.get("valorventa").setValue(i.subtotal,{emitEvent:!1}),this.itemForm.get("montototalimpuestos").setValue(i.montototalimpuestos,{emitEvent:!1}),this.itemForm.get("total").setValue(i.total,{emitEvent:!1})}createForm(){return new i.h({producto:new i.e(this._data.item.producto,[i.v.required]),descripcion:new i.e(this._data.item.descripcion||null),idimpuesto:new i.e(this._data.item.idimpuesto||null,[i.v.required]),preciounit:new i.e(this._data.item.preciounit||null,[i.v.required]),cantidad:new i.e(this._data.item.cantidad||null,[i.v.required]),valorunit:new i.e(this._data.item.valorunit||null,[i.v.required]),descuento:new i.e(this._data.item.descuento||null),valorventa:new i.e(this._data.item.valorventa,[i.v.required]),montototalimpuestos:new i.e(this._data.item.montototalimpuestos,[i.v.required]),total:new i.e(this._data.item.total,[i.v.required])})}displayProductoFn(t){return t?t.nombre:void 0}autocompletadoProductoSelected(t){console.log("OPTION",t);const e=parseFloat(t.precio),o=this._utils.calculoLinea(t.idimpuesto,e,1);this.itemForm.get("cantidad").setValue(1,{emitEvent:!1}),this.itemForm.get("preciounit").setValue(e,{emitEvent:!1}),this.itemForm.get("valorunit").setValue(o.valorunit,{emitEvent:!1}),this.itemForm.get("valorventa").setValue(o.subtotal,{emitEvent:!1}),this.itemForm.get("montototalimpuestos").setValue(o.montototalimpuestos,{emitEvent:!1}),this.itemForm.get("total").setValue(o.total,{emitEvent:!1}),this.itemForm.get("idimpuesto").setValue(t.idimpuesto,{emitEvent:!1}),this.stock.setValue(t.codigo)}save(){let t={};t=this.itemForm.getRawValue(),this.matDialogRef.close(t)}}return t.\u0275fac=function(e){return new(e||t)(u.Qb(d.a),u.Qb(d.g),u.Qb(U.a))},t.\u0275cmp=u.Kb({type:t,selectors:[["vex-ventas-item"]],viewQuery:function(t,e){var o;1&t&&u.Nc(ra,!0),2&t&&u.tc(o=u.fc())&&(e.productoElement=o.first)},decls:72,vars:21,consts:[[3,"formGroup","ngSubmit"],["fxLayout","row","fxLayoutAlign","start center","mat-dialog-title",""],["fxFlex","auto",1,"headline","m-0"],["mat-dialog-close","","mat-icon-button","","type","button",1,"text-secondary"],[3,"icIcon"],[1,"-mx-6","text-border"],["fxLayout","column"],["appearance","standard"],["matInput","","formControlName","producto",3,"matAutocomplete"],["producto",""],["autoActiveFirstOption","",3,"displayWith","optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["matSuffix","",3,"icIcon",4,"ngIf"],["matSuffix","","class","cursor-pointer",3,"icIcon","click",4,"ngIf"],[4,"ngIf"],["matInput","","formControlName","descripcion"],[1,"mt-4"],["fxLayout","row","fxLayout.lt-sm","column","fxLayoutGap","16px","fxLayoutGap.lt-sm","0"],["appearance","standard","fxFlex","auto"],["placeholder","Tipo IGV","name","idimpuesto","formControlName","idimpuesto"],[3,"value"],["fxFlex","auto"],["matInput","",3,"formControl"],["matInput","","type","number","formControlName","cantidad"],["matInput","","type","number","formControlName","preciounit"],["matInput","","type","number","formControlName","descuento"],["matInput","","type","number","name","valorventa","formControlName","valorventa",3,"readonly"],["matInput","","type","number","name","montototalimpuestos","formControlName","montototalimpuestos",3,"readonly"],["matInput","","type","number","name","total","formControlName","total",3,"readonly"],["align","end"],["mat-button","","mat-dialog-close","","type","button"],["color","primary","mat-button","","type","submit",3,"disabled"],["fxLayout","row","fxLayoutAlign","space-between center"],["fxFlex","80"],["fxFlex","10"],["matSuffix","",3,"icIcon"],["matSuffix","",1,"cursor-pointer",3,"icIcon","click"]],template:function(t,e){if(1&t&&(u.Wb(0,"form",0),u.ec("ngSubmit",(function(){return e.save()})),u.Wb(1,"div",1),u.Wb(2,"h2",2),u.Gc(3,"Detalle de linea"),u.Vb(),u.Wb(4,"button",3),u.Rb(5,"mat-icon",4),u.Vb(),u.Vb(),u.Rb(6,"mat-divider",5),u.Wb(7,"mat-dialog-content",6),u.Wb(8,"mat-form-field",7),u.Wb(9,"mat-label"),u.Gc(10,"Producto / servicio"),u.Vb(),u.Rb(11,"input",8,9),u.Wb(13,"mat-autocomplete",10,11),u.ec("optionSelected",(function(t){return e.autocompletadoProductoSelected(t.option.value)})),u.Ec(15,sa,9,6,"mat-option",12),u.jc(16,"async"),u.Vb(),u.Ec(17,la,1,1,"mat-icon",13),u.Ec(18,da,1,1,"mat-icon",14),u.Ec(19,ua,2,0,"mat-error",15),u.Vb(),u.Wb(20,"mat-form-field",7),u.Wb(21,"mat-label"),u.Gc(22,"Descripci\xf3n adicional"),u.Vb(),u.Rb(23,"input",16),u.Vb(),u.Wb(24,"fieldset",17),u.Wb(25,"div",18),u.Wb(26,"mat-form-field",19),u.Wb(27,"mat-label"),u.Gc(28,"Tipo IGV"),u.Vb(),u.Wb(29,"mat-select",20),u.Wb(30,"mat-option",21),u.Gc(31,"Seleccione"),u.Vb(),u.Ec(32,ba,2,2,"mat-option",12),u.Vb(),u.Ec(33,ma,2,0,"mat-error",15),u.Vb(),u.Wb(34,"mat-form-field",22),u.Wb(35,"mat-label"),u.Gc(36,"Stock actual disponible"),u.Vb(),u.Rb(37,"input",23),u.Vb(),u.Vb(),u.Wb(38,"div",18),u.Wb(39,"mat-form-field",19),u.Wb(40,"mat-label"),u.Gc(41,"Cantidad"),u.Vb(),u.Rb(42,"input",24),u.Ec(43,pa,2,0,"mat-error",15),u.Vb(),u.Wb(44,"mat-form-field",19),u.Wb(45,"mat-label"),u.Gc(46,"Precio unitario"),u.Vb(),u.Rb(47,"input",25),u.Ec(48,fa,2,0,"mat-error",15),u.Vb(),u.Wb(49,"mat-form-field",19),u.Wb(50,"mat-label"),u.Gc(51,"Descuento sin IGV(Opcional)"),u.Vb(),u.Rb(52,"input",26),u.Ec(53,va,2,0,"mat-error",15),u.Vb(),u.Vb(),u.Wb(54,"div",18),u.Wb(55,"mat-form-field",19),u.Wb(56,"mat-label"),u.Gc(57,"Sub total"),u.Vb(),u.Rb(58,"input",27),u.Vb(),u.Wb(59,"mat-form-field",19),u.Wb(60,"mat-label"),u.Gc(61,"Igv"),u.Vb(),u.Rb(62,"input",28),u.Vb(),u.Wb(63,"mat-form-field",19),u.Wb(64,"mat-label"),u.Gc(65,"Total"),u.Vb(),u.Rb(66,"input",29),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Wb(67,"mat-dialog-actions",30),u.Wb(68,"button",31),u.Gc(69,"CERRAR"),u.Vb(),u.Wb(70,"button",32),u.Gc(71,"GUARDAR"),u.Vb(),u.Vb(),u.Vb()),2&t){const t=u.uc(14);u.oc("formGroup",e.itemForm),u.Cb(5),u.oc("icIcon",e.icClose),u.Cb(6),u.oc("matAutocomplete",t),u.Cb(2),u.oc("displayWith",e.displayProductoFn),u.Cb(2),u.oc("ngForOf",u.kc(16,19,e.filteredOptions)),u.Cb(2),u.oc("ngIf",!e.itemForm.get("producto").value),u.Cb(1),u.oc("ngIf",e.itemForm.get("producto").value),u.Cb(1),u.oc("ngIf",e.itemForm.get("producto").hasError("required")),u.Cb(11),u.oc("value",null),u.Cb(2),u.oc("ngForOf",e._data.impuestos),u.Cb(1),u.oc("ngIf",e.itemForm.get("idimpuesto").hasError("required")),u.Cb(4),u.oc("formControl",e.stock),u.Cb(6),u.oc("ngIf",e.itemForm.get("cantidad").hasError("required")),u.Cb(5),u.oc("ngIf",e.itemForm.get("preciounit").hasError("required")),u.Cb(5),u.oc("ngIf",e.itemForm.get("descuento").hasError("required")),u.Cb(5),u.oc("readonly",!0),u.Cb(4),u.oc("readonly",!0),u.Cb(4),u.oc("readonly",!0),u.Cb(4),u.oc("disabled",e.itemForm.invalid)}},directives:[i.w,i.q,i.i,F.c,F.b,d.h,F.a,y.b,d.d,E.a,G.a,R.a,d.e,oe.d,oe.h,ae.b,i.b,qe.c,i.p,i.g,qe.a,W.o,W.p,F.d,Ge.a,Re.n,i.f,i.s,d.c,oe.j,oe.c],pipes:[W.b,W.x],styles:["@media (min-width:600px){.ventasitem-form-dialog{width:100%}}@media (min-width:960px){.ventasitem-form-dialog{width:800px}}.ventasitem-form-dialog fieldset{border:1px solid #ccc;border-radius:8px;padding:8px}.ventasitem-form-dialog fieldset legend{padding:0 8px}"],encapsulation:2}),t})();var ga=o("T7YG"),Va=o.n(ga),Ca=o("Ldl7"),xa=o.n(Ca);function Wa(t,e){if(1&t&&(u.Wb(0,"mat-option",32),u.Gc(1),u.Vb()),2&t){const t=e.$implicit;u.oc("value",t.idmediopago),u.Cb(1),u.Ic(" ",t.nombre," ")}}function wa(t,e){if(1&t&&(u.Wb(0,"mat-error"),u.Gc(1),u.Vb()),2&t){const t=u.ic().index,e=u.ic();u.Cb(1),u.Ic(" M\xednimo ",e.mediopagoForm.get("mediopago").controls[t].controls.importe.errors.min.min," c\xe9ntimos ")}}function Fa(t,e){1&t&&(u.Wb(0,"mat-error"),u.Gc(1," Es requerido "),u.Vb())}function ya(t,e){if(1&t){const t=u.Xb();u.Wb(0,"div",33),u.Wb(1,"button",34),u.ec("click",(function(){u.wc(t);const e=u.ic().index;return u.ic().deleteItem(e)})),u.Rb(2,"mat-icon",4),u.Vb(),u.Vb()}if(2&t){const t=u.ic(2);u.Cb(2),u.oc("icIcon",t.icDeleteSweep)}}function Ia(t,e){if(1&t&&(u.Wb(0,"fieldset",26),u.Wb(1,"div",17),u.Wb(2,"mat-form-field",18),u.Wb(3,"mat-label"),u.Gc(4,"Tipo"),u.Vb(),u.Wb(5,"mat-select",27),u.Ec(6,Wa,2,2,"mat-option",28),u.Vb(),u.Vb(),u.Wb(7,"mat-form-field",18),u.Wb(8,"mat-label"),u.Gc(9,"Importe"),u.Vb(),u.Rb(10,"input",29),u.Ec(11,wa,2,1,"mat-error",22),u.Ec(12,Fa,2,0,"mat-error",22),u.Vb(),u.Vb(),u.Wb(13,"div",17),u.Wb(14,"mat-form-field",18),u.Wb(15,"mat-label"),u.Gc(16,"Nota"),u.Vb(),u.Rb(17,"input",30),u.Vb(),u.Ec(18,ya,3,1,"div",31),u.Vb(),u.Vb()),2&t){const t=e.index,o=u.ic();u.oc("formGroupName",t),u.Cb(6),u.oc("ngForOf",o.mediosdepago),u.Cb(5),u.oc("ngIf",o.mediopagoForm.get("mediopago").controls[t].controls.importe.hasError("min")),u.Cb(1),u.oc("ngIf",o.mediopagoForm.get("mediopago").controls[t].controls.importe.hasError("required")),u.Cb(6),u.oc("ngIf",o.mediopagoForm.get("mediopago").controls.length>1&&t>0)}}function Ea(t,e){if(1&t&&(u.Wb(0,"mat-error"),u.Gc(1),u.Vb()),2&t){const t=u.ic();u.Cb(1),u.Ic(" M\xednimo ",t.mediopagoForm.get("vuelto").errors.min.min," ")}}let Ga=(()=>{class t{constructor(t,e,o,a){this._data=t,this.matDialogRef=e,this._utils=o,this._datainicial=a,this.mediosdepago=this._datainicial.mediosdepago,this.icAdd=fe.a,this.icEdit=A.a,this.icDelete=he.a,this.icClose=V.a,this.icArrowDownward=Va.a,this.icDeleteSweep=xa.a,console.log("_data",t)}ngOnInit(){this.mediopagoForm=this.createForm(),this.mediopagoForm.get("mediopago").valueChanges.subscribe(t=>{t.forEach((t,e)=>{this.calcularTotales()})}),this.addItem()}createForm(){return new i.h({total:new i.e(this._data.venta.total,[i.v.required]),pagado:new i.e(0,[i.v.required]),vuelto:new i.e(0,[i.v.required,i.v.min(0)]),mediopago:new i.c([])})}calcularTotales(){const t=this.mediopagoForm.get("total").value;let e=0,o=0;this.mediopago.value.forEach(t=>{t.importe&&(e+=t.importe)}),o=this._utils.redondearValor(e-t,2),this.mediopagoForm.get("pagado").setValue(e),this.mediopagoForm.get("vuelto").setValue(o)}save(){let t={};t=this.mediopagoForm.getRawValue(),this.matDialogRef.close(t)}get mediopago(){return this.mediopagoForm.get("mediopago")}addItem(){const t=new i.h({idmediopago:new i.e(1),importe:new i.e("",[i.v.required,i.v.min(.1)]),nota:new i.e("")});this.mediopago.push(t)}deleteItem(t){this.mediopago.removeAt(t)}pagoRapido(t){let e=!1;if(this.mediopago.value.forEach((o,a)=>{if(!e){let o=this.mediopago.at(a).get("importe").value||0;0===o&&(e=!0,o+=t,this.mediopago.at(a).get("importe").setValue(o))}}),!e){const e=this.mediopago.length-1;let o=this.mediopago.at(e).get("importe").value||0;o+=t,this.mediopago.at(e).get("importe").setValue(o)}}}return t.\u0275fac=function(e){return new(e||t)(u.Qb(d.a),u.Qb(d.g),u.Qb(U.a),u.Qb(ee.a))},t.\u0275cmp=u.Kb({type:t,selectors:[["vex-ventas-mediopago"]],decls:59,vars:14,consts:[[3,"formGroup","ngSubmit"],["fxLayout","row","fxLayoutAlign","start center","mat-dialog-title",""],["fxFlex","auto",1,"headline","m-0"],["mat-dialog-close","","mat-icon-button","","type","button",1,"text-secondary"],[3,"icIcon"],[1,"-mx-6","text-border"],["fxLayout","column"],["fxLayout","row","fxLayout.lt-sm","column"],["fxFlex","75","formArrayName","mediopago"],["class","mt-4",3,"formGroupName",4,"ngFor","ngForOf"],["mat-mini-fab","","type","button","color","accent","matTooltip","Agregar",1,"mt-4",3,"click"],["fxFlex","25"],["fxLayout","column","fxLayoutAlign","space-between center"],[1,"mt-4"],["mat-flat-button","","type","button","color","accent",1,"w-100",3,"click"],["mat-flat-button","","type","button","color","primary",1,"w-100",3,"click"],["mat-flat-button","","type","button","color","warn",1,"w-100",3,"click"],["fxLayout","row","fxLayout.lt-sm","column","fxLayoutGap","16px","fxLayoutGap.lt-sm","0"],["appearance","standard","fxFlex","auto"],["matInput","","type","number","formControlName","pagado",3,"readonly"],["matInput","","type","number","formControlName","total",3,"readonly"],["matInput","","type","number","formControlName","vuelto",3,"readonly"],[4,"ngIf"],["align","end"],["mat-button","","mat-dialog-close","","type","button"],["mat-raised-button","","type","submit","color","primary",3,"disabled"],[1,"mt-4",3,"formGroupName"],["formControlName","idmediopago"],[3,"value",4,"ngFor","ngForOf"],["matInput","","type","number","formControlName","importe"],["matInput","","formControlName","nota"],["fxFlex","10",4,"ngIf"],[3,"value"],["fxFlex","10"],["mat-icon-button","","type","button","color","warn","matTooltip","Eliminarxyz",3,"click"]],template:function(t,e){1&t&&(u.Wb(0,"form",0),u.ec("ngSubmit",(function(){return e.save()})),u.Wb(1,"div",1),u.Wb(2,"h2",2),u.Gc(3,"Medio de pago"),u.Vb(),u.Wb(4,"button",3),u.Rb(5,"mat-icon",4),u.Vb(),u.Vb(),u.Rb(6,"mat-divider",5),u.Wb(7,"mat-dialog-content",6),u.Wb(8,"div",7),u.Wb(9,"div",8),u.Ec(10,Ia,19,5,"fieldset",9),u.Wb(11,"button",10),u.ec("click",(function(){return e.addItem()})),u.Rb(12,"mat-icon",4),u.Vb(),u.Vb(),u.Wb(13,"div",11),u.Wb(14,"div",12),u.Wb(15,"div",13),u.Gc(16,"Pago r\xe1pido"),u.Vb(),u.Rb(17,"mat-icon",4),u.Wb(18,"button",14),u.ec("click",(function(){return e.pagoRapido(e.mediopagoForm.get("total").value)})),u.Gc(19),u.jc(20,"number"),u.Vb(),u.Wb(21,"button",15),u.ec("click",(function(){return e.pagoRapido(1)})),u.Gc(22," S/ 1 "),u.Vb(),u.Wb(23,"button",15),u.ec("click",(function(){return e.pagoRapido(2)})),u.Gc(24," S/ 2 "),u.Vb(),u.Wb(25,"button",15),u.ec("click",(function(){return e.pagoRapido(5)})),u.Gc(26," S/ 5 "),u.Vb(),u.Wb(27,"button",15),u.ec("click",(function(){return e.pagoRapido(10)})),u.Gc(28," S/ 10 "),u.Vb(),u.Wb(29,"button",15),u.ec("click",(function(){return e.pagoRapido(20)})),u.Gc(30," S/ 20 "),u.Vb(),u.Wb(31,"button",15),u.ec("click",(function(){return e.pagoRapido(20)})),u.Gc(32," S/ 50 "),u.Vb(),u.Wb(33,"button",15),u.ec("click",(function(){return e.pagoRapido(100)})),u.Gc(34," S/ 100 "),u.Vb(),u.Wb(35,"button",15),u.ec("click",(function(){return e.pagoRapido(200)})),u.Gc(36," S/ 200 "),u.Vb(),u.Wb(37,"button",16),u.ec("click",(function(){return e.pagoRapido(10)})),u.Gc(38," Limpiar "),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Wb(39,"fieldset",13),u.Wb(40,"div",17),u.Wb(41,"mat-form-field",18),u.Wb(42,"mat-label"),u.Gc(43,"Importe TOTAL pagado"),u.Vb(),u.Rb(44,"input",19),u.Vb(),u.Wb(45,"mat-form-field",18),u.Wb(46,"mat-label"),u.Gc(47,"Importe TOTAL"),u.Vb(),u.Rb(48,"input",20),u.Vb(),u.Wb(49,"mat-form-field",18),u.Wb(50,"mat-label"),u.Gc(51,"Diferencia(Vuelto)"),u.Vb(),u.Rb(52,"input",21),u.Ec(53,Ea,2,1,"mat-error",22),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Wb(54,"mat-dialog-actions",23),u.Wb(55,"button",24),u.Gc(56,"CERRAR"),u.Vb(),u.Wb(57,"button",25),u.Gc(58,"EMITIR"),u.Vb(),u.Vb(),u.Vb()),2&t&&(u.oc("formGroup",e.mediopagoForm),u.Cb(5),u.oc("icIcon",e.icClose),u.Cb(5),u.oc("ngForOf",e.mediopagoForm.get("mediopago").controls),u.Cb(2),u.oc("icIcon",e.icAdd),u.Cb(5),u.oc("icIcon",e.icArrowDownward),u.Cb(2),u.Ic(" S/ ",u.lc(20,11,e.mediopagoForm.get("total").value,"1.2-2")," "),u.Cb(25),u.oc("readonly",!0),u.Cb(4),u.oc("readonly",!0),u.Cb(4),u.oc("readonly",!0),u.Cb(1),u.oc("ngIf",e.mediopagoForm.get("vuelto").hasError("min")),u.Cb(4),u.oc("disabled",e.mediopagoForm.invalid))},directives:[i.w,i.q,i.i,F.c,F.b,d.h,F.a,y.b,d.d,E.a,G.a,R.a,d.e,i.d,W.o,I.a,F.d,oe.d,oe.h,ae.b,i.s,i.b,i.p,i.g,W.p,d.c,i.j,Ge.a,Re.n,oe.c],pipes:[W.f],styles:["@media (min-width:600px){.ventasmediopago-form-dialog{width:100%}}@media (min-width:960px){.ventasmediopago-form-dialog{width:640px}}.ventasmediopago-form-dialog table{width:100%}.ventasmediopago-form-dialog fieldset{border:1px solid #ccc;border-radius:8px;padding:8px}.ventasmediopago-form-dialog fieldset legend{padding:0 8px}.ventasmediopago-form-dialog .w-100{width:104px;margin-bottom:4px}"],encapsulation:2}),t})();const Ra=["serienc"];function Sa(t,e){1&t&&(u.Wb(0,"span"),u.Gc(1,"Nota de cr\xe9dito"),u.Vb())}function ka(t,e){1&t&&(u.Wb(0,"span"),u.Gc(1,"Nota de d\xe9bito"),u.Vb())}function La(t,e){if(1&t&&(u.Wb(0,"mat-option",21),u.Gc(1),u.Vb()),2&t){const t=e.$implicit;u.oc("value",t.iddocumentofiscal),u.Cb(1),u.Ic(" ",t.nombre," ")}}function Da(t,e){1&t&&(u.Wb(0,"mat-error"),u.Gc(1," Es requerido "),u.Vb())}function _a(t,e){1&t&&(u.Wb(0,"mat-error"),u.Gc(1," 4 caracteres "),u.Vb())}function Na(t,e){1&t&&(u.Wb(0,"mat-error"),u.Gc(1," Es requerido "),u.Vb())}function Aa(t,e){if(1&t&&(u.Wb(0,"mat-option",21),u.Gc(1),u.Vb()),2&t){const t=e.$implicit;u.oc("value",t.id),u.Cb(1),u.Ic(" ",t.nombre," ")}}let Ta=(()=>{class t{constructor(t,e,o){this._data=t,this.matDialogRef=e,this._datainicial=o,this.operaciones=this._datainicial.operaciones,this.comprobantes=this._datainicial.comprobantenc,this.motivos=[],this.icClose=V.a,this.icSearch=me.a,console.log(t),10===t.iddocumentofiscal&&(this.motivos=this._datainicial.tipond),13===t.iddocumentofiscal&&(this.motivos=this._datainicial.tiponc)}ngOnInit(){if(this.notacreditoForm=this.createForm(),!this._data.documentonc){const t=this._data.serie.substr(0,1);console.log(t),this.notacreditoForm.get("documentonc").setValue("F"===t?1:2),this.notacreditoForm.get("serienc").setValue(t),setTimeout(()=>{this.seriencElement.nativeElement.focus()},100)}}createForm(){return new i.h({tiponc:new i.e(this._data.tiponc,[i.v.required]),documentonc:new i.e(this._data.documentonc,[i.v.required]),serienc:new i.e(this._data.serienc,[i.v.required,i.v.minLength(3),i.v.maxLength(4)]),numeronc:new i.e(this._data.numeronc,[i.v.required,i.v.min(1)])})}selected(t){console.log(t),this.notacreditoForm.get("serienc").setValue(1===t?"F":"B"),setTimeout(()=>{this.seriencElement.nativeElement.focus()},100)}save(){let t={};t=this.notacreditoForm.getRawValue(),this.matDialogRef.close(t)}}return t.\u0275fac=function(e){return new(e||t)(u.Qb(d.a),u.Qb(d.g),u.Qb(ee.a))},t.\u0275cmp=u.Kb({type:t,selectors:[["vex-ventas-notacredito"]],viewQuery:function(t,e){var o;1&t&&u.Nc(Ra,!0),2&t&&u.tc(o=u.fc())&&(e.seriencElement=o.first)},decls:38,vars:10,consts:[[3,"formGroup","ngSubmit"],["fxLayout","row","fxLayoutAlign","start center","mat-dialog-title",""],["fxFlex","auto",1,"headline","m-0"],[4,"ngIf"],["mat-dialog-close","","mat-icon-button","","type","button",1,"text-secondary"],[3,"icIcon"],[1,"-mx-6","text-border"],["fxLayout","column"],["fxLayout","row","fxLayout.lt-sm","column","fxLayoutGap","16px","fxLayoutGap.lt-sm","0"],["appearance","standard","floatLabel","always","fxFlex","50"],["formControlName","documentonc",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["appearance","standard","floatLabel","always","fxFlex","25"],["matInput","","type","text","formControlName","serienc"],["serienc",""],["matInput","","type","number","formControlName","numeronc"],["appearance","standard","floatLabel","always","fxFlex",""],["placeholder","Motivo de emisi\xf3n","name","tiponc","formControlName","tiponc"],["align","end"],["mat-button","","mat-dialog-close","","type","button"],["color","primary","mat-raised-button","","type","submit",3,"disabled"],[3,"value"]],template:function(t,e){1&t&&(u.Wb(0,"form",0),u.ec("ngSubmit",(function(){return e.save()})),u.Wb(1,"div",1),u.Wb(2,"h2",2),u.Gc(3," Comprobante a emitir "),u.Ec(4,Sa,2,0,"span",3),u.Ec(5,ka,2,0,"span",3),u.Vb(),u.Wb(6,"button",4),u.Rb(7,"mat-icon",5),u.Vb(),u.Vb(),u.Rb(8,"mat-divider",6),u.Wb(9,"mat-dialog-content",7),u.Wb(10,"div",8),u.Wb(11,"mat-form-field",9),u.Wb(12,"mat-label"),u.Gc(13,"Comprobante"),u.Vb(),u.Wb(14,"mat-select",10),u.ec("selectionChange",(function(t){return e.selected(t.value)})),u.Ec(15,La,2,2,"mat-option",11),u.Vb(),u.Vb(),u.Wb(16,"mat-form-field",12),u.Wb(17,"mat-label"),u.Gc(18,"Serie"),u.Vb(),u.Rb(19,"input",13,14),u.Ec(21,Da,2,0,"mat-error",3),u.Ec(22,_a,2,0,"mat-error",3),u.Vb(),u.Wb(23,"mat-form-field",12),u.Wb(24,"mat-label"),u.Gc(25,"N\xfamero"),u.Vb(),u.Rb(26,"input",15),u.Ec(27,Na,2,0,"mat-error",3),u.Vb(),u.Vb(),u.Wb(28,"mat-form-field",16),u.Wb(29,"mat-label"),u.Gc(30,"Motivo de emisi\xf3n "),u.Vb(),u.Wb(31,"mat-select",17),u.Ec(32,Aa,2,2,"mat-option",11),u.Vb(),u.Vb(),u.Vb(),u.Wb(33,"mat-dialog-actions",18),u.Wb(34,"button",19),u.Gc(35,"CERRAR"),u.Vb(),u.Wb(36,"button",20),u.Gc(37,"ACEPTAR"),u.Vb(),u.Vb(),u.Vb()),2&t&&(u.oc("formGroup",e.notacreditoForm),u.Cb(4),u.oc("ngIf",13===e._data.iddocumentofiscal),u.Cb(1),u.oc("ngIf",10===e._data.iddocumentofiscal),u.Cb(2),u.oc("icIcon",e.icClose),u.Cb(8),u.oc("ngForOf",e.comprobantes),u.Cb(6),u.oc("ngIf",e.notacreditoForm.get("serienc").hasError("required")),u.Cb(1),u.oc("ngIf",e.notacreditoForm.get("serienc").hasError("minlength")||e.notacreditoForm.get("serienc").hasError("maxlength")),u.Cb(5),u.oc("ngIf",e.notacreditoForm.get("numeronc").hasError("required")),u.Cb(5),u.oc("ngForOf",e.motivos),u.Cb(4),u.oc("disabled",e.notacreditoForm.invalid))},directives:[i.w,i.q,i.i,F.c,F.b,d.h,F.a,W.p,y.b,d.d,E.a,G.a,R.a,d.e,F.d,oe.d,oe.h,Ge.a,i.p,i.g,W.o,ae.b,i.b,i.s,d.c,Re.n,oe.c],styles:["@media (min-width:960px){.ventasnotacredito-form-dialog{width:480px}}.ventasnotacredito-form-dialog fieldset{border:1px solid #ccc;border-radius:8px;padding:8px}.ventasnotacredito-form-dialog fieldset legend{padding:0 8px}"],encapsulation:2}),t})();var Oa=o("LExC"),Pa=o("dGNC"),qa=o("hF2C"),ja=o.n(qa),Ma=o("rw17"),Qa=o.n(Ma),Ba=o("m2C8"),$a=o.n(Ba),za=o("QcxM"),Ha=o.n(za),Xa=o("dVfw"),Ua=o("GPUG"),Ka=o("Wp6s"),Ja=o("zkoq");function Ya(t,e){if(1&t&&(u.Wb(0,"span"),u.Gc(1),u.Vb()),2&t){const t=u.ic();u.Cb(1),u.Lc(" ",t.ventaForm.get("comprobante").value.documentofiscal.nombre," ",t.ventaForm.get("comprobante").value.serie," - ",t.ventaForm.get("comprobante").value.numero," | ",t.ventaForm.valid," ")}}function Za(t,e){if(1&t&&(u.Wb(0,"mat-option",24),u.Wb(1,"div",67),u.Wb(2,"span",71),u.Gc(3),u.Vb(),u.Wb(4,"span",72),u.Gc(5),u.Vb(),u.Vb(),u.Vb()),2&t){const t=e.$implicit;u.oc("value",t),u.Cb(3),u.Ic("",t.documentofiscal.nombre," "),u.Cb(2),u.Jc("",t.serie," - ",t.numero,"")}}function ti(t,e){1&t&&(u.Wb(0,"mat-error"),u.Gc(1," Requerido! "),u.Vb())}function ei(t,e){1&t&&(u.Wb(0,"mat-error"),u.Gc(1," Requerido! "),u.Vb())}function oi(t,e){if(1&t&&(u.Wb(0,"mat-option",24),u.Gc(1),u.Vb()),2&t){const t=e.$implicit;u.oc("value",t.moneda),u.Cb(1),u.Ic(" ",t.nombre," ")}}function ai(t,e){1&t&&(u.Wb(0,"mat-error"),u.Gc(1," Requerido! "),u.Vb())}function ii(t,e){1&t&&(u.Wb(0,"span"),u.Gc(1,' "Factura '),u.Vb())}function ni(t,e){1&t&&(u.Wb(0,"span"),u.Gc(1,' "Boleta de venta '),u.Vb())}function ci(t,e){if(1&t&&(u.Wb(0,"span"),u.Gc(1),u.Vb()),2&t){const t=u.ic(2);u.Cb(1),u.Jc(" ",t.ventaForm.get("serienc").value," - ",t.ventaForm.get("numeronc").value,'" ')}}function ri(t,e){if(1&t){const t=u.Xb();u.Wb(0,"div",73),u.Wb(1,"button",74),u.ec("click",(function(){return u.wc(t),u.ic().modalNotacredito()})),u.Wb(2,"span"),u.Gc(3,"Comprobante a emitir nota de cr\xe9dito"),u.Vb(),u.Ec(4,ii,2,0,"span",10),u.Ec(5,ni,2,0,"span",10),u.Ec(6,ci,2,2,"span",10),u.Vb(),u.Vb()}if(2&t){const t=u.ic();u.Cb(4),u.oc("ngIf",1===t.ventaForm.get("documentonc").value),u.Cb(1),u.oc("ngIf",2===t.ventaForm.get("documentonc").value),u.Cb(1),u.oc("ngIf",t.ventaForm.get("documentonc").value)}}function si(t,e){1&t&&(u.Wb(0,"mat-option"),u.Rb(1,"mat-spinner",75),u.Vb())}function li(t,e){1&t&&(u.Wb(0,"span",86),u.Gc(1,"DNI"),u.Vb())}function di(t,e){1&t&&(u.Wb(0,"span",86),u.Gc(1,"RUC"),u.Vb())}function ui(t,e){1&t&&(u.Wb(0,"span",86),u.Gc(1,"C.Ext."),u.Vb())}function bi(t,e){1&t&&(u.Wb(0,"span",86),u.Gc(1,"Pasap."),u.Vb())}function mi(t,e){1&t&&(u.Wb(0,"span",86),u.Gc(1,"SinD."),u.Vb())}function pi(t,e){1&t&&(u.Wb(0,"span",86),u.Gc(1,"Identificaci\xf3n"),u.Vb())}function fi(t,e){if(1&t&&(u.Wb(0,"mat-option",78),u.Wb(1,"div",79),u.Rb(2,"img",80),u.jc(3,"imagen"),u.Wb(4,"span",81),u.Gc(5),u.Vb(),u.Vb(),u.Wb(6,"div",82),u.Ec(7,li,2,0,"span",83),u.Ec(8,di,2,0,"span",83),u.Ec(9,ui,2,0,"span",83),u.Ec(10,bi,2,0,"span",83),u.Ec(11,mi,2,0,"span",83),u.Ec(12,pi,2,0,"span",84),u.Wb(13,"small",85),u.Gc(14),u.Vb(),u.Vb(),u.Vb()),2&t){const t=e.$implicit;u.oc("value",t)("ngSwitch",t.clientedoc),u.Cb(2),u.oc("src",u.lc(3,10,t.imgperfil,t.sexo),u.zc),u.Cb(3),u.Hc(t.entidad),u.Cb(2),u.oc("ngSwitchCase",1),u.Cb(1),u.oc("ngSwitchCase",2),u.Cb(1),u.oc("ngSwitchCase",3),u.Cb(1),u.oc("ngSwitchCase",4),u.Cb(1),u.oc("ngSwitchCase",5),u.Cb(3),u.Hc(t.numerodoc)}}function vi(t,e){if(1&t&&(u.Ub(0),u.Ec(1,fi,15,13,"mat-option",76),u.Wb(2,"div",77),u.Wb(3,"p"),u.Gc(4),u.Vb(),u.Vb(),u.Tb()),2&t){const t=u.ic();u.Cb(1),u.oc("ngForOf",t.searchResult.data),u.Cb(3),u.Jc("Mostrando ",t.searchResult.to," de ",t.searchResult.total," resultados.")}}function hi(t,e){if(1&t&&u.Rb(0,"mat-icon",87),2&t){const t=u.ic();u.oc("icIcon",t.icSearch)}}function gi(t,e){if(1&t){const t=u.Xb();u.Wb(0,"mat-icon",88),u.ec("click",(function(){return u.wc(t),u.ic().ventaForm.get("cliente").setValue("")})),u.Vb()}if(2&t){const t=u.ic();u.oc("icIcon",t.icClose)}}function Vi(t,e){1&t&&(u.Wb(0,"mat-error"),u.Gc(1," Requerido "),u.Vb())}function Ci(t,e){1&t&&(u.Wb(0,"mat-label"),u.Gc(1,"Dni"),u.Vb())}function xi(t,e){1&t&&(u.Wb(0,"mat-label"),u.Gc(1,"Ruc"),u.Vb())}function Wi(t,e){1&t&&(u.Wb(0,"mat-label"),u.Gc(1,"C.Ext."),u.Vb())}function wi(t,e){1&t&&(u.Wb(0,"mat-label"),u.Gc(1,"Pasap."),u.Vb())}function Fi(t,e){1&t&&(u.Wb(0,"mat-label"),u.Gc(1,"SinD."),u.Vb())}function yi(t,e){1&t&&(u.Wb(0,"mat-label"),u.Gc(1,"Identificaci\xf3n"),u.Vb())}function Ii(t,e){if(1&t&&(u.Wb(0,"mat-option",24),u.Wb(1,"div",67),u.Wb(2,"small",89),u.Gc(3),u.jc(4,"uppercase"),u.Vb(),u.Wb(5,"small",38),u.Gc(6),u.Vb(),u.Wb(7,"small",90),u.Gc(8),u.Vb(),u.Vb(),u.Vb()),2&t){const t=e.$implicit;u.oc("value",t),u.Cb(3),u.Hc(u.kc(4,4,t.nombre)),u.Cb(3),u.Hc(t.codigo),u.Cb(2),u.Hc(t.precio)}}function Ei(t,e){if(1&t&&u.Rb(0,"mat-icon",87),2&t){const t=u.ic();u.oc("icIcon",t.icSearch)}}function Gi(t,e){if(1&t){const t=u.Xb();u.Wb(0,"mat-icon",88),u.ec("click",(function(){return u.wc(t),u.ic().producto.setValue("")})),u.Vb()}if(2&t){const t=u.ic();u.oc("icIcon",t.icClose)}}function Ri(t,e){if(1&t&&(u.Wb(0,"mat-option",24),u.Wb(1,"div",67),u.Wb(2,"small",101),u.Gc(3),u.jc(4,"uppercase"),u.Vb(),u.Wb(5,"small",102),u.Wb(6,"span",103),u.Gc(7,"Precio"),u.Vb(),u.Gc(8),u.Vb(),u.Vb(),u.Vb()),2&t){const t=e.$implicit;u.oc("value",t),u.Cb(3),u.Hc(u.kc(4,3,t.nombre)),u.Cb(5),u.Ic(" ",t.precio,"")}}function Si(t,e){if(1&t&&u.Rb(0,"mat-icon",87),2&t){const t=u.ic(2);u.oc("icIcon",t.icSearch)}}function ki(t,e){if(1&t){const t=u.Xb();u.Wb(0,"mat-icon",88),u.ec("click",(function(){u.wc(t);const e=u.ic().index;return u.ic().ventaForm.get("ventadet").controls[e].controls.producto.setValue("")})),u.Vb()}if(2&t){const t=u.ic(2);u.oc("icIcon",t.icClose)}}function Li(t,e){1&t&&(u.Wb(0,"mat-error"),u.Gc(1," Requerido! "),u.Vb())}function Di(t,e){1&t&&(u.Wb(0,"mat-error"),u.Gc(1," Requerido "),u.Vb())}function _i(t,e){if(1&t&&(u.Wb(0,"mat-error"),u.Gc(1),u.Vb()),2&t){const t=u.ic().index,e=u.ic();u.Cb(1),u.Ic(" M\xednimo ",e.ventaForm.get("ventadet").controls[t].controls.cantidad.errors.min.min," ")}}function Ni(t,e){1&t&&(u.Wb(0,"mat-error"),u.Gc(1," Requerido! "),u.Vb())}function Ai(t,e){1&t&&(u.Wb(0,"mat-error"),u.Gc(1," Requerido! "),u.Vb())}function Ti(t,e){if(1&t){const t=u.Xb();u.Wb(0,"tr",91),u.Wb(1,"td"),u.Wb(2,"mat-form-field",92),u.Rb(3,"input",93),u.Wb(4,"mat-autocomplete",49,94),u.ec("optionSelected",(function(o){u.wc(t);const a=e.index;return u.ic().autocompletadoProductoSelected(o.option.value,a)})),u.Ec(6,Ri,9,5,"mat-option",25),u.jc(7,"async"),u.Vb(),u.Ec(8,Si,1,1,"mat-icon",36),u.Ec(9,ki,1,1,"mat-icon",37),u.Ec(10,Li,2,0,"mat-error",10),u.Vb(),u.Vb(),u.Wb(11,"td"),u.Wb(12,"mat-form-field",95),u.Rb(13,"input",96),u.Ec(14,Di,2,0,"mat-error",10),u.Ec(15,_i,2,1,"mat-error",10),u.Vb(),u.Vb(),u.Wb(16,"td"),u.Wb(17,"mat-form-field",95),u.Rb(18,"input",97),u.Ec(19,Ni,2,0,"mat-error",10),u.Vb(),u.Vb(),u.Wb(20,"td"),u.Wb(21,"mat-form-field",95),u.Rb(22,"input",98),u.Ec(23,Ai,2,0,"mat-error",10),u.Vb(),u.Vb(),u.Wb(24,"td"),u.Wb(25,"button",99),u.ec("click",(function(){u.wc(t);const o=e.$implicit,a=e.index;return u.ic().modalItem(o,a)})),u.Rb(26,"mat-icon",19),u.Vb(),u.Wb(27,"button",100),u.ec("click",(function(){u.wc(t);const o=e.index;return u.ic().deleteItem(o)})),u.Rb(28,"mat-icon",19),u.Vb(),u.Vb(),u.Vb()}if(2&t){const t=e.index,o=u.uc(5),a=u.ic();u.oc("formGroupName",t),u.Cb(3),u.oc("matAutocomplete",o),u.Cb(1),u.oc("displayWith",a.displayProductoFn),u.Cb(2),u.oc("ngForOf",u.kc(7,14,a.filteredProductos[t])),u.Cb(2),u.oc("ngIf",!a.ventaForm.get("ventadet").controls[t].controls.producto.value),u.Cb(1),u.oc("ngIf",a.ventaForm.get("ventadet").controls[t].controls.producto.value),u.Cb(1),u.oc("ngIf",a.ventaForm.get("ventadet").controls[t].controls.producto.hasError("required")),u.Cb(4),u.oc("ngIf",a.ventaForm.get("ventadet").controls[t].controls.cantidad.hasError("required")),u.Cb(1),u.oc("ngIf",a.ventaForm.get("ventadet").controls[t].controls.cantidad.hasError("min")),u.Cb(4),u.oc("ngIf",a.ventaForm.get("ventadet").controls[t].controls.preciounit.hasError("required")),u.Cb(3),u.oc("readonly",!0),u.Cb(1),u.oc("ngIf",a.ventaForm.get("ventadet").controls[t].controls.total.hasError("required")),u.Cb(3),u.oc("icIcon",a.icEdit),u.Cb(2),u.oc("icIcon",a.icDeleteSweep)}}function Oi(t,e){1&t&&(u.Wb(0,"tr"),u.Wb(1,"td",104),u.Wb(2,"div",105),u.Gc(3,"No hay registros."),u.Vb(),u.Vb(),u.Vb())}function Pi(t,e){if(1&t){const t=u.Xb();u.Wb(0,"mat-grid-tile"),u.Wb(1,"mat-card",106),u.ec("click",(function(){u.wc(t);const o=e.$implicit;return u.ic().selected(o)})),u.Wb(2,"mat-card-content"),u.Gc(3),u.Vb(),u.Wb(4,"mat-card-actions"),u.Wb(5,"button",107),u.Gc(6),u.Vb(),u.Vb(),u.Vb(),u.Vb()}if(2&t){const t=e.$implicit;u.Cb(1),u.oc("matRippleCentered",!0),u.Cb(2),u.Ic(" ",t.nombre," "),u.Cb(3),u.Hc(t.precio)}}let qi=(()=>{class t{constructor(t,e,o,a,n,c,r,s,l){this.activatedRoute=t,this._matDialog=e,this.snackBar=o,this._entidadService=a,this._ventaService=n,this._documentoserieService=c,this._productoService=r,this._utils=s,this._datainicial=l,this.pipeDate=new W.e("es-Pe"),this.comprobantes=[],this.producto=new i.e(""),this.comprobantenc=this._datainicial.comprobantenc,this.tiponc=this._datainicial.tiponc,this.monedas=this._datainicial.monedas,this.impuestos=this._datainicial.impuestos,this.searchResult={data:[],to:null,total:null},this.isLoadingSearch=!1,this.productos=[],this.filteredProductos=[],this.submitted=!1,this.icSearch=me.a,this.icAdd=fe.a,this.icEdit=A.a,this.icDelete=he.a,this.icClose=V.a,this.icSettings=ja.a,this.icInsertDriveFile=B.a,this.icArrowBack=Qa.a,this.icSend=$a.a,this.icSave=Ha.a,this.icPrint=h.a,this.icMoreVert=M.a,this.icDeleteSweep=xa.a}ngOnInit(){this.ventaForm=this.createForm(),this.activatedRoute.params.subscribe(t=>{if(console.log("activatedRoute",t),t.comprobante)switch(t.comprobante.toUpperCase()){case"FACTURA":this.iddocumentofiscalDefault=1;break;case"BOLETADEVENTA":this.iddocumentofiscalDefault=2;break;case"NOTADECREDITO":this.iddocumentofiscalDefault=13;break;case"NOTADEDEBITO":this.iddocumentofiscalDefault=10}this.filteredOptions=this.producto.valueChanges.pipe(Object(Zo.a)(""),Object(ta.a)(t=>"string"==typeof t?t:t.nombre),Object(ta.a)(t=>t?this._filterProductos(t):this.productos.slice())),t.venta&&this._ventaService.show(t.venta,{conRecurso:"ventadet.producto, cliente, ventapago"}).subscribe(t=>{this.ventaForm.get("cliente").setValue({identidad:t.data.cliente.identidad,numerodoc:t.data.cliente.numerodoc,entidad:t.data.cliente.entidad,sexo:t.data.cliente.sexo}),this.ventaForm.get("idventa").setValue(t.data.idventa),this.ventaForm.get("idsede").setValue(t.data.idsede),this.ventaForm.get("condicionpago").setValue(t.data.condicionpago),this.ventaForm.get("observacion").setValue(t.data.observacion),this.ventaForm.get("fechavencimiento").setValue(t.data.fechavencimiento),this.ventaForm.get("operacion").setValue(t.data.operacion),this.ventaForm.get("placavehiculo").setValue(t.data.placavehiculo),this.ventaForm.get("ordencompra").setValue(t.data.ordencompra),this.ventaForm.get("guiaremitente").setValue(t.data.guiaremitente),this.ventaForm.get("guiatransportista").setValue(t.data.guiatransportista),this.ventaForm.get("pdfformato").setValue(t.data.pdfformato),this.ventaForm.get("moneda").setValue(t.data.moneda),this.ventaForm.get("tipocambio").setValue(parseFloat(t.data.tipocambio)),this.ventaForm.get("detraccion").setValue("1"===t.data.detraccion),this.ventaForm.get("selvaproducto").setValue("1"===t.data.selvaproducto),this.ventaForm.get("selvaservicio").setValue("1"===t.data.selvaservicio),this.ventaForm.get("pagado").setValue(parseFloat(t.data.pagado)),this.ventaForm.get("vuelto").setValue(parseFloat(t.data.vuelto)),13===this.iddocumentofiscalDefault&&(this.ventaForm.get("tiponc").setValue(1),this.ventaForm.get("documentonc").setValue(t.data.iddocumentofiscal),this.ventaForm.get("serienc").setValue(t.data.serie),this.ventaForm.get("numeronc").setValue(t.data.numero)),t.data.ventadet.forEach(t=>{const e=this._utils.calculoLinea(t.idimpuesto,parseFloat(t.preciounit),t.cantidad,parseFloat(t.descuento)),o={producto:{idproducto:t.producto.idproducto,codigo:t.producto.codigo,nombre:t.producto.nombre,precio:t.producto.precio,unidadmedida:t.producto.unidadmedida,codigosunat:t.producto.codigosunat,idimpuesto:t.idimpuesto},descripcion:t.descripcion,idimpuesto:t.idimpuesto,cantidad:t.cantidad,valorunit:e.valorunit,descuento:parseFloat(t.descuento),valorventa:e.subtotal,montototalimpuestos:e.montototalimpuestos,preciounit:parseFloat(t.preciounit),total:e.total};this.addItem(o)}),t.data.ventapago.forEach(t=>{const e=new i.h({idmediopago:new i.e(t.idmediopago),importe:new i.e(t.importe),nota:new i.e(t.nota)});this.ventapago.push(e)})},t=>{console.log(t)});let e=null;this.comprobantes.forEach(t=>{t.iddocumentofiscal===this.iddocumentofiscalDefault&&(e=t)}),console.log("itemSelected",e),e&&this.ventaForm.get("comprobante").setValue(e)}),this.ventaForm.get("ventadet").valueChanges.subscribe(t=>{t.forEach((t,e)=>{if("object"==typeof t.producto){console.log("(1) valueChanges "+e,t);const o=t.preciounit||null,a=t.cantidad||null,i=t.descuento||null,n=this._utils.calculoLinea(t.idimpuesto||null,o,a,i);this.ventadet.at(e).get("cantidad").setValue(a,{emitEvent:!1}),this.ventadet.at(e).get("preciounit").setValue(o,{emitEvent:!1}),this.ventadet.at(e).get("valorunit").setValue(n.valorunit,{emitEvent:!1}),this.ventadet.at(e).get("descuento").setValue(i,{emitEvent:!1}),this.ventadet.at(e).get("gravada").setValue(n.subtotal,{emitEvent:!1}),this.ventadet.at(e).get("montototalimpuestos").setValue(n.montototalimpuestos,{emitEvent:!1}),this.ventadet.at(e).get("total").setValue(n.total,{emitEvent:!1}),this.calcularTotales()}"string"==typeof t.producto&&(console.log("(2) valueChanges "+e),this.ventadet.at(e).get("cantidad").setValue("",{emitEvent:!1}),this.ventadet.at(e).get("cantidad").setValidators(null),this.ventadet.at(e).get("cantidad").disable({emitEvent:!1}),this.ventadet.at(e).get("cantidad").updateValueAndValidity({emitEvent:!1}),this.ventadet.at(e).get("preciounit").setValue("",{emitEvent:!1}),this.ventadet.at(e).get("preciounit").setValidators(null),this.ventadet.at(e).get("preciounit").disable({emitEvent:!1}),this.ventadet.at(e).get("preciounit").updateValueAndValidity({emitEvent:!1}),this.ventadet.at(e).get("valorunit").setValue("",{emitEvent:!1}),this.ventadet.at(e).get("descuento").setValue("",{emitEvent:!1}),this.ventadet.at(e).get("valorventa").setValue("",{emitEvent:!1}),this.ventadet.at(e).get("montototalimpuestos").setValue("",{emitEvent:!1}),this.ventadet.at(e).get("total").setValue("",{emitEvent:!1}),this.ventadet.at(e).get("total").setValidators(null),this.ventadet.at(e).get("total").disable({emitEvent:!1}),this.ventadet.at(e).get("total").updateValueAndValidity({emitEvent:!1}),this.calcularTotales())})}),this.ventaForm.controls.cliente.valueChanges.pipe(Object(n.a)(300),Object(c.a)(()=>this.isLoadingSearch=!0),Object(r.a)(t=>{if("object"==typeof t?(console.log("data =>",t),this.ventaForm.get("idcliente").setValue(t.identidad),this.ventaForm.get("cpecorreo").setValue(t.email),this.ventaForm.get("clientenombre").setValue(t.entidad),this.ventaForm.get("clientedoc").setValue(t.clientedoc),this.ventaForm.get("clientenumerodoc").setValue(t.numerodoc),this.ventaForm.get("clientedireccion").setValue(t.direccion)):(this.ventaForm.get("idcliente").setValue(null),this.ventaForm.get("cpecorreo").setValue(null),this.ventaForm.get("clientenombre").setValue(null),this.ventaForm.get("clientedoc").setValue(null),this.ventaForm.get("clientenumerodoc").setValue(null),this.ventaForm.get("clientedireccion").setValue(null)),t&&"string"==typeof t){const e={idempresa:this._entidadService.usuario.idempresa,page:1,pageSize:10,orderName:"entidad",orderSort:"asc"};return parseFloat(t)>0?e.likeNumerodoc=t:e.likeEntidad=t,this._entidadService.index(e).pipe(Object(s.a)(()=>this.isLoadingSearch=!1))}return this.isLoadingSearch=!1,[]})).subscribe(t=>{this.searchResult.to=t.to,this.searchResult.total=t.total,this.searchResult.data=[],t.data.forEach(t=>{this.searchResult.data.push({identidad:t.identidad,entidad:t.entidad,numerodoc:t.numerodoc,sexo:t.sexo,direccion:t.direccion,email:t.email,clientedoc:t.iddocumento})})}),this.ventaForm.controls.comprobante.valueChanges.subscribe(t=>{console.log("comprobante Subscribe",t),this.ventaForm.get("tiponc").setValue(null),this.ventaForm.get("documentonc").setValue(null),this.ventaForm.get("serienc").setValue(null),this.ventaForm.get("numeronc").setValue(null),t&&t.iddocumentofiscal?(this.ventaForm.get("iddocumentofiscal").setValue(t.iddocumentofiscal),this.ventaForm.get("serie").setValue(t.serie),this.ventaForm.get("numero").setValue(t.numero),13===t.iddocumentofiscal&&this.ventaForm.get("tiponc").setValue(1)):(this.ventaForm.get("iddocumentofiscal").setValue(null),this.ventaForm.get("serie").setValue(null),this.ventaForm.get("numero").setValue(null))}),this.ventaForm.controls.cargo.valueChanges.subscribe(t=>{this.calcularTotales()}),this.ventaForm.controls.descuentoporcentaje.valueChanges.subscribe(t=>{this.calcularTotales()}),this.indexDocumentoseries(),this.indexProductos()}resetForm(){let t=null;this.comprobantes.forEach(e=>{e.iddocumentofiscal===this.iddocumentofiscalDefault&&(t=e)});let e=1;const o=[];for(;e<=this.ventadet.value.length;)o.push({idimpuesto:1}),e++;const a={comprobante:t,idsede:this._entidadService.sedeDefault||null,iddocumentofiscal:t?t.iddocumentofiscal:null,serie:t?t.serie:null,numero:t?t.numero:null,fechaemision:new Date,fechavencimiento:new Date,idestadodocumento:27,operacion:1,moneda:"PEN",detraccion:!1,selvaproducto:!1,selvaservicio:!1,pdfformato:"A4",ventadet:o,tiponc:t&&13===t.iddocumentofiscal?1:null};this.ventaForm.reset(a,{emitEvent:!1})}createForm(){return new i.h({idventa:new i.e(null),comprobante:new i.e(null,[i.v.required]),idsede:new i.e(this._entidadService.sedeDefault||null),iddocumentofiscal:new i.e(null),serie:new i.e(null),numero:new i.e(null),idcliente:new i.e(null),fechaemision:new i.e(new Date,[i.v.required]),fechavencimiento:new i.e(new Date,[i.v.required]),idestadodocumento:new i.e(27,[i.v.required]),cliente:new i.e(null,[i.v.required]),cpecorreo:new i.e(null),clientenombre:new i.e(null),clientedoc:new i.e(null),clientenumerodoc:new i.e(null),clientedireccion:new i.e(null),operacion:new i.e(1,[i.v.required]),moneda:new i.e("PEN",[i.v.required]),tipocambio:new i.e(null),detraccion:new i.e(!1),selvaproducto:new i.e(!1),selvaservicio:new i.e(!1),placavehiculo:new i.e(null),ordencompra:new i.e(null),guiaremitente:new i.e(null),guiatransportista:new i.e(null),exonerada:new i.e(null),inafecta:new i.e(null),gratuita:new i.e(null),gravada:new i.e(null,[i.v.required]),valorimpuesto:new i.e(null,[i.v.required]),total:new i.e(null,[i.v.required]),pagado:new i.e(null),vuelto:new i.e(null),condicionpago:new i.e(null),pdfformato:new i.e("A4"),observacion:new i.e(null),ventadet:new i.c([]),ventapago:new i.c([]),tiponc:new i.e(null),documentonc:new i.e(null),serienc:new i.e(null),numeronc:new i.e(null),descuentoporcentaje:new i.e(null,[i.v.min(0)]),descuentoglobal:new i.e(null),descuentoitem:new i.e(null),descuentototal:new i.e(null),cargo:new i.e(null,[i.v.min(0)])})}calcularTotales(){console.log("calcularTotales()");let t=0,e=0,o=0,a=0,i=0,n=0,c=0,r=0,s=0;const l=this.ventaForm.get("cargo").value,d=this.ventaForm.get("descuentoporcentaje").value;if(ea.c);else{this.ventadet.value.forEach(a=>{a.total&&(console.log("element",a),c+=a.descuento,1===a.idimpuesto&&(n+=a.total),-1!==[2,3,4,5,6,7,10,11,12,13,14,15].indexOf(a.idimpuesto)&&(o+=a.total),8===a.idimpuesto&&(t+=a.total),9===a.idimpuesto&&(e+=a.total))}),r=c,d>0&&(s=n*(d/100)-c,t-=t*(d/100),e-=e*(d/100),n-=n*(d/100));const u=this._utils.calculoLinea(1,n,1);a=u.subtotal,i=u.montototalimpuestos,n=u.total+t+e+l,console.log("total",n)}this.ventaForm.get("descuentoglobal").setValue(s),this.ventaForm.get("exonerada").setValue(t),this.ventaForm.get("inafecta").setValue(e),this.ventaForm.get("gratuita").setValue(o),this.ventaForm.get("descuentoitem").setValue(c),this.ventaForm.get("descuentototal").setValue(r),this.ventaForm.get("gravada").setValue(a),this.ventaForm.get("valorimpuesto").setValue(i),this.ventaForm.get("total").setValue(n)}get ventadet(){return this.ventaForm.get("ventadet")}get ventapago(){return this.ventaForm.get("ventapago")}autocompletadoProducto(t){this.filteredProductos[t]=this.ventadet.at(t).get("producto").valueChanges.pipe(Object(Zo.a)(""),Object(ta.a)(t=>"string"==typeof(t=null===t?"":t)?t:t.nombre),Object(ta.a)(t=>t?this._filterProductos(t):this.productos.slice()))}_filterProductos(t){const e=t.toLowerCase();return this.productos.filter(t=>0===t.nombre.toLowerCase().indexOf(e))}autocompletadoProductoSelected(t,e){let o=0;if(this.ventadet.value.forEach(e=>{e.producto&&e.producto.idproducto===t.idproducto&&(console.log("item",e),o+=1)}),o>1)this.ventadet.at(e).get("producto").setValue(""),this.snackBar.open(`${t.nombre} ya esta a\xf1adido.`,"Cerrar",{duration:4e3,panelClass:["error-dialog"]});else{const o=1,a=this._utils.calculoLinea(t.idimpuesto,parseFloat(t.precio),o);this.ventadet.at(e).get("idimpuesto").setValue(t.idimpuesto,{emitEvent:!1}),this.ventadet.at(e).get("cantidad").setValue(o,{emitEvent:!1}),this.ventadet.at(e).get("valorunit").setValue(a.valorunit,{emitEvent:!1}),this.ventadet.at(e).get("valorventa").setValue(a.subtotal,{emitEvent:!1}),this.ventadet.at(e).get("montototalimpuestos").setValue(a.montototalimpuestos,{emitEvent:!1}),this.ventadet.at(e).get("preciounit").setValue(parseFloat(t.precio),{emitEvent:!1}),this.ventadet.at(e).get("total").setValue(a.total,{emitEvent:!1}),this.enabledItem(e),this.calcularTotales()}}enabledItem(t){this.ventadet.at(t).get("cantidad").setValidators([i.v.required,i.v.min(1)]),this.ventadet.at(t).get("cantidad").enable({emitEvent:!1}),this.ventadet.at(t).get("cantidad").updateValueAndValidity({emitEvent:!1}),this.ventadet.at(t).get("preciounit").setValidators([i.v.required]),this.ventadet.at(t).get("preciounit").enable({emitEvent:!1}),this.ventadet.at(t).get("preciounit").updateValueAndValidity({emitEvent:!1}),this.ventadet.at(t).get("descuento").enable({emitEvent:!1}),this.ventadet.at(t).get("descuento").updateValueAndValidity({emitEvent:!1}),this.ventadet.at(t).get("total").setValidators([i.v.required]),this.ventadet.at(t).get("total").enable({emitEvent:!1}),this.ventadet.at(t).get("total").updateValueAndValidity({emitEvent:!1})}autocompletadoClienteSelected(t){console.log("autocompletadoClienteSelected()")}addItem(t){let e=!1;if(this.ventadet.value.forEach(o=>{t&&o.producto&&o.producto.idproducto===t.producto.idproducto&&(e=!0)}),e)return this.snackBar.open(`${t.producto.nombre} ya esta a\xf1adido.`,"Cerrar",{duration:4e3,panelClass:["error-dialog"]}),!1;let o=-1;for(let a=0;a<this.ventadet.value.length;a++)if("string"==typeof this.ventadet.value[a].producto){o=a;break}if(-1!==o&&void 0!==t)console.log("addItem() [update]"),this.ventadet.at(o).get("producto").setValue(t?t.producto:""),this.ventadet.at(o).get("descripcion").setValue(t?t.descripcion:"",{emitEvent:!1}),this.ventadet.at(o).get("cantidad").setValue(t?t.cantidad:"",{emitEvent:!1}),this.ventadet.at(o).get("valorunit").setValue(t?t.valorunit:"",{emitEvent:!1}),this.ventadet.at(o).get("descuento").setValue(t?t.descuento:"",{emitEvent:!1}),this.ventadet.at(o).get("valorventa").setValue(t?t.valorventa:"",{emitEvent:!1}),this.ventadet.at(o).get("idimpuesto").setValue(t?t.idimpuesto:1,{emitEvent:!1}),this.ventadet.at(o).get("montototalimpuestos").setValue(t?t.montototalimpuestos:"",{emitEvent:!1}),this.ventadet.at(o).get("preciounit").setValue(t?t.preciounit:"",{emitEvent:!1}),this.ventadet.at(o).get("total").setValue(t?t.total:"",{emitEvent:!1}),this.enabledItem(o),this.calcularTotales(),t&&this.snackBar.open(`${t.producto.nombre} a\xf1adido.`,"Cerrar",{duration:4e3});else{console.log("addItem() [new]",t);const e=!t,o=new i.h({producto:new i.e(t?t.producto:null),descripcion:new i.e(t?t.descripcion:null),cantidad:new i.e({value:t?t.cantidad:null,disabled:e}),valorunit:new i.e(t?t.valorunit:null),descuento:new i.e(t?t.descuento:null),valorventa:new i.e(t?t.valorventa:null),idimpuesto:new i.e(t?t.idimpuesto:null),montototalimpuestos:new i.e(t?t.montototalimpuestos:null),preciounit:new i.e({value:t?t.preciounit:null,disabled:e}),total:new i.e({value:t?t.total:null,disabled:e})});this.ventadet.push(o),this.autocompletadoProducto(this.ventadet.length-1),t&&this.snackBar.open(`${t.producto.nombre} a\xf1adido.`,"Cerrar",{duration:4e3}),setTimeout(()=>{this.ventadet.at(this.ventadet.length-1).get("producto").updateValueAndValidity()},100)}}deleteItem(t){console.log("Remove",t),this.ventadet.removeAt(t),this.filteredProductos.splice(t,1),this.calcularTotales()}displaySearchEntidad(t){return t?t.entidad:null}displayProductoFn(t){return t?t.nombre:void 0}newEntidad(){let t=null;"string"==typeof this.ventaForm.get("cliente").value&&/^[0-9]+$/.exec(this.ventaForm.get("cliente").value.trim())&&(t=this.ventaForm.get("cliente").value.trim()),this._matDialog.open(Oa.a,{panelClass:"contacto-form-dialog",data:{action:"new",dialogTitle:"Nuevo cliente",tipo:"cliente",numerodoc:t},autoFocus:!1}).afterClosed().subscribe(t=>{if(!t)return;const e={identidad:t.identidad,numerodoc:t.numerodoc,entidad:t.entidad,sexo:t.sexo};this.searchResult.data.push(e),this.searchResult.to+=1,this.searchResult.total+=1,this.ventaForm.get("cliente").setValue(e),this.ventaForm.get("cliente").updateValueAndValidity()})}newProducto(){this._matDialog.open(Pa.a,{panelClass:"item-form-dialog",data:{action:"new",dialogTitle:"Nuevo producto"},autoFocus:!1}).afterClosed().subscribe(t=>{t&&(console.log("response",t),this.productos.push({idproducto:t.idproducto,codigo:t.codigo,nombre:t.nombre,precio:t.valorventa,unidadmedida:t.unidadmedida,codigosunat:t.codigosunat,idimpuesto:t.idimpuesto}),this.producto.updateValueAndValidity())})}modalGeneral(){this._matDialog.open(ia,{panelClass:"ventasgeneral-form-dialog",data:{venta:this.ventaForm.getRawValue()},autoFocus:!1}).afterClosed().subscribe(t=>{t&&(this.ventaForm.get("fechavencimiento").setValue(t.fechavencimiento),this.ventaForm.get("operacion").setValue(t.operacion),this.ventaForm.get("placavehiculo").setValue(t.placavehiculo),this.ventaForm.get("ordencompra").setValue(t.ordencompra),this.ventaForm.get("guiaremitente").setValue(t.guiaremitente),this.ventaForm.get("guiatransportista").setValue(t.guiatransportista),this.ventaForm.get("tipocambio").setValue(t.tipocambio),this.ventaForm.get("pdfformato").setValue(t.pdfformato),this.ventaForm.get("detraccion").setValue(t.detraccion),this.ventaForm.get("selvaproducto").setValue(t.selvaproducto),this.ventaForm.get("selvaservicio").setValue(t.selvaservicio))})}modalNotacredito(){this._matDialog.open(Ta,{panelClass:"ventasnotacredito-form-dialog",data:{venta:this.ventaForm.getRawValue()},autoFocus:!1}).afterClosed().subscribe(t=>{if(!t)return;this.ventaForm.get("tiponc").setValue(t.tiponc),this.ventaForm.get("documentonc").setValue(t.documentonc),this.ventaForm.get("serienc").setValue(t.serienc),this.ventaForm.get("numeronc").setValue(t.numeronc);let e=null;this.comprobantes.forEach(o=>{13===o.iddocumentofiscal&&o.serie===t.serienc&&(e=o)}),"0"===t.serienc.substr(0,1)&&this.comprobantes.forEach(o=>{const a=1===t.documentonc?"F":"B";13===o.iddocumentofiscal&&o.serie.substr(0,1)===a&&(e=o)}),e&&this.ventaForm.get("comprobante").setValue(e,{emitEvent:!1})})}modalGuia(){this._matDialog.open(na,{panelClass:"ventasguia-form-dialog",data:{venta:this.ventaForm},autoFocus:!1}).afterClosed().subscribe(t=>{t&&console.log("response",t)})}modalFormato(){this._matDialog.open(ca,{panelClass:"ventasformato-form-dialog",data:{venta:this.ventaForm},autoFocus:!1}).afterClosed().subscribe(t=>{t&&console.log("response",t)})}modalItem(t,e){this._matDialog.open(ha,{panelClass:"ventasitem-form-dialog",data:{item:t.getRawValue(),productos:this.productos,impuestos:this.impuestos},autoFocus:!1}).afterClosed().subscribe(o=>{if(!o)return;let a=!1;this.ventadet.value.forEach(e=>{e.producto&&e.producto.idproducto===o.producto.idproducto&&o.producto.idproducto!==t.get("producto").value.idproducto&&(a=!0)}),a?this.snackBar.open(`${o.producto.nombre} ya esta a\xf1adido.`,"Cerrar",{duration:4e3,panelClass:["error-dialog"]}):(this.ventadet.at(e).get("idimpuesto").setValue(o.idimpuesto,{emitEvent:!1}),this.ventadet.at(e).get("producto").setValue(o.producto,{emitEvent:!1}),this.ventadet.at(e).get("descripcion").setValue(o.descripcion,{emitEvent:!1}),this.ventadet.at(e).get("cantidad").setValue(o.cantidad,{emitEvent:!1}),this.ventadet.at(e).get("preciounit").setValue(o.preciounit,{emitEvent:!1}),this.ventadet.at(e).get("valorunit").setValue(o.valorunit,{emitEvent:!1}),this.ventadet.at(e).get("descuento").setValue(o.descuento,{emitEvent:!1}),this.ventadet.at(e).get("valorventa").setValue(o.valorventa,{emitEvent:!1}),this.ventadet.at(e).get("montototalimpuestos").setValue(o.montototalimpuestos,{emitEvent:!1}),this.ventadet.at(e).get("total").setValue(o.total,{emitEvent:!1}),setTimeout(()=>{t.get("producto").updateValueAndValidity()},100),console.log("response",o),this.enabledItem(e),this.calcularTotales())})}modalMediopago(){this.ventaForm.get("idcliente").value?this._matDialog.open(Ga,{panelClass:"ventasmediopago-form-dialog",data:{venta:this.ventaForm.getRawValue()},autoFocus:!1}).afterClosed().subscribe(t=>{if(t){for(;this.ventapago.value.length>0;)this.ventapago.removeAt(0);t.mediopago.forEach(t=>{const e=new i.h({idmediopago:new i.e(t.idmediopago),importe:new i.e(t.importe),nota:new i.e(t.nota)});this.ventapago.push(e)}),this.ventaForm.get("pagado").setValue(t.pagado),this.ventaForm.get("vuelto").setValue(t.vuelto),this.save()}}):this.snackBar.open("Ingrese cliente","Cerrar",{panelClass:["error-dialog"]})}selected(t){const e=this._utils.calculoLinea(t.idimpuesto,parseFloat(t.precio),1),o={producto:{idproducto:t.idproducto,codigo:t.codigo,nombre:t.nombre,precio:t.precio,unidadmedida:t.unidadmedida,codigosunat:t.codigosunat,idimpuesto:t.idimpuesto},descripcion:null,idimpuesto:t.idimpuesto,cantidad:1,valorunit:e.valorunit,descuento:null,valorventa:e.valorventa,montototalimpuestos:e.montototalimpuestos,preciounit:parseFloat(t.precio),total:e.total};this.addItem(o)}optionProductoSelected(t){const e=this._utils.calculoLinea(t.idimpuesto,parseFloat(t.precio),1),o={producto:{idproducto:t.idproducto,codigo:t.codigo,nombre:t.nombre,precio:t.precio,unidadmedida:t.unidadmedida,codigosunat:t.codigosunat,idimpuesto:t.idimpuesto},descripcion:null,idimpuesto:t.idimpuesto,cantidad:1,valorunit:e.valorunit,descuento:null,valorventa:e.subtotal,montototalimpuestos:e.montototalimpuestos,preciounit:parseFloat(t.precio),total:e.total};this.producto.setValue(""),this.addItem(o)}indexEntidades(){if(0===this.ventaForm.controls.clientenumerodoc.value.trim().length)return;const t={idempresa:this._entidadService.usuario.idempresa,numerodoc:this.ventaForm.controls.clientenumerodoc.value};this.ventaForm.controls.cliente.setValue("",{emitEvent:!1}),this._entidadService.index(t).subscribe(t=>{1===t.data.length&&this.ventaForm.controls.cliente.setValue({identidad:t.data[0].identidad,entidad:t.data[0].entidad},{emitEvent:!1})})}indexDocumentoseries(){this._documentoserieService.index({idsede:this._entidadService.sedeDefault,conRecurso:"documentofiscal",orderName:"iddocumentofiscal",orderSort:"asc"}).subscribe(t=>{t.data.forEach(t=>{this.comprobantes.push({iddocumentofiscal:t.iddocumentofiscal,documentofiscal:{nombre:t.documentofiscal.nombre},serie:t.serie,numero:t.numero})});let e=null;this.comprobantes.forEach(t=>{t.iddocumentofiscal===this.iddocumentofiscalDefault&&(e=t)}),e&&this.ventaForm.get("comprobante").setValue(e)})}indexProductos(){this._productoService.index({idempresa:this._entidadService.usuario.idempresa,orderName:"nombre",orderSort:"asc",ventaind:2}).subscribe(t=>{const e=[];t.data.forEach(t=>{e.push({idproducto:t.idproducto,codigo:t.codigo,nombre:t.nombre,precio:t.valorventa,unidadmedida:t.unidadmedida,codigosunat:t.codigosunat,idimpuesto:t.idimpuesto})}),this.productos=e,this.producto.updateValueAndValidity(),0===this.ventadet.value.length&&(this.addItem(),this.addItem(),this.addItem())})}save(){let t={};t=this.ventaForm.getRawValue();const e=[];t.ventadet.forEach(t=>{t.producto&&t.producto.idproducto&&(t.idproducto=t.producto.idproducto,t.nombre=t.producto.nombre,t.codigo=t.producto.codigo,t.unidadmedida=t.producto.unidadmedida,t.codigosunat=t.producto.codigosunat,e.push(t))}),console.log("ventadet",e),t.ventadet=e,t.fechaemision=this.pipeDate.transform(t.fechaemision,"yyyy-MM-dd"),t.fechavencimiento=this.pipeDate.transform(t.fechavencimiento,"yyyy-MM-dd"),t.detraccion=t.detraccion?"1":"0",t.selvaproducto=t.selvaproducto?"1":"0",t.selvaservicio=t.selvaservicio?"1":"0",this.snackBar.open("Procesando venta..."),console.log("PARAM: ",t),this._ventaService.create(t).subscribe(e=>{let o;switch(this.indexDocumentoseries(),t.iddocumentofiscal){case 1:o="Factura";break;case 2:o="Boleta de venta";break;case 10:o="Nota de d\xe9bito";break;case 13:o="Nota de cr\xe9dito"}this.resetForm(),this.submitted=!1,this.snackBar.open(`${o} ${t.serie} - ${t.numero} emitido.`,"Cerrar")},t=>{const e=this._utils.convertError(t);this.submitted=!1,this.snackBar.open(e,"Cerrar",{panelClass:["error-dialog"]})})}}return t.\u0275fac=function(e){return new(e||t)(u.Qb(a.a),u.Qb(d.b),u.Qb(K.b),u.Qb(J.a),u.Qb(b.a),u.Qb(Xa.a),u.Qb(Ua.a),u.Qb(U.a),u.Qb(ee.a))},t.\u0275cmp=u.Kb({type:t,selectors:[["vex-ventas-form"]],decls:225,vars:94,consts:[["id","ventas-form",3,"formGroup","ngSubmit"],[1,"content"],["fxLayout","column","fxLayout.gt-xs","row"],["fxFlex","60"],[1,"cardcustom"],["color","primary"],["fxLayoutAlign","space-between center"],["fxLayout","row","fxLayoutAlign","center center"],["mat-icon-button","","type","button","matTooltip","Volver a comprobantes",3,"routerLink"],[3,"icIcon"],[4,"ngIf"],["mat-raised-button","","type","submit","fxHide","","fxShow.gt-xs","",1,"mr-1"],["mat-icon-button","","type","submit","fxShow","","fxHide.gt-xs","",3,"disabled"],["mat-raised-button","","type","button",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","","type","submit",3,"disabled"],["mat-menu-item",""],["fxLayoutAlign","center center"],["mat-button","","type","button",3,"click"],["size","18px",3,"icIcon"],["fxLayout","column"],["fxLayout","row","fxLayout.lt-sm","column","fxLayoutGap","16px","fxLayoutGap.lt-sm","0"],["appearance","standard","fxFlex","40"],["formControlName","comprobante"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["appearance","standard","fxFlex","30"],["matInput","","name","start","formControlName","fechaemision",3,"matDatepicker"],["matSuffix","",3,"for"],["fechaDatePicker",""],["formControlName","moneda"],["fxLayout","column","fxLayout.gt-xs","row","fxLayoutAlign","center center",4,"ngIf"],["appearance","standard","fxFlex","85"],["matInput","","formControlName","cliente",3,"matAutocomplete"],["autoActiveFirstOption","","panelWidth","600px",3,"displayWith","optionSelected"],["autoCliente","matAutocomplete"],["matSuffix","",3,"icIcon",4,"ngIf"],["matSuffix","","class","cursor-pointer",3,"icIcon","click",4,"ngIf"],["fxFlex","15"],["mat-flat-button","","color","primary","type","button",3,"click"],["appearance","standard","fxFlex","30",3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["matInput","","name","clientenumerodoc","formControlName","clientenumerodoc",3,"readonly","keyup.enter"],["appearance","standard","fxFlex","70"],["matInput","","formControlName","cpecorreo"],["appearance","standard"],["matInput","","formControlName","clientedireccion"],["matInput","",3,"matAutocomplete","formControl"],["panelWidth","600px","autoActiveFirstOption","",3,"displayWith","optionSelected"],["autoProducto","matAutocomplete"],["formArrayName","ventadet"],[2,"width","50%"],[2,"width","12%"],[1,"text-center",2,"width","14%"],["mat-icon-button","","color","accent","type","button","matTooltip","Agregar linea",3,"click"],[3,"formGroupName",4,"ngFor","ngForOf"],["fxLayout","column","fxFlex","60"],["appearance","outline"],["matInput","","formControlName","condicionpago"],["matInput","","formControlName","observacion"],["fxFlex","40"],["fxFlex","70",1,"text-right"],["fxFlex","30",1,"text-right"],["matInput","","type","number","formControlName","descuentoporcentaje",2,"border","1px solid #CCC"],["matInput","","type","number","formControlName","cargo",2,"border","1px solid #CCC"],["fxFlex","70",1,"text-right","font-weight-600"],["fxLayout","row","fxLayoutAlign","space-between center"],["mat-icon-button","","type","button"],["cols","3"],[4,"ngFor","ngForOf"],["fxFlex","70"],["fxFlex","30"],["fxLayout","column","fxLayout.gt-xs","row","fxLayoutAlign","center center"],["type","button","mat-flat-button","","color","accent",3,"click"],["diameter","50"],["fxLayout","row","fxLayoutAlign","space-between center",3,"value","ngSwitch",4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","start center"],["fxLayout","row","fxLayoutAlign","space-between center",3,"value","ngSwitch"],["fxFlex","",1,"borde"],[1,"align-middle","mr-4","shadow-6","h-6","inline-block",3,"src"],[1,"body-1"],["fxFlex","",1,"text-right","borde"],["class","caption text-secondary ml-4",4,"ngSwitchCase"],["class","caption text-secondary ml-4",4,"ngSwitchDefault"],[1,"ml-1"],[1,"caption","text-secondary","ml-4"],["matSuffix","",3,"icIcon"],["matSuffix","",1,"cursor-pointer",3,"icIcon","click"],["fxFlex","75"],["fxFlex","10"],[3,"formGroupName"],["appearance","standard",1,"w-full"],["matInput","","placeholder","Ingrese producto","formControlName","producto",3,"matAutocomplete"],["auto","matAutocomplete"],["appearance","standard",2,"width","70px"],["matInput","","type","number","formControlName","cantidad"],["matInput","","type","number","formControlName","preciounit"],["matInput","","type","number","formControlName","total",1,"text-right",3,"readonly"],["type","button","mat-icon-button","","color","accent","matTooltip","Editar linea",3,"click"],["type","button","mat-icon-button","","color","warn","matTooltip","Eliminar linea",3,"click"],["fxFlex","80",1,"borde"],["fxFlex","20",1,"text-right","borde"],[1,"caption","text-secondary","mr-1"],["colspan","8",1,"text-center"],[1,"p-16"],["fxFlex","","matRipple","",1,"mr-sm-8","cursor-pointer",3,"matRippleCentered","click"],["mat-button","","type","button"]],template:function(t,e){if(1&t&&(u.Wb(0,"form",0),u.ec("ngSubmit",(function(){return e.modalMediopago()})),u.Wb(1,"div",1),u.Wb(2,"div",2),u.Wb(3,"div",3),u.Wb(4,"mat-card",4),u.Wb(5,"mat-card-header"),u.Wb(6,"mat-toolbar",5),u.Wb(7,"mat-toolbar-row",6),u.Wb(8,"div",7),u.Wb(9,"button",8),u.Wb(10,"mat-icon",9),u.Gc(11,"arrow_back"),u.Vb(),u.Vb(),u.Ec(12,Ya,2,4,"span",10),u.Vb(),u.Wb(13,"div"),u.Wb(14,"button",11),u.Rb(15,"mat-icon",9),u.Gc(16," GENERAR "),u.Vb(),u.Wb(17,"button",12),u.Rb(18,"mat-icon",9),u.Vb(),u.Wb(19,"button",13),u.Rb(20,"mat-icon",9),u.Vb(),u.Wb(21,"mat-menu",null,14),u.Wb(23,"button",15),u.Rb(24,"mat-icon",9),u.Wb(25,"span"),u.Gc(26,"Emitir e imprimir"),u.Vb(),u.Vb(),u.Wb(27,"button",15),u.Rb(28,"mat-icon",9),u.Wb(29,"span"),u.Gc(30,"Vista previa"),u.Vb(),u.Vb(),u.Wb(31,"button",16),u.Rb(32,"mat-icon",9),u.Wb(33,"span"),u.Gc(34,"Guardar como borrador"),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Wb(35,"mat-toolbar-row",17),u.Wb(36,"button",18),u.ec("click",(function(){return e.modalGeneral()})),u.Rb(37,"mat-icon",19),u.Gc(38," GENERAL "),u.Vb(),u.Wb(39,"button",18),u.ec("click",(function(){return e.modalGuia()})),u.Rb(40,"mat-icon",19),u.Gc(41," GU\xcdA REMISI\xd3N "),u.Vb(),u.Wb(42,"button",18),u.ec("click",(function(){return e.modalGuia()})),u.Rb(43,"mat-icon",19),u.Gc(44," COTIZACI\xd3N "),u.Vb(),u.Wb(45,"button",18),u.ec("click",(function(){return e.resetForm()})),u.Rb(46,"mat-icon",19),u.Gc(47," NOTA DE SALIDA "),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Wb(48,"mat-card-content",20),u.Wb(49,"div",21),u.Wb(50,"mat-form-field",22),u.Wb(51,"mat-label"),u.Gc(52,"Comprobante"),u.Vb(),u.Wb(53,"mat-select",23),u.Wb(54,"mat-option",24),u.Gc(55,"Seleccione"),u.Vb(),u.Ec(56,Za,6,4,"mat-option",25),u.Vb(),u.Ec(57,ti,2,0,"mat-error",10),u.Vb(),u.Wb(58,"mat-form-field",26),u.Wb(59,"mat-label"),u.Gc(60,"Fecha emisi\xf3n"),u.Vb(),u.Rb(61,"input",27),u.Rb(62,"mat-datepicker-toggle",28),u.Rb(63,"mat-datepicker",null,29),u.Ec(65,ei,2,0,"mat-error",10),u.Vb(),u.Wb(66,"mat-form-field",26),u.Wb(67,"mat-label"),u.Gc(68,"Moneda"),u.Vb(),u.Wb(69,"mat-select",30),u.Wb(70,"mat-option",24),u.Gc(71,"Seleccione"),u.Vb(),u.Ec(72,oi,2,2,"mat-option",25),u.Vb(),u.Ec(73,ai,2,0,"mat-error",10),u.Vb(),u.Vb(),u.Ec(74,ri,7,3,"div",31),u.Wb(75,"div",21),u.Wb(76,"mat-form-field",32),u.Wb(77,"mat-label"),u.Gc(78,"Clientex"),u.Vb(),u.Rb(79,"input",33),u.Wb(80,"mat-autocomplete",34,35),u.ec("optionSelected",(function(t){return e.autocompletadoClienteSelected(t.option.value)})),u.Ec(82,si,2,0,"mat-option",10),u.Ec(83,vi,5,3,"ng-container",10),u.Vb(),u.Ec(84,hi,1,1,"mat-icon",36),u.Ec(85,gi,1,1,"mat-icon",37),u.Ec(86,Vi,2,0,"mat-error",10),u.Vb(),u.Wb(87,"div",38),u.Wb(88,"button",39),u.ec("click",(function(){return e.newEntidad()})),u.Gc(89," NUEVO "),u.Vb(),u.Vb(),u.Vb(),u.Wb(90,"div",21),u.Wb(91,"mat-form-field",40),u.Ec(92,Ci,2,0,"mat-label",41),u.Ec(93,xi,2,0,"mat-label",41),u.Ec(94,Wi,2,0,"mat-label",41),u.Ec(95,wi,2,0,"mat-label",41),u.Ec(96,Fi,2,0,"mat-label",41),u.Ec(97,yi,2,0,"mat-label",42),u.Wb(98,"input",43),u.ec("keyup.enter",(function(){return e.indexEntidades()})),u.Vb(),u.Vb(),u.Wb(99,"mat-form-field",44),u.Wb(100,"mat-label"),u.Gc(101,"Correo"),u.Vb(),u.Rb(102,"input",45),u.Vb(),u.Vb(),u.Wb(103,"mat-form-field",46),u.Wb(104,"mat-label"),u.Gc(105,"Direcci\xf3n"),u.Vb(),u.Rb(106,"input",47),u.Vb(),u.Wb(107,"div",21),u.Wb(108,"mat-form-field",32),u.Wb(109,"mat-label"),u.Gc(110,"Producto"),u.Vb(),u.Rb(111,"input",48),u.Wb(112,"mat-autocomplete",49,50),u.ec("optionSelected",(function(t){return e.optionProductoSelected(t.option.value)})),u.Ec(114,Ii,9,6,"mat-option",25),u.jc(115,"async"),u.Vb(),u.Ec(116,Ei,1,1,"mat-icon",36),u.Ec(117,Gi,1,1,"mat-icon",37),u.Vb(),u.Wb(118,"div",38),u.Wb(119,"button",39),u.ec("click",(function(){return e.newProducto()})),u.Gc(120," NUEVO "),u.Vb(),u.Vb(),u.Vb(),u.Wb(121,"table",51),u.Wb(122,"thead"),u.Wb(123,"tr"),u.Wb(124,"th",52),u.Gc(125,"Nombre"),u.Vb(),u.Wb(126,"th",53),u.Gc(127,"Cantidad"),u.Vb(),u.Wb(128,"th",53),u.Gc(129,"P.Unit."),u.Vb(),u.Wb(130,"th",53),u.Gc(131,"Total"),u.Vb(),u.Wb(132,"th",54),u.Wb(133,"button",55),u.ec("click",(function(){return e.addItem()})),u.Rb(134,"mat-icon",9),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Wb(135,"tbody"),u.Ec(136,Ti,29,16,"tr",56),u.Ec(137,Oi,4,0,"tr",10),u.Vb(),u.Vb(),u.Wb(138,"div",21),u.Wb(139,"div",57),u.Wb(140,"mat-form-field",58),u.Wb(141,"mat-label"),u.Gc(142,"Condiciones de pago"),u.Vb(),u.Rb(143,"textarea",59),u.Vb(),u.Wb(144,"mat-form-field",58),u.Wb(145,"mat-label"),u.Gc(146,"Observaciones"),u.Vb(),u.Rb(147,"textarea",60),u.Vb(),u.Vb(),u.Wb(148,"div",61),u.Wb(149,"fieldset"),u.Wb(150,"div",2),u.Wb(151,"div",62),u.Gc(152," % Descuento global "),u.Vb(),u.Wb(153,"div",63),u.Rb(154,"input",64),u.Vb(),u.Vb(),u.Wb(155,"div",2),u.Wb(156,"div",62),u.Gc(157," Descuento global (-) S/ "),u.Vb(),u.Wb(158,"div",63),u.Gc(159),u.jc(160,"number"),u.Vb(),u.Vb(),u.Wb(161,"div",2),u.Wb(162,"div",62),u.Gc(163," Descuento por \xedtem (-) S/ "),u.Vb(),u.Wb(164,"div",63),u.Gc(165),u.jc(166,"number"),u.Vb(),u.Vb(),u.Wb(167,"div",2),u.Wb(168,"div",62),u.Gc(169," Descuento total (-) S/ "),u.Vb(),u.Wb(170,"div",63),u.Gc(171),u.jc(172,"number"),u.Vb(),u.Vb(),u.Wb(173,"div",2),u.Wb(174,"div",62),u.Gc(175," Exonerada S/ "),u.Vb(),u.Wb(176,"div",63),u.Gc(177),u.jc(178,"number"),u.Vb(),u.Vb(),u.Wb(179,"div",2),u.Wb(180,"div",62),u.Gc(181," Inafecta S/ "),u.Vb(),u.Wb(182,"div",63),u.Gc(183),u.jc(184,"number"),u.Vb(),u.Vb(),u.Wb(185,"div",2),u.Wb(186,"div",62),u.Gc(187," Gravada S/ "),u.Vb(),u.Wb(188,"div",63),u.Gc(189),u.jc(190,"number"),u.Vb(),u.Vb(),u.Wb(191,"div",2),u.Wb(192,"div",62),u.Gc(193," IGV S/ "),u.Vb(),u.Wb(194,"div",63),u.Gc(195),u.jc(196,"number"),u.Vb(),u.Vb(),u.Wb(197,"div",2),u.Wb(198,"div",62),u.Gc(199," Gratuita S/ "),u.Vb(),u.Wb(200,"div",63),u.Gc(201),u.jc(202,"number"),u.Vb(),u.Vb(),u.Wb(203,"div",2),u.Wb(204,"div",62),u.Gc(205," Otros cargos S/ "),u.Vb(),u.Wb(206,"div",63),u.Rb(207,"input",65),u.Vb(),u.Vb(),u.Wb(208,"div",2),u.Wb(209,"div",66),u.Gc(210," Total S/ "),u.Vb(),u.Wb(211,"div",63),u.Gc(212),u.jc(213,"number"),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Wb(214,"div",61),u.Wb(215,"div",67),u.Wb(216,"h3"),u.Gc(217,"Productos destacados"),u.Vb(),u.Wb(218,"button",68),u.Rb(219,"mat-icon",9),u.Vb(),u.Vb(),u.Wb(220,"pre"),u.Gc(221),u.jc(222,"json"),u.Vb(),u.Wb(223,"mat-grid-list",69),u.Ec(224,Pi,7,3,"mat-grid-tile",70),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Vb()),2&t){const t=u.uc(22),o=u.uc(64),a=u.uc(81),i=u.uc(113);u.oc("formGroup",e.ventaForm),u.Cb(9),u.oc("routerLink","/ventas"),u.Cb(1),u.oc("icIcon",e.icArrowBack),u.Cb(2),u.oc("ngIf",e.ventaForm.get("comprobante").value),u.Cb(3),u.oc("icIcon",e.icSend),u.Cb(2),u.oc("disabled",!e.ventaForm.valid||e.submitted),u.Cb(1),u.oc("icIcon",e.icSave),u.Cb(1),u.oc("matMenuTriggerFor",t),u.Cb(1),u.oc("icIcon",e.icMoreVert),u.Cb(3),u.oc("disabled",!e.ventaForm.valid||e.submitted),u.Cb(1),u.oc("icIcon",e.icPrint),u.Cb(3),u.oc("disabled",!e.ventaForm.valid||e.submitted),u.Cb(1),u.oc("icIcon",e.icPrint),u.Cb(4),u.oc("icIcon",e.icInsertDriveFile),u.Cb(5),u.oc("icIcon",e.icSettings),u.Cb(3),u.oc("icIcon",e.icInsertDriveFile),u.Cb(3),u.oc("icIcon",e.icInsertDriveFile),u.Cb(3),u.oc("icIcon",e.icInsertDriveFile),u.Cb(8),u.oc("value",null),u.Cb(2),u.oc("ngForOf",e.comprobantes),u.Cb(1),u.oc("ngIf",e.ventaForm.get("comprobante").hasError("required")),u.Cb(4),u.oc("matDatepicker",o),u.Cb(1),u.oc("for",o),u.Cb(3),u.oc("ngIf",e.ventaForm.get("fechaemision").hasError("required")),u.Cb(5),u.oc("value",null),u.Cb(2),u.oc("ngForOf",e.monedas),u.Cb(1),u.oc("ngIf",e.ventaForm.get("moneda").hasError("required")),u.Cb(1),u.oc("ngIf",e.ventaForm.get("comprobante").value&&13===e.ventaForm.get("comprobante").value.iddocumentofiscal),u.Cb(5),u.oc("matAutocomplete",a),u.Cb(1),u.oc("displayWith",e.displaySearchEntidad),u.Cb(2),u.oc("ngIf",e.isLoadingSearch),u.Cb(1),u.oc("ngIf",!e.isLoadingSearch),u.Cb(1),u.oc("ngIf",!e.ventaForm.get("cliente").value),u.Cb(1),u.oc("ngIf",e.ventaForm.get("cliente").value),u.Cb(1),u.oc("ngIf",e.ventaForm.get("cliente").hasError("required")),u.Cb(5),u.oc("ngSwitch",e.ventaForm.get("clientedoc").value),u.Cb(1),u.oc("ngSwitchCase",1),u.Cb(1),u.oc("ngSwitchCase",2),u.Cb(1),u.oc("ngSwitchCase",3),u.Cb(1),u.oc("ngSwitchCase",4),u.Cb(1),u.oc("ngSwitchCase",5),u.Cb(2),u.oc("readonly",!0),u.Cb(13),u.oc("matAutocomplete",i)("formControl",e.producto),u.Cb(1),u.oc("displayWith",e.displayProductoFn),u.Cb(2),u.oc("ngForOf",u.kc(115,63,e.filteredOptions)),u.Cb(2),u.oc("ngIf",!e.producto.value),u.Cb(1),u.oc("ngIf",e.producto.value),u.Cb(17),u.oc("icIcon",e.icAdd),u.Cb(2),u.oc("ngForOf",e.ventaForm.get("ventadet").controls),u.Cb(1),u.oc("ngIf",0===e.ventadet.controls.length),u.Cb(22),u.Ic(" ",u.lc(160,65,e.ventaForm.get("descuentoglobal").value,"1.2-2")," "),u.Cb(6),u.Ic(" ",u.lc(166,68,e.ventaForm.get("descuentoitem").value,"1.2-2")," "),u.Cb(6),u.Ic(" ",u.lc(172,71,e.ventaForm.get("descuentototal").value,"1.2-2")," "),u.Cb(6),u.Ic(" ",u.lc(178,74,e.ventaForm.get("exonerada").value,"1.2-2")," "),u.Cb(6),u.Ic(" ",u.lc(184,77,e.ventaForm.get("inafecta").value,"1.2-2")," "),u.Cb(6),u.Ic(" ",u.lc(190,80,e.ventaForm.get("gravada").value,"1.2-2")," "),u.Cb(6),u.Ic(" ",u.lc(196,83,e.ventaForm.get("valorimpuesto").value,"1.2-2")," "),u.Cb(6),u.Ic(" ",u.lc(202,86,e.ventaForm.get("gratuita").value,"1.2-2")," "),u.Cb(11),u.Ic(" ",u.lc(213,89,e.ventaForm.get("total").value,"1.2-2")," "),u.Cb(7),u.oc("icIcon",e.icSettings),u.Cb(2),u.Ic("          ",u.kc(222,92,e.ventaForm.value)," \n        "),u.Cb(3),u.oc("ngForOf",e.productos)}},directives:[i.w,i.q,i.i,F.c,F.a,Ka.a,Ka.d,Z.a,Z.c,F.b,y.b,I.a,a.g,E.a,G.a,W.p,Oe.b,Y.c,Y.d,Y.a,Ka.c,F.d,oe.d,oe.h,Ge.a,i.p,i.g,Re.n,W.o,ae.b,i.b,je.b,je.d,oe.j,je.a,qe.c,qe.a,W.r,W.s,W.t,i.f,i.d,i.s,Ja.a,oe.c,Be.b,i.j,Ja.c,Re.s,Ka.b],pipes:[W.b,W.f,W.h,$e.a,W.x],styles:["#ventas-form .content{padding:24px}#ventas-form .content fieldset{border:1px solid #ccc;border-radius:8px;padding:8px}#ventas-form .content fieldset legend{padding:0 8px}#ventas-form .cardcustom mat-card-header{margin:-16px -16px 0}#ventas-form .cardcustom mat-card-header mat-toolbar{border-radius:4px 4px 0 0}#ventas-form .cardcustom .mat-card-header-text{margin:0}#ventas-form .mat-select-panel mat-option.mat-option{height:unset;border:1px solid red}#ventas-form .mat-option-text.mat-option-text{white-space:normal;border:1px solid red}#ventas-form .borde{border:1px solid #000!important}"],encapsulation:2}),t})();var ji=o("iTUp"),Mi=o("cc8n"),Qi=o("YioD"),Bi=o("iWjc"),$i=o("7lCJ"),zi=o("J0XA"),Hi=o("We1G"),Xi=o.n(Hi),Ui=o("6qmq"),Ki=o.n(Ui),Ji=o("kYjG");function Yi(t,e){1&t&&(u.Wb(0,"span"),u.Gc(1,"comprobante electr\xf3nico"),u.Vb())}function Zi(t,e){if(1&t&&(u.Wb(0,"span"),u.Gc(1),u.Vb()),2&t){const t=u.ic();u.Cb(1),u.Ic(" Nueva ",t.comprobante.value.documentofiscal.nombre," ")}}function tn(t,e){if(1&t&&(u.Wb(0,"mat-option",75),u.Wb(1,"div",76),u.Wb(2,"span",77),u.Gc(3),u.Vb(),u.Wb(4,"span",78),u.Gc(5),u.Vb(),u.Vb(),u.Vb()),2&t){const t=e.$implicit;u.oc("value",t),u.Cb(3),u.Ic("",t.documentofiscal.nombre," "),u.Cb(2),u.Jc("",t.serie," - ",t.numero,"")}}function en(t,e){1&t&&(u.Wb(0,"mat-error"),u.Gc(1," Requerido! "),u.Vb())}function on(t,e){if(1&t&&(u.Wb(0,"mat-option",75),u.Gc(1),u.Vb()),2&t){const t=e.$implicit;u.oc("value",t.moneda),u.Cb(1),u.Ic(" ",t.nombre," ")}}function an(t,e){1&t&&(u.Wb(0,"mat-error"),u.Gc(1," Requerido! "),u.Vb())}function nn(t,e){1&t&&(u.Wb(0,"mat-error"),u.Gc(1," Requerido! "),u.Vb())}function cn(t,e){if(1&t&&(u.Wb(0,"mat-option",75),u.Gc(1),u.Vb()),2&t){const t=e.$implicit;u.oc("value",t.operacion),u.Cb(1),u.Ic(" ",t.nombre," ")}}function rn(t,e){1&t&&(u.Wb(0,"mat-error"),u.Gc(1," Requerido! "),u.Vb())}function sn(t,e){1&t&&(u.Wb(0,"span"),u.Gc(1," Comprobante a emitir Nota de cr\xe9dito "),u.Vb())}function ln(t,e){1&t&&(u.Wb(0,"span"),u.Gc(1," Comprobante a emitir Nota de d\xe9bito "),u.Vb())}function dn(t,e){1&t&&(u.Wb(0,"span"),u.Gc(1,' "Factura '),u.Vb())}function un(t,e){1&t&&(u.Wb(0,"span"),u.Gc(1,' "Boleta de venta '),u.Vb())}function bn(t,e){if(1&t&&(u.Wb(0,"span"),u.Gc(1),u.Vb()),2&t){const t=u.ic(2);u.Cb(1),u.Jc(" ",t.ventaForm.get("serienc").value," - ",t.ventaForm.get("numeronc").value,'" ')}}function mn(t,e){if(1&t){const t=u.Xb();u.Wb(0,"div",12),u.Wb(1,"button",79),u.ec("click",(function(){return u.wc(t),u.ic().modalNotacredito()})),u.Ec(2,sn,2,0,"span",6),u.Ec(3,ln,2,0,"span",6),u.Ec(4,dn,2,0,"span",6),u.Ec(5,un,2,0,"span",6),u.Ec(6,bn,2,2,"span",6),u.Vb(),u.Vb()}if(2&t){const t=u.ic();u.Cb(2),u.oc("ngIf",13===t.comprobante.value.iddocumentofiscal),u.Cb(1),u.oc("ngIf",10===t.comprobante.value.iddocumentofiscal),u.Cb(1),u.oc("ngIf",1===t.ventaForm.get("documentonc").value),u.Cb(1),u.oc("ngIf",2===t.ventaForm.get("documentonc").value),u.Cb(1),u.oc("ngIf",t.ventaForm.get("documentonc").value)}}function pn(t,e){1&t&&(u.Wb(0,"mat-option",80),u.Rb(1,"mat-spinner",81),u.Vb())}function fn(t,e){if(1&t&&u.Rb(0,"ic-icon",93),2&t){const t=u.ic(3);u.oc("icIcon",t.icAccountCircle)}}function vn(t,e){if(1&t&&u.Rb(0,"ic-icon",93),2&t){const t=u.ic(3);u.oc("icIcon",t.icDomain)}}function hn(t,e){1&t&&(u.Wb(0,"small",94),u.Gc(1,"DNI"),u.Vb())}function gn(t,e){1&t&&(u.Wb(0,"small",94),u.Gc(1,"RUC"),u.Vb())}function Vn(t,e){1&t&&(u.Wb(0,"small",94),u.Gc(1,"C.Ext."),u.Vb())}function Cn(t,e){1&t&&(u.Wb(0,"small",94),u.Gc(1,"Pasap."),u.Vb())}function xn(t,e){1&t&&(u.Wb(0,"small",94),u.Gc(1,"Sin D."),u.Vb())}function Wn(t,e){1&t&&(u.Wb(0,"small",94),u.Gc(1,"Identificaci\xf3n"),u.Vb())}const wn=function(){return[1,3,4,5,6,7]};function Fn(t,e){if(1&t&&(u.Wb(0,"mat-option",85),u.Wb(1,"div",86),u.Wb(2,"div",87),u.Ec(3,fn,1,1,"ic-icon",88),u.Ec(4,vn,1,1,"ic-icon",88),u.Vb(),u.Wb(5,"div",89),u.Wb(6,"small"),u.Gc(7),u.Vb(),u.Wb(8,"div",86),u.Ec(9,hn,2,0,"small",90),u.Ec(10,gn,2,0,"small",90),u.Ec(11,Vn,2,0,"small",90),u.Ec(12,Cn,2,0,"small",90),u.Ec(13,xn,2,0,"small",90),u.Ec(14,Wn,2,0,"small",91),u.Wb(15,"small",92),u.Gc(16),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Vb()),2&t){const t=e.$implicit;u.oc("value",t)("ngSwitch",t.iddocumento),u.Cb(3),u.oc("ngIf",-1!==u.pc(11,wn).indexOf(t.iddocumento)),u.Cb(1),u.oc("ngIf",2===t.iddocumento),u.Cb(3),u.Hc(t.entidad),u.Cb(2),u.oc("ngSwitchCase",1),u.Cb(1),u.oc("ngSwitchCase",2),u.Cb(1),u.oc("ngSwitchCase",3),u.Cb(1),u.oc("ngSwitchCase",4),u.Cb(1),u.oc("ngSwitchCase",5),u.Cb(3),u.Hc(t.numerodoc)}}function yn(t,e){if(1&t&&(u.Ub(0),u.Ec(1,Fn,17,12,"mat-option",82),u.Wb(2,"div",83),u.Wb(3,"small",84),u.Gc(4),u.Vb(),u.Vb(),u.Tb()),2&t){const t=u.ic();u.Cb(1),u.oc("ngForOf",t.searchResult.data),u.Cb(3),u.Jc("Mostrando ",t.searchResult.to," de ",t.searchResult.total," resultados.")}}function In(t,e){if(1&t&&u.Rb(0,"mat-icon",95),2&t){const t=u.ic();u.oc("icIcon",t.icSearch)}}function En(t,e){if(1&t){const t=u.Xb();u.Wb(0,"mat-icon",96),u.ec("click",(function(){return u.wc(t),u.ic().cliente.setValue("")})),u.Vb()}if(2&t){const t=u.ic();u.oc("icIcon",t.icClose)}}function Gn(t,e){1&t&&(u.Wb(0,"mat-error"),u.Gc(1," Requerido "),u.Vb())}function Rn(t,e){1&t&&(u.Wb(0,"mat-label"),u.Gc(1,"DNI"),u.Vb())}function Sn(t,e){1&t&&(u.Wb(0,"mat-label"),u.Gc(1,"RUC"),u.Vb())}function kn(t,e){1&t&&(u.Wb(0,"mat-label"),u.Gc(1,"C.Extranjeria"),u.Vb())}function Ln(t,e){1&t&&(u.Wb(0,"mat-label"),u.Gc(1,"Pasaporte"),u.Vb())}function Dn(t,e){1&t&&(u.Wb(0,"mat-label"),u.Gc(1,"Sin Documento"),u.Vb())}function _n(t,e){1&t&&(u.Wb(0,"mat-label"),u.Gc(1,"DNI / RUC / Otros"),u.Vb())}function Nn(t,e){if(1&t&&u.Rb(0,"mat-icon",95),2&t){const t=u.ic();u.oc("icIcon",t.icSearch)}}function An(t,e){if(1&t){const t=u.Xb();u.Wb(0,"mat-icon",96),u.ec("click",(function(){u.wc(t);const e=u.ic();return e.ventaForm.get("clientenumerodoc").setValue(""),e.cliente.setValue("")})),u.Vb()}if(2&t){const t=u.ic();u.oc("icIcon",t.icClose)}}function Tn(t,e){if(1&t&&(u.Wb(0,"mat-label"),u.Gc(1),u.Vb()),2&t){const t=u.ic().$implicit;u.Cb(1),u.Hc(t.get("producto").value.codigo)}}function On(t,e){1&t&&(u.Wb(0,"mat-option",80),u.Rb(1,"mat-spinner",81),u.Vb())}function Pn(t,e){if(1&t&&(u.Wb(0,"mat-option",75),u.Wb(1,"div",87),u.Wb(2,"small"),u.Gc(3),u.Vb(),u.Wb(4,"div",86),u.Wb(5,"small",94),u.Gc(6,"Precio"),u.Vb(),u.Wb(7,"small",92),u.Gc(8),u.Vb(),u.Vb(),u.Vb(),u.Vb()),2&t){const t=e.$implicit;u.oc("value",t),u.Cb(3),u.Hc(t.nombre),u.Cb(5),u.Hc(t.precio)}}function qn(t,e){if(1&t&&(u.Ub(0),u.Ec(1,Pn,9,3,"mat-option",16),u.Tb()),2&t){const t=u.ic().$implicit;u.Cb(1),u.oc("ngForOf",t.get("datalist").value)}}function jn(t,e){if(1&t&&u.Rb(0,"mat-icon",95),2&t){const t=u.ic(2);u.oc("icIcon",t.icSearch)}}function Mn(t,e){if(1&t){const t=u.Xb();u.Wb(0,"mat-icon",96),u.ec("click",(function(){return u.wc(t),u.ic().$implicit.get("producto").setValue("")})),u.Vb()}if(2&t){const t=u.ic(2);u.oc("icIcon",t.icClose)}}function Qn(t,e){if(1&t&&(u.Wb(0,"mat-option",75),u.Gc(1),u.Vb()),2&t){const t=e.$implicit;u.oc("value",t.idimpuesto),u.Cb(1),u.Ic(" ",t.nombre," ")}}function Bn(t,e){if(1&t&&(u.Wb(0,"div",114),u.Wb(1,"div",73),u.Wb(2,"button",115),u.ec("click",(function(){return(0,e.close)()})),u.Rb(3,"mat-icon",8),u.Vb(),u.Vb(),u.Wb(4,"div",12),u.Wb(5,"div",116),u.Rb(6,"mat-slide-toggle",117),u.Vb(),u.Wb(7,"mat-form-field",118),u.Wb(8,"mat-label"),u.Gc(9,"Impuesto a bolsa pl\xe1stica"),u.Vb(),u.Rb(10,"input",119),u.Vb(),u.Vb(),u.Wb(11,"mat-form-field",120),u.Wb(12,"mat-label"),u.Gc(13,"Descuento (Aplica al Sub total)"),u.Vb(),u.Rb(14,"input",121),u.Vb(),u.Wb(15,"mat-form-field",120),u.Wb(16,"mat-label"),u.Gc(17,"IGV de \xedtem"),u.Vb(),u.Rb(18,"input",122),u.Vb(),u.Vb()),2&t){const t=u.ic(2);u.Cb(3),u.oc("icIcon",t.icClose)}}function $n(t,e){if(1&t){const t=u.Xb();u.Wb(0,"div",97),u.Wb(1,"mat-form-field",98),u.Ec(2,Tn,2,1,"mat-label",6),u.Rb(3,"input",99),u.Wb(4,"mat-autocomplete",32,100),u.ec("optionSelected",(function(){u.wc(t);const o=e.$implicit;return u.ic().autocompletadoProductoSelected(o)})),u.Ec(6,On,2,0,"mat-option",34),u.Ec(7,qn,2,1,"ng-container",6),u.Vb(),u.Ec(8,jn,1,1,"mat-icon",35),u.Ec(9,Mn,1,1,"mat-icon",36),u.Vb(),u.Wb(10,"mat-form-field",101),u.Rb(11,"input",102),u.Vb(),u.Wb(12,"mat-form-field",103),u.Rb(13,"input",104),u.Vb(),u.Wb(14,"mat-form-field",103),u.Wb(15,"mat-select",105),u.Ec(16,Qn,2,2,"mat-option",16),u.Vb(),u.Vb(),u.Wb(17,"mat-form-field",103),u.Rb(18,"input",106),u.Vb(),u.Wb(19,"mat-form-field",103),u.Rb(20,"input",107),u.Vb(),u.Wb(21,"mat-form-field",103),u.Rb(22,"input",108),u.Vb(),u.Wb(23,"div",109,110),u.Wb(25,"button",111),u.ec("click",(function(){u.wc(t);const o=e.index;return u.ic().deleteItem(o)})),u.Rb(26,"mat-icon",8),u.Vb(),u.Wb(27,"button",112),u.ec("click",(function(){u.wc(t);const o=e.$implicit,a=u.uc(30),i=u.uc(24);return u.ic().openAddList(o,a,i)})),u.Rb(28,"mat-icon",8),u.Vb(),u.Ec(29,Bn,19,1,"ng-template",null,113,u.Fc),u.Vb(),u.Vb()}if(2&t){const t=e.$implicit,o=e.index,a=u.uc(5),i=u.ic();u.oc("formGroupName",o),u.Cb(2),u.oc("ngIf",t.get("producto").value),u.Cb(1),u.oc("matAutocomplete",a),u.Cb(1),u.oc("displayWith",i.displayProductoFn),u.Cb(2),u.oc("ngIf",t.get("datalistloading").value),u.Cb(1),u.oc("ngIf",!t.get("datalistloading").value),u.Cb(1),u.oc("ngIf",!t.get("producto").value),u.Cb(1),u.oc("ngIf",t.get("producto").value),u.Cb(7),u.oc("ngForOf",i.impuestos),u.Cb(10),u.oc("icIcon",i.icDelete),u.Cb(2),u.oc("icIcon",i.icEdit)}}function zn(t,e){if(1&t){const t=u.Xb();u.Wb(0,"div",123),u.Wb(1,"button",124),u.ec("click",(function(){return u.wc(t),u.ic().addItem()})),u.Rb(2,"mat-icon",8),u.Vb(),u.Vb()}if(2&t){const t=u.ic();u.Cb(2),u.oc("icIcon",t.icAdd)}}function Hn(t,e){if(1&t&&(u.Wb(0,"div",65),u.Wb(1,"div",125),u.Gc(2," Descuento total (-) S/ "),u.Vb(),u.Wb(3,"div",126),u.Gc(4),u.jc(5,"number"),u.Vb(),u.Vb()),2&t){const t=u.ic();u.Cb(4),u.Ic(" ",u.lc(5,1,t.ventaForm.get("descuentototal").value,"1.2-2")," ")}}function Xn(t,e){if(1&t&&(u.Wb(0,"div",65),u.Wb(1,"div",66),u.Gc(2," Exonerada S/ "),u.Vb(),u.Wb(3,"div",67),u.Gc(4),u.jc(5,"number"),u.Vb(),u.Vb()),2&t){const t=u.ic();u.Cb(4),u.Ic(" ",u.lc(5,1,t.ventaForm.get("exonerada").value,"1.2-2")," ")}}function Un(t,e){if(1&t&&(u.Wb(0,"div",65),u.Wb(1,"div",66),u.Gc(2," Inafecta S/ "),u.Vb(),u.Wb(3,"div",67),u.Gc(4),u.jc(5,"number"),u.Vb(),u.Vb()),2&t){const t=u.ic();u.Cb(4),u.Ic(" ",u.lc(5,1,t.ventaForm.get("inafecta").value,"1.2-2")," ")}}function Kn(t,e){if(1&t&&(u.Wb(0,"div",65),u.Wb(1,"div",66),u.Gc(2," Gratuita S/ "),u.Vb(),u.Wb(3,"div",67),u.Gc(4),u.jc(5,"number"),u.Vb(),u.Vb()),2&t){const t=u.ic();u.Cb(4),u.Ic(" ",u.lc(5,1,t.ventaForm.get("gratuita").value,"1.2-2")," ")}}function Jn(t,e){if(1&t&&(u.Wb(0,"div",65),u.Wb(1,"div",66),u.Gc(2," ICBPER "),u.Vb(),u.Wb(3,"div",67),u.Gc(4),u.jc(5,"number"),u.Vb(),u.Vb()),2&t){const t=u.ic();u.Cb(4),u.Ic(" ",u.lc(5,1,t.ventaForm.get("totalimpuestobolsa").value,"1.2-2")," ")}}let Yn=(()=>{class t{constructor(t,e,o,a,n,c,r,s,l,d){this.activatedRoute=t,this._matDialog=e,this.snackBar=o,this._entidadService=a,this._ventaService=n,this._documentoserieService=c,this._productoService=r,this._utils=s,this._datainicial=l,this.popover=d,this.submitted=!1,this.paramRoute=null,this.ventaNcNd=null,this.pipeDate=new W.e("es-Pe"),this.comprobante=new i.e(null,[i.v.required]),this.comprobantes=[],this.cliente=new i.e(null,[i.v.required]),this.searchResult={data:[],to:null,total:null},this.isLoadingSearch=!1,this.tiponc=this._datainicial.tiponc,this.monedas=this._datainicial.monedas,this.impuestos=this._datainicial.impuestos,this.operaciones=this._datainicial.operaciones,this.comprobantenc=this._datainicial.comprobantenc,this.icAdd=fe.a,this.icEdit=A.a,this.icSend=$a.a,this.icSave=Ha.a,this.icPrint=h.a,this.icClose=V.a,this.icSearch=me.a,this.icDelete=he.a,this.icDomain=Xi.a,this.icMoreVert=M.a,this.icSettings=ja.a,this.icArrowBack=Qa.a,this.icAccountCircle=Ki.a,this.icInsertDriveFile=B.a,this.leyenda={exonerada:!1,inafecta:!1,gratuita:!1,icpber:!1},this.settings=this._entidadService.settings,this.ventaForm=this.createForm()}ngOnInit(){this.settings.mediopago&&this.ventaForm.addControl("ventapago",new i.c([],[i.v.required])),this.activatedRoute.params.subscribe(t=>{if(this.resetForm(),this.paramRoute=t,this.paramRoute.comprobante)switch(this.paramRoute.comprobante.toUpperCase()){case"FACTURA":this.comprobantedefault=1;break;case"BOLETADEVENTA":this.comprobantedefault=2;break;case"NOTADECREDITO":this.comprobantedefault=13;break;case"NOTADEDEBITO":this.comprobantedefault=10}let e=null;this.comprobantes.forEach(t=>{t.iddocumentofiscal===this.comprobantedefault&&(e=t)}),console.log("itemSelected",e),e&&this.comprobante.setValue(e),this.paramRoute.venta&&this.show()}),this.cliente.valueChanges.pipe(Object(n.a)(300),Object(c.a)(()=>this.isLoadingSearch=!0),Object(r.a)(t=>{if("string"==typeof t&&(this.ventaForm.get("idcliente").setValue(null),this.ventaForm.get("cpecorreo").setValue(null),this.ventaForm.get("clientenombre").setValue(null),this.ventaForm.get("clientedoc").setValue(null),this.ventaForm.get("clientenumerodoc").setValue(null,{emitEvent:!1}),this.ventaForm.get("clientedireccion").setValue(null)),"string"==typeof t&&t){console.log("get API CLIENTE");const e={idempresa:this._entidadService.usuario.idempresa,page:1,pageSize:10,orderName:"entidad",orderSort:"asc"};return parseFloat(t)>0?e.likeNumerodoc=t:e.likeEntidad=t,this._entidadService.index(e).pipe(Object(s.a)(()=>this.isLoadingSearch=!1))}return this.isLoadingSearch=!1,[]})).subscribe(t=>{this.searchResult=t}),this.comprobante.valueChanges.subscribe(t=>{t&&t.iddocumentofiscal?(console.log("---\x3e",t.iddocumentofiscal,t.serie),this.ventaForm.get("iddocumentofiscal").setValue(t.iddocumentofiscal),this.ventaForm.get("serie").setValue(t.serie),this.ventaForm.get("numero").setValue(t.numero),13===t.iddocumentofiscal||10===t.iddocumentofiscal?(this.ventaForm.get("tiponc").setValue(1),this.ventaNcNd&&this.ventaNcNd.serie===t.serie?(this.ventaForm.get("documentonc").setValue(this.ventaNcNd.iddocumentofiscal),this.ventaForm.get("serienc").setValue(this.ventaNcNd.serie),this.ventaForm.get("numeronc").setValue(this.ventaNcNd.numero)):(this.ventaForm.get("documentonc").setValue(null),this.ventaForm.get("serienc").setValue(null),this.ventaForm.get("numeronc").setValue(null))):(this.ventaForm.get("tiponc").setValue(null),this.ventaForm.get("documentonc").setValue(null),this.ventaForm.get("serienc").setValue(null),this.ventaForm.get("numeronc").setValue(null))):(console.log("-vacio->"),this.ventaForm.get("iddocumentofiscal").setValue(null),this.ventaForm.get("serie").setValue(null),this.ventaForm.get("numero").setValue(null),this.ventaForm.get("tiponc").setValue(null),this.ventaForm.get("documentonc").setValue(null),this.ventaForm.get("serienc").setValue(null),this.ventaForm.get("numeronc").setValue(null))}),this.ventaForm.get("ventadet").valueChanges.subscribe(t=>{let e=!1,o=!1,a=!1,i=!1;t.forEach((t,n)=>{switch(t.idimpuesto){case 8:e=!0;break;case 9:o=!0;break;case 2:a=!0}t.bolsa&&(i=!0)}),this.leyenda={exonerada:e,inafecta:o,gratuita:a,icpber:i}}),this.ventaForm.get("clientenumerodoc").valueChanges.pipe(Object(n.a)(300),Object(r.a)(t=>{if("string"!=typeof t||8!==t.length&&11!==t.length)return[];{const e={page:1,pageSize:10,orderName:"entidad",orderSort:"asc"};return e.numerodoc=t,this._entidadService.index(e)}})).subscribe(t=>{if(t.data.length){const e=t.data[0];this.ventaForm.get("idcliente").setValue(e.identidad),this.ventaForm.get("cpecorreo").setValue(e.email),this.ventaForm.get("clientenombre").setValue(e.entidad),this.ventaForm.get("clientedoc").setValue(e.iddocumento),this.ventaForm.get("clientenumerodoc").setValue(e.numerodoc,{emitEvent:!1}),this.ventaForm.get("clientedireccion").setValue(e.direccion),this.cliente.setValue(e,{emitEvent:!1}),this.searchResult=t}}),this.ventaForm.get("cargo").valueChanges.subscribe(t=>{t=this._utils.redondearValor(t,2),this.ventaForm.get("cargo").setValue(t,{emitEvent:!1}),this.calcularTotales()}),this.ventaForm.get("descuentoporcentaje").valueChanges.subscribe(t=>{t=this._utils.redondearValor(t,2),this.ventaForm.get("descuentoporcentaje").setValue(t,{emitEvent:!1}),this.calcularTotales()}),this.indexDocumentoseries(),this.paramRoute.venta||(this.addItem(),this.addItem(),this.addItem())}show(){this._ventaService.show(this.paramRoute.venta,{conRecurso:"ventadet.producto,cliente,ventapago"}).subscribe(t=>{this.inicializarCliente(t.data),this.inicializarVenta(t.data)},t=>{console.log(t)})}createForm(){return new i.h({idsede:new i.e(this._entidadService.sedeDefault||null),iddocumentofiscal:new i.e(null),serie:new i.e(null),numero:new i.e(null),idcliente:new i.e(null),fechaemision:new i.e(new Date,[i.v.required]),fechavencimiento:new i.e(new Date),idestadodocumento:new i.e(27,[i.v.required]),cpecorreo:new i.e(null),clientenombre:new i.e(null),clientedoc:new i.e(null),clientenumerodoc:new i.e(null),clientedireccion:new i.e(null),operacion:new i.e(1,[i.v.required]),moneda:new i.e("PEN",[i.v.required]),tipocambio:new i.e(null),detraccion:new i.e(!1),selvaproducto:new i.e(!1),selvaservicio:new i.e(!1),placavehiculo:new i.e(null),ordencompra:new i.e(null),guiaremitente:new i.e(null),guiatransportista:new i.e(null),exonerada:new i.e(null),inafecta:new i.e(null),gratuita:new i.e(null),gravada:new i.e(null,[i.v.required]),valorimpuesto:new i.e(null,[i.v.required]),total:new i.e(null,[i.v.required]),pagado:new i.e(null),vuelto:new i.e(null),condicionpago:new i.e(null),pdfformato:new i.e("A4"),observacion:new i.e(null),ventadet:new i.c([],[i.v.required]),tiponc:new i.e(null),documentonc:new i.e(null),serienc:new i.e(null),numeronc:new i.e(null),descuentoporcentaje:new i.e(null,[i.v.min(0)]),descuentoglobal:new i.e(null),descuentoitem:new i.e(null),descuentototal:new i.e(null),cargo:new i.e(null,[i.v.min(0)]),totalimpuestobolsa:new i.e(null)})}inicializarCliente(t){const e={identidad:t.cliente.identidad,email:t.cliente.email,entidad:t.cliente.entidad,iddocumento:t.cliente.iddocumento,numerodoc:t.cliente.numerodoc,direccion:t.cliente.direccion};this.cliente.setValue(e),this.cliente.updateValueAndValidity(),this.autocompletadoClienteSelected(e),this.searchResult.data.push(e),this.searchResult.to+=1,this.searchResult.total+=1}inicializarVenta(t){console.log("PRIMERO inicializarVenta()"),this.ventaNcNd=t,this.ventaForm.get("idsede").setValue(t.idsede),this.ventaForm.get("operacion").setValue(t.operacion),this.ventaForm.get("pdfformato").setValue(t.pdfformato),this.ventaForm.get("moneda").setValue(t.moneda),this.ventaForm.get("selvaproducto").setValue("1"===t.selvaproducto),this.ventaForm.get("selvaservicio").setValue("1"===t.selvaservicio),13!==this.comprobantedefault&&10!==this.comprobantedefault||(this.ventaForm.get("tiponc").setValue(1),this.ventaForm.get("documentonc").setValue(t.iddocumentofiscal),this.ventaForm.get("serienc").setValue(t.serie),this.ventaForm.get("numeronc").setValue(t.numero)),t.ventadet.forEach(t=>{const e={idproducto:t.producto.idproducto,codigo:t.producto.codigo,nombre:t.producto.nombre,precio:parseFloat(t.preciounit),unidadmedida:t.producto.unidadmedida,codigosunat:t.producto.codigosunat,idimpuesto:t.idimpuesto,stock:null},o={producto:e,descripcion:t.descripcion,idimpuesto:t.idimpuesto,cantidad:parseFloat(t.cantidad),valorunit:parseFloat(t.valorunit),descuento:parseFloat(t.descuento),valorventa:parseFloat(t.valorventa),impuestobolsa:parseFloat(t.impuestobolsa),montototalimpuestos:parseFloat(t.montototalimpuestos),preciounit:parseFloat(t.preciounit),total:parseFloat(t.total),bolsa:parseFloat(t.impuestobolsa)>0,datalist:[new i.e(e)]};this.addItem(o)}),this.calcularTotales();let e=null;this.comprobantes.forEach(t=>{t.iddocumentofiscal===this.comprobantedefault&&this.ventaNcNd&&t.serie===this.ventaNcNd.serie&&(e=t)}),e&&this.comprobante.setValue(e)}calcularTotales(){console.log("calcularTotales()");let t=0,e=0,o=0,a=0,i=0,n=0,c=0,r=0,s=0,l=0;const d=this.ventaForm.get("cargo").value||0,u=this.ventaForm.get("descuentoporcentaje").value;if(this.ventadet.getRawValue().forEach(n=>{null!==n.total&&(i+=n.descuento,r+=n.impuestobolsa||0,1===n.idimpuesto&&(t+=n.valorventa,s+=n.montototalimpuestos),8===n.idimpuesto&&(e+=n.total),9===n.idimpuesto&&(o+=n.total),2===n.idimpuesto&&(a+=n.total))}),u>0){let a,i;if(i="porcentaje","porcentaje"===i&&(a=u/100),"valor"===i){let i=this._utils.redondearValor(t+s+e+o,2);i=0===i?1:i,a=u/i}c=(t+e+o)*a,c=this._utils.redondearValor(c,2),e-=e*a,e=this._utils.redondearValor(e,2),o-=o*a,o=this._utils.redondearValor(o,2);let n=t+s;n-=n*a,n=this._utils.redondearValor(n,2);const r=n/1.18,l=.18*r;t=this._utils.redondearValor(r,2),s=this._utils.redondearValor(l,2)}n=this._utils.redondearValor(i+c,2),l=this._utils.redondearValor(t+s+e+o+d+r,2),this.ventaForm.get("descuentoglobal").setValue(c),this.ventaForm.get("exonerada").setValue(e),this.ventaForm.get("inafecta").setValue(o),this.ventaForm.get("gratuita").setValue(a),this.ventaForm.get("gravada").setValue(t),this.ventaForm.get("descuentoitem").setValue(i),this.ventaForm.get("descuentototal").setValue(n),this.ventaForm.get("valorimpuesto").setValue(s),this.ventaForm.get("totalimpuestobolsa").setValue(r),this.ventaForm.get("total").setValue(l)}get ventadet(){return this.ventaForm.get("ventadet")}get ventapago(){return this.ventaForm.get("ventapago")}autocompletadoProductoSelected(t){const e=t.value,o=e.cantidad||1,a=this._utils.calculoLinea(e.producto.idimpuesto||1,e.producto.precio||0,o,e.descuento||null);this.setImpuesto(t,a),this.setImpuestoBolsa(t,o,e.bolsa)}autocompletadoClienteSelected(t){t&&(this.ventaForm.get("idcliente").setValue(t.identidad),this.ventaForm.get("cpecorreo").setValue(t.email),this.ventaForm.get("clientenombre").setValue(t.entidad),this.ventaForm.get("clientedoc").setValue(t.iddocumento),this.ventaForm.get("clientenumerodoc").setValue(t.numerodoc,{emitEvent:!1}),this.ventaForm.get("clientedireccion").setValue(t.direccion))}addItem(t,e){const o=new i.h({producto:new i.e(t?t.producto:null),descripcion:new i.e(t?t.descripcion:null),cantidad:new i.e(t?t.cantidad:null),valorunit:new i.e(t?t.valorunit:null),descuento:new i.e(t?t.descuento:null),valorventa:new i.e({value:t?t.valorventa:null,disabled:!0}),impuestobolsa:new i.e({value:t?t.impuestobolsa:null,disabled:!0}),idimpuesto:new i.e(t?t.idimpuesto:1),montototalimpuestos:new i.e({value:t?t.montototalimpuestos:null,disabled:!0}),preciounit:new i.e(t?t.preciounit:null),total:new i.e(t?t.total:null),bolsa:new i.e(!!t&&t.bolsa),datalist:new i.c(t?t.datalist:[]),datalistloading:new i.e(!1)});o.get("idimpuesto").valueChanges.subscribe(e=>{(t=o.value).idimpuesto=e;const a=this._utils.calculoLinea(t.idimpuesto,t.preciounit,t.cantidad,t.descuento||null);this.setImpuesto(o,a)}),o.get("preciounit").valueChanges.subscribe(e=>{(t=o.value).preciounit=e;const a=this._utils.calculoLinea(t.idimpuesto,t.preciounit,t.cantidad,t.descuento||null);this.setImpuesto(o,a)}),o.get("cantidad").valueChanges.subscribe(e=>{(t=o.value).cantidad=e;const a=this._utils.calculoLinea(t.idimpuesto,t.preciounit,t.cantidad,t.descuento||null);this.setImpuesto(o,a),this.setImpuestoBolsa(o,t.cantidad,t.bolsa)}),o.get("descuento").valueChanges.subscribe(e=>{(t=o.value).descuento=e;const a=this._utils.calculoLinea(t.idimpuesto,t.preciounit,t.cantidad,t.descuento||null);this.setImpuesto(o,a)}),o.get("total").valueChanges.subscribe(e=>{(t=o.value).total=e;const a=this._utils.calculoLineaT(t.idimpuesto,t.total,t.cantidad,t.descuento||null);this.setImpuesto(o,a)}),o.get("bolsa").valueChanges.subscribe(e=>{this.setImpuestoBolsa(o,(t=o.value).cantidad,e)}),o.get("producto").valueChanges.pipe(Object(n.a)(300),Object(r.a)(t=>{if(t&&"string"==typeof t){o.get("datalistloading").setValue(!0);const e={page:1,pageSize:10,orderName:"nombre",orderSort:"asc"};return e.likeNombre=t,this._productoService.index(e)}return o.get("datalistloading").setValue(!1),[]})).subscribe(t=>{o.get("datalistloading").setValue(!1),o.get("datalist").clear(),t.data.forEach(t=>{o.get("datalist").push(new i.e({idproducto:t.idproducto,codigo:t.codigo,nombre:t.nombre,precio:t.valorventa,unidadmedida:t.unidadmedida,codigosunat:t.codigosunat,idimpuesto:t.idimpuesto,stock:t.stock}))})}),void 0===e?this.ventadet.push(o):this.ventadet.setControl(e,o),this.calcularTotales()}setImpuesto(t,e){t.get("cantidad").setValue(e.cantidad,{emitEvent:!1}),t.get("idimpuesto").setValue(e.idimpuesto,{emitEvent:!1}),t.get("preciounit").setValue(e.preciounit,{emitEvent:!1}),t.get("valorunit").setValue(e.valorunit,{emitEvent:!1}),t.get("descuento").setValue(e.descuento,{emitEvent:!1}),t.get("valorventa").setValue(e.subtotal,{emitEvent:!1}),t.get("montototalimpuestos").setValue(e.montototalimpuestos,{emitEvent:!1}),t.get("total").setValue(e.total,{emitEvent:!1}),this.calcularTotales()}setImpuestoBolsa(t,e,o){if(o){const o=this._utils.redondearValor(.2*(e=e||0),3);t.get("impuestobolsa").setValue(o,{emitEvent:!1})}else t.get("impuestobolsa").setValue(null,{emitEvent:!1});this.calcularTotales()}deleteItem(t){this.ventadet.removeAt(t),this.calcularTotales()}displaySearchEntidad(t){return t?t.entidad:null}displayProductoFn(t){return t?t.nombre:void 0}newEntidad(){let t=null;"string"==typeof this.cliente.value&&/^[0-9]+$/.exec(this.cliente.value.trim())&&(t=this.cliente.value.trim()),this._matDialog.open(Oa.a,{panelClass:"contacto-form-dialog",data:{action:"new",dialogTitle:"Nuevo cliente",tipo:"cliente",numerodoc:t},autoFocus:!1}).afterClosed().subscribe(t=>{if(!t)return;const e={identidad:t.identidad,email:t.email,entidad:t.entidad,iddocumento:t.iddocumento,numerodoc:t.numerodoc,direccion:t.direccion};this.cliente.setValue(e),this.cliente.updateValueAndValidity(),this.autocompletadoClienteSelected(e),this.searchResult.data.push(e),this.searchResult.to+=1,this.searchResult.total+=1})}newProducto(){this._matDialog.open(Pa.a,{panelClass:"item-form-dialog",data:{action:"new",dialogTitle:"Nuevo producto"},autoFocus:!1}).afterClosed().subscribe(t=>{if(!t)return;let e;for(const[i,c]of this.ventadet.value.entries())if(!c.producto||!c.producto.idproducto){e=i;break}const o={idproducto:t.idproducto,codigo:t.codigo,nombre:t.nombre,precio:t.valorventa,unidadmedida:t.unidadmedida,codigosunat:t.codigosunat,idimpuesto:t.idimpuesto,stock:null},a=this._utils.calculoLinea(t.idimpuesto,t.valorventa,1),n={producto:o,descripcion:null,idimpuesto:t.idimpuesto,cantidad:1,valorunit:a.valorunit,descuento:a.descuento,valorventa:a.subtotal,montototalimpuestos:a.montototalimpuestos,preciounit:a.preciounit,total:a.total,bolsa:a.impuestobolsa>0,datalist:[new i.e(o)]};this.addItem(n,e)})}modalGeneral(){this._matDialog.open(ia,{panelClass:"ventasgeneral-form-dialog",data:{venta:this.ventaForm.getRawValue()},autoFocus:!1}).afterClosed().subscribe(t=>{t&&(this.ventaForm.get("fechavencimiento").setValue(t.fechavencimiento),this.ventaForm.get("operacion").setValue(t.operacion),this.ventaForm.get("placavehiculo").setValue(t.placavehiculo),this.ventaForm.get("ordencompra").setValue(t.ordencompra),this.ventaForm.get("guiaremitente").setValue(t.guiaremitente),this.ventaForm.get("guiatransportista").setValue(t.guiatransportista),this.ventaForm.get("tipocambio").setValue(t.tipocambio),this.ventaForm.get("pdfformato").setValue(t.pdfformato),this.ventaForm.get("detraccion").setValue(t.detraccion),this.ventaForm.get("selvaproducto").setValue(t.selvaproducto),this.ventaForm.get("selvaservicio").setValue(t.selvaservicio))})}modalNotacredito(){this._matDialog.open(Ta,{panelClass:"ventasnotacredito-form-dialog",data:this.ventaForm.getRawValue(),autoFocus:!1}).afterClosed().subscribe(t=>{if(!t)return;this.ventaForm.get("tiponc").setValue(t.tiponc),this.ventaForm.get("documentonc").setValue(t.documentonc),this.ventaForm.get("serienc").setValue(t.serienc),this.ventaForm.get("numeronc").setValue(t.numeronc);let e=null;this.comprobantes.forEach(o=>{13!==o.iddocumentofiscal&&10!==o.iddocumentofiscal||o.serie!==t.serienc||(e=o)}),"0"===t.serienc.substr(0,1)&&this.comprobantes.forEach(o=>{const a=1===t.documentonc?"F":"B";13!==o.iddocumentofiscal&&10!==o.iddocumentofiscal||o.serie.substr(0,1)!==a||(e=o)}),e&&this.comprobante.setValue(e,{emitEvent:!1})})}modalGuia(){this._matDialog.open(na,{panelClass:"ventasguia-form-dialog",data:{venta:this.ventaForm},autoFocus:!1}).afterClosed().subscribe(t=>{})}modalFormato(){this._matDialog.open(ca,{panelClass:"ventasformato-form-dialog",data:{venta:this.ventaForm},autoFocus:!1}).afterClosed().subscribe(t=>{})}modalItem(t,e){this._matDialog.open(ha,{panelClass:"ventasitem-form-dialog",data:{item:t.getRawValue(),impuestos:this.impuestos},autoFocus:!1}).afterClosed().subscribe(o=>{if(!o)return;let a=!1;this.ventadet.value.forEach(e=>{e.producto&&e.producto.idproducto===o.producto.idproducto&&o.producto.idproducto!==t.get("producto").value.idproducto&&(a=!0)}),a?this.snackBar.open(`${o.producto.nombre} ya esta a\xf1adido.`,"Cerrar",{duration:4e3,panelClass:["error-dialog"]}):(this.ventadet.at(e).get("idimpuesto").setValue(o.idimpuesto,{emitEvent:!1}),this.ventadet.at(e).get("producto").setValue(o.producto,{emitEvent:!1}),this.ventadet.at(e).get("descripcion").setValue(o.descripcion,{emitEvent:!1}),this.ventadet.at(e).get("cantidad").setValue(o.cantidad,{emitEvent:!1}),this.ventadet.at(e).get("preciounit").setValue(o.preciounit,{emitEvent:!1}),this.ventadet.at(e).get("valorunit").setValue(o.valorunit,{emitEvent:!1}),this.ventadet.at(e).get("descuento").setValue(o.descuento,{emitEvent:!1}),this.ventadet.at(e).get("valorventa").setValue(o.valorventa,{emitEvent:!1}),this.ventadet.at(e).get("montototalimpuestos").setValue(o.montototalimpuestos,{emitEvent:!1}),this.ventadet.at(e).get("total").setValue(o.total,{emitEvent:!1}),setTimeout(()=>{t.get("producto").updateValueAndValidity()},100),this.calcularTotales())})}indexDocumentoseries(){this._documentoserieService.index({idsede:this._entidadService.sedeDefault,conRecurso:"documentofiscal",orderName:"iddocumentofiscal",orderSort:"asc"}).subscribe(t=>{console.log("PRIMERO indexDocumentoseries()"),t.data.forEach(t=>{this.comprobantes.push({iddocumentofiscal:t.iddocumentofiscal,documentofiscal:{nombre:t.documentofiscal.nombre},serie:t.serie,numero:t.numero})});let e=null;this.comprobantes.forEach(t=>{this.paramRoute.venta?t.iddocumentofiscal===this.comprobantedefault&&this.ventaNcNd&&t.serie===this.ventaNcNd.serie&&(e=t):t.iddocumentofiscal===this.comprobantedefault&&(e=t)}),e&&(console.log("indexDocumentoseries",!this.paramRoute.venta),this.comprobante.setValue(e))})}modalMediopago(){this._matDialog.open(Ga,{panelClass:"ventasmediopago-form-dialog",data:{venta:this.ventaForm.getRawValue()},autoFocus:!1}).afterClosed().subscribe(t=>{if(t){for(;this.ventapago.value.length>0;)this.ventapago.removeAt(0);t.mediopago.forEach(t=>{const e=new i.h({idmediopago:new i.e(t.idmediopago),importe:new i.e(t.importe),nota:new i.e(t.nota)});this.ventapago.push(e)}),this.ventaForm.get("pagado").setValue(t.pagado),this.ventaForm.get("vuelto").setValue(t.vuelto),this.save()}})}emitir(){let t;if(t=this.ventaForm.getRawValue(),!t.idcliente)return void this.snackBar.open("Ingrese cliente","Cerrar",{panelClass:["error-dialog"]});let e=!0;t.ventadet.forEach(t=>{t.producto&&t.producto.idproducto&&(e=!1)}),e?this.snackBar.open("Ingrese producto para la venta","Cerrar",{panelClass:["error-dialog"]}):this.settings.mediopago?this.modalMediopago():this.save()}resetCliente(){this.resetForm()}save(){let t;t=this.ventaForm.getRawValue();const e=[];t.ventadet.forEach(t=>{t.producto&&t.producto.idproducto&&e.push({cantidad:t.cantidad,codigo:t.producto.codigo,codigosunat:t.producto.codigosunat,descripcion:t.descripcion,descuento:t.descuento,idimpuesto:t.idimpuesto,idproducto:t.producto.idproducto,impuestobolsa:t.impuestobolsa,montototalimpuestos:t.montototalimpuestos,nombre:t.producto.nombre,preciounit:t.preciounit,total:t.total,unidadmedida:t.producto.unidadmedida,valorunit:t.valorunit,valorventa:t.valorventa})}),t.ventadet=e,t.fechaemision=this.pipeDate.transform(t.fechaemision,"yyyy-MM-dd"),t.fechavencimiento=t.fechavencimiento?this.pipeDate.transform(t.fechavencimiento,"yyyy-MM-dd"):null,t.detraccion=t.detraccion?"1":"0",t.selvaproducto=t.selvaproducto?"1":"0",t.selvaservicio=t.selvaservicio?"1":"0",this.snackBar.open("Procesando venta..."),this.submitted=!0,this._ventaService.create(t).subscribe(t=>{let e;switch(this.indexDocumentoseries(),t.iddocumentofiscal){case 1:e="Factura";break;case 2:e="Boleta de venta";break;case 10:e="Nota de d\xe9bito";break;case 13:e="Nota de cr\xe9dito"}this.resetForm(),this.submitted=!1,this.showVenta(t,"COMPROBANTE"),this.snackBar.open(`${e} ${t.serie} - ${t.numero} emitido.`,"Cerrar")},t=>{const e=this._utils.convertError(t);this.submitted=!1,this.snackBar.open(e,"Cerrar",{panelClass:["error-dialog"]})})}resetForm(){let t=null;this.comprobantes.forEach(e=>{e.iddocumentofiscal===this.comprobantedefault&&(t=e)}),this.comprobante.reset(t,{emitEvent:!1}),this.cliente.reset(null,{emitEvent:!1}),this.ventaForm.get("ventadet").controls.forEach(t=>{for(;0!==t.controls.datalist.length;)t.controls.datalist.removeAt(0)});let e=1;const o=[];for(;e<=this.ventadet.value.length;)o.push({producto:null,descripcion:null,cantidad:null,valorunit:null,descuento:null,valorventa:null,impuestobolsa:null,idimpuesto:1,montototalimpuestos:null,preciounit:null,total:null,bolsa:!1,datalist:[],datalistloading:!1}),e++;const a={comprobante:t,idsede:this._entidadService.sedeDefault||null,iddocumentofiscal:t?t.iddocumentofiscal:null,serie:t?t.serie:null,numero:t?t.numero:null,fechaemision:new Date,fechavencimiento:new Date,idestadodocumento:27,operacion:1,moneda:"PEN",detraccion:!1,selvaproducto:!1,selvaservicio:!1,pdfformato:"A4",ventadet:o,tiponc:t&&13===t.iddocumentofiscal?1:null};this.settings.mediopago&&(a.ventapago=[]),this.ventaForm.reset(a,{emitEvent:!1}),this.leyenda={exonerada:!1,inafecta:!1,gratuita:!1,icpber:!1}}openAddList(t,e,o){this.popover.open({content:e,origin:o,position:[{originX:"start",originY:"bottom",overlayX:"center",overlayY:"top"},{originX:"center",originY:"bottom",overlayX:"center",overlayY:"top"}]})}showVenta(t,e){this._matDialog.open(Jt,{panelClass:"venta-show-dialog",data:{idventa:t.idventa,pestana:e,botones:{canu:!1,rpdf:!1,nvent:!0,edit:!1,anu:!0,mail:!0,nc:!1,nd:!1,gr:!1}},autoFocus:!1,disableClose:!0}).afterClosed().subscribe(e=>{e&&("anular"===e&&this.anularVenta(t),"correo"===e&&this.correoVenta(t))})}anularVenta(t){this._matDialog.open(ce,{panelClass:"ventasanular-form-dialog",data:{venta:t},autoFocus:!1}).afterClosed().subscribe(t=>{})}correoVenta(t){this._matDialog.open(ue,{panelClass:"ventascorreo-form-dialog",data:{venta:t},autoFocus:!1}).afterClosed().subscribe(t=>{})}}return t.\u0275fac=function(e){return new(e||t)(u.Qb(a.a),u.Qb(d.b),u.Qb(K.b),u.Qb(J.a),u.Qb(b.a),u.Qb(Xa.a),u.Qb(Ua.a),u.Qb(U.a),u.Qb(ee.a),u.Qb(Ji.a))},t.\u0275cmp=u.Kb({type:t,selectors:[["vex-ventas-emitir"]],decls:193,vars:65,consts:[["id","ventas-emitir",3,"formGroup","ngSubmit"],["color","primary"],["fxLayoutAlign","space-between center",1,"container"],["fxLayout","row","fxLayoutAlign","center center"],["mat-icon-button","","type","button","matTooltip","Volver",3,"routerLink"],[3,"icIcon"],[4,"ngIf"],["mat-button","","type","button",3,"click"],["size","18px",3,"icIcon"],["mat-raised-button","","type","submit","fxHide","","fxShow.gt-xs","",1,"mr-1",3,"disabled"],["mat-icon-button","","type","submit","fxShow","","fxHide.gt-xs","",3,"disabled"],[1,"content","container"],["fxLayout","row","fxLayout.lt-sm","column","fxLayoutGap","16px","fxLayoutGap.lt-sm","0"],["fxFlex","50"],["appearance","standard","floatLabel","always","fxFlex","66",1,"vex-flex-form-field"],[3,"formControl"],[3,"value",4,"ngFor","ngForOf"],["appearance","standard","floatLabel","always","fxFlex","auto",1,"vex-flex-form-field"],["formControlName","moneda"],["appearance","standard","floatLabel","always","fxFlex","33",1,"vex-flex-form-field"],["matInput","","name","start","formControlName","fechaemision",3,"matDatepicker"],["matSuffix","",3,"for"],["fechaDatePicker",""],["matInput","","name","start","formControlName","fechavencimiento",3,"matDatepicker"],["fechaDatePickerVence",""],["appearance","standard","floatLabel","always","fxFlex","34",1,"vex-flex-form-field"],["formControlName","operacion"],["matInput","","formControlName","guiaremitente"],["matInput","","formControlName","ordencompra"],["fxLayout","row","fxLayout.lt-sm","column","fxLayoutGap","16px","fxLayoutGap.lt-sm","0",4,"ngIf"],["fxLayout","row","fxLayoutGap","8px","fxFlex","100"],["matInput","",3,"matAutocomplete","formControl"],["autoActiveFirstOption","",3,"displayWith","optionSelected"],["autoCliente","matAutocomplete"],["class","p-3","value","",4,"ngIf"],["matSuffix","",3,"icIcon",4,"ngIf"],["matSuffix","","class","cursor-pointer",3,"icIcon","click",4,"ngIf"],["fxFlex","none"],["type","button","mat-mini-fab","","color","primary","matTooltip","Nuevo cliente",3,"click"],["appearance","standard","floatLabel","always","fxFlex","35",3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["matInput","","name","clientenumerodoc","formControlName","clientenumerodoc"],["appearance","standard","floatLabel","always","fxFlex","65"],["matInput","","formControlName","cpecorreo"],["appearance","standard","floatLabel","always","fxFlex","100"],["matInput","","formControlName","clientedireccion"],["fxFlex","auto",1,"mt-4"],["formArrayName","ventadet"],["fxLayout","row","fxLayoutAlign","start center","fxLayout.lt-sm","column","fxLayoutAlign.lt-sm","start stretch","fxLayoutGap","8px","fxLayoutGap.lt-sm","0"],["fxFlex","43"],["fxFlex","12"],["fxFlex","7"],["fxFlex","10","fxLayout","row","fxLayoutAlign","center center"],["type","button","mat-icon-button","","matTooltip","Agregar linea",1,"w-8","h-8","leading-none","flex","items-center","justify-center","ml-1","hover:bg-hover",3,"click"],["fxLayout","row","fxLayoutAlign","start center","fxLayout.lt-sm","column","fxLayoutAlign.lt-sm","start stretch","fxLayoutGap","8px","fxLayoutGap.lt-sm","0",3,"formGroupName",4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","center center","class","mt-4",4,"ngIf"],["fxLayout","row","fxLayout.lt-sm","column","fxLayoutGap","16px","fxLayoutGap.lt-sm","0",1,"mt-4"],["fxLayout","column","fxLayoutAlign","space-between","fxFlex","50",1,"borde"],["fxLayout","column","fxLayoutAlign","start start",1,"borde"],["fxLayout","row","fxLayout.lt-sm","column","fxLayoutGap","16px","fxLayoutGap.lt-sm","0",1,"borde"],["appearance","standard","floatLabel","always","fxFlex","auto",1,"vex-dense-form-field"],["matInput","","formControlName","condicionpago"],["matInput","","formControlName","observacion"],["fxFlex","50",1,"borde"],["fxLayout","column","fxLayout.gt-xs","row"],["fxFlex","80",1,"text-right"],["fxFlex","20",1,"text-right"],["matInput","","type","number","formControlName","descuentoporcentaje",2,"border-bottom","1px solid #CCC","width","80px"],["fxLayout","column","fxLayout.gt-xs","row",1,"mt-1"],["matInput","","type","number","formControlName","cargo",2,"border-bottom","1px solid #CCC","width","80px"],["fxLayout","column","fxLayout.gt-xs","row",4,"ngIf"],["fxFlex","80",1,"text-right","font-weight-600"],["fxLayout","row","fxLayoutAlign","end center"],["mat-raised-button","","color","primary","type","submit",1,"w-full",3,"disabled"],[3,"value"],["fxLayout","row","fxLayoutAlign","space-between center"],["fxFlex","70"],["fxFlex","30"],["type","button","mat-flat-button","","color","accent",3,"click"],["value","",1,"p-3"],["diameter","25"],[3,"value","ngSwitch",4,"ngFor","ngForOf"],["fxLayout","row"],[1,"p-3"],[3,"value","ngSwitch"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","8px"],["fxLayout","column","fxLayoutAlign","center start"],["size","24px",3,"icIcon",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center stretch"],["class","text-secondary inline-block",4,"ngSwitchCase"],["class","text-secondary inline-block",4,"ngSwitchDefault"],[1,"text-secondary"],["size","24px",3,"icIcon"],[1,"text-secondary","inline-block"],["matSuffix","",3,"icIcon"],["matSuffix","",1,"cursor-pointer",3,"icIcon","click"],["fxLayout","row","fxLayoutAlign","start center","fxLayout.lt-sm","column","fxLayoutAlign.lt-sm","start stretch","fxLayoutGap","8px","fxLayoutGap.lt-sm","0",3,"formGroupName"],["appearance","standard","floatLabel","always","fxFlex","43",1,"vex-flex-form-field"],["matInput","","formControlName","producto","placeholder","Buscar",3,"matAutocomplete"],["auto","matAutocomplete"],["appearance","standard","floatLabel","always","fxFlex","12",1,"vex-flex-form-field"],["matInput","","formControlName","descripcion"],["appearance","standard","floatLabel","always","fxFlex","7",1,"vex-flex-form-field"],["matInput","","type","number","formControlName","cantidad"],["formControlName","idimpuesto"],["matInput","","type","number","formControlName","preciounit"],["matInput","","type","number","formControlName","valorventa"],["matInput","","type","number","formControlName","total",1,"text-right"],["fxLayout","row","fxLayoutAlign","center center","fxFlex","10"],["addListOriginRef",""],["type","button","mat-icon-button","","matTooltip","Eliminar",1,"w-8","h-8","leading-none","flex","items-center","justify-center","hover:bg-hover",3,"click"],["type","button","mat-icon-button","","matTooltip","Editar",1,"w-8","h-8","leading-none","flex","items-center","justify-center","ml-1","hover:bg-hover",3,"click"],["addListTemplate",""],["fxLayout","column",1,"card","px-4","pt-3","pb-2"],["mat-icon-button","","type","button",1,"text-secondary","w-8","h-8","leading-none",3,"click"],["fxFlex","auto","fxLayout","row","fxLayoutAlign","center start"],["formControlName","bolsa","labelPosition","after"],["appearance","standard","floatLabel","always","fxFlex","80"],["matInput","","type","number","formControlName","impuestobolsa"],["appearance","standard","floatLabel","always"],["matInput","","type","number","formControlName","descuento"],["matInput","","type","number","formControlName","montototalimpuestos"],["fxLayout","row","fxLayoutAlign","center center",1,"mt-4"],["mat-stroked-button","","matTooltip","Agregar linea",1,"w-full",3,"click"],["fxFlex","70",1,"text-right"],["fxFlex","30",1,"text-right"]],template:function(t,e){if(1&t&&(u.Wb(0,"form",0),u.ec("ngSubmit",(function(){return e.emitir()})),u.Wb(1,"mat-toolbar",1),u.Wb(2,"mat-toolbar-row",2),u.Wb(3,"div",3),u.Wb(4,"button",4),u.Rb(5,"mat-icon",5),u.Vb(),u.Ec(6,Yi,2,0,"span",6),u.Ec(7,Zi,2,1,"span",6),u.Vb(),u.Wb(8,"div"),u.Wb(9,"button",7),u.ec("click",(function(){return e.modalGeneral()})),u.Rb(10,"mat-icon",8),u.Gc(11," GENERAL "),u.Vb(),u.Wb(12,"button",7),u.ec("click",(function(){return e.resetCliente()})),u.Gc(13," RESET CLIENTE "),u.Vb(),u.Wb(14,"button",9),u.Rb(15,"mat-icon",5),u.Gc(16," EMITIR "),u.Vb(),u.Wb(17,"button",10),u.Rb(18,"mat-icon",5),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Wb(19,"div",11),u.Wb(20,"div",12),u.Wb(21,"mat-card",13),u.Wb(22,"mat-card-content"),u.Wb(23,"div",12),u.Wb(24,"mat-form-field",14),u.Wb(25,"mat-label"),u.Gc(26,"Comprobante"),u.Vb(),u.Wb(27,"mat-select",15),u.Ec(28,tn,6,4,"mat-option",16),u.Vb(),u.Ec(29,en,2,0,"mat-error",6),u.Vb(),u.Wb(30,"mat-form-field",17),u.Wb(31,"mat-label"),u.Gc(32,"Moneda"),u.Vb(),u.Wb(33,"mat-select",18),u.Ec(34,on,2,2,"mat-option",16),u.Vb(),u.Ec(35,an,2,0,"mat-error",6),u.Vb(),u.Vb(),u.Wb(36,"div",12),u.Wb(37,"mat-form-field",19),u.Wb(38,"mat-label"),u.Gc(39,"Fecha emisi\xf3n"),u.Vb(),u.Rb(40,"input",20),u.Rb(41,"mat-datepicker-toggle",21),u.Rb(42,"mat-datepicker",null,22),u.Ec(44,nn,2,0,"mat-error",6),u.Vb(),u.Wb(45,"mat-form-field",19),u.Wb(46,"mat-label"),u.Gc(47,"Fecha vencimiento"),u.Vb(),u.Rb(48,"input",23),u.Rb(49,"mat-datepicker-toggle",21),u.Rb(50,"mat-datepicker",null,24),u.Vb(),u.Wb(52,"mat-form-field",25),u.Wb(53,"mat-label"),u.Gc(54,"Operaci\xf3n"),u.Vb(),u.Wb(55,"mat-select",26),u.Ec(56,cn,2,2,"mat-option",16),u.Vb(),u.Ec(57,rn,2,0,"mat-error",6),u.Vb(),u.Vb(),u.Wb(58,"div",12),u.Wb(59,"mat-form-field",17),u.Wb(60,"mat-label"),u.Gc(61,"Gu\xeda de remisi\xf3n"),u.Vb(),u.Rb(62,"input",27),u.Vb(),u.Wb(63,"mat-form-field",17),u.Wb(64,"mat-label"),u.Gc(65,"Orden de compra"),u.Vb(),u.Rb(66,"input",28),u.Vb(),u.Vb(),u.Ec(67,mn,7,5,"div",29),u.Vb(),u.Vb(),u.Wb(68,"mat-card",13),u.Wb(69,"mat-card-content"),u.Wb(70,"div",12),u.Wb(71,"div",30),u.Wb(72,"mat-form-field",17),u.Wb(73,"mat-label"),u.Gc(74,"Cliente"),u.Vb(),u.Rb(75,"input",31),u.Wb(76,"mat-autocomplete",32,33),u.ec("optionSelected",(function(t){return e.autocompletadoClienteSelected(t.option.value)})),u.Ec(78,pn,2,0,"mat-option",34),u.Ec(79,yn,5,3,"ng-container",6),u.Vb(),u.Ec(80,In,1,1,"mat-icon",35),u.Ec(81,En,1,1,"mat-icon",36),u.Ec(82,Gn,2,0,"mat-error",6),u.Vb(),u.Wb(83,"div",37),u.Wb(84,"button",38),u.ec("click",(function(){return e.newEntidad()})),u.Rb(85,"mat-icon",5),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Wb(86,"div",12),u.Wb(87,"mat-form-field",39),u.Ec(88,Rn,2,0,"mat-label",40),u.Ec(89,Sn,2,0,"mat-label",40),u.Ec(90,kn,2,0,"mat-label",40),u.Ec(91,Ln,2,0,"mat-label",40),u.Ec(92,Dn,2,0,"mat-label",40),u.Ec(93,_n,2,0,"mat-label",41),u.Rb(94,"input",42),u.Ec(95,Nn,1,1,"mat-icon",35),u.Ec(96,An,1,1,"mat-icon",36),u.Vb(),u.Wb(97,"mat-form-field",43),u.Wb(98,"mat-label"),u.Gc(99,"Correo"),u.Vb(),u.Rb(100,"input",44),u.Vb(),u.Vb(),u.Wb(101,"div",12),u.Wb(102,"mat-form-field",45),u.Wb(103,"mat-label"),u.Gc(104,"Direcci\xf3n"),u.Vb(),u.Rb(105,"input",46),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Wb(106,"div",12),u.Wb(107,"mat-card",47),u.Wb(108,"mat-card-content"),u.Wb(109,"div",48),u.Wb(110,"div",49),u.Wb(111,"div",50),u.Gc(112,"Producto - servicio"),u.Vb(),u.Wb(113,"div",51),u.Gc(114,"Detalle adicional"),u.Vb(),u.Wb(115,"div",52),u.Gc(116,"Cantidad"),u.Vb(),u.Wb(117,"div",52),u.Gc(118,"Tipo Igv"),u.Vb(),u.Wb(119,"div",52),u.Gc(120,"P. Unit."),u.Vb(),u.Wb(121,"div",52),u.Gc(122,"Sub total"),u.Vb(),u.Wb(123,"div",52),u.Gc(124,"Total"),u.Vb(),u.Wb(125,"div",53),u.Wb(126,"button",54),u.ec("click",(function(){return e.addItem()})),u.Rb(127,"mat-icon",8),u.Vb(),u.Vb(),u.Vb(),u.Ec(128,$n,31,11,"div",55),u.Ec(129,zn,3,1,"div",56),u.Vb(),u.Wb(130,"div",57),u.Wb(131,"div",58),u.Wb(132,"div",59),u.Wb(133,"button",7),u.ec("click",(function(){return e.newProducto()})),u.Gc(134,"Nuevo producto "),u.Vb(),u.Vb(),u.Wb(135,"div",60),u.Wb(136,"mat-form-field",61),u.Wb(137,"mat-label"),u.Gc(138,"Condiciones de pago"),u.Vb(),u.Rb(139,"input",62),u.Vb(),u.Wb(140,"mat-form-field",61),u.Wb(141,"mat-label"),u.Gc(142,"Observaciones"),u.Vb(),u.Rb(143,"input",63),u.Vb(),u.Vb(),u.Vb(),u.Wb(144,"div",64),u.Wb(145,"div"),u.Wb(146,"div",65),u.Wb(147,"div",66),u.Gc(148," Descuento global "),u.Wb(149,"strong"),u.Gc(150,"%"),u.Vb(),u.Vb(),u.Wb(151,"div",67),u.Rb(152,"input",68),u.Vb(),u.Vb(),u.Wb(153,"div",69),u.Wb(154,"div",66),u.Gc(155," Otros cargos S/ "),u.Vb(),u.Wb(156,"div",67),u.Rb(157,"input",70),u.Vb(),u.Vb(),u.Ec(158,Hn,6,4,"div",71),u.Ec(159,Xn,6,4,"div",71),u.Ec(160,Un,6,4,"div",71),u.Ec(161,Kn,6,4,"div",71),u.Wb(162,"div",65),u.Wb(163,"div",66),u.Gc(164," Gravada S/ "),u.Vb(),u.Wb(165,"div",67),u.Gc(166),u.jc(167,"number"),u.Vb(),u.Vb(),u.Wb(168,"div",65),u.Wb(169,"div",66),u.Gc(170," IGV S/ "),u.Vb(),u.Wb(171,"div",67),u.Gc(172),u.jc(173,"number"),u.Vb(),u.Vb(),u.Ec(174,Jn,6,4,"div",71),u.Wb(175,"div",65),u.Wb(176,"div",72),u.Wb(177,"strong"),u.Gc(178,"Total S/"),u.Vb(),u.Vb(),u.Wb(179,"div",67),u.Wb(180,"strong"),u.Gc(181),u.jc(182,"number"),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Wb(183,"mat-card-actions",73),u.Wb(184,"button",74),u.Rb(185,"mat-icon",5),u.Gc(186," EMITIR "),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Wb(187,"div",12),u.Wb(188,"mat-card",47),u.Wb(189,"mat-card-content"),u.Wb(190,"pre"),u.Gc(191),u.jc(192,"json"),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Vb()),2&t){const t=u.uc(43),o=u.uc(51),a=u.uc(77);u.oc("formGroup",e.ventaForm),u.Cb(4),u.oc("routerLink","/ventas"),u.Cb(1),u.oc("icIcon",e.icArrowBack),u.Cb(1),u.oc("ngIf",!e.comprobante.value),u.Cb(1),u.oc("ngIf",e.comprobante.value),u.Cb(3),u.oc("icIcon",e.icSettings),u.Cb(4),u.oc("disabled",e.submitted),u.Cb(1),u.oc("icIcon",e.icSend),u.Cb(2),u.oc("disabled",e.submitted),u.Cb(1),u.oc("icIcon",e.icSave),u.Cb(9),u.oc("formControl",e.comprobante),u.Cb(1),u.oc("ngForOf",e.comprobantes),u.Cb(1),u.oc("ngIf",e.comprobante.hasError("required")),u.Cb(5),u.oc("ngForOf",e.monedas),u.Cb(1),u.oc("ngIf",e.ventaForm.get("moneda").hasError("required")),u.Cb(5),u.oc("matDatepicker",t),u.Cb(1),u.oc("for",t),u.Cb(3),u.oc("ngIf",e.ventaForm.get("fechaemision").hasError("required")),u.Cb(4),u.oc("matDatepicker",o),u.Cb(1),u.oc("for",o),u.Cb(7),u.oc("ngForOf",e.operaciones),u.Cb(1),u.oc("ngIf",e.ventaForm.get("operacion").hasError("required")),u.Cb(10),u.oc("ngIf",e.comprobante.value&&(13===e.comprobante.value.iddocumentofiscal||10===e.comprobante.value.iddocumentofiscal)),u.Cb(8),u.oc("matAutocomplete",a)("formControl",e.cliente),u.Cb(1),u.oc("displayWith",e.displaySearchEntidad),u.Cb(2),u.oc("ngIf",e.isLoadingSearch),u.Cb(1),u.oc("ngIf",!e.isLoadingSearch),u.Cb(1),u.oc("ngIf",!e.cliente.value),u.Cb(1),u.oc("ngIf",e.cliente.value),u.Cb(1),u.oc("ngIf",e.cliente.hasError("required")),u.Cb(3),u.oc("icIcon",e.icAdd),u.Cb(2),u.oc("ngSwitch",e.ventaForm.get("clientedoc").value),u.Cb(1),u.oc("ngSwitchCase",1),u.Cb(1),u.oc("ngSwitchCase",2),u.Cb(1),u.oc("ngSwitchCase",3),u.Cb(1),u.oc("ngSwitchCase",4),u.Cb(1),u.oc("ngSwitchCase",5),u.Cb(3),u.oc("ngIf",!e.ventaForm.get("clientenumerodoc").value),u.Cb(1),u.oc("ngIf",e.ventaForm.get("clientenumerodoc").value),u.Cb(31),u.oc("icIcon",e.icAdd),u.Cb(1),u.oc("ngForOf",e.ventadet.controls),u.Cb(1),u.oc("ngIf",e.ventaForm.get("ventadet").hasError("required")),u.Cb(29),u.oc("ngIf",e.ventaForm.get("descuentototal").value>0),u.Cb(1),u.oc("ngIf",e.leyenda.exonerada),u.Cb(1),u.oc("ngIf",e.leyenda.inafecta),u.Cb(1),u.oc("ngIf",e.leyenda.gratuita),u.Cb(5),u.Ic(" ",u.lc(167,54,e.ventaForm.get("gravada").value,"1.2-2")," "),u.Cb(6),u.Ic(" ",u.lc(173,57,e.ventaForm.get("valorimpuesto").value,"1.2-2")," "),u.Cb(2),u.oc("ngIf",e.leyenda.icpber),u.Cb(7),u.Hc(u.lc(182,60,e.ventaForm.get("total").value,"1.2-2")),u.Cb(3),u.oc("disabled",e.submitted),u.Cb(1),u.oc("icIcon",e.icSend),u.Cb(6),u.Ic("            ",u.kc(192,63,e.ventaForm.value)," \n          ")}},directives:[i.w,i.q,i.i,Z.a,Z.c,F.b,F.c,y.b,I.a,a.g,E.a,G.a,W.p,Oe.b,F.d,Ka.a,F.a,Ka.c,oe.d,oe.h,Ge.a,i.p,i.f,W.o,i.g,ae.b,i.b,je.b,je.d,oe.j,je.a,qe.c,qe.a,W.r,W.s,W.t,i.d,i.s,Ka.b,Re.n,oe.c,Be.b,i.j,oa.a],pipes:[W.f,W.h],styles:["#ventas-emitir .content{padding:24px}#ventas-emitir .content fieldset{border:1px solid #ccc;border-radius:8px;padding:8px}#ventas-emitir .content fieldset legend{padding:0 8px}#ventas-emitir .mat-select-panel mat-option.mat-option{height:unset;border:1px solid red}#ventas-emitir .mat-option-text.mat-option-text{white-space:normal;border:1px solid red}.mat-autocomplete-panel .mat-option{line-height:18px;padding:6px 8px}"],encapsulation:2}),t})();const Zn=[{path:"",component:Yo},{path:"nuevo",component:qi},{path:"nuevo/:comprobante",component:qi},{path:"emitir",component:Yn},{path:"emitir/:comprobante",component:Yn}];let tc=(()=>{class t{}return t.\u0275mod=u.Ob({type:t}),t.\u0275inj=u.Nb({factory:function(e){return new(e||t)},imports:[[a.j.forChild(Zn),ji.a,Mi.a,Qi.a,Bi.a,$i.a,zi.a]]}),t})()},rwX0:function(t,e){e.__esModule=!0,e.default={body:'<circle cx="9" cy="8.5" opacity=".3" r="1.5" fill="currentColor"/><path opacity=".3" d="M4.34 17h9.32c-.84-.58-2.87-1.25-4.66-1.25s-3.82.67-4.66 1.25z" fill="currentColor"/><path d="M9 12c1.93 0 3.5-1.57 3.5-3.5S10.93 5 9 5S5.5 6.57 5.5 8.5S7.07 12 9 12zm0-5c.83 0 1.5.67 1.5 1.5S9.83 10 9 10s-1.5-.67-1.5-1.5S8.17 7 9 7zm0 6.75c-2.34 0-7 1.17-7 3.5V19h14v-1.75c0-2.33-4.66-3.5-7-3.5zM4.34 17c.84-.58 2.87-1.25 4.66-1.25s3.82.67 4.66 1.25H4.34zm11.7-3.19c1.16.84 1.96 1.96 1.96 3.44V19h4v-1.75c0-2.02-3.5-3.17-5.96-3.44zM15 12c1.93 0 3.5-1.57 3.5-3.5S16.93 5 15 5c-.54 0-1.04.13-1.5.35c.63.89 1 1.98 1 3.15s-.37 2.26-1 3.15c.46.22.96.35 1.5.35z" fill="currentColor"/>',width:24,height:24}}}]);