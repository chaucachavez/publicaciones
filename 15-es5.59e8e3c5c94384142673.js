function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var o=[],a=!0,n=!1,i=void 0;try{for(var c,r=t[Symbol.iterator]();!(a=(c=r.next()).done)&&(o.push(c.value),!e||o.length!==e);a=!0);}catch(l){n=!0,i=l}finally{try{a||null==r.return||r.return()}finally{if(n)throw i}}return o}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _createForOfIteratorHelper(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=_unsupportedIterableToArray(t))){var e=0,o=function(){};return{s:o,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,n,i=!0,c=!1;return{s:function(){a=t[Symbol.iterator]()},n:function(){var t=a.next();return i=t.done,t},e:function(t){c=!0,n=t},f:function(){try{i||null==a.return||a.return()}finally{if(c)throw n}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(o):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,a=new Array(e);o<e;o++)a[o]=t[o];return a}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var o=0;o<e.length;o++){var a=e[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function _createClass(t,e,o){return e&&_defineProperties(t.prototype,e),o&&_defineProperties(t,o),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{"+4LO":function(t,e){e.__esModule=!0,e.default={body:'<path d="M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z" fill="currentColor"/>',width:24,height:24}},Ldl7:function(t,e){e.__esModule=!0,e.default={body:'<path opacity=".3" d="M5 10h6v8H5z" fill="currentColor"/><path d="M15 16h4v2h-4zm0-8h7v2h-7zm0 4h6v2h-6zM3 18c0 1.1.9 2 2 2h6c1.1 0 2-.9 2-2V8H3v10zm2-8h6v8H5v-8zm5-6H6L5 5H2v2h12V5h-3z" fill="currentColor"/>',width:24,height:24}},QcxM:function(t,e){e.__esModule=!0,e.default={body:'<path opacity=".3" d="M5 5v14h14V7.83L16.17 5H5zm7 13c-1.66 0-3-1.34-3-3s1.34-3 3-3s3 1.34 3 3s-1.34 3-3 3zm3-8H6V6h9v4z" fill="currentColor"/><path d="M17 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm2 16H5V5h11.17L19 7.83V19zm-7-7c-1.66 0-3 1.34-3 3s1.34 3 3 3s3-1.34 3-3s-1.34-3-3-3zM6 6h9v4H6z" fill="currentColor"/>',width:24,height:24}},T7YG:function(t,e){e.__esModule=!0,e.default={body:'<path d="M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8l8-8z" fill="currentColor"/>',width:24,height:24}},kkQI:function(t,e){e.__esModule=!0,e.default={body:'<path d="M12 6v3l4-4l-4-4v3c-4.42 0-8 3.58-8 8c0 1.57.46 3.03 1.24 4.26L6.7 14.8A5.87 5.87 0 0 1 6 12c0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8c0 3.31-2.69 6-6 6v-3l-4 4l4 4v-3c4.42 0 8-3.58 8-8c0-1.57-.46-3.03-1.24-4.26z" fill="currentColor"/>',width:24,height:24}},m2C8:function(t,e){e.__esModule=!0,e.default={body:'<path opacity=".3" d="M4 8.25l7.51 1l-7.5-3.22zm.01 9.72l7.5-3.22l-7.51 1z" fill="currentColor"/><path d="M2.01 3L2 10l15 2l-15 2l.01 7L23 12L2.01 3zM4 8.25V6.03l7.51 3.22l-7.51-1zm.01 9.72v-2.22l7.51-1l-7.51 3.22z" fill="currentColor"/>',width:24,height:24}},p2va:function(t,e,o){"use strict";o.r(e),o.d(e,"VentasModule",(function(){return hc}));var a,n,i=o("tyNb"),c=o("3Pt+"),r=o("Kj3r"),l=o("vkgz"),u=o("eIep"),s=o("nYR2"),d=o("Iab2"),b=o("0IaG"),m=o("fXoL"),p=o("TgOq"),f=((a=function(){function t(e,o,a,n){_classCallCheck(this,t),this.data=e,this.matDialogRef=o,this._matDialog=a,this._ventaService=n}return _createClass(t,[{key:"ngOnInit",value:function(){this.loading=!1,this.url="http://apiifact.pe/temporal/20431738806-03-B004-1270.pdf"}}]),t}()).\u0275fac=function(t){return new(t||a)(m.Qb(b.a),m.Qb(b.g),m.Qb(b.b),m.Qb(p.a))},a.\u0275cmp=m.Kb({type:a,selectors:[["vex-ventas-descarga"]],decls:1,vars:0,template:function(t,e){1&t&&m.Gc(0,"hola mundo")},styles:[".venta-descarga-dialog .mat-dialog-container{padding:0}.venta-descarga-dialog .dialog-content-wrapper{max-height:85vh;display:flex;flex-direction:column}"],encapsulation:2}),a),v=o("pI64"),g=o.n(v),h=o("yHIK"),V=o.n(h),C=o("5mnX"),x=o.n(C),W=o("MzEE"),y=o.n(W),w=o("ofXK"),F=o("6JgD"),I=o("XiUz"),E=o("bTqV"),G=o("Qu3c"),k=o("NFeN"),R=o("VX/1"),S=o("f0Cb"),_=o("jhN1"),L=((n=function(){function t(e){_classCallCheck(this,t),this.domSanitizer=e}return _createClass(t,[{key:"transform",value:function(t,e){return this.domSanitizer.bypassSecurityTrustResourceUrl(e+t)}}]),t}()).\u0275fac=function(t){return new(t||n)(m.Qb(_.b))},n.\u0275pipe=m.Pb({name:"domseguro",type:n,pure:!0}),n);function D(t,e){1&t&&m.Rb(0,"vex-loading")}function A(t,e){if(1&t){var o=m.Xb();m.Wb(0,"div"),m.Wb(1,"div",1),m.Wb(2,"h2",2),m.Gc(3),m.Vb(),m.Wb(4,"a",3),m.Rb(5,"mat-icon",4),m.Vb(),m.Wb(6,"button",5),m.ec("click",(function(){m.wc(o);var t=m.ic();return t.downloadPdf(t.venta.pdf)})),m.Rb(7,"mat-icon",4),m.Vb(),m.Wb(8,"button",6),m.ec("click",(function(){m.wc(o);var t=m.ic();return t.printPdf(t.venta.pdf)})),m.Rb(9,"mat-icon",4),m.Vb(),m.Wb(10,"button",7),m.Rb(11,"mat-icon",4),m.Vb(),m.Vb(),m.Rb(12,"mat-divider",8),m.Wb(13,"mat-dialog-content",9),m.Wb(14,"object",10),m.jc(15,"domseguro"),m.Gc(16,"Comunicarse con proveedor de servicios electr\xf3nicos"),m.Vb(),m.Vb(),m.Wb(17,"mat-dialog-actions",11),m.Wb(18,"button",12),m.Gc(19,"CERRAR"),m.Vb(),m.Vb(),m.Vb()}if(2&t){var a=m.ic();m.Cb(3),m.Kc("",a.venta.docnegocio.nombre," ",a.venta.serie," - ",a.venta.numero,""),m.Cb(1),m.oc("href",a.venta.pdf,m.zc),m.Cb(1),m.oc("icIcon",a.icCallMade),m.Cb(2),m.oc("icIcon",a.icCloudDownload),m.Cb(2),m.oc("icIcon",a.icPrint),m.Cb(2),m.oc("icIcon",a.icClose),m.Cb(3),m.oc("data",m.lc(15,9,a.venta.pdf,""),m.yc)}}var N,T=((N=function(){function t(e,o,a){_classCallCheck(this,t),this.data=e,this.matDialogRef=o,this._ventaService=a,this.icCallMade=g.a,this.icPrint=V.a,this.icClose=x.a,this.icCloudDownload=y.a,this.show()}return _createClass(t,[{key:"ngOnInit",value:function(){}},{key:"show",value:function(){this.venta=this.data.venta}},{key:"downloadPdf",value:function(t){var e=this.urlPdf(t);this._ventaService.downloadProxy(e).subscribe((function(e){var o=t.split("/").reverse()[0];Object(d.saveAs)(e,o)}),(function(t){}))}},{key:"printPdf",value:function(t){var e=this.urlPdf(t);this._ventaService.downloadProxy(e).subscribe((function(t){var e=new Blob([t],{type:"application/pdf"}),o=URL.createObjectURL(e),a=document.createElement("iframe");a.style.display="none",a.src=o,document.body.appendChild(a),a.contentWindow.print()}),(function(t){}))}},{key:"urlPdf",value:function(t){var e="",o=t.split("/").reverse()[0],a=t.split("/").reverse()[1];return-1===t.indexOf("www.pse.pe")&&(e="/apiifact/public/"+a+"/"+o),-1!==t.indexOf("www.pse.pe")&&(e="/"+a+"/"+o),e}}]),t}()).\u0275fac=function(t){return new(t||N)(m.Qb(b.a),m.Qb(b.g),m.Qb(p.a))},N.\u0275cmp=m.Kb({type:N,selectors:[["vex-ventas-pdf"]],decls:2,vars:2,consts:[[4,"ngIf"],["fxLayout","row","fxLayoutAlign","start center","mat-dialog-title",""],["fxFlex","auto",1,"headline","m-0"],["mat-icon-button","","target","_blank","matTooltip","Nueva pesta\xf1a",1,"text-secondary",3,"href"],[3,"icIcon"],["mat-icon-button","","type","button","matTooltip","Descargar",1,"text-secondary",3,"click"],["mat-icon-button","","type","button","matTooltip","Imprimir",1,"text-secondary",3,"click"],["mat-icon-button","","type","button","mat-dialog-close","","matTooltip","Cerrar",1,"text-secondary"],[1,"-mx-6","text-border"],["fxLayout","column"],["name","DocumentoPresupuesto","type","application/pdf","height","800",3,"data"],["align","end"],["mat-button","","mat-dialog-close","","type","button"]],template:function(t,e){1&t&&(m.Ec(0,D,1,0,"vex-loading",0),m.Ec(1,A,20,12,"div",0)),2&t&&(m.oc("ngIf",e.loading),m.Cb(1),m.oc("ngIf",!e.loading))},directives:[w.p,F.a,I.c,I.b,b.h,I.a,E.a,G.a,k.a,R.a,E.b,b.d,S.a,b.e,b.c],pipes:[L],styles:["@media (min-width:960px){.venta-pdf-dialog{width:960px}}"],encapsulation:2}),N),O=o("pN9m"),P=o.n(O),j=o("a84l"),q=o.n(j),M=o("6qw8"),Q=o.n(M),B=o("+Chm"),z=o.n(B),H=o("WT4w"),X=o.n(H),$=o("kkQI"),U=o.n($),K=o("+tDV"),J=o.n(K),Y=o("YMqD"),Z=o("dNgK"),tt=o("yCEk"),et=o("STbY"),ot=o("/t3+"),at=o("wZkO"),nt=["tabGroup"];function it(t,e){1&t&&m.Rb(0,"vex-loading")}function ct(t,e){1&t&&m.Rb(0,"vex-loading")}function rt(t,e){if(1&t&&(m.Wb(0,"span"),m.Gc(1),m.Vb()),2&t){var o=m.ic(2);m.Cb(1),m.Jc(" Factura Electr\xf3nica ",o.venta.serie," - ",o.venta.numero," ")}}function lt(t,e){if(1&t&&(m.Wb(0,"span"),m.Gc(1),m.Vb()),2&t){var o=m.ic(2);m.Cb(1),m.Jc(" Boleta de Venta Electr\xf3nica ",o.venta.serie," - ",o.venta.numero," ")}}function ut(t,e){if(1&t&&(m.Wb(0,"span"),m.Gc(1),m.Vb()),2&t){var o=m.ic(2);m.Cb(1),m.Jc(" Nota de D\xe9bito Electr\xf3nica ",o.venta.serie," - ",o.venta.numero," ")}}function st(t,e){if(1&t&&(m.Wb(0,"span"),m.Gc(1),m.Vb()),2&t){var o=m.ic(2);m.Cb(1),m.Jc(" Nota de Cr\xe9dito Electr\xf3nica ",o.venta.serie," - ",o.venta.numero," ")}}function dt(t,e){if(1&t){var o=m.Xb();m.Wb(0,"button",27),m.ec("click",(function(){m.wc(o);var t=m.ic(2);return t.estadoAnulacion(t.venta.idventa)})),m.Rb(1,"mat-icon",12),m.Vb()}if(2&t){var a=m.ic(2);m.Cb(1),m.oc("icIcon",a.icAutorenew)}}function bt(t,e){if(1&t){var o=m.Xb();m.Wb(0,"button",28),m.ec("click",(function(){return m.wc(o),m.ic(2).matDialogRef.close("regenerar")})),m.Rb(1,"mat-icon",12),m.Vb()}if(2&t){var a=m.ic(2);m.Cb(1),m.oc("icIcon",a.icAutorenew)}}function mt(t,e){if(1&t&&(m.Wb(0,"a",29),m.Rb(1,"mat-icon",12),m.Vb()),2&t){var o=m.ic(2);m.oc("href",o.venta.pdf,m.zc),m.Cb(1),m.oc("icIcon",o.icCallMade)}}function pt(t,e){if(1&t){var o=m.Xb();m.Wb(0,"button",30),m.ec("click",(function(){return m.wc(o),m.ic(2).matDialogRef.close("correo")})),m.Rb(1,"mat-icon",12),m.Vb()}if(2&t){var a=m.ic(2);m.Cb(1),m.oc("icIcon",a.icMail)}}function ft(t,e){if(1&t){var o=m.Xb();m.Wb(0,"button",31),m.ec("click",(function(){return m.wc(o),m.ic(2).matDialogRef.close("edit")})),m.Rb(1,"mat-icon",12),m.Vb()}if(2&t){var a=m.ic(2);m.Cb(1),m.oc("icIcon",a.icEdit)}}function vt(t,e){if(1&t){var o=m.Xb();m.Wb(0,"button",52),m.ec("click",(function(){m.wc(o);var t=m.ic(3);return t.downloadFile(t.venta.pdf)})),m.Rb(1,"ic-icon",53),m.Wb(2,"span"),m.Gc(3,"Descargar PDF"),m.Vb(),m.Vb()}if(2&t){var a=m.ic(3);m.Cb(1),m.oc("icon",a.icCloudDownload)}}function gt(t,e){if(1&t){var o=m.Xb();m.Wb(0,"button",54),m.ec("click",(function(){m.wc(o);var t=m.ic(3);return t.downloadFile(t.venta.xml)})),m.Rb(1,"ic-icon",53),m.Wb(2,"span"),m.Gc(3,"Descargar XML"),m.Vb(),m.Vb()}if(2&t){var a=m.ic(3);m.Cb(1),m.oc("icon",a.icCloudDownload)}}function ht(t,e){if(1&t){var o=m.Xb();m.Wb(0,"button",54),m.ec("click",(function(){m.wc(o);var t=m.ic(3);return t.downloadFile(t.venta.cdr)})),m.Rb(1,"ic-icon",53),m.Wb(2,"span"),m.Gc(3,"Descargar CDR"),m.Vb(),m.Vb()}if(2&t){var a=m.ic(3);m.Cb(1),m.oc("icon",a.icCloudDownload)}}function Vt(t,e){1&t&&(m.Wb(0,"legend"),m.Gc(1," Factura Electr\xf3nica "),m.Vb())}function Ct(t,e){1&t&&(m.Wb(0,"legend"),m.Gc(1," Boleta de Venta Electr\xf3nica "),m.Vb())}function xt(t,e){1&t&&(m.Wb(0,"legend"),m.Gc(1," Nota de D\xe9bito Electr\xf3nica "),m.Vb())}function Wt(t,e){1&t&&(m.Wb(0,"legend"),m.Gc(1," Nota de Cr\xe9dito Electr\xf3nica "),m.Vb())}function yt(t,e){1&t&&(m.Wb(0,"span"),m.Gc(1,"Borrador"),m.Vb())}function wt(t,e){1&t&&(m.Wb(0,"span"),m.Gc(1,"Emitido"),m.Vb())}function Ft(t,e){1&t&&(m.Wb(0,"span"),m.Gc(1,"Anulado"),m.Vb())}function It(t,e){1&t&&(m.Wb(0,"span"),m.Gc(1," S/ "),m.Vb())}function Et(t,e){1&t&&(m.Wb(0,"span"),m.Gc(1," $ "),m.Vb())}function Gt(t,e){1&t&&(m.Wb(0,"span"),m.Gc(1," \u20ac "),m.Vb())}function kt(t,e){if(1&t&&(m.Wb(0,"span"),m.Rb(1,"mat-icon",55),m.Vb()),2&t){var o=m.ic(3);m.Cb(1),m.oc("icIcon",o.icCheck)}}function Rt(t,e){if(1&t){var o=m.Xb();m.Wb(0,"span"),m.Wb(1,"mat-icon",56),m.ec("click",(function(){m.wc(o);var t=m.ic(3);return t.estadoComprobante(t.venta.idventa)})),m.Vb(),m.Vb()}if(2&t){var a=m.ic(3);m.Cb(1),m.oc("icIcon",a.icAutorenew)}}function St(t,e){if(1&t){var o=m.Xb();m.Wb(0,"span"),m.Wb(1,"mat-icon",56),m.ec("click",(function(){m.wc(o);var t=m.ic(3);return t.estadoComprobante(t.venta.idventa)})),m.Vb(),m.Vb()}if(2&t){var a=m.ic(3);m.Cb(1),m.oc("icIcon",a.icAutorenew)}}function _t(t,e){if(1&t&&(m.Wb(0,"div",39),m.Gc(1),m.Vb()),2&t){var o=m.ic(3);m.Cb(1),m.Ic("Anulaci\xf3n (",o.venta.sunat_anulado_aceptado,")")}}function Lt(t,e){if(1&t&&(m.Wb(0,"span"),m.Rb(1,"mat-icon",55),m.Vb()),2&t){var o=m.ic(4);m.Cb(1),m.oc("icIcon",o.icCheck)}}function Dt(t,e){if(1&t){var o=m.Xb();m.Wb(0,"span"),m.Wb(1,"mat-icon",56),m.ec("click",(function(){m.wc(o);var t=m.ic(4);return t.estadoAnulacion(t.venta.idventa)})),m.Vb(),m.Vb()}if(2&t){var a=m.ic(4);m.Cb(1),m.oc("icIcon",a.icAutorenew)}}function At(t,e){if(1&t&&(m.Wb(0,"div",41),m.Ec(1,Lt,2,1,"span",8),m.Ec(2,Dt,2,1,"span",8),m.Vb()),2&t){var o=m.ic(3);m.oc("ngSwitch",o.venta.sunat_anulado_aceptado),m.Cb(1),m.oc("ngSwitchCase",1),m.Cb(1),m.oc("ngSwitchCase",0)}}function Nt(t,e){1&t&&(m.Wb(0,"span"),m.Gc(1,"DNI"),m.Vb())}function Tt(t,e){1&t&&(m.Wb(0,"span"),m.Gc(1,"RUC"),m.Vb())}function Ot(t,e){1&t&&(m.Wb(0,"span"),m.Gc(1,"C.EXT."),m.Vb())}function Pt(t,e){1&t&&(m.Wb(0,"span"),m.Gc(1,"PASAP."),m.Vb())}function jt(t,e){1&t&&(m.Wb(0,"span"),m.Gc(1,"SIN DOC."),m.Vb())}function qt(t,e){1&t&&(m.Wb(0,"small"),m.Gc(1,"(Enviado)"),m.Vb())}function Mt(t,e){1&t&&(m.Wb(0,"small"),m.Gc(1,"(Pendiente)"),m.Vb())}function Qt(t,e){if(1&t&&(m.Wb(0,"div",32),m.Wb(1,"div",49),m.Gc(2,"Modificado por"),m.Vb(),m.Wb(3,"div",57),m.Gc(4),m.Vb(),m.Wb(5,"div",49),m.Gc(6,"Fecha y hora"),m.Vb(),m.Wb(7,"div",50),m.Gc(8),m.Vb(),m.Vb()),2&t){var o=m.ic(3);m.Cb(4),m.Hc(null==o.venta.modificacion?null:o.venta.modificacion.name),m.Cb(4),m.Hc(o.venta.updated_at)}}function Bt(t,e){if(1&t&&(m.Wb(0,"div"),m.Wb(1,"fieldset"),m.Wb(2,"legend"),m.Gc(3,"Archivos electr\xf3nicos"),m.Vb(),m.Wb(4,"div",32),m.Wb(5,"div",33),m.Wb(6,"div",34),m.Ec(7,vt,4,1,"button",35),m.Ec(8,gt,4,1,"button",36),m.Ec(9,ht,4,1,"button",36),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Wb(10,"div",37),m.Wb(11,"fieldset",38),m.Ec(12,Vt,2,0,"legend",8),m.Ec(13,Ct,2,0,"legend",8),m.Ec(14,xt,2,0,"legend",8),m.Ec(15,Wt,2,0,"legend",8),m.Wb(16,"div",32),m.Wb(17,"div",39),m.Gc(18,"N\xfamero"),m.Vb(),m.Wb(19,"div",40),m.Gc(20),m.Vb(),m.Wb(21,"div",39),m.Gc(22,"Moneda"),m.Vb(),m.Wb(23,"div",40),m.Gc(24),m.Vb(),m.Vb(),m.Wb(25,"div",32),m.Wb(26,"div",39),m.Gc(27,"F.Emisi\xf3n"),m.Vb(),m.Wb(28,"div",40),m.Gc(29),m.jc(30,"date"),m.Vb(),m.Wb(31,"div",39),m.Gc(32,"F.Venci."),m.Vb(),m.Wb(33,"div",40),m.Gc(34),m.jc(35,"date"),m.Vb(),m.Vb(),m.Wb(36,"div",32),m.Wb(37,"div",39),m.Gc(38,"Estado"),m.Vb(),m.Wb(39,"div",41),m.Ec(40,yt,2,0,"span",8),m.Ec(41,wt,2,0,"span",8),m.Ec(42,Ft,2,0,"span",8),m.Vb(),m.Wb(43,"div",39),m.Gc(44,"Total"),m.Vb(),m.Wb(45,"div",41),m.Ec(46,It,2,0,"span",8),m.Ec(47,Et,2,0,"span",8),m.Ec(48,Gt,2,0,"span",8),m.Gc(49),m.Vb(),m.Vb(),m.Wb(50,"div",32),m.Wb(51,"div",39),m.Gc(52),m.Vb(),m.Wb(53,"div",41),m.Ec(54,kt,2,1,"span",8),m.Ec(55,Rt,2,1,"span",8),m.Ec(56,St,2,1,"span",42),m.Vb(),m.Ec(57,_t,2,1,"div",43),m.Ec(58,At,3,3,"div",44),m.Vb(),m.Vb(),m.Wb(59,"fieldset",45),m.Wb(60,"legend"),m.Gc(61,"Cliente"),m.Vb(),m.Wb(62,"div",32),m.Wb(63,"div",39),m.Gc(64,"Se\xf1or(es)"),m.Vb(),m.Wb(65,"div",46),m.Gc(66),m.Vb(),m.Vb(),m.Wb(67,"div",32),m.Wb(68,"div",47),m.Ec(69,Nt,2,0,"span",8),m.Ec(70,Tt,2,0,"span",8),m.Ec(71,Ot,2,0,"span",8),m.Ec(72,Pt,2,0,"span",8),m.Ec(73,jt,2,0,"span",8),m.Vb(),m.Wb(74,"div",46),m.Gc(75),m.Vb(),m.Vb(),m.Wb(76,"div",32),m.Wb(77,"div",39),m.Gc(78,"Direcci\xf3n"),m.Vb(),m.Wb(79,"div",46),m.Gc(80),m.Vb(),m.Vb(),m.Wb(81,"div",32),m.Wb(82,"div",39),m.Gc(83,"Correo"),m.Vb(),m.Wb(84,"div",46),m.Gc(85),m.Ec(86,qt,2,0,"small",0),m.Ec(87,Mt,2,0,"small",0),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Wb(88,"fieldset",48),m.Wb(89,"legend"),m.Gc(90,"Registro"),m.Vb(),m.Wb(91,"div",32),m.Wb(92,"div",49),m.Gc(93,"Creado por"),m.Vb(),m.Wb(94,"div",50),m.Gc(95),m.Vb(),m.Wb(96,"div",49),m.Gc(97,"Fecha y hora"),m.Vb(),m.Wb(98,"div",50),m.Gc(99),m.Vb(),m.Vb(),m.Ec(100,Qt,9,2,"div",51),m.Vb(),m.Vb()),2&t){var o=m.ic(2);m.Cb(7),m.oc("ngIf",o.venta.pdf),m.Cb(1),m.oc("ngIf",o.venta.xml),m.Cb(1),m.oc("ngIf",o.venta.cdr),m.Cb(2),m.oc("ngSwitch",o.venta.iddocumentofiscal),m.Cb(1),m.oc("ngSwitchCase",1),m.Cb(1),m.oc("ngSwitchCase",2),m.Cb(1),m.oc("ngSwitchCase",10),m.Cb(1),m.oc("ngSwitchCase",13),m.Cb(5),m.Jc("",o.venta.serie," - ",o.venta.numero,""),m.Cb(4),m.Hc(o.venta.moneda),m.Cb(5),m.Hc(m.lc(30,43,o.venta.fechaemision,"dd/MM/yyyy")),m.Cb(5),m.Hc(m.lc(35,46,o.venta.fechavencimiento,"dd/MM/yyyy")),m.Cb(5),m.oc("ngSwitch",o.venta.idestadodocumento),m.Cb(1),m.oc("ngSwitchCase",26),m.Cb(1),m.oc("ngSwitchCase",27),m.Cb(1),m.oc("ngSwitchCase",28),m.Cb(3),m.oc("ngSwitch",o.venta.moneda),m.Cb(1),m.oc("ngSwitchCase","PEN"),m.Cb(1),m.oc("ngSwitchCase","USD"),m.Cb(1),m.oc("ngSwitchCase","EUR"),m.Cb(1),m.Ic(" ",o.venta.total," "),m.Cb(3),m.Ic("Emisi\xf3n (",o.venta.sunat_aceptado,")"),m.Cb(1),m.oc("ngSwitch",o.venta.sunat_aceptado),m.Cb(1),m.oc("ngSwitchCase",1),m.Cb(1),m.oc("ngSwitchCase",0),m.Cb(2),m.oc("ngIf",o.venta.sunat_anulado_aceptado),m.Cb(1),m.oc("ngIf",o.venta.sunat_anulado_aceptado),m.Cb(8),m.Hc(o.venta.clientenombre),m.Cb(2),m.oc("ngSwitch",o.venta.clientedoc),m.Cb(1),m.oc("ngSwitchCase",1),m.Cb(1),m.oc("ngSwitchCase",2),m.Cb(1),m.oc("ngSwitchCase",3),m.Cb(1),m.oc("ngSwitchCase",4),m.Cb(1),m.oc("ngSwitchCase",5),m.Cb(2),m.Hc(o.venta.clientenumerodoc),m.Cb(5),m.Hc(o.venta.clientedireccion),m.Cb(5),m.Ic("",o.venta.cpecorreo," "),m.Cb(1),m.oc("ngIf","1"===o.venta.sendcorreo),m.Cb(1),m.oc("ngIf",!o.venta.sendcorreo),m.Cb(8),m.Hc(null==o.venta.creacion?null:o.venta.creacion.name),m.Cb(4),m.Hc(o.venta.created_at),m.Cb(1),m.oc("ngIf",o.venta.modificacion)}}function zt(t,e){1&t&&(m.Wb(0,"div"),m.Gc(1," PDF no existe, porfavor comunicarse con soporte. "),m.Vb())}function Ht(t,e){if(1&t&&(m.Wb(0,"object",59),m.jc(1,"domseguro"),m.Gc(2,"Comunicarse con proveedor de servicios electr\xf3nicos"),m.Vb()),2&t){var o=m.ic(3);m.oc("data",m.lc(1,1,o.venta.pdf,""),m.yc)}}function Xt(t,e){if(1&t&&(m.Wb(0,"div",23),m.Ec(1,zt,2,0,"div",0),m.Ec(2,Ht,3,4,"object",58),m.Vb()),2&t){var o=m.ic(2);m.Cb(1),m.oc("ngIf",!o.venta.pdf),m.Cb(1),m.oc("ngIf",o.venta.pdf)}}function $t(t,e){if(1&t){var o=m.Xb();m.Wb(0,"div"),m.Wb(1,"div",5),m.Wb(2,"mat-toolbar",6),m.Wb(3,"h2",7),m.Ec(4,rt,2,2,"span",8),m.Ec(5,lt,2,2,"span",8),m.Ec(6,ut,2,2,"span",8),m.Ec(7,st,2,2,"span",8),m.Vb(),m.Rb(8,"mat-divider"),m.Ec(9,dt,2,1,"button",9),m.Ec(10,bt,2,1,"button",10),m.Wb(11,"button",11),m.ec("click",(function(){m.wc(o);var t=m.ic();return t.printPdf(t.venta.pdf)})),m.Rb(12,"mat-icon",12),m.Vb(),m.Ec(13,mt,2,2,"a",13),m.Wb(14,"button",14),m.ec("click",(function(){m.wc(o);var t=m.ic();return t.downloadFile(t.venta.pdf)})),m.Rb(15,"mat-icon",12),m.Vb(),m.Ec(16,pt,2,1,"button",15),m.Ec(17,ft,2,1,"button",16),m.Wb(18,"button",17),m.Rb(19,"mat-icon",12),m.Vb(),m.Wb(20,"button",18),m.Rb(21,"mat-icon",12),m.Vb(),m.Vb(),m.Wb(22,"mat-tab-group",19,20),m.ec("selectedTabChange",(function(t){return m.wc(o),m.ic().handleTabChange(t)})),m.Rb(24,"mat-tab",21),m.Rb(25,"mat-tab",22),m.Vb(),m.Vb(),m.Wb(26,"mat-dialog-content",23),m.Ec(27,Bt,101,49,"div",0),m.Ec(28,Xt,3,2,"div",24),m.Vb(),m.Wb(29,"mat-dialog-actions",25),m.Wb(30,"button",26),m.Gc(31," CERRAR "),m.Vb(),m.Vb(),m.Vb()}if(2&t){var a=m.ic(),n=m.uc(4);m.Cb(3),m.oc("ngSwitch",a.venta.iddocumentofiscal),m.Cb(1),m.oc("ngSwitchCase",1),m.Cb(1),m.oc("ngSwitchCase",2),m.Cb(1),m.oc("ngSwitchCase",10),m.Cb(1),m.oc("ngSwitchCase",13),m.Cb(2),m.oc("ngIf",a.botones.canu),m.Cb(1),m.oc("ngIf",a.botones.rpdf),m.Cb(2),m.oc("icIcon",a.icPrint),m.Cb(1),m.oc("ngIf",a.botones.nvent),m.Cb(2),m.oc("icIcon",a.icCloudDownload),m.Cb(1),m.oc("ngIf",a.botones.mail),m.Cb(1),m.oc("ngIf",a.botones.edit),m.Cb(1),m.oc("matMenuTriggerFor",n),m.Cb(1),m.oc("icIcon",a.icMoreVert),m.Cb(2),m.oc("icIcon",a.icClose),m.Cb(1),m.oc("selectedIndex",a.activeTabIndex)("color","accent")("backgroundColor","primary"),m.Cb(5),m.oc("ngIf",0===a.activeTabIndex),m.Cb(1),m.oc("ngIf",1===a.activeTabIndex)}}function Ut(t,e){if(1&t){var o=m.Xb();m.Wb(0,"button",60),m.ec("click",(function(){return m.wc(o),m.ic().matDialogRef.close("anular")})),m.Rb(1,"mat-icon",61),m.Gc(2," Anular "),m.Vb()}if(2&t){var a=m.ic();m.Cb(1),m.oc("icIcon",a.icBlock)}}function Kt(t,e){if(1&t){var o=m.Xb();m.Wb(0,"button",60),m.ec("click",(function(){return m.wc(o),m.ic().matDialogRef.close("regenerar")})),m.Rb(1,"mat-icon",12),m.Gc(2," Regenerar PDF "),m.Vb()}if(2&t){var a=m.ic();m.Cb(1),m.oc("icIcon",a.icAutorenew)}}function Jt(t,e){if(1&t){var o=m.Xb();m.Wb(0,"button",60),m.ec("click",(function(){return m.wc(o),m.ic().matDialogRef.close("Notadecredito")})),m.Rb(1,"mat-icon",12),m.Gc(2," Nota de cr\xe9dito "),m.Vb()}if(2&t){var a=m.ic();m.Cb(1),m.oc("icIcon",a.icInsertDriveFile)}}function Yt(t,e){if(1&t){var o=m.Xb();m.Wb(0,"button",60),m.ec("click",(function(){return m.wc(o),m.ic().matDialogRef.close("Notadedebito")})),m.Rb(1,"mat-icon",12),m.Gc(2," Nota de d\xe9bito "),m.Vb()}if(2&t){var a=m.ic();m.Cb(1),m.oc("icIcon",a.icInsertDriveFile)}}function Zt(t,e){if(1&t&&(m.Wb(0,"button",62),m.Rb(1,"mat-icon",12),m.Gc(2," Guia de remisi\xf3n "),m.Vb()),2&t){var o=m.ic();m.Cb(1),m.oc("icIcon",o.icInsertDriveFile)}}var te,ee=((te=function(){function t(e,o,a,n,i,c,r){_classCallCheck(this,t),this.data=e,this.matDialogRef=o,this._matDialog=a,this._ventaService=n,this._utils=i,this.snackBar=c,this._entidadService=r,this.activeTabIndex=void 0,this.icEdit=P.a,this.icBlock=q.a,this.icPrint=V.a,this.icClose=x.a,this.icCallMade=g.a,this.icCloudDownload=y.a,this.icMail=Q.a,this.icMoreVert=z.a,this.icInsertDriveFile=X.a,this.icAutorenew=U.a,this.icCheck=J.a,this.submitted=!1,this.show(),this.botones=e.botones,console.log(this.botones)}return _createClass(t,[{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){this.activeTabIndex="COMPROBANTE"===this.data.pestana?1:0}},{key:"handleTabChange",value:function(t){this.activeTabIndex=t.index}},{key:"show",value:function(){var t=this;this.loading=!0,this._ventaService.show(this.data.idventa,{conRecurso:"ventadet.producto,creacion,modificacion"}).subscribe((function(e){t.venta=e.data,console.log("this.venta",t.venta),t.loading=!1}),(function(e){t.loading=!1}))}},{key:"estadoAnulacion",value:function(t){var e=this;this.submitted=!0,this._ventaService.estadoAnulacion(t).subscribe((function(t){e.venta.sunat_anulado_aceptado="1",e.submitted=!1,e.snackBar.open(t.data,"Cerrar")}),(function(t){e.submitted=!1;var o=e._utils.convertError(t);e.snackBar.open(o,"Cerrar",{panelClass:["error-dialog"]})}))}},{key:"estadoComprobante",value:function(t){var e=this;this.submitted=!0,this._ventaService.estadoComprobante(t).subscribe((function(t){e.venta.sunat_aceptado="1",e.submitted=!1,e.snackBar.open(t.data,"Cerrar")}),(function(t){e.submitted=!1;var o=e._utils.convertError(t);e.snackBar.open(o,"Cerrar",{panelClass:["error-dialog"]})}))}},{key:"downloadFile",value:function(t){var e=this.urlPdf(t);this._ventaService.downloadProxy(e).subscribe((function(e){var o=t.split("/").reverse()[0];Object(d.saveAs)(e,o)}),(function(t){}))}},{key:"printPdf",value:function(t){var e=this.urlPdf(t);this._ventaService.downloadProxy(e).subscribe((function(t){var e=new Blob([t],{type:"application/pdf"}),o=URL.createObjectURL(e),a=document.createElement("iframe");a.style.display="none",a.src=o,document.body.appendChild(a),a.contentWindow.print()}),(function(t){}))}},{key:"urlPdf",value:function(t){console.log(t);var e=t.split("/").reverse()[0],o=t.split("/").reverse()[1];return"localhost"===location.hostname?"/empresa/"+this._entidadService.settings.idempresa+"/"+o+"/"+e:"/api/public/empresa/"+this._entidadService.settings.idempresa+"/"+o+"/"+e}}]),t}()).\u0275fac=function(t){return new(t||te)(m.Qb(b.a),m.Qb(b.g),m.Qb(b.b),m.Qb(p.a),m.Qb(Y.a),m.Qb(Z.b),m.Qb(tt.a))},te.\u0275cmp=m.Kb({type:te,selectors:[["vex-venta-show"]],viewQuery:function(t,e){var o;1&t&&m.Nc(nt,!0),2&t&&m.tc(o=m.fc())&&(e.tabGroup=o.first)},decls:10,vars:8,consts:[[4,"ngIf"],["xPosition","before","yPosition","below"],["settingsMenu","matMenu"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-menu-item","",4,"ngIf"],["mat-dialog-title","","fxLayout","column"],["color","primary","fxLayout","row","fxLayoutAlign","start center"],["fxFlex","auto",1,"headline","m-0",3,"ngSwitch"],[4,"ngSwitchCase"],["mat-icon-button","","type","button","class","text-secondary","matTooltip","Consultar anulaci\xf3n",3,"click",4,"ngIf"],["mat-icon-button","","type","button","class","text-secondary","matTooltip","Regenerar PDF",3,"click",4,"ngIf"],["mat-icon-button","","type","button","matTooltip","Imprimir",1,"text-secondary",3,"click"],[3,"icIcon"],["mat-icon-button","","target","_blank","class","text-secondary","matTooltip","Nueva pesta\xf1a",3,"href",4,"ngIf"],["mat-icon-button","","type","button","matTooltip","Descargar PDF",1,"text-secondary",3,"click"],["class","text-secondary","mat-icon-button","","type","button","matTooltip","Enviar correo",3,"click",4,"ngIf"],["class","text-secondary","type","button","mat-icon-button","","matTooltip","Editar",3,"click",4,"ngIf"],["mat-icon-button","","type","button","matTooltip","M\xe1s acciones",1,"text-secondary",3,"matMenuTriggerFor"],["mat-icon-button","","type","button","mat-dialog-close","","matTooltip","Cerrar",1,"text-secondary"],["fxFlex","auto",3,"selectedIndex","color","backgroundColor","selectedTabChange"],["tabGroup",""],["label","VENTA"],["label","COMPROBANTE",1,"p-0","m-0"],["fxLayout","column"],["fxLayout","column",4,"ngIf"],["align","end"],["mat-button","","mat-dialog-close","","aria-label","CERRAR"],["mat-icon-button","","type","button","matTooltip","Consultar anulaci\xf3n",1,"text-secondary",3,"click"],["mat-icon-button","","type","button","matTooltip","Regenerar PDF",1,"text-secondary",3,"click"],["mat-icon-button","","target","_blank","matTooltip","Nueva pesta\xf1a",1,"text-secondary",3,"href"],["mat-icon-button","","type","button","matTooltip","Enviar correo",1,"text-secondary",3,"click"],["type","button","mat-icon-button","","matTooltip","Editar",1,"text-secondary",3,"click"],["fxLayout","row","fxLayout.xs","column","fxLayoutAlign","start start"],["fxFlex","70"],["fxLayout","row","fxLayout.xs","column","fxLayoutAlign","start start","fxLayoutGap","6px"],["mat-raised-button","","type","button","color","primary","class","rounded-full",3,"click",4,"ngIf"],["mat-raised-button","","type","button","color","accent","class","rounded-full",3,"click",4,"ngIf"],["fxLayout","row","fxLayout.lt-sm","column","fxLayoutGap","16px","fxLayoutGap.lt-sm","0"],["fxFlex","50",1,"mt-4",3,"ngSwitch"],["fxFlex","20"],["fxFlex","30"],["fxFlex","30",3,"ngSwitch"],[4,"ngSwitchDefault"],["fxFlex","20",4,"ngIf"],["fxFlex","30",3,"ngSwitch",4,"ngIf"],["fxFlex","50",1,"mt-4"],["fxFlex","80"],["fxFlex","20",3,"ngSwitch"],[1,"mt-4"],["fxFlex","15"],["fxFlex","35"],["fxLayout","row","fxLayout.xs","column","fxLayoutAlign","start start",4,"ngIf"],["mat-raised-button","","type","button","color","primary",1,"rounded-full",3,"click"],["inline","true","size","24px",1,"ltr:-ml-1","rtl:-mr-1","ltr:mr-2","rtl:ml-2",3,"icon"],["mat-raised-button","","type","button","color","accent",1,"rounded-full",3,"click"],["size","18px","color","primary",3,"icIcon"],["size","18px","color","warn",3,"icIcon","click"],["fxFlex","85"],["name","DocumentoPresupuesto","type","application/pdf","height","600","width","100%",3,"data",4,"ngIf"],["name","DocumentoPresupuesto","type","application/pdf","height","600","width","100%",3,"data"],["mat-menu-item","",3,"click"],["color","warn",3,"icIcon"],["mat-menu-item",""]],template:function(t,e){1&t&&(m.Ec(0,it,1,0,"vex-loading",0),m.Ec(1,ct,1,0,"vex-loading",0),m.Ec(2,$t,32,20,"div",0),m.Wb(3,"mat-menu",1,2),m.Ec(5,Ut,3,1,"button",3),m.Ec(6,Kt,3,1,"button",3),m.Ec(7,Jt,3,1,"button",3),m.Ec(8,Yt,3,1,"button",3),m.Ec(9,Zt,3,1,"button",4),m.Vb()),2&t&&(m.oc("ngIf",e.loading),m.Cb(1),m.oc("ngIf",e.submitted),m.Cb(1),m.oc("ngIf",!e.loading),m.Cb(3),m.oc("ngIf",e.botones.anu),m.Cb(1),m.oc("ngIf",e.botones.rpdf),m.Cb(1),m.oc("ngIf",e.botones.nc),m.Cb(1),m.oc("ngIf",e.botones.nd),m.Cb(1),m.oc("ngIf",e.botones.gr))},directives:[w.p,et.d,F.a,b.h,I.c,ot.a,I.b,I.a,w.r,w.s,S.a,E.b,G.a,k.a,R.a,et.c,b.d,at.b,at.a,b.e,b.c,E.a,I.d,w.t,et.a],pipes:[w.e,L],styles:["@media (min-width:960px){.venta-show-dialog{width:960px}}.venta-show-dialog .mat-dialog-container{padding:0;margin:0}.venta-show-dialog .mat-dialog-content{padding:0 16px;margin:0}.venta-show-dialog .mat-dialog-actions{padding:16px 24px;margin:0}.venta-show-dialog table{width:100%}.venta-show-dialog table td{padding:4px}.venta-show-dialog fieldset{border:1px solid #ccc;border-radius:8px;line-height:24px;padding:8px}.venta-show-dialog fieldset legend{padding:0 8px}"],encapsulation:2}),te);function oe(t,e){1&t&&m.Rb(0,"vex-loading")}function ae(t,e){if(1&t){var o=m.Xb();m.Wb(0,"div",2),m.Wb(1,"div",3),m.Wb(2,"mat-toolbar",4),m.Wb(3,"mat-toolbar-row",5),m.Wb(4,"span"),m.Gc(5,"PDF"),m.Vb(),m.Wb(6,"div",6),m.Wb(7,"button",7),m.Wb(8,"mat-icon"),m.Gc(9,"print"),m.Vb(),m.Vb(),m.Wb(10,"button",8),m.ec("click",(function(){return m.wc(o),m.ic().matDialogRef.close()})),m.Wb(11,"mat-icon"),m.Gc(12,"close"),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Wb(13,"div",9),m.Wb(14,"div",10),m.Wb(15,"div",11),m.Wb(16,"object",12),m.jc(17,"domseguro"),m.Gc(18,"Esto no est\xe1 funcionando como se esperaba"),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Wb(19,"div",13),m.Wb(20,"button",14),m.ec("click",(function(){return m.wc(o),m.ic().matDialogRef.close()})),m.Gc(21," CERRAR "),m.Vb(),m.Vb(),m.Vb()}if(2&t){var a=m.ic();m.Cb(16),m.oc("data",m.lc(17,1,a.url,"http://apiclinicanet.pe/"),m.yc)}}var ne,ie=((ne=function(){function t(e,o,a,n){_classCallCheck(this,t),this.data=e,this.matDialogRef=o,this._matDialog=a,this._ventaService=n}return _createClass(t,[{key:"ngOnInit",value:function(){this.loading=!1,this.url="temporal/s2qWQ4fJg8j6nzcw.pdf"}}]),t}()).\u0275fac=function(t){return new(t||ne)(m.Qb(b.a),m.Qb(b.g),m.Qb(b.b),m.Qb(p.a))},ne.\u0275cmp=m.Kb({type:ne,selectors:[["vex-venta-dowloand"]],decls:2,vars:2,consts:[[4,"ngIf"],["class","dialog-content-wrapper",4,"ngIf"],[1,"dialog-content-wrapper"],["mat-dialog-title","",1,"m-0"],[1,"primary"],["fxFlex","","fxLayout","row","fxLayoutAlign","space-between center"],["fxLayout","row","fxLayoutAlign","end center"],["mat-icon-button","","type","button","aria-label","Imprimir","matTooltip","Imprimir"],["mat-icon-button","","type","button","matTooltip","Cerrar",3,"click"],["mat-dialog-content","","fusePerfectScrollbar","",1,"p-0","m-0"],["fxLayout","column","fxFlex",""],[1,"p-24"],["name","DocumentoPresupuesto","type","application/pdf","width","100%","height","800",3,"data"],["mat-dialog-actions","","fxLayout","row","fxLayoutAlign","end center",1,"p-16","m-0"],["mat-button","","aria-label","CERRAR","color","accent",3,"click"]],template:function(t,e){1&t&&(m.Ec(0,oe,1,0,"vex-loading",0),m.Ec(1,ae,22,4,"div",1)),2&t&&(m.oc("ngIf",e.loading),m.Cb(1),m.oc("ngIf",!e.loading))},directives:[w.p,F.a,b.h,ot.a,ot.c,I.a,I.c,I.b,E.b,G.a,k.a,b.e,b.c],pipes:[L],styles:[".venta-download-dialog .mat-dialog-container{padding:0}.venta-download-dialog .dialog-content-wrapper{max-height:85vh;display:flex;flex-direction:column}"],encapsulation:2}),ne),ce=o("eUUZ"),re=o("kmnG"),le=o("qFsG"),ue=["motivo"];function se(t,e){1&t&&m.Rb(0,"vex-loading")}var de,be=((de=function(){function t(e,o,a,n,i,c){_classCallCheck(this,t),this._data=e,this.matDialogRef=o,this._ventaService=a,this.snackBar=n,this._utils=i,this._datainicial=c,this.formatos=this._datainicial.formatos,this.operaciones=this._datainicial.operaciones,this.icClose=x.a,this.submitted=!1,this._data=this._data.venta}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.anularForm=this.createForm(),setTimeout((function(){t.motivoElement.nativeElement.focus()}),0)}},{key:"createForm",value:function(){var t;switch(this._data.iddocumentofiscal){case 1:t="Factura";break;case 2:t="Boleta de venta";break;case 10:t="Nota de d\xe9bito";break;case 13:t="Nota de cr\xe9dito"}return new c.h({comprobante:new c.e({value:"".concat(t," ").concat(this._data.serie," - ").concat(this._data.numero),disabled:!1}),motivoanulacion:new c.e(null)})}},{key:"save",value:function(){var t,e,o=this;switch(e=this.anularForm.getRawValue(),this._data.iddocumentofiscal){case 1:t="Factura";break;case 2:t="Boleta de venta";break;case 10:t="Nota de d\xe9bito";break;case 13:t="Nota de cr\xe9dito"}var a="".concat(t," ").concat(this._data.serie," - ").concat(this._data.numero);this.submitted=!0,this._ventaService.anular(this._data.idventa,e).subscribe((function(t){o.submitted=!1,o.snackBar.open("".concat(a," anulado."),"Cerrar"),o.matDialogRef.close(t)}),(function(t){o.submitted=!1;var e=o._utils.convertError(t);o.snackBar.open(e,"Cerrar",{panelClass:["error-dialog"]})}))}}]),t}()).\u0275fac=function(t){return new(t||de)(m.Qb(b.a),m.Qb(b.g),m.Qb(p.a),m.Qb(Z.b),m.Qb(Y.a),m.Qb(ce.a))},de.\u0275cmp=m.Kb({type:de,selectors:[["vex-ventas-anular"]],viewQuery:function(t,e){var o;1&t&&m.Nc(ue,!0),2&t&&m.tc(o=m.fc())&&(e.motivoElement=o.first)},decls:23,vars:6,consts:[[4,"ngIf"],[3,"formGroup","ngSubmit"],["fxLayout","row","fxLayoutAlign","start center","mat-dialog-title",""],["fxFlex","auto",1,"headline","m-0"],["mat-dialog-close","","mat-icon-button","","type","button",1,"text-secondary"],[3,"icIcon"],[1,"-mx-6","text-border"],["fxLayout","column"],["appearance","standard"],["matInput","","formControlName","comprobante",3,"readonly"],["appearance","fill",3,"floatLabel"],["matInput","","formControlName","motivoanulacion"],["motivo",""],["align","end"],["mat-button","","mat-dialog-close","","type","button"],["color","primary","mat-raised-button","","type","submit",3,"disabled"]],template:function(t,e){1&t&&(m.Ec(0,se,1,0,"vex-loading",0),m.Wb(1,"form",1),m.ec("ngSubmit",(function(){return e.save()})),m.Wb(2,"div",2),m.Wb(3,"h2",3),m.Gc(4,"Anulaci\xf3n"),m.Vb(),m.Wb(5,"button",4),m.Rb(6,"mat-icon",5),m.Vb(),m.Vb(),m.Rb(7,"mat-divider",6),m.Wb(8,"mat-dialog-content",7),m.Wb(9,"mat-form-field",8),m.Wb(10,"mat-label"),m.Gc(11,"Comprobante"),m.Vb(),m.Rb(12,"input",9),m.Vb(),m.Wb(13,"mat-form-field",10),m.Wb(14,"mat-label"),m.Gc(15,"Motivo de anulaci\xf3n (Opcional)"),m.Vb(),m.Rb(16,"input",11,12),m.Vb(),m.Vb(),m.Wb(18,"mat-dialog-actions",13),m.Wb(19,"button",14),m.Gc(20,"CERRAR"),m.Vb(),m.Wb(21,"button",15),m.Gc(22,"SI, ANULAR"),m.Vb(),m.Vb(),m.Vb()),2&t&&(m.oc("ngIf",e.submitted),m.Cb(1),m.oc("formGroup",e.anularForm),m.Cb(5),m.oc("icIcon",e.icClose),m.Cb(6),m.oc("readonly",!0),m.Cb(1),m.oc("floatLabel","always"),m.Cb(8),m.oc("disabled",e.anularForm.invalid||e.submitted))},directives:[w.p,c.w,c.q,c.i,I.c,I.b,b.h,I.a,E.b,b.d,k.a,R.a,S.a,b.e,re.d,re.h,le.b,c.b,c.p,c.g,b.c,F.a],styles:["@media (min-width:960px){.ventasanular-form-dialog{width:400px}}"],encapsulation:2}),de),me=["correo"];function pe(t,e){1&t&&m.Rb(0,"vex-loading")}function fe(t,e){1&t&&(m.Wb(0,"mat-error"),m.Gc(1," Es requerido "),m.Vb())}function ve(t,e){1&t&&(m.Wb(0,"mat-error"),m.Gc(1," Correo inv\xe1lido! "),m.Vb())}var ge,he=((ge=function(){function t(e,o,a,n,i,c){_classCallCheck(this,t),this._data=e,this.matDialogRef=o,this._ventaService=a,this.snackBar=n,this._utils=i,this._datainicial=c,this.icClose=x.a,this.icMail=Q.a,this.submitted=!1,this._data=this._data.venta}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.correoForm=this.createForm(),setTimeout((function(){t.correoElement.nativeElement.focus()}),0)}},{key:"createForm",value:function(){var t;switch(this._data.iddocumentofiscal){case 1:t="Factura";break;case 2:t="Boleta de venta";break;case 10:t="Nota de d\xe9bito";break;case 13:t="Nota de cr\xe9dito"}return new c.h({comprobante:new c.e({value:"".concat(t," ").concat(this._data.serie," - ").concat(this._data.numero),disabled:!1}),cpecorreo:new c.e(null,[c.v.required,c.v.email])})}},{key:"save",value:function(){var t,e,o=this;switch(e=this.correoForm.getRawValue(),this._data.iddocumentofiscal){case 1:t="Factura";break;case 2:t="Boleta de venta";break;case 10:t="Nota de d\xe9bito";break;case 13:t="Nota de cr\xe9dito"}var a="".concat(t," ").concat(this._data.serie," - ").concat(this._data.numero);this.submitted=!0,this._ventaService.correoEnvio(this._data.idventa,e).subscribe((function(t){o.submitted=!1,o.snackBar.open("".concat(a," enviado."),"Cerrar"),o.matDialogRef.close(t)}),(function(t){o.submitted=!1;var e=o._utils.convertError(t);o.snackBar.open(e,"Cerrar",{panelClass:["error-dialog"]})}))}}]),t}()).\u0275fac=function(t){return new(t||ge)(m.Qb(b.a),m.Qb(b.g),m.Qb(p.a),m.Qb(Z.b),m.Qb(Y.a),m.Qb(ce.a))},ge.\u0275cmp=m.Kb({type:ge,selectors:[["vex-ventas-correo"]],viewQuery:function(t,e){var o;1&t&&m.Nc(me,!0),2&t&&m.tc(o=m.fc())&&(e.correoElement=o.first)},decls:26,vars:9,consts:[[4,"ngIf"],[3,"formGroup","ngSubmit"],["fxLayout","row","fxLayoutAlign","start center","mat-dialog-title",""],["fxFlex","auto",1,"headline","m-0"],["mat-dialog-close","","mat-icon-button","","type","button",1,"text-secondary"],[3,"icIcon"],[1,"-mx-6","text-border"],["fxLayout","column"],["appearance","standard"],["matInput","","formControlName","comprobante",3,"readonly"],["appearance","fill",3,"floatLabel"],["matInput","","formControlName","cpecorreo","required",""],["correo",""],["matPrefix","",1,"mr-2",3,"icIcon"],["align","end"],["mat-button","","mat-dialog-close","","type","button"],["color","primary","mat-raised-button","","type","submit",3,"disabled"]],template:function(t,e){1&t&&(m.Ec(0,pe,1,0,"vex-loading",0),m.Wb(1,"form",1),m.ec("ngSubmit",(function(){return e.save()})),m.Wb(2,"div",2),m.Wb(3,"h2",3),m.Gc(4,"Env\xedo a correo"),m.Vb(),m.Wb(5,"button",4),m.Rb(6,"mat-icon",5),m.Vb(),m.Vb(),m.Rb(7,"mat-divider",6),m.Wb(8,"mat-dialog-content",7),m.Wb(9,"mat-form-field",8),m.Wb(10,"mat-label"),m.Gc(11,"Comprobante"),m.Vb(),m.Rb(12,"input",9),m.Vb(),m.Wb(13,"mat-form-field",10),m.Wb(14,"mat-label"),m.Gc(15,"Correo electr\xf3nico"),m.Vb(),m.Rb(16,"input",11,12),m.Rb(18,"mat-icon",13),m.Ec(19,fe,2,0,"mat-error",0),m.Ec(20,ve,2,0,"mat-error",0),m.Vb(),m.Vb(),m.Wb(21,"mat-dialog-actions",14),m.Wb(22,"button",15),m.Gc(23,"Cancelar"),m.Vb(),m.Wb(24,"button",16),m.Gc(25,"Enviar"),m.Vb(),m.Vb(),m.Vb()),2&t&&(m.oc("ngIf",e.submitted),m.Cb(1),m.oc("formGroup",e.correoForm),m.Cb(5),m.oc("icIcon",e.icClose),m.Cb(6),m.oc("readonly",!0),m.Cb(1),m.oc("floatLabel","always"),m.Cb(5),m.oc("icIcon",e.icMail),m.Cb(1),m.oc("ngIf",e.correoForm.get("cpecorreo").hasError("required")),m.Cb(1),m.oc("ngIf",e.correoForm.get("cpecorreo").hasError("email")),m.Cb(4),m.oc("disabled",e.correoForm.invalid||e.submitted))},directives:[w.p,c.w,c.q,c.i,I.c,I.b,b.h,I.a,E.b,b.d,k.a,R.a,S.a,b.e,re.d,re.h,le.b,c.b,c.p,c.g,c.u,re.i,b.c,F.a,re.c],styles:["@media (min-width:960px){.ventascorreo-form-dialog{width:400px}}"],encapsulation:2}),ge),Ve=o("sF+I"),Ce=o.n(Ve),xe=o("7wwx"),We=o.n(xe),ye=o("e3EN"),we=o.n(ye),Fe=o("uQ9D"),Ie=o.n(Fe),Ee=o("p+k2"),Ge=o.n(Ee),ke=o("rwX0"),Re=o.n(ke),Se=o("+4LO"),_e=o.n(Se),Le=o("Fck7"),De=o.n(Le),Ae=o("d3UM"),Ne=o("FKr1");function Te(t,e){1&t&&m.Rb(0,"vex-loading")}function Oe(t,e){if(1&t&&(m.Wb(0,"mat-option",17),m.Gc(1),m.Vb()),2&t){var o=e.$implicit;m.oc("value",o.id),m.Cb(1),m.Ic(" ",o.nombre," ")}}function Pe(t,e){1&t&&(m.Wb(0,"mat-error"),m.Gc(1," Es requerido "),m.Vb())}var je,qe=((je=function(){function t(e,o,a,n,i,c){_classCallCheck(this,t),this._data=e,this.matDialogRef=o,this._ventaService=a,this.snackBar=n,this._utils=i,this._datainicial=c,this.formatos=this._datainicial.formatos,this.icClose=x.a,this.icPictureAsPdf=De.a,this.submitted=!1,this._data=this._data.venta}return _createClass(t,[{key:"ngOnInit",value:function(){this.regenerarForm=this.createForm()}},{key:"createForm",value:function(){return new c.h({comprobante:new c.e({value:"".concat(this._data.docnegocio.nombre," ").concat(this._data.serie," - ").concat(this._data.numero),disabled:!1}),pdfformato:new c.e(null,[c.v.required])})}},{key:"save",value:function(){var t=this,e={pdfformato:this.regenerarForm.get("pdfformato").value},o="".concat(this._data.docnegocio.nombre," ").concat(this._data.serie," - ").concat(this._data.numero);this.submitted=!0,this._ventaService.regenerarPdf(this._data.idventa,e).subscribe((function(e){t.submitted=!1,t.snackBar.open("PDF de ".concat(o," regenerado."),"Cerrar"),t.matDialogRef.close(e)}),(function(e){t.submitted=!1;var o=t._utils.convertError(e);t.snackBar.open(o,"Cerrar",{panelClass:["error-dialog"]})}))}}]),t}()).\u0275fac=function(t){return new(t||je)(m.Qb(b.a),m.Qb(b.g),m.Qb(p.a),m.Qb(Z.b),m.Qb(Y.a),m.Qb(ce.a))},je.\u0275cmp=m.Kb({type:je,selectors:[["vex-ventas-regenerar"]],decls:25,vars:9,consts:[[4,"ngIf"],[3,"formGroup","ngSubmit"],["fxLayout","row","fxLayoutAlign","start center","mat-dialog-title",""],["fxFlex","auto",1,"headline","m-0"],["mat-dialog-close","","mat-icon-button","","type","button",1,"text-secondary"],[3,"icIcon"],[1,"-mx-6","text-border"],["fxLayout","column"],["appearance","standard"],["matInput","","formControlName","comprobante",3,"readonly"],["appearance","fill",3,"floatLabel"],["formControlName","pdfformato","required",""],[3,"value",4,"ngFor","ngForOf"],["matPrefix","",1,"mr-2",3,"icIcon"],["align","end"],["mat-button","","mat-dialog-close","","type","button"],["color","primary","mat-raised-button","","type","submit",3,"disabled"],[3,"value"]],template:function(t,e){1&t&&(m.Ec(0,Te,1,0,"vex-loading",0),m.Wb(1,"form",1),m.ec("ngSubmit",(function(){return e.save()})),m.Wb(2,"div",2),m.Wb(3,"h2",3),m.Gc(4,"Regenerar PDF"),m.Vb(),m.Wb(5,"button",4),m.Rb(6,"mat-icon",5),m.Vb(),m.Vb(),m.Rb(7,"mat-divider",6),m.Wb(8,"mat-dialog-content",7),m.Wb(9,"mat-form-field",8),m.Wb(10,"mat-label"),m.Gc(11,"Comprobante"),m.Vb(),m.Rb(12,"input",9),m.Vb(),m.Wb(13,"mat-form-field",10),m.Wb(14,"mat-label"),m.Gc(15,"Formato impresi\xf3n"),m.Vb(),m.Wb(16,"mat-select",11),m.Ec(17,Oe,2,2,"mat-option",12),m.Vb(),m.Rb(18,"mat-icon",13),m.Ec(19,Pe,2,0,"mat-error",0),m.Vb(),m.Vb(),m.Wb(20,"mat-dialog-actions",14),m.Wb(21,"button",15),m.Gc(22,"CERRAR"),m.Vb(),m.Wb(23,"button",16),m.Gc(24,"ACEPTAR"),m.Vb(),m.Vb(),m.Vb()),2&t&&(m.oc("ngIf",e.submitted),m.Cb(1),m.oc("formGroup",e.regenerarForm),m.Cb(5),m.oc("icIcon",e.icClose),m.Cb(6),m.oc("readonly",!0),m.Cb(1),m.oc("floatLabel","always"),m.Cb(4),m.oc("ngForOf",e.formatos),m.Cb(1),m.oc("icIcon",e.icPictureAsPdf),m.Cb(1),m.oc("ngIf",e.regenerarForm.get("pdfformato").hasError("required")),m.Cb(4),m.oc("disabled",e.regenerarForm.invalid||e.submitted))},directives:[w.p,c.w,c.q,c.i,I.c,I.b,b.h,I.a,E.b,b.d,k.a,R.a,S.a,b.e,re.d,re.h,le.b,c.b,c.p,c.g,Ae.a,c.u,w.o,re.i,b.c,F.a,Ne.n,re.c],styles:["@media (min-width:960px){.ventasregenerar-form-dialog{width:400px}}"],encapsulation:2}),je),Me=o("+0xr"),Qe=o("ZuBe"),Be=o("uwSD"),ze=o("Z998"),He=o("znSr"),Xe=o("C0s9"),$e=o("/1cH"),Ue=o("iadO"),Ke=o("Dh3D"),Je=o("M9IT"),Ye=o("Xa2L"),Ze=o("0CBe"),to=["pagVenta"],eo=["sortVenta"];function oo(t,e){if(1&t&&(m.Wb(0,"mat-option",16),m.Gc(1),m.Vb()),2&t){var o=e.$implicit;m.oc("value",o.value),m.Cb(1),m.Ic(" ",o.nombre," ")}}function ao(t,e){if(1&t){var o=m.Xb();m.Wb(0,"mat-option",66),m.ec("keyup.enter",(function(){return m.wc(o),m.ic().index(!0)})),m.Rb(1,"mat-spinner",67),m.Vb()}}function no(t,e){if(1&t&&(m.Wb(0,"mat-option",16),m.Rb(1,"img",69),m.jc(2,"imagen"),m.Wb(3,"span",70),m.Gc(4),m.Vb(),m.Wb(5,"span",71),m.Gc(6),m.Vb(),m.Vb()),2&t){var o=e.$implicit;m.oc("value",o),m.Cb(1),m.oc("src",m.lc(2,4,o.imgperfil,o.sexo),m.zc),m.Cb(3),m.Hc(o.entidad),m.Cb(2),m.Hc(o.numerodoc)}}function io(t,e){if(1&t&&(m.Ub(0),m.Ec(1,no,7,7,"mat-option",17),m.Wb(2,"div",68),m.Wb(3,"p"),m.Gc(4),m.Vb(),m.Vb(),m.Tb()),2&t){var o=m.ic();m.Cb(1),m.oc("ngForOf",o.searchResult.data),m.Cb(3),m.Jc("Mostrando ",o.searchResult.to," de ",o.searchResult.total," resultados.")}}function co(t,e){if(1&t&&(m.Wb(0,"button",72),m.Rb(1,"mat-icon",21),m.Vb()),2&t){var o=m.ic();m.Cb(1),m.oc("icIcon",o.icSearch)}}function ro(t,e){if(1&t){var o=m.Xb();m.Wb(0,"button",73),m.ec("click",(function(){return m.wc(o),m.ic().cliente.setValue("")})),m.Rb(1,"mat-icon",21),m.Vb()}if(2&t){var a=m.ic();m.Cb(1),m.oc("icIcon",a.icClose)}}function lo(t,e){1&t&&(m.Wb(0,"div",74),m.Rb(1,"mat-spinner"),m.Vb())}function uo(t,e){1&t&&(m.Wb(0,"th",75),m.Gc(1,"F.EMISI\xd3N"),m.Vb())}var so=function(t){return{through:t}};function bo(t,e){if(1&t&&(m.Wb(0,"td",76),m.Gc(1),m.Vb()),2&t){var o=e.$implicit;m.oc("ngClass",m.qc(2,so,28===o.idestadodocumento)),m.Cb(1),m.Ic(" ",o.fechaemision," ")}}function mo(t,e){1&t&&(m.Wb(0,"th",75),m.Gc(1,"DNI/RUC/."),m.Vb())}function po(t,e){if(1&t&&(m.Wb(0,"td",76),m.Gc(1),m.Vb()),2&t){var o=e.$implicit;m.oc("ngClass",m.qc(2,so,28===o.idestadodocumento)),m.Cb(1),m.Ic(" ",o.clientenumerodoc," ")}}function fo(t,e){1&t&&(m.Wb(0,"th",77),m.Gc(1,"CLIENTE"),m.Vb())}function vo(t,e){if(1&t&&(m.Wb(0,"td",78),m.Gc(1),m.Vb()),2&t){var o=e.$implicit;m.oc("ngClass",m.qc(2,so,28===o.idestadodocumento)),m.Cb(1),m.Ic(" ",o.clientenombre," ")}}function go(t,e){1&t&&(m.Wb(0,"th",77),m.Gc(1,"DIRECCI\xd3N"),m.Vb())}function ho(t,e){if(1&t&&(m.Wb(0,"td"),m.Gc(1),m.Vb()),2&t){var o=e.$implicit;m.Cb(1),m.Ic(" ",o.direccion,"")}}function Vo(t,e){1&t&&(m.Wb(0,"th",75),m.Gc(1,"COMPROBANTE"),m.Vb())}function Co(t,e){if(1&t&&(m.Wb(0,"td",76),m.Gc(1),m.Vb()),2&t){var o=e.$implicit;m.oc("ngClass",m.qc(2,so,28===o.idestadodocumento)),m.Cb(1),m.Ic(" ",o.docnegocio.nombre," ")}}function xo(t,e){1&t&&(m.Wb(0,"th",75),m.Gc(1,"SERIE"),m.Vb())}function Wo(t,e){if(1&t&&(m.Wb(0,"td",76),m.Gc(1),m.Vb()),2&t){var o=e.$implicit;m.oc("ngClass",m.qc(2,so,28===o.idestadodocumento)),m.Cb(1),m.Ic(" ",o.serie," ")}}function yo(t,e){1&t&&(m.Wb(0,"th",75),m.Gc(1,"NUMERO"),m.Vb())}function wo(t,e){if(1&t&&(m.Wb(0,"td",76),m.Gc(1),m.Vb()),2&t){var o=e.$implicit;m.oc("ngClass",m.qc(2,so,28===o.idestadodocumento)),m.Cb(1),m.Ic(" ",o.numero," ")}}function Fo(t,e){1&t&&(m.Wb(0,"th",75),m.Gc(1,"ESTADO"),m.Vb())}function Io(t,e){1&t&&(m.Wb(0,"span"),m.Gc(1,"Pendiente"),m.Vb())}function Eo(t,e){1&t&&(m.Wb(0,"span"),m.Gc(1,"Pagado"),m.Vb())}function Go(t,e){1&t&&(m.Wb(0,"span"),m.Gc(1,"Anulado"),m.Vb())}function ko(t,e){if(1&t&&(m.Wb(0,"td",76),m.Wb(1,"div",79),m.Ec(2,Io,2,0,"span",80),m.Ec(3,Eo,2,0,"span",80),m.Ec(4,Go,2,0,"span",80),m.Vb(),m.Vb()),2&t){var o=e.$implicit;m.oc("ngClass",m.qc(5,so,28===o.idestadodocumento)),m.Cb(1),m.oc("ngSwitch",o.idestadodocumento),m.Cb(1),m.oc("ngSwitchCase",26),m.Cb(1),m.oc("ngSwitchCase",27),m.Cb(1),m.oc("ngSwitchCase",28)}}function Ro(t,e){1&t&&(m.Wb(0,"th",75),m.Gc(1,"TOTAL"),m.Vb())}function So(t,e){if(1&t&&(m.Wb(0,"td",76),m.Gc(1),m.Vb()),2&t){var o=e.$implicit;m.oc("ngClass",m.qc(2,so,28===o.idestadodocumento)),m.Cb(1),m.Ic(" ",o.total," ")}}function _o(t,e){1&t&&(m.Wb(0,"th",75),m.Gc(1,"Sunat"),m.Vb())}function Lo(t,e){if(1&t&&(m.Wb(0,"td",81),m.Rb(1,"mat-icon",82),m.Vb()),2&t){var o=m.ic();m.Cb(1),m.oc("icIcon",o.icCheck)}}function Do(t,e){1&t&&(m.Wb(0,"th",75),m.Gc(1,"Correo"),m.Vb())}function Ao(t,e){if(1&t&&(m.Wb(0,"td",81),m.Rb(1,"mat-icon",82),m.Vb()),2&t){var o=m.ic();m.Cb(1),m.oc("icIcon",o.icCheck)}}function No(t,e){1&t&&(m.Wb(0,"th",75),m.Gc(1," ACCIONES "),m.Vb())}function To(t,e){if(1&t){var o=m.Xb();m.Wb(0,"button",93),m.ec("click",(function(t){m.wc(o);var e=m.ic().$implicit,a=m.ic();return t.stopPropagation(),a.printPdf(e.pdf)})),m.Rb(1,"mat-icon",82),m.Vb()}if(2&t){var a=m.ic(2);m.Cb(1),m.oc("icIcon",a.icPrint)}}function Oo(t,e){if(1&t){var o=m.Xb();m.Wb(0,"button",94),m.ec("click",(function(t){m.wc(o);var e=m.ic().$implicit,a=m.ic();return t.stopPropagation(),a.showVenta(e,"COMPROBANTE")})),m.Rb(1,"mat-icon",82),m.Vb()}if(2&t){var a=m.ic(2);m.Cb(1),m.oc("icIcon",a.icPictureAsPdf)}}function Po(t,e){if(1&t){var o=m.Xb();m.Wb(0,"button",95),m.ec("click",(function(t){m.wc(o);var e=m.ic().$implicit,a=m.ic();return t.stopPropagation(),a.downloadPdf(e.pdf)})),m.Rb(1,"mat-icon",82),m.Vb()}if(2&t){var a=m.ic(2);m.Cb(1),m.oc("icIcon",a.icCloudDownload)}}function jo(t,e){if(1&t){var o=m.Xb();m.Wb(0,"button",90),m.ec("click",(function(){m.wc(o);var t=m.ic().$implicit;return m.ic().nuevoComprobante(t,"Notadecredito")})),m.Rb(1,"mat-icon",82),m.Gc(2," Nota de cr\xe9dito "),m.Vb()}if(2&t){var a=m.ic(2);m.Cb(1),m.oc("icIcon",a.icInsertDriveFile)}}function qo(t,e){if(1&t){var o=m.Xb();m.Wb(0,"button",90),m.ec("click",(function(){m.wc(o);var t=m.ic().$implicit;return m.ic().nuevoComprobante(t,"Notadedebito")})),m.Rb(1,"mat-icon",82),m.Gc(2," Nota de d\xe9bito "),m.Vb()}if(2&t){var a=m.ic(2);m.Cb(1),m.oc("icIcon",a.icInsertDriveFile)}}var Mo=function(){return[1,2]};function Qo(t,e){if(1&t){var o=m.Xb();m.Wb(0,"td",81),m.Wb(1,"div",83),m.Ec(2,To,2,1,"button",84),m.Ec(3,Oo,2,1,"button",85),m.Ec(4,Po,2,1,"button",86),m.Wb(5,"button",87),m.ec("click",(function(t){m.wc(o);var a=e.$implicit,n=m.ic();return t.stopPropagation(),n.nuevoComprobante(a.idventa)})),m.Rb(6,"mat-icon",82),m.Vb(),m.Wb(7,"button",88),m.ec("click",(function(t){return m.wc(o),t.stopPropagation()})),m.Rb(8,"mat-icon",82),m.Vb(),m.Wb(9,"mat-menu",null,89),m.Wb(11,"button",90),m.ec("click",(function(){m.wc(o);var t=e.$implicit;return m.ic().anularVenta(t)})),m.Rb(12,"mat-icon",91),m.Gc(13," Anular "),m.Vb(),m.Wb(14,"button",90),m.ec("click",(function(){m.wc(o);var t=e.$implicit;return m.ic().correoVenta(t)})),m.Rb(15,"mat-icon",82),m.Gc(16," Enviar "),m.Vb(),m.Rb(17,"mat-divider"),m.Ec(18,jo,3,1,"button",92),m.Ec(19,qo,3,1,"button",92),m.Rb(20,"mat-divider"),m.Wb(21,"button",90),m.ec("click",(function(){m.wc(o);var t=e.$implicit;return m.ic().regenerarPDF(t)})),m.Rb(22,"mat-icon",82),m.Gc(23," Regenerar "),m.Vb(),m.Vb(),m.Vb(),m.Vb()}if(2&t){var a=e.$implicit,n=m.uc(10),i=m.ic();m.Cb(2),m.oc("ngIf",a.pdf),m.Cb(1),m.oc("ngIf",a.pdf&&-1===a.pdf.indexOf("www.pse.pe")),m.Cb(1),m.oc("ngIf",a.pdf&&-1!==a.pdf.indexOf("www.pse.pe")),m.Cb(2),m.oc("icIcon",i.icEdit),m.Cb(1),m.oc("matMenuTriggerFor",n),m.Cb(1),m.oc("icIcon",i.icMoreVert),m.Cb(4),m.oc("icIcon",i.icBlock),m.Cb(3),m.oc("icIcon",i.icMail),m.Cb(3),m.oc("ngIf",-1!==m.pc(11,Mo).indexOf(a.iddocumentofiscal)),m.Cb(1),m.oc("ngIf",-1!==m.pc(12,Mo).indexOf(a.iddocumentofiscal)),m.Cb(3),m.oc("icIcon",i.icAutorenew)}}function Bo(t,e){1&t&&(m.Wb(0,"mat-footer-cell"),m.Gc(1," No hay registros. "),m.Vb())}function zo(t,e){1&t&&m.Rb(0,"tr",96)}function Ho(t,e){if(1&t){var o=m.Xb();m.Wb(0,"tr",97),m.ec("click",(function(){m.wc(o);var t=e.$implicit;return m.ic().showVenta(t)})),m.Vb()}}var Xo=function(t){return{hide:t}};function $o(t,e){if(1&t&&m.Rb(0,"tr",98),2&t){var o=m.ic();m.oc("ngClass",m.qc(1,Xo,o.rLengthVenta>0||o.loadVenta))}}var Uo,Ko=function(){return["Ventas"]},Jo=function(){return["/ventas/nuevo","Factura"]},Yo=function(){return["/ventas/nuevo","Boletadeventa"]},Zo=function(){return["/ventas/nuevo","Notadecredito"]},ta=function(){return["/ventas/nuevo","Notadedebito"]},ea=function(){return{nombre:"Factura",value:1}},oa=function(){return{nombre:"Boleta de venta",value:2}},aa=function(){return{nombre:"Nota de cr\xe9dito",value:13}},na=function(){return{nombre:"Nota de d\xe9bito",value:10}},ia=function(t,e,o,a){return[t,e,o,a]},ca=function(){return["empty"]},ra=((Uo=function(){function t(e,o,a,n,i,r){_classCallCheck(this,t),this.router=e,this._matDialog=o,this._entidadService=a,this._ventaService=n,this._utils=i,this.snackBar=r,this.pipeDate=new w.e("es-Pe"),this.searchResult={data:null,to:null,total:null},this.isLoadingSearch=!1,this.idsede=new c.e,this.fechaemisionFrom=new c.e,this.fechaemisionTo=new c.e,this.cliente=new c.e,this.icSearch=Ce.a,this.icAdd=We.a,this.icEdit=P.a,this.icDelete=we.a,this.icClose=x.a,this.icVisibility=Ie.a,this.icCheckBoxOutlineBlank=Ge.a,this.icCheck=J.a,this.icAutorenew=U.a,this.icPeople=Re.a,this.icMoreVert=z.a,this.icCloudDownload=y.a,this.icFilterList=_e.a,this.icPictureAsPdf=De.a,this.icInsertDriveFile=X.a,this.icMail=Q.a,this.icBlock=q.a,this.icPrint=V.a,this.dcVenta=["acciones","fechaemision","numerodoc","entidad","iddocumentofiscal","serie","numero","idestadodocumento","total","sunat","estado"],this.dsVenta=new Me.o,this.loadVenta=!0,this.rLengthVenta=0,this.pSizeVenta=20,this.pSizeOptVenta=[10,20,50],this.idsede.setValue(this._entidadService.sedeDefault||"")}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.searchForm=this.createSearchForm(),this.searchForm.controls.iddocumentofiscal.valueChanges.subscribe((function(e){console.log("searchForm iddocumentofiscal",e),t.index()})),this.fechaemisionFrom.valueChanges.subscribe((function(e){t.index()})),this.fechaemisionTo.valueChanges.subscribe((function(e){t.index()})),this.cliente.valueChanges.pipe(Object(r.a)(300),Object(l.a)((function(){return t.isLoadingSearch=!0})),Object(u.a)((function(e){if(""===e&&t.index(!0),e&&"string"==typeof e){var o={page:1,pageSize:10,orderName:"entidad",orderSort:"asc"};return parseFloat(e)>0?o.likeNumerodoc=e:o.likeEntidad=e,t._entidadService.index(o).pipe(Object(s.a)((function(){return t.isLoadingSearch=!1})))}return t.isLoadingSearch=!1,[]}))).subscribe((function(e){t.searchResult=e})),this.sortVenta.sortChange.subscribe((function(){t.pagVenta.pageIndex=0,t.index()})),this.pagVenta.page.subscribe((function(){t.index()})),this.index()}},{key:"createSearchForm",value:function(){return new c.h({iddocumentofiscal:new c.e,serie:new c.e,numero:new c.e})}},{key:"index",value:function(t){var e=this;t&&(this.pagVenta.pageIndex=0);var o={page:this.pagVenta.pageSize?this.pagVenta.pageIndex+1:1,pageSize:this.pagVenta.pageSize?this.pagVenta.pageSize:this.pSizeVenta,orderName:this.sortVenta.active?this.sortVenta.active:"idventa",orderSort:this.sortVenta.direction?this.sortVenta.direction:"desc",conRecurso:"sede,docnegocio"};this.idsede.value&&(o.idsede=this.idsede.value),this.fechaemisionFrom.value&&(o.fechaemisionFrom=this.pipeDate.transform(this.fechaemisionFrom.value,"yyyy-MM-dd")),this.fechaemisionTo.value&&(o.fechaemisionTo=this.pipeDate.transform(this.fechaemisionTo.value,"yyyy-MM-dd")),this.cliente.value&&(o.idcliente=this.cliente.value.identidad);var a=this.searchForm.getRawValue();this.clean(a),Object.assign(o,a),this.loadVenta=!0,this._ventaService.index(o).subscribe((function(t){t.data.forEach((function(t){t.pdf=e.urlPdf(t.pdf)})),e.dsVenta.data=t.data,e.loadVenta=!1,e.rLengthVenta=t.total,console.log("this.rLengthVenta",e.rLengthVenta)}),(function(t){e.loadVenta=!1;var o=e._utils.convertError(t);e.snackBar.open(o,"Cerrar",{panelClass:["error-dialog"]})}))}},{key:"clean",value:function(t){for(var e in t)null!=t[e]&&""!==t[e]||delete t[e]}},{key:"showVenta",value:function(t,e){var o=this;this._matDialog.open(ee,{panelClass:"venta-show-dialog",data:{idventa:t.idventa,pestana:e,botones:{canu:!1,rpdf:!1,nvent:!0,edit:!1,anu:!0,mail:!0,nc:!1,nd:!1,gr:!0}},autoFocus:!1,disableClose:!0}).afterClosed().subscribe((function(e){console.log("response: ",e),e&&("anular"===e&&o.anularVenta(t),"correo"===e&&o.correoVenta(t),"regenerar"===e&&o.regenerarPDF(t),"Notadecredito"===e&&o.nuevoComprobante(t,"Notadecredito"),"Notadedebito"===e&&o.nuevoComprobante(t,"Notadecredito"))}))}},{key:"downloadVenta",value:function(){this._matDialog.open(ie,{panelClass:"venta-download-dialog",data:{}}).afterClosed().subscribe((function(t){}))}},{key:"descargar",value:function(){var t=this;this._matDialog.open(f,{panelClass:"venta-descarga-dialog",data:{item:null},autoFocus:!1}).afterClosed().subscribe((function(e){e&&t.index()}))}},{key:"pdf",value:function(t){var e=this;this._matDialog.open(T,{panelClass:"venta-pdf-dialog",data:{venta:t},autoFocus:!1}).afterClosed().subscribe((function(t){t&&e.index()}))}},{key:"anularVenta",value:function(t){var e=this;this._matDialog.open(be,{panelClass:"ventasanular-form-dialog",data:{venta:t},autoFocus:!1}).afterClosed().subscribe((function(t){t&&e.index()}))}},{key:"correoVenta",value:function(t){var e=this;this._matDialog.open(he,{panelClass:"ventascorreo-form-dialog",data:{venta:t},autoFocus:!1}).afterClosed().subscribe((function(t){t&&e.index()}))}},{key:"regenerarPDF",value:function(t){var e=this;this._matDialog.open(qe,{panelClass:"ventasregenerar-form-dialog",data:{venta:t},autoFocus:!1}).afterClosed().subscribe((function(o){o&&(e.index(),e.showVenta(t,"COMPROBANTE"))}))}},{key:"displaySearchEntidad",value:function(t){return t?t.entidad:null}},{key:"nuevoComprobante",value:function(t,e){if(!e)switch(t.iddocumentofiscal){case 1:e="Factura";break;case 2:e="Boletadeventa";break;case 13:e="Notadecredito";break;case 10:e="Notadedebito"}this.router.navigate(["/ventas/emitir/"+e,{venta:t.idventa}])}},{key:"resetForm",value:function(){this.searchForm.reset({},{emitEvent:!1}),this.index()}},{key:"downloadPdf",value:function(t){var e=this.urlPdf(t);this._ventaService.downloadProxy(e).subscribe((function(e){var o=t.split("/").reverse()[0];Object(d.saveAs)(e,o)}),(function(t){}))}},{key:"printPdf",value:function(t){var e=this.urlPdf(t);this._ventaService.downloadProxy(e).subscribe((function(t){var e=new Blob([t],{type:"application/pdf"}),o=URL.createObjectURL(e),a=document.createElement("iframe");a.style.display="none",a.src=o,document.body.appendChild(a),a.contentWindow.print()}),(function(t){}))}},{key:"urlPdf",value:function(t){var e="";if(t){var o=t.split("/").reverse()[0],a=t.split("/").reverse()[1];-1===t.indexOf("www.pse.pe")&&(e="/api/public/"+a+"/"+o),-1!==t.indexOf("www.pse.pe")&&(e="/"+a+"/"+o)}return e}}]),t}()).\u0275fac=function(t){return new(t||Uo)(m.Qb(i.f),m.Qb(b.b),m.Qb(tt.a),m.Qb(p.a),m.Qb(Y.a),m.Qb(Z.b))},Uo.\u0275cmp=m.Kb({type:Uo,selectors:[["vex-ventas"]],viewQuery:function(t,e){var o;1&t&&(m.Cc(to,!0),m.Cc(eo,!0)),2&t&&(m.tc(o=m.fc())&&(e.pagVenta=o.first),m.tc(o=m.fc())&&(e.sortVenta=o.first))},decls:110,vars:55,consts:[["fxLayout","column","fxLayoutAlign","center start",1,"pb-16"],[1,"w-full","flex","flex-col","sm:flex-row","justify-between","px-gutter"],[1,"title","mt-0","mb-1"],[3,"crumbs"],["mat-raised-button","","matTooltip","Descargar Excel","fxHide","","fxShow.gt-xs","",3,"click"],[3,"icIcon"],["mat-icon-button","","fxShow","","fxHide.gt-xs",""],["mat-raised-button","","fxHide","","fxShow.gt-xs","",1,"ml-1",3,"matMenuTriggerFor"],["mat-icon-button","","type","button","fxShow","","fxHide.gt-xs","",3,"matMenuTriggerFor"],["menuAdd","matMenu"],["mat-menu-item","",3,"routerLink"],[1,"-mt-6","px-gutter"],[1,"card","overflow-auto","-mt-16"],["fxLayout","row","fxLayoutAlign","start center",1,"bg-app-bar","px-6","h-16","border-b","sticky","left-0"],["fxFlex","400px","fxFlex.lt-md","auto","fxHide.xs","","fxLayout","row","fxLayoutAlign","start center",1,"bg-card","rounded-full","border","px-4",3,"formGroup","ngSubmit"],["placeholder","Comprobante","name","iddocumentofiscal","formControlName","iddocumentofiscal",1,"px-4","py-3","border-0","outline-none","w-full","bg-transparent"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["matInput","","placeholder","Serie","name","serie","formControlName","serie",1,"px-4","py-3","border-0","outline-none","w-full","bg-transparent"],["matInput","","placeholder","N\xfamero","name","numero","formControlName","numero",1,"px-4","py-3","border-0","outline-none","w-full","bg-transparent"],["mat-icon-button","","type","submit","matTooltip","Buscar"],["size","20px",3,"icIcon"],["fxFlex","","fxFlex.lt-md","auto","fxHide.xs","","fxLayout","row","fxLayoutAlign","start center",1,"bg-card","rounded-full","border","px-4"],["matInput","","placeholder","Cliente o  DNI/RUC",1,"px-4","py-3","border-0","outline-none","w-full","bg-transparent",3,"matAutocomplete","formControl"],["nombreERef",""],[3,"displayWith","optionSelected"],["auto","matAutocomplete"],[3,"keyup.enter",4,"ngIf"],[4,"ngIf"],["mat-icon-button","","matSuffix","","type","button",4,"ngIf"],["mat-icon-button","","matSuffix","","type","button",3,"click",4,"ngIf"],["fxFlex","290px","fxFlex.lt-md","auto","fxHide.xs","","fxLayout","row","fxLayoutAlign","start center",1,"bg-card","rounded-full","border","px-4"],["matInput","","placeholder","Desde","name","fechaemisionFrom",1,"px-4","py-3","border-0","outline-none","w-full","bg-transparent",3,"formControl","matDatepicker"],["matSuffix","",3,"for"],["fechaFromDatePicker",""],["matInput","","placeholder","Hasta","name","fechaemisionTo",3,"formControl","matDatepicker"],["fechaToDatePicker",""],[1,"loading-container"],["class","loading-shade",4,"ngIf"],["mat-table","","matSort","","matSortActive","idventa","matSortDisableClear","","matSortDirection","desc",1,"w-full",3,"dataSource"],["table","","sortVenta","matSort"],["matColumnDef","fechaemision"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",3,"ngClass",4,"matCellDef"],["matColumnDef","numerodoc"],["matColumnDef","entidad"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],[3,"ngClass",4,"matCellDef"],["matColumnDef","direccion"],[4,"matCellDef"],["matColumnDef","iddocumentofiscal"],["matColumnDef","serie"],["matColumnDef","numero"],["matColumnDef","idestadodocumento"],["matColumnDef","total"],["matColumnDef","sunat"],["mat-cell","",4,"matCellDef"],["matColumnDef","estado"],["matColumnDef","acciones"],["matColumnDef","empty"],[4,"matFooterCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","hover:bg-hover trans-ease-out cursor-pointer","mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",3,"ngClass",4,"matFooterRowDef"],[1,"sticky","left-0",3,"length","pageSizeOptions","pageSize"],["pagVenta",""],[3,"keyup.enter"],["diameter","50"],["fxLayout","row","fxLayoutAlign","start center"],[1,"align-middle","mr-4","shadow-6","h-6","inline-block",3,"src"],[1,"body-1"],[1,"caption","text-secondary","ml-4"],["mat-icon-button","","matSuffix","","type","button"],["mat-icon-button","","matSuffix","","type","button",3,"click"],[1,"loading-shade"],["mat-header-cell",""],["mat-cell","",3,"ngClass"],["mat-header-cell","","mat-sort-header",""],[3,"ngClass"],[3,"ngSwitch"],[4,"ngSwitchCase"],["mat-cell",""],["size","18px",3,"icIcon"],["fxLayout","row","fxLayoutAlign","center center"],["type","button","mat-icon-button","","matTooltip","Imprimir","class","w-8 h-8 leading-none flex items-center justify-center hover:bg-hover",3,"click",4,"ngIf"],["type","button","mat-icon-button","","matTooltip","PDF","class","w-8 h-8 leading-none flex items-center justify-center ml-1 hover:bg-hover",3,"click",4,"ngIf"],["type","button","mat-icon-button","","matTooltip","Descargar","class","w-8 h-8 leading-none flex items-center justify-center ml-1 hover:bg-hover",3,"click",4,"ngIf"],["type","button","mat-icon-button","","matTooltip","Editar",1,"w-8","h-8","leading-none","flex","items-center","justify-center","ml-1","hover:bg-hover",3,"click"],["type","button","mat-icon-button","",1,"w-8","h-8","leading-none","flex","items-center","justify-center","ml-1","hover:bg-hover",3,"matMenuTriggerFor","click"],["menumore","matMenu"],["mat-menu-item","",3,"click"],["color","warn","size","18px",3,"icIcon"],["mat-menu-item","",3,"click",4,"ngIf"],["type","button","mat-icon-button","","matTooltip","Imprimir",1,"w-8","h-8","leading-none","flex","items-center","justify-center","hover:bg-hover",3,"click"],["type","button","mat-icon-button","","matTooltip","PDF",1,"w-8","h-8","leading-none","flex","items-center","justify-center","ml-1","hover:bg-hover",3,"click"],["type","button","mat-icon-button","","matTooltip","Descargar",1,"w-8","h-8","leading-none","flex","items-center","justify-center","ml-1","hover:bg-hover",3,"click"],["mat-header-row",""],["mat-row","",1,"hover:bg-hover","trans-ease-out","cursor-pointer",3,"click"],["mat-footer-row","",3,"ngClass"]],template:function(t,e){if(1&t&&(m.Wb(0,"vex-page-layout"),m.Wb(1,"vex-page-layout-header",0),m.Wb(2,"div",1),m.Wb(3,"div"),m.Wb(4,"h1",2),m.Gc(5,"Ventas"),m.Vb(),m.Rb(6,"vex-breadcrumbs",3),m.Vb(),m.Wb(7,"div"),m.Wb(8,"button",4),m.ec("click",(function(){return e.descargar()})),m.Rb(9,"mat-icon",5),m.Gc(10," Descargar "),m.Vb(),m.Wb(11,"button",6),m.Rb(12,"mat-icon",5),m.Vb(),m.Wb(13,"button",7),m.Rb(14,"mat-icon",5),m.Gc(15," Nuevo "),m.Vb(),m.Wb(16,"button",8),m.Rb(17,"mat-icon",5),m.Vb(),m.Wb(18,"mat-menu",null,9),m.Wb(20,"button",10),m.Rb(21,"mat-icon",5),m.Gc(22," Factura "),m.Vb(),m.Wb(23,"button",10),m.Rb(24,"mat-icon",5),m.Gc(25," Boleta de venta "),m.Vb(),m.Wb(26,"button",10),m.Rb(27,"mat-icon",5),m.Gc(28," Nota de cr\xe9dito "),m.Vb(),m.Wb(29,"button",10),m.Rb(30,"mat-icon",5),m.Gc(31," Nota de d\xe9bito "),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Wb(32,"vex-page-layout-content",11),m.Wb(33,"div",12),m.Wb(34,"div",13),m.Wb(35,"form",14),m.ec("ngSubmit",(function(){return e.index(!0)})),m.Wb(36,"mat-select",15),m.Wb(37,"mat-option",16),m.Gc(38,"Todos"),m.Vb(),m.Ec(39,oo,2,2,"mat-option",17),m.Vb(),m.Rb(40,"input",18),m.Rb(41,"input",19),m.Wb(42,"button",20),m.Rb(43,"mat-icon",21),m.Vb(),m.Vb(),m.Wb(44,"div",22),m.Rb(45,"input",23,24),m.Wb(47,"mat-autocomplete",25,26),m.ec("optionSelected",(function(){return e.index(!0)})),m.Ec(49,ao,2,0,"mat-option",27),m.Ec(50,io,5,3,"ng-container",28),m.Vb(),m.Ec(51,co,2,1,"button",29),m.Ec(52,ro,2,1,"button",30),m.Vb(),m.Wb(53,"div",31),m.Rb(54,"input",32),m.Rb(55,"mat-datepicker-toggle",33),m.Rb(56,"mat-datepicker",null,34),m.Rb(58,"input",35),m.Rb(59,"mat-datepicker-toggle",33),m.Rb(60,"mat-datepicker",null,36),m.Vb(),m.Vb(),m.Wb(62,"div",37),m.Ec(63,lo,2,0,"div",38),m.Wb(64,"table",39,40),m.Ub(67,41),m.Ec(68,uo,2,0,"th",42),m.Ec(69,bo,2,4,"td",43),m.Tb(),m.Ub(70,44),m.Ec(71,mo,2,0,"th",42),m.Ec(72,po,2,4,"td",43),m.Tb(),m.Ub(73,45),m.Ec(74,fo,2,0,"th",46),m.Ec(75,vo,2,4,"td",47),m.Tb(),m.Ub(76,48),m.Ec(77,go,2,0,"th",46),m.Ec(78,ho,2,1,"td",49),m.Tb(),m.Ub(79,50),m.Ec(80,Vo,2,0,"th",42),m.Ec(81,Co,2,4,"td",43),m.Tb(),m.Ub(82,51),m.Ec(83,xo,2,0,"th",42),m.Ec(84,Wo,2,4,"td",43),m.Tb(),m.Ub(85,52),m.Ec(86,yo,2,0,"th",42),m.Ec(87,wo,2,4,"td",43),m.Tb(),m.Ub(88,53),m.Ec(89,Fo,2,0,"th",42),m.Ec(90,ko,5,7,"td",43),m.Tb(),m.Ub(91,54),m.Ec(92,Ro,2,0,"th",42),m.Ec(93,So,2,4,"td",43),m.Tb(),m.Ub(94,55),m.Ec(95,_o,2,0,"th",42),m.Ec(96,Lo,2,1,"td",56),m.Tb(),m.Ub(97,57),m.Ec(98,Do,2,0,"th",42),m.Ec(99,Ao,2,1,"td",56),m.Tb(),m.Ub(100,58),m.Ec(101,No,2,0,"th",42),m.Ec(102,Qo,24,13,"td",56),m.Tb(),m.Ub(103,59),m.Ec(104,Bo,2,0,"mat-footer-cell",60),m.Tb(),m.Ec(105,zo,1,0,"tr",61),m.Ec(106,Ho,1,0,"tr",62),m.Ec(107,$o,1,3,"tr",63),m.Vb(),m.Rb(108,"mat-paginator",64,65),m.Vb(),m.Vb(),m.Vb(),m.Vb()),2&t){var o=m.uc(19),a=m.uc(48),n=m.uc(57),i=m.uc(61);m.Cb(6),m.oc("crumbs",m.pc(40,Ko)),m.Cb(3),m.oc("icIcon",e.icCloudDownload),m.Cb(3),m.oc("icIcon",e.icCloudDownload),m.Cb(1),m.oc("matMenuTriggerFor",o),m.Cb(1),m.oc("icIcon",e.icAdd),m.Cb(2),m.oc("matMenuTriggerFor",o),m.Cb(1),m.oc("icIcon",e.icAdd),m.Cb(3),m.oc("routerLink",m.pc(41,Jo)),m.Cb(1),m.oc("icIcon",e.icInsertDriveFile),m.Cb(2),m.oc("routerLink",m.pc(42,Yo)),m.Cb(1),m.oc("icIcon",e.icInsertDriveFile),m.Cb(2),m.oc("routerLink",m.pc(43,Zo)),m.Cb(1),m.oc("icIcon",e.icInsertDriveFile),m.Cb(2),m.oc("routerLink",m.pc(44,ta)),m.Cb(1),m.oc("icIcon",e.icInsertDriveFile),m.Cb(5),m.oc("formGroup",e.searchForm),m.Cb(2),m.oc("value",null),m.Cb(2),m.oc("ngForOf",m.sc(49,ia,m.pc(45,ea),m.pc(46,oa),m.pc(47,aa),m.pc(48,na))),m.Cb(4),m.oc("icIcon",e.icSearch),m.Cb(2),m.oc("matAutocomplete",a)("formControl",e.cliente),m.Cb(2),m.oc("displayWith",e.displaySearchEntidad),m.Cb(2),m.oc("ngIf",e.isLoadingSearch),m.Cb(1),m.oc("ngIf",!e.isLoadingSearch),m.Cb(1),m.oc("ngIf",!e.cliente.value),m.Cb(1),m.oc("ngIf",e.cliente.value),m.Cb(2),m.oc("formControl",e.fechaemisionFrom)("matDatepicker",n),m.Cb(1),m.oc("for",n),m.Cb(3),m.oc("formControl",e.fechaemisionTo)("matDatepicker",i),m.Cb(1),m.oc("for",i),m.Cb(4),m.oc("ngIf",e.loadVenta),m.Cb(1),m.oc("dataSource",e.dsVenta),m.Cb(41),m.oc("matHeaderRowDef",e.dcVenta),m.Cb(1),m.oc("matRowDefColumns",e.dcVenta),m.Cb(1),m.oc("matFooterRowDef",m.pc(54,ca)),m.Cb(1),m.oc("length",e.rLengthVenta)("pageSizeOptions",e.pSizeOptVenta)("pageSize",e.pSizeVenta)}},directives:[Qe.a,Be.a,I.c,I.b,ze.a,E.b,G.a,He.b,k.a,R.a,et.c,et.d,et.a,i.g,Xe.a,c.w,c.q,I.a,c.i,Ae.a,c.p,c.g,Ne.n,w.o,le.b,c.b,$e.c,c.f,$e.a,w.p,Ue.b,Ue.d,re.j,Ue.a,Me.n,Ke.a,Me.c,Me.i,Me.b,Me.e,Me.k,Me.m,Me.g,Je.a,Ye.b,Me.h,Me.a,He.a,w.m,Ke.b,w.r,w.s,S.a,Me.d,Me.j,Me.l,Me.f],pipes:[Ze.a],styles:["vex-ventas .loading-container{position:relative}vex-ventas .loading-shade{position:absolute;top:0;left:0;bottom:56px;right:0;background:rgba(0,0,0,.15);z-index:1;display:flex;align-items:center;justify-content:center}vex-ventas .hide{display:none}"],encapsulation:2}),Uo),la=o("JX91"),ua=o("lJxs"),sa=o("0np6"),da=o("1jcm");function ba(t,e){if(1&t&&(m.Wb(0,"mat-option",20),m.Gc(1),m.Vb()),2&t){var o=e.$implicit;m.oc("value",o.id),m.Cb(1),m.Ic(" ",o.nombre," ")}}var ma,pa,fa,va=((fa=function(){function t(e,o,a){_classCallCheck(this,t),this._data=e,this.matDialogRef=o,this._datainicial=a,this.formatos=this._datainicial.formatos,this.icClose=x.a,this._data=this._data.venta}return _createClass(t,[{key:"ngOnInit",value:function(){this.generalForm=this.createForm()}},{key:"createForm",value:function(){return new c.h({tipocambio:new c.e(this._data.tipocambio),placavehiculo:new c.e(this._data.placavehiculo),pdfformato:new c.e(this._data.pdfformato),detraccion:new c.e(this._data.detraccion),selvaproducto:new c.e(this._data.selvaproducto),selvaservicio:new c.e(this._data.selvaservicio),guiatransportista:new c.e(this._data.guiatransportista)})}},{key:"save",value:function(){var t;t=this.generalForm.getRawValue(),this.matDialogRef.close(t)}}]),t}()).\u0275fac=function(t){return new(t||fa)(m.Qb(b.a),m.Qb(b.g),m.Qb(ce.a))},fa.\u0275cmp=m.Kb({type:fa,selectors:[["vex-ventas-general"]],decls:40,vars:4,consts:[[3,"formGroup","ngSubmit"],["fxLayout","row","fxLayoutAlign","start center","mat-dialog-title",""],["fxFlex","auto",1,"headline","m-0"],["mat-dialog-close","","mat-icon-button","","type","button",1,"text-secondary"],[3,"icIcon"],[1,"-mx-6","text-border"],["fxLayout","column"],["fxLayout","row","fxLayout.lt-sm","column","fxLayoutGap","16px","fxLayoutGap.lt-sm","0"],["appearance","standard","fxFlex","auto"],["matInput","","formControlName","placavehiculo"],["formControlName","pdfformato"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","guiatransportista"],["matInput","","type","number","formControlName","tipocambio"],["formControlName","detraccion"],["formControlName","selvaproducto"],["formControlName","selvaservicio"],["align","end"],["mat-button","","mat-dialog-close","","type","button"],["color","primary","mat-raised-button","","type","submit",3,"disabled"],[3,"value"]],template:function(t,e){1&t&&(m.Wb(0,"form",0),m.ec("ngSubmit",(function(){return e.save()})),m.Wb(1,"div",1),m.Wb(2,"h2",2),m.Gc(3,"Datos generales"),m.Vb(),m.Wb(4,"button",3),m.Rb(5,"mat-icon",4),m.Vb(),m.Vb(),m.Rb(6,"mat-divider",5),m.Wb(7,"mat-dialog-content",6),m.Wb(8,"div",7),m.Wb(9,"mat-form-field",8),m.Wb(10,"mat-label"),m.Gc(11,"Placa de veh\xedculo"),m.Vb(),m.Rb(12,"input",9),m.Vb(),m.Wb(13,"mat-form-field",8),m.Wb(14,"mat-label"),m.Gc(15,"Formato impresi\xf3n"),m.Vb(),m.Wb(16,"mat-select",10),m.Ec(17,ba,2,2,"mat-option",11),m.Vb(),m.Vb(),m.Vb(),m.Wb(18,"div",7),m.Wb(19,"mat-form-field",8),m.Wb(20,"mat-label"),m.Gc(21,"Gu\xeda transportista"),m.Vb(),m.Rb(22,"input",12),m.Vb(),m.Wb(23,"mat-form-field",8),m.Wb(24,"mat-label"),m.Gc(25,"Tipo de cambio"),m.Vb(),m.Rb(26,"input",13),m.Vb(),m.Vb(),m.Wb(27,"fieldset"),m.Wb(28,"div",6),m.Wb(29,"mat-slide-toggle",14),m.Gc(30," Comprobante sujeto a detracci\xf3n? "),m.Vb(),m.Wb(31,"mat-slide-toggle",15),m.Gc(32," Bienes regi\xf3n selva? "),m.Vb(),m.Wb(33,"mat-slide-toggle",16),m.Gc(34," Servicios regi\xf3n selva? "),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Wb(35,"mat-dialog-actions",17),m.Wb(36,"button",18),m.Gc(37,"CERRAR"),m.Vb(),m.Wb(38,"button",19),m.Gc(39,"ACEPTAR"),m.Vb(),m.Vb(),m.Vb()),2&t&&(m.oc("formGroup",e.generalForm),m.Cb(5),m.oc("icIcon",e.icClose),m.Cb(12),m.oc("ngForOf",e.formatos),m.Cb(21),m.oc("disabled",e.generalForm.invalid))},directives:[c.w,c.q,c.i,I.c,I.b,b.h,I.a,E.b,b.d,k.a,R.a,S.a,b.e,I.d,re.d,re.h,le.b,c.b,c.p,c.g,Ae.a,w.o,c.s,da.a,b.c,Ne.n],styles:["@media (min-width:960px){.ventasgeneral-form-dialog{width:480px}}.ventasgeneral-form-dialog fieldset{border:1px solid #ccc;border-radius:8px;padding:8px}.ventasgeneral-form-dialog fieldset legend{padding:0 8px}"],encapsulation:2}),fa),ga=((pa=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||pa)},pa.\u0275cmp=m.Kb({type:pa,selectors:[["vex-ventas-guia"]],decls:2,vars:0,template:function(t,e){1&t&&(m.Wb(0,"p"),m.Gc(1," ventas-guia works!\n"),m.Vb())},styles:[""]}),pa),ha=((ma=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||ma)},ma.\u0275cmp=m.Kb({type:ma,selectors:[["vex-ventas-formato"]],decls:2,vars:0,template:function(t,e){1&t&&(m.Wb(0,"p"),m.Gc(1," ventas-formato works!\n"),m.Vb())},styles:[""]}),ma),Va=["producto"];function Ca(t,e){if(1&t&&(m.Wb(0,"mat-option",21),m.Wb(1,"div",33),m.Wb(2,"small",34),m.Gc(3),m.jc(4,"uppercase"),m.Vb(),m.Wb(5,"small",35),m.Gc(6),m.Vb(),m.Wb(7,"small",35),m.Gc(8),m.Vb(),m.Vb(),m.Vb()),2&t){var o=e.$implicit;m.oc("value",o),m.Cb(3),m.Hc(m.kc(4,4,o.nombre)),m.Cb(3),m.Hc(o.codigo),m.Cb(2),m.Ic("S/. ",o.precio,"")}}function xa(t,e){if(1&t&&m.Rb(0,"mat-icon",36),2&t){var o=m.ic();m.oc("icIcon",o.icSearch)}}function Wa(t,e){if(1&t){var o=m.Xb();m.Wb(0,"mat-icon",37),m.ec("click",(function(){return m.wc(o),m.ic().itemForm.get("producto").setValue("")})),m.Vb()}if(2&t){var a=m.ic();m.oc("icIcon",a.icClose)}}function ya(t,e){1&t&&(m.Wb(0,"mat-error"),m.Gc(1," Requerido! "),m.Vb())}function wa(t,e){if(1&t&&(m.Wb(0,"mat-option",21),m.Gc(1),m.Vb()),2&t){var o=e.$implicit;m.oc("value",o.idimpuesto),m.Cb(1),m.Ic(" ",o.nombre," ")}}function Fa(t,e){1&t&&(m.Wb(0,"mat-error"),m.Gc(1," Requerido! "),m.Vb())}function Ia(t,e){1&t&&(m.Wb(0,"mat-error"),m.Gc(1," Requerido! "),m.Vb())}function Ea(t,e){1&t&&(m.Wb(0,"mat-error"),m.Gc(1," Requerido! "),m.Vb())}function Ga(t,e){1&t&&(m.Wb(0,"mat-error"),m.Gc(1," Requerido! "),m.Vb())}var ka,Ra=((ka=function(){function t(e,o,a){_classCallCheck(this,t),this._data=e,this.matDialogRef=o,this._utils=a,this.productos=[],this.stock=new c.e({value:null,disabled:!0}),this.icClose=x.a,this.icSearch=Ce.a}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.itemForm=this.createForm(),this.itemForm.controls.idimpuesto.valueChanges.subscribe((function(e){var o=t.itemForm.get("idimpuesto").value||0,a=t.itemForm.get("preciounit").value||0,n=t.itemForm.get("cantidad").value||0,i=t.itemForm.get("descuento").value||0;t.calculoItem(o,a,n,i)})),this.itemForm.controls.cantidad.valueChanges.subscribe((function(e){var o=t.itemForm.get("idimpuesto").value||0,a=t.itemForm.get("preciounit").value||0,n=e||0,i=t.itemForm.get("descuento").value||0;t.calculoItem(o,a,n,i)})),this.itemForm.controls.preciounit.valueChanges.subscribe((function(e){var o=t.itemForm.get("idimpuesto").value||0,a=e||0,n=t.itemForm.get("cantidad").value||0,i=t.itemForm.get("descuento").value||0;t.calculoItem(o,a,n,i)})),this.itemForm.controls.descuento.valueChanges.subscribe((function(e){var o=t.itemForm.get("idimpuesto").value||0,a=t.itemForm.get("preciounit").value||0,n=t.itemForm.get("cantidad").value||0;t.calculoItem(o,a,n,e||0)})),this.filteredOptions=this.itemForm.controls.producto.valueChanges.pipe(Object(la.a)(""),Object(ua.a)((function(t){return"string"==typeof t||null===t?t:t.nombre})),Object(ua.a)((function(e){return e?t._filterStates(e):t._data.productos.slice()}))),this.itemForm.controls.producto.valueChanges.subscribe((function(e){console.log("ValueChange: ",e),"string"==typeof e&&(t.itemForm.get("idimpuesto").setValue(null,{emitEvent:!1}),t.itemForm.get("cantidad").setValue(null,{emitEvent:!1}),t.itemForm.get("preciounit").setValue(null,{emitEvent:!1}),t.itemForm.get("valorunit").setValue(null,{emitEvent:!1}),t.itemForm.get("descuento").setValue(null,{emitEvent:!1}),t.itemForm.get("valorventa").setValue(null,{emitEvent:!1}),t.itemForm.get("montototalimpuestos").setValue(null,{emitEvent:!1}),t.itemForm.get("total").setValue(null,{emitEvent:!1}),t.stock.setValue(null))})),this._data.item.producto&&setTimeout((function(){t.itemForm.get("producto").updateValueAndValidity()}),100),this._data.item.producto||setTimeout((function(){}),300)}},{key:"_filterStates",value:function(t){var e=t.toLowerCase();return console.log("filterValue: ",e),this._data.productos.filter((function(t){return 0===t.nombre.toLowerCase().indexOf(e)}))}},{key:"calculoItem",value:function(t,e,o,a){var n=this._utils.calculoLinea(t,e,o,a);this.itemForm.get("valorunit").setValue(n.valorunit,{emitEvent:!1}),this.itemForm.get("valorventa").setValue(n.subtotal,{emitEvent:!1}),this.itemForm.get("montototalimpuestos").setValue(n.montototalimpuestos,{emitEvent:!1}),this.itemForm.get("total").setValue(n.total,{emitEvent:!1})}},{key:"createForm",value:function(){return new c.h({producto:new c.e(this._data.item.producto,[c.v.required]),descripcion:new c.e(this._data.item.descripcion||null),idimpuesto:new c.e(this._data.item.idimpuesto||null,[c.v.required]),preciounit:new c.e(this._data.item.preciounit||null,[c.v.required]),cantidad:new c.e(this._data.item.cantidad||null,[c.v.required]),valorunit:new c.e(this._data.item.valorunit||null,[c.v.required]),descuento:new c.e(this._data.item.descuento||null),valorventa:new c.e(this._data.item.valorventa,[c.v.required]),montototalimpuestos:new c.e(this._data.item.montototalimpuestos,[c.v.required]),total:new c.e(this._data.item.total,[c.v.required])})}},{key:"displayProductoFn",value:function(t){return t?t.nombre:void 0}},{key:"autocompletadoProductoSelected",value:function(t){console.log("OPTION",t);var e=parseFloat(t.precio),o=this._utils.calculoLinea(t.idimpuesto,e,1);this.itemForm.get("cantidad").setValue(1,{emitEvent:!1}),this.itemForm.get("preciounit").setValue(e,{emitEvent:!1}),this.itemForm.get("valorunit").setValue(o.valorunit,{emitEvent:!1}),this.itemForm.get("valorventa").setValue(o.subtotal,{emitEvent:!1}),this.itemForm.get("montototalimpuestos").setValue(o.montototalimpuestos,{emitEvent:!1}),this.itemForm.get("total").setValue(o.total,{emitEvent:!1}),this.itemForm.get("idimpuesto").setValue(t.idimpuesto,{emitEvent:!1}),this.stock.setValue(t.codigo)}},{key:"save",value:function(){var t;t=this.itemForm.getRawValue(),this.matDialogRef.close(t)}}]),t}()).\u0275fac=function(t){return new(t||ka)(m.Qb(b.a),m.Qb(b.g),m.Qb(Y.a))},ka.\u0275cmp=m.Kb({type:ka,selectors:[["vex-ventas-item"]],viewQuery:function(t,e){var o;1&t&&m.Nc(Va,!0),2&t&&m.tc(o=m.fc())&&(e.productoElement=o.first)},decls:72,vars:21,consts:[[3,"formGroup","ngSubmit"],["fxLayout","row","fxLayoutAlign","start center","mat-dialog-title",""],["fxFlex","auto",1,"headline","m-0"],["mat-dialog-close","","mat-icon-button","","type","button",1,"text-secondary"],[3,"icIcon"],[1,"-mx-6","text-border"],["fxLayout","column"],["appearance","standard"],["matInput","","formControlName","producto",3,"matAutocomplete"],["producto",""],["autoActiveFirstOption","",3,"displayWith","optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["matSuffix","",3,"icIcon",4,"ngIf"],["matSuffix","","class","cursor-pointer",3,"icIcon","click",4,"ngIf"],[4,"ngIf"],["matInput","","formControlName","descripcion"],[1,"mt-4"],["fxLayout","row","fxLayout.lt-sm","column","fxLayoutGap","16px","fxLayoutGap.lt-sm","0"],["appearance","standard","fxFlex","auto"],["placeholder","Tipo IGV","name","idimpuesto","formControlName","idimpuesto"],[3,"value"],["fxFlex","auto"],["matInput","",3,"formControl"],["matInput","","type","number","formControlName","cantidad"],["matInput","","type","number","formControlName","preciounit"],["matInput","","type","number","formControlName","descuento"],["matInput","","type","number","name","valorventa","formControlName","valorventa",3,"readonly"],["matInput","","type","number","name","montototalimpuestos","formControlName","montototalimpuestos",3,"readonly"],["matInput","","type","number","name","total","formControlName","total",3,"readonly"],["align","end"],["mat-button","","mat-dialog-close","","type","button"],["color","primary","mat-button","","type","submit",3,"disabled"],["fxLayout","row","fxLayoutAlign","space-between center"],["fxFlex","80"],["fxFlex","10"],["matSuffix","",3,"icIcon"],["matSuffix","",1,"cursor-pointer",3,"icIcon","click"]],template:function(t,e){if(1&t&&(m.Wb(0,"form",0),m.ec("ngSubmit",(function(){return e.save()})),m.Wb(1,"div",1),m.Wb(2,"h2",2),m.Gc(3,"Detalle de linea"),m.Vb(),m.Wb(4,"button",3),m.Rb(5,"mat-icon",4),m.Vb(),m.Vb(),m.Rb(6,"mat-divider",5),m.Wb(7,"mat-dialog-content",6),m.Wb(8,"mat-form-field",7),m.Wb(9,"mat-label"),m.Gc(10,"Producto / servicio"),m.Vb(),m.Rb(11,"input",8,9),m.Wb(13,"mat-autocomplete",10,11),m.ec("optionSelected",(function(t){return e.autocompletadoProductoSelected(t.option.value)})),m.Ec(15,Ca,9,6,"mat-option",12),m.jc(16,"async"),m.Vb(),m.Ec(17,xa,1,1,"mat-icon",13),m.Ec(18,Wa,1,1,"mat-icon",14),m.Ec(19,ya,2,0,"mat-error",15),m.Vb(),m.Wb(20,"mat-form-field",7),m.Wb(21,"mat-label"),m.Gc(22,"Descripci\xf3n adicional"),m.Vb(),m.Rb(23,"input",16),m.Vb(),m.Wb(24,"fieldset",17),m.Wb(25,"div",18),m.Wb(26,"mat-form-field",19),m.Wb(27,"mat-label"),m.Gc(28,"Tipo IGV"),m.Vb(),m.Wb(29,"mat-select",20),m.Wb(30,"mat-option",21),m.Gc(31,"Seleccione"),m.Vb(),m.Ec(32,wa,2,2,"mat-option",12),m.Vb(),m.Ec(33,Fa,2,0,"mat-error",15),m.Vb(),m.Wb(34,"mat-form-field",22),m.Wb(35,"mat-label"),m.Gc(36,"Stock actual disponible"),m.Vb(),m.Rb(37,"input",23),m.Vb(),m.Vb(),m.Wb(38,"div",18),m.Wb(39,"mat-form-field",19),m.Wb(40,"mat-label"),m.Gc(41,"Cantidad"),m.Vb(),m.Rb(42,"input",24),m.Ec(43,Ia,2,0,"mat-error",15),m.Vb(),m.Wb(44,"mat-form-field",19),m.Wb(45,"mat-label"),m.Gc(46,"Precio unitario"),m.Vb(),m.Rb(47,"input",25),m.Ec(48,Ea,2,0,"mat-error",15),m.Vb(),m.Wb(49,"mat-form-field",19),m.Wb(50,"mat-label"),m.Gc(51,"Descuento sin IGV(Opcional)"),m.Vb(),m.Rb(52,"input",26),m.Ec(53,Ga,2,0,"mat-error",15),m.Vb(),m.Vb(),m.Wb(54,"div",18),m.Wb(55,"mat-form-field",19),m.Wb(56,"mat-label"),m.Gc(57,"Sub total"),m.Vb(),m.Rb(58,"input",27),m.Vb(),m.Wb(59,"mat-form-field",19),m.Wb(60,"mat-label"),m.Gc(61,"Igv"),m.Vb(),m.Rb(62,"input",28),m.Vb(),m.Wb(63,"mat-form-field",19),m.Wb(64,"mat-label"),m.Gc(65,"Total"),m.Vb(),m.Rb(66,"input",29),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Wb(67,"mat-dialog-actions",30),m.Wb(68,"button",31),m.Gc(69,"CERRAR"),m.Vb(),m.Wb(70,"button",32),m.Gc(71,"GUARDAR"),m.Vb(),m.Vb(),m.Vb()),2&t){var o=m.uc(14);m.oc("formGroup",e.itemForm),m.Cb(5),m.oc("icIcon",e.icClose),m.Cb(6),m.oc("matAutocomplete",o),m.Cb(2),m.oc("displayWith",e.displayProductoFn),m.Cb(2),m.oc("ngForOf",m.kc(16,19,e.filteredOptions)),m.Cb(2),m.oc("ngIf",!e.itemForm.get("producto").value),m.Cb(1),m.oc("ngIf",e.itemForm.get("producto").value),m.Cb(1),m.oc("ngIf",e.itemForm.get("producto").hasError("required")),m.Cb(11),m.oc("value",null),m.Cb(2),m.oc("ngForOf",e._data.impuestos),m.Cb(1),m.oc("ngIf",e.itemForm.get("idimpuesto").hasError("required")),m.Cb(4),m.oc("formControl",e.stock),m.Cb(6),m.oc("ngIf",e.itemForm.get("cantidad").hasError("required")),m.Cb(5),m.oc("ngIf",e.itemForm.get("preciounit").hasError("required")),m.Cb(5),m.oc("ngIf",e.itemForm.get("descuento").hasError("required")),m.Cb(5),m.oc("readonly",!0),m.Cb(4),m.oc("readonly",!0),m.Cb(4),m.oc("readonly",!0),m.Cb(4),m.oc("disabled",e.itemForm.invalid)}},directives:[c.w,c.q,c.i,I.c,I.b,b.h,I.a,E.b,b.d,k.a,R.a,S.a,b.e,re.d,re.h,le.b,c.b,$e.c,c.p,c.g,$e.a,w.o,w.p,I.d,Ae.a,Ne.n,c.f,c.s,b.c,re.j,re.c],pipes:[w.b,w.x],styles:["@media (min-width:600px){.ventasitem-form-dialog{width:100%}}@media (min-width:960px){.ventasitem-form-dialog{width:800px}}.ventasitem-form-dialog fieldset{border:1px solid #ccc;border-radius:8px;padding:8px}.ventasitem-form-dialog fieldset legend{padding:0 8px}"],encapsulation:2}),ka),Sa=o("T7YG"),_a=o.n(Sa),La=o("Ldl7"),Da=o.n(La);function Aa(t,e){if(1&t&&(m.Wb(0,"mat-option",32),m.Gc(1),m.Vb()),2&t){var o=e.$implicit;m.oc("value",o.idmediopago),m.Cb(1),m.Ic(" ",o.nombre," ")}}function Na(t,e){if(1&t&&(m.Wb(0,"mat-error"),m.Gc(1),m.Vb()),2&t){var o=m.ic().index,a=m.ic();m.Cb(1),m.Ic(" M\xednimo ",a.mediopagoForm.get("mediopago").controls[o].controls.importe.errors.min.min," c\xe9ntimos ")}}function Ta(t,e){1&t&&(m.Wb(0,"mat-error"),m.Gc(1," Es requerido "),m.Vb())}function Oa(t,e){if(1&t){var o=m.Xb();m.Wb(0,"div",33),m.Wb(1,"button",34),m.ec("click",(function(){m.wc(o);var t=m.ic().index;return m.ic().deleteItem(t)})),m.Rb(2,"mat-icon",4),m.Vb(),m.Vb()}if(2&t){var a=m.ic(2);m.Cb(2),m.oc("icIcon",a.icDeleteSweep)}}function Pa(t,e){if(1&t&&(m.Wb(0,"fieldset",26),m.Wb(1,"div",17),m.Wb(2,"mat-form-field",18),m.Wb(3,"mat-label"),m.Gc(4,"Tipo"),m.Vb(),m.Wb(5,"mat-select",27),m.Ec(6,Aa,2,2,"mat-option",28),m.Vb(),m.Vb(),m.Wb(7,"mat-form-field",18),m.Wb(8,"mat-label"),m.Gc(9,"Importe"),m.Vb(),m.Rb(10,"input",29),m.Ec(11,Na,2,1,"mat-error",22),m.Ec(12,Ta,2,0,"mat-error",22),m.Vb(),m.Vb(),m.Wb(13,"div",17),m.Wb(14,"mat-form-field",18),m.Wb(15,"mat-label"),m.Gc(16,"Nota"),m.Vb(),m.Rb(17,"input",30),m.Vb(),m.Ec(18,Oa,3,1,"div",31),m.Vb(),m.Vb()),2&t){var o=e.index,a=m.ic();m.oc("formGroupName",o),m.Cb(6),m.oc("ngForOf",a.mediosdepago),m.Cb(5),m.oc("ngIf",a.mediopagoForm.get("mediopago").controls[o].controls.importe.hasError("min")),m.Cb(1),m.oc("ngIf",a.mediopagoForm.get("mediopago").controls[o].controls.importe.hasError("required")),m.Cb(6),m.oc("ngIf",a.mediopagoForm.get("mediopago").controls.length>1&&o>0)}}function ja(t,e){if(1&t&&(m.Wb(0,"mat-error"),m.Gc(1),m.Vb()),2&t){var o=m.ic();m.Cb(1),m.Ic(" M\xednimo ",o.mediopagoForm.get("vuelto").errors.min.min," ")}}var qa,Ma=((qa=function(){function t(e,o,a,n){_classCallCheck(this,t),this._data=e,this.matDialogRef=o,this._utils=a,this._datainicial=n,this.mediosdepago=this._datainicial.mediosdepago,this.icAdd=We.a,this.icEdit=P.a,this.icDelete=we.a,this.icClose=x.a,this.icArrowDownward=_a.a,this.icDeleteSweep=Da.a,console.log("_data",e)}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.mediopagoForm=this.createForm(),this.mediopagoForm.get("mediopago").valueChanges.subscribe((function(e){e.forEach((function(e,o){t.calcularTotales()}))})),this.addItem()}},{key:"createForm",value:function(){return new c.h({total:new c.e(this._data.venta.total,[c.v.required]),pagado:new c.e(0,[c.v.required]),vuelto:new c.e(0,[c.v.required,c.v.min(0)]),mediopago:new c.c([])})}},{key:"calcularTotales",value:function(){var t,e=this.mediopagoForm.get("total").value,o=0;this.mediopago.value.forEach((function(t){t.importe&&(o+=t.importe)})),t=this._utils.redondearValor(o-e,2),this.mediopagoForm.get("pagado").setValue(o),this.mediopagoForm.get("vuelto").setValue(t)}},{key:"save",value:function(){var t;t=this.mediopagoForm.getRawValue(),this.matDialogRef.close(t)}},{key:"addItem",value:function(){var t=new c.h({idmediopago:new c.e(1),importe:new c.e("",[c.v.required,c.v.min(.1)]),nota:new c.e("")});this.mediopago.push(t)}},{key:"deleteItem",value:function(t){this.mediopago.removeAt(t)}},{key:"pagoRapido",value:function(t){var e=this,o=!1;if(this.mediopago.value.forEach((function(a,n){if(!o){var i=e.mediopago.at(n).get("importe").value||0;0===i&&(o=!0,i+=t,e.mediopago.at(n).get("importe").setValue(i))}})),!o){var a=this.mediopago.length-1,n=this.mediopago.at(a).get("importe").value||0;n+=t,this.mediopago.at(a).get("importe").setValue(n)}}},{key:"mediopago",get:function(){return this.mediopagoForm.get("mediopago")}}]),t}()).\u0275fac=function(t){return new(t||qa)(m.Qb(b.a),m.Qb(b.g),m.Qb(Y.a),m.Qb(ce.a))},qa.\u0275cmp=m.Kb({type:qa,selectors:[["vex-ventas-mediopago"]],decls:59,vars:14,consts:[[3,"formGroup","ngSubmit"],["fxLayout","row","fxLayoutAlign","start center","mat-dialog-title",""],["fxFlex","auto",1,"headline","m-0"],["mat-dialog-close","","mat-icon-button","","type","button",1,"text-secondary"],[3,"icIcon"],[1,"-mx-6","text-border"],["fxLayout","column"],["fxLayout","row","fxLayout.lt-sm","column"],["fxFlex","75","formArrayName","mediopago"],["class","mt-4",3,"formGroupName",4,"ngFor","ngForOf"],["mat-mini-fab","","type","button","color","accent","matTooltip","Agregar",1,"mt-4",3,"click"],["fxFlex","25"],["fxLayout","column","fxLayoutAlign","space-between center"],[1,"mt-4"],["mat-flat-button","","type","button","color","accent",1,"w-100",3,"click"],["mat-flat-button","","type","button","color","primary",1,"w-100",3,"click"],["mat-flat-button","","type","button","color","warn",1,"w-100",3,"click"],["fxLayout","row","fxLayout.lt-sm","column","fxLayoutGap","16px","fxLayoutGap.lt-sm","0"],["appearance","standard","fxFlex","auto"],["matInput","","type","number","formControlName","pagado",3,"readonly"],["matInput","","type","number","formControlName","total",3,"readonly"],["matInput","","type","number","formControlName","vuelto",3,"readonly"],[4,"ngIf"],["align","end"],["mat-button","","mat-dialog-close","","type","button"],["mat-raised-button","","type","submit","color","primary",3,"disabled"],[1,"mt-4",3,"formGroupName"],["formControlName","idmediopago"],[3,"value",4,"ngFor","ngForOf"],["matInput","","type","number","formControlName","importe"],["matInput","","formControlName","nota"],["fxFlex","10",4,"ngIf"],[3,"value"],["fxFlex","10"],["mat-icon-button","","type","button","color","warn","matTooltip","Eliminarxyz",3,"click"]],template:function(t,e){1&t&&(m.Wb(0,"form",0),m.ec("ngSubmit",(function(){return e.save()})),m.Wb(1,"div",1),m.Wb(2,"h2",2),m.Gc(3,"Medio de pago"),m.Vb(),m.Wb(4,"button",3),m.Rb(5,"mat-icon",4),m.Vb(),m.Vb(),m.Rb(6,"mat-divider",5),m.Wb(7,"mat-dialog-content",6),m.Wb(8,"div",7),m.Wb(9,"div",8),m.Ec(10,Pa,19,5,"fieldset",9),m.Wb(11,"button",10),m.ec("click",(function(){return e.addItem()})),m.Rb(12,"mat-icon",4),m.Vb(),m.Vb(),m.Wb(13,"div",11),m.Wb(14,"div",12),m.Wb(15,"div",13),m.Gc(16,"Pago r\xe1pido"),m.Vb(),m.Rb(17,"mat-icon",4),m.Wb(18,"button",14),m.ec("click",(function(){return e.pagoRapido(e.mediopagoForm.get("total").value)})),m.Gc(19),m.jc(20,"number"),m.Vb(),m.Wb(21,"button",15),m.ec("click",(function(){return e.pagoRapido(1)})),m.Gc(22," S/ 1 "),m.Vb(),m.Wb(23,"button",15),m.ec("click",(function(){return e.pagoRapido(2)})),m.Gc(24," S/ 2 "),m.Vb(),m.Wb(25,"button",15),m.ec("click",(function(){return e.pagoRapido(5)})),m.Gc(26," S/ 5 "),m.Vb(),m.Wb(27,"button",15),m.ec("click",(function(){return e.pagoRapido(10)})),m.Gc(28," S/ 10 "),m.Vb(),m.Wb(29,"button",15),m.ec("click",(function(){return e.pagoRapido(20)})),m.Gc(30," S/ 20 "),m.Vb(),m.Wb(31,"button",15),m.ec("click",(function(){return e.pagoRapido(20)})),m.Gc(32," S/ 50 "),m.Vb(),m.Wb(33,"button",15),m.ec("click",(function(){return e.pagoRapido(100)})),m.Gc(34," S/ 100 "),m.Vb(),m.Wb(35,"button",15),m.ec("click",(function(){return e.pagoRapido(200)})),m.Gc(36," S/ 200 "),m.Vb(),m.Wb(37,"button",16),m.ec("click",(function(){return e.pagoRapido(10)})),m.Gc(38," Limpiar "),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Wb(39,"fieldset",13),m.Wb(40,"div",17),m.Wb(41,"mat-form-field",18),m.Wb(42,"mat-label"),m.Gc(43,"Importe TOTAL pagado"),m.Vb(),m.Rb(44,"input",19),m.Vb(),m.Wb(45,"mat-form-field",18),m.Wb(46,"mat-label"),m.Gc(47,"Importe TOTAL"),m.Vb(),m.Rb(48,"input",20),m.Vb(),m.Wb(49,"mat-form-field",18),m.Wb(50,"mat-label"),m.Gc(51,"Diferencia(Vuelto)"),m.Vb(),m.Rb(52,"input",21),m.Ec(53,ja,2,1,"mat-error",22),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Wb(54,"mat-dialog-actions",23),m.Wb(55,"button",24),m.Gc(56,"CERRAR"),m.Vb(),m.Wb(57,"button",25),m.Gc(58,"EMITIR"),m.Vb(),m.Vb(),m.Vb()),2&t&&(m.oc("formGroup",e.mediopagoForm),m.Cb(5),m.oc("icIcon",e.icClose),m.Cb(5),m.oc("ngForOf",e.mediopagoForm.get("mediopago").controls),m.Cb(2),m.oc("icIcon",e.icAdd),m.Cb(5),m.oc("icIcon",e.icArrowDownward),m.Cb(2),m.Ic(" S/ ",m.lc(20,11,e.mediopagoForm.get("total").value,"1.2-2")," "),m.Cb(25),m.oc("readonly",!0),m.Cb(4),m.oc("readonly",!0),m.Cb(4),m.oc("readonly",!0),m.Cb(1),m.oc("ngIf",e.mediopagoForm.get("vuelto").hasError("min")),m.Cb(4),m.oc("disabled",e.mediopagoForm.invalid))},directives:[c.w,c.q,c.i,I.c,I.b,b.h,I.a,E.b,b.d,k.a,R.a,S.a,b.e,c.d,w.o,G.a,I.d,re.d,re.h,le.b,c.s,c.b,c.p,c.g,w.p,b.c,c.j,Ae.a,Ne.n,re.c],pipes:[w.f],styles:["@media (min-width:600px){.ventasmediopago-form-dialog{width:100%}}@media (min-width:960px){.ventasmediopago-form-dialog{width:640px}}.ventasmediopago-form-dialog table{width:100%}.ventasmediopago-form-dialog fieldset{border:1px solid #ccc;border-radius:8px;padding:8px}.ventasmediopago-form-dialog fieldset legend{padding:0 8px}.ventasmediopago-form-dialog .w-100{width:104px;margin-bottom:4px}"],encapsulation:2}),qa),Qa=["serienc"];function Ba(t,e){1&t&&(m.Wb(0,"span"),m.Gc(1,"Nota de cr\xe9dito"),m.Vb())}function za(t,e){1&t&&(m.Wb(0,"span"),m.Gc(1,"Nota de d\xe9bito"),m.Vb())}function Ha(t,e){if(1&t&&(m.Wb(0,"mat-option",21),m.Gc(1),m.Vb()),2&t){var o=e.$implicit;m.oc("value",o.iddocumentofiscal),m.Cb(1),m.Ic(" ",o.nombre," ")}}function Xa(t,e){1&t&&(m.Wb(0,"mat-error"),m.Gc(1," Es requerido "),m.Vb())}function $a(t,e){1&t&&(m.Wb(0,"mat-error"),m.Gc(1," 4 caracteres "),m.Vb())}function Ua(t,e){1&t&&(m.Wb(0,"mat-error"),m.Gc(1," Es requerido "),m.Vb())}function Ka(t,e){if(1&t&&(m.Wb(0,"mat-option",21),m.Gc(1),m.Vb()),2&t){var o=e.$implicit;m.oc("value",o.id),m.Cb(1),m.Ic(" ",o.nombre," ")}}var Ja,Ya=((Ja=function(){function t(e,o,a){_classCallCheck(this,t),this._data=e,this.matDialogRef=o,this._datainicial=a,this.operaciones=this._datainicial.operaciones,this.comprobantes=this._datainicial.comprobantenc,this.motivos=[],this.icClose=x.a,this.icSearch=Ce.a,console.log(e),10===e.iddocumentofiscal&&(this.motivos=this._datainicial.tipond),13===e.iddocumentofiscal&&(this.motivos=this._datainicial.tiponc)}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;if(this.notacreditoForm=this.createForm(),!this._data.documentonc){var e=this._data.serie.substr(0,1);console.log(e),this.notacreditoForm.get("documentonc").setValue("F"===e?1:2),this.notacreditoForm.get("serienc").setValue(e),setTimeout((function(){t.seriencElement.nativeElement.focus()}),100)}}},{key:"createForm",value:function(){return new c.h({tiponc:new c.e(this._data.tiponc,[c.v.required]),documentonc:new c.e(this._data.documentonc,[c.v.required]),serienc:new c.e(this._data.serienc,[c.v.required,c.v.minLength(3),c.v.maxLength(4)]),numeronc:new c.e(this._data.numeronc,[c.v.required,c.v.min(1)])})}},{key:"selected",value:function(t){var e=this;console.log(t),this.notacreditoForm.get("serienc").setValue(1===t?"F":"B"),setTimeout((function(){e.seriencElement.nativeElement.focus()}),100)}},{key:"save",value:function(){var t;t=this.notacreditoForm.getRawValue(),this.matDialogRef.close(t)}}]),t}()).\u0275fac=function(t){return new(t||Ja)(m.Qb(b.a),m.Qb(b.g),m.Qb(ce.a))},Ja.\u0275cmp=m.Kb({type:Ja,selectors:[["vex-ventas-notacredito"]],viewQuery:function(t,e){var o;1&t&&m.Nc(Qa,!0),2&t&&m.tc(o=m.fc())&&(e.seriencElement=o.first)},decls:38,vars:10,consts:[[3,"formGroup","ngSubmit"],["fxLayout","row","fxLayoutAlign","start center","mat-dialog-title",""],["fxFlex","auto",1,"headline","m-0"],[4,"ngIf"],["mat-dialog-close","","mat-icon-button","","type","button",1,"text-secondary"],[3,"icIcon"],[1,"-mx-6","text-border"],["fxLayout","column"],["fxLayout","row","fxLayout.lt-sm","column","fxLayoutGap","16px","fxLayoutGap.lt-sm","0"],["appearance","standard","floatLabel","always","fxFlex","50"],["formControlName","documentonc",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["appearance","standard","floatLabel","always","fxFlex","25"],["matInput","","type","text","formControlName","serienc"],["serienc",""],["matInput","","type","number","formControlName","numeronc"],["appearance","standard","floatLabel","always","fxFlex",""],["placeholder","Motivo de emisi\xf3n","name","tiponc","formControlName","tiponc"],["align","end"],["mat-button","","mat-dialog-close","","type","button"],["color","primary","mat-raised-button","","type","submit",3,"disabled"],[3,"value"]],template:function(t,e){1&t&&(m.Wb(0,"form",0),m.ec("ngSubmit",(function(){return e.save()})),m.Wb(1,"div",1),m.Wb(2,"h2",2),m.Gc(3," Comprobante a emitir "),m.Ec(4,Ba,2,0,"span",3),m.Ec(5,za,2,0,"span",3),m.Vb(),m.Wb(6,"button",4),m.Rb(7,"mat-icon",5),m.Vb(),m.Vb(),m.Rb(8,"mat-divider",6),m.Wb(9,"mat-dialog-content",7),m.Wb(10,"div",8),m.Wb(11,"mat-form-field",9),m.Wb(12,"mat-label"),m.Gc(13,"Comprobante"),m.Vb(),m.Wb(14,"mat-select",10),m.ec("selectionChange",(function(t){return e.selected(t.value)})),m.Ec(15,Ha,2,2,"mat-option",11),m.Vb(),m.Vb(),m.Wb(16,"mat-form-field",12),m.Wb(17,"mat-label"),m.Gc(18,"Serie"),m.Vb(),m.Rb(19,"input",13,14),m.Ec(21,Xa,2,0,"mat-error",3),m.Ec(22,$a,2,0,"mat-error",3),m.Vb(),m.Wb(23,"mat-form-field",12),m.Wb(24,"mat-label"),m.Gc(25,"N\xfamero"),m.Vb(),m.Rb(26,"input",15),m.Ec(27,Ua,2,0,"mat-error",3),m.Vb(),m.Vb(),m.Wb(28,"mat-form-field",16),m.Wb(29,"mat-label"),m.Gc(30,"Motivo de emisi\xf3n "),m.Vb(),m.Wb(31,"mat-select",17),m.Ec(32,Ka,2,2,"mat-option",11),m.Vb(),m.Vb(),m.Vb(),m.Wb(33,"mat-dialog-actions",18),m.Wb(34,"button",19),m.Gc(35,"CERRAR"),m.Vb(),m.Wb(36,"button",20),m.Gc(37,"ACEPTAR"),m.Vb(),m.Vb(),m.Vb()),2&t&&(m.oc("formGroup",e.notacreditoForm),m.Cb(4),m.oc("ngIf",13===e._data.iddocumentofiscal),m.Cb(1),m.oc("ngIf",10===e._data.iddocumentofiscal),m.Cb(2),m.oc("icIcon",e.icClose),m.Cb(8),m.oc("ngForOf",e.comprobantes),m.Cb(6),m.oc("ngIf",e.notacreditoForm.get("serienc").hasError("required")),m.Cb(1),m.oc("ngIf",e.notacreditoForm.get("serienc").hasError("minlength")||e.notacreditoForm.get("serienc").hasError("maxlength")),m.Cb(5),m.oc("ngIf",e.notacreditoForm.get("numeronc").hasError("required")),m.Cb(5),m.oc("ngForOf",e.motivos),m.Cb(4),m.oc("disabled",e.notacreditoForm.invalid))},directives:[c.w,c.q,c.i,I.c,I.b,b.h,I.a,w.p,E.b,b.d,k.a,R.a,S.a,b.e,I.d,re.d,re.h,Ae.a,c.p,c.g,w.o,le.b,c.b,c.s,b.c,Ne.n,re.c],styles:["@media (min-width:960px){.ventasnotacredito-form-dialog{width:480px}}.ventasnotacredito-form-dialog fieldset{border:1px solid #ccc;border-radius:8px;padding:8px}.ventasnotacredito-form-dialog fieldset legend{padding:0 8px}"],encapsulation:2}),Ja),Za=o("LExC"),tn=o("dGNC"),en=o("hF2C"),on=o.n(en),an=o("rw17"),nn=o.n(an),cn=o("m2C8"),rn=o.n(cn),ln=o("QcxM"),un=o.n(ln),sn=o("dVfw"),dn=o("GPUG"),bn=o("Wp6s"),mn=o("zkoq");function pn(t,e){if(1&t&&(m.Wb(0,"span"),m.Gc(1),m.Vb()),2&t){var o=m.ic();m.Cb(1),m.Lc(" ",o.ventaForm.get("comprobante").value.documentofiscal.nombre," ",o.ventaForm.get("comprobante").value.serie," - ",o.ventaForm.get("comprobante").value.numero," | ",o.ventaForm.valid," ")}}function fn(t,e){if(1&t&&(m.Wb(0,"mat-option",24),m.Wb(1,"div",67),m.Wb(2,"span",71),m.Gc(3),m.Vb(),m.Wb(4,"span",72),m.Gc(5),m.Vb(),m.Vb(),m.Vb()),2&t){var o=e.$implicit;m.oc("value",o),m.Cb(3),m.Ic("",o.documentofiscal.nombre," "),m.Cb(2),m.Jc("",o.serie," - ",o.numero,"")}}function vn(t,e){1&t&&(m.Wb(0,"mat-error"),m.Gc(1," Requerido! "),m.Vb())}function gn(t,e){1&t&&(m.Wb(0,"mat-error"),m.Gc(1," Requerido! "),m.Vb())}function hn(t,e){if(1&t&&(m.Wb(0,"mat-option",24),m.Gc(1),m.Vb()),2&t){var o=e.$implicit;m.oc("value",o.moneda),m.Cb(1),m.Ic(" ",o.nombre," ")}}function Vn(t,e){1&t&&(m.Wb(0,"mat-error"),m.Gc(1," Requerido! "),m.Vb())}function Cn(t,e){1&t&&(m.Wb(0,"span"),m.Gc(1,' "Factura '),m.Vb())}function xn(t,e){1&t&&(m.Wb(0,"span"),m.Gc(1,' "Boleta de venta '),m.Vb())}function Wn(t,e){if(1&t&&(m.Wb(0,"span"),m.Gc(1),m.Vb()),2&t){var o=m.ic(2);m.Cb(1),m.Jc(" ",o.ventaForm.get("serienc").value," - ",o.ventaForm.get("numeronc").value,'" ')}}function yn(t,e){if(1&t){var o=m.Xb();m.Wb(0,"div",73),m.Wb(1,"button",74),m.ec("click",(function(){return m.wc(o),m.ic().modalNotacredito()})),m.Wb(2,"span"),m.Gc(3,"Comprobante a emitir nota de cr\xe9dito"),m.Vb(),m.Ec(4,Cn,2,0,"span",10),m.Ec(5,xn,2,0,"span",10),m.Ec(6,Wn,2,2,"span",10),m.Vb(),m.Vb()}if(2&t){var a=m.ic();m.Cb(4),m.oc("ngIf",1===a.ventaForm.get("documentonc").value),m.Cb(1),m.oc("ngIf",2===a.ventaForm.get("documentonc").value),m.Cb(1),m.oc("ngIf",a.ventaForm.get("documentonc").value)}}function wn(t,e){1&t&&(m.Wb(0,"mat-option"),m.Rb(1,"mat-spinner",75),m.Vb())}function Fn(t,e){1&t&&(m.Wb(0,"span",86),m.Gc(1,"DNI"),m.Vb())}function In(t,e){1&t&&(m.Wb(0,"span",86),m.Gc(1,"RUC"),m.Vb())}function En(t,e){1&t&&(m.Wb(0,"span",86),m.Gc(1,"C.Ext."),m.Vb())}function Gn(t,e){1&t&&(m.Wb(0,"span",86),m.Gc(1,"Pasap."),m.Vb())}function kn(t,e){1&t&&(m.Wb(0,"span",86),m.Gc(1,"SinD."),m.Vb())}function Rn(t,e){1&t&&(m.Wb(0,"span",86),m.Gc(1,"Identificaci\xf3n"),m.Vb())}function Sn(t,e){if(1&t&&(m.Wb(0,"mat-option",78),m.Wb(1,"div",79),m.Rb(2,"img",80),m.jc(3,"imagen"),m.Wb(4,"span",81),m.Gc(5),m.Vb(),m.Vb(),m.Wb(6,"div",82),m.Ec(7,Fn,2,0,"span",83),m.Ec(8,In,2,0,"span",83),m.Ec(9,En,2,0,"span",83),m.Ec(10,Gn,2,0,"span",83),m.Ec(11,kn,2,0,"span",83),m.Ec(12,Rn,2,0,"span",84),m.Wb(13,"small",85),m.Gc(14),m.Vb(),m.Vb(),m.Vb()),2&t){var o=e.$implicit;m.oc("value",o)("ngSwitch",o.clientedoc),m.Cb(2),m.oc("src",m.lc(3,10,o.imgperfil,o.sexo),m.zc),m.Cb(3),m.Hc(o.entidad),m.Cb(2),m.oc("ngSwitchCase",1),m.Cb(1),m.oc("ngSwitchCase",2),m.Cb(1),m.oc("ngSwitchCase",3),m.Cb(1),m.oc("ngSwitchCase",4),m.Cb(1),m.oc("ngSwitchCase",5),m.Cb(3),m.Hc(o.numerodoc)}}function _n(t,e){if(1&t&&(m.Ub(0),m.Ec(1,Sn,15,13,"mat-option",76),m.Wb(2,"div",77),m.Wb(3,"p"),m.Gc(4),m.Vb(),m.Vb(),m.Tb()),2&t){var o=m.ic();m.Cb(1),m.oc("ngForOf",o.searchResult.data),m.Cb(3),m.Jc("Mostrando ",o.searchResult.to," de ",o.searchResult.total," resultados.")}}function Ln(t,e){if(1&t&&m.Rb(0,"mat-icon",87),2&t){var o=m.ic();m.oc("icIcon",o.icSearch)}}function Dn(t,e){if(1&t){var o=m.Xb();m.Wb(0,"mat-icon",88),m.ec("click",(function(){return m.wc(o),m.ic().ventaForm.get("cliente").setValue("")})),m.Vb()}if(2&t){var a=m.ic();m.oc("icIcon",a.icClose)}}function An(t,e){1&t&&(m.Wb(0,"mat-error"),m.Gc(1," Requerido "),m.Vb())}function Nn(t,e){1&t&&(m.Wb(0,"mat-label"),m.Gc(1,"Dni"),m.Vb())}function Tn(t,e){1&t&&(m.Wb(0,"mat-label"),m.Gc(1,"Ruc"),m.Vb())}function On(t,e){1&t&&(m.Wb(0,"mat-label"),m.Gc(1,"C.Ext."),m.Vb())}function Pn(t,e){1&t&&(m.Wb(0,"mat-label"),m.Gc(1,"Pasap."),m.Vb())}function jn(t,e){1&t&&(m.Wb(0,"mat-label"),m.Gc(1,"SinD."),m.Vb())}function qn(t,e){1&t&&(m.Wb(0,"mat-label"),m.Gc(1,"Identificaci\xf3n"),m.Vb())}function Mn(t,e){if(1&t&&(m.Wb(0,"mat-option",24),m.Wb(1,"div",67),m.Wb(2,"small",89),m.Gc(3),m.jc(4,"uppercase"),m.Vb(),m.Wb(5,"small",38),m.Gc(6),m.Vb(),m.Wb(7,"small",90),m.Gc(8),m.Vb(),m.Vb(),m.Vb()),2&t){var o=e.$implicit;m.oc("value",o),m.Cb(3),m.Hc(m.kc(4,4,o.nombre)),m.Cb(3),m.Hc(o.codigo),m.Cb(2),m.Hc(o.precio)}}function Qn(t,e){if(1&t&&m.Rb(0,"mat-icon",87),2&t){var o=m.ic();m.oc("icIcon",o.icSearch)}}function Bn(t,e){if(1&t){var o=m.Xb();m.Wb(0,"mat-icon",88),m.ec("click",(function(){return m.wc(o),m.ic().producto.setValue("")})),m.Vb()}if(2&t){var a=m.ic();m.oc("icIcon",a.icClose)}}function zn(t,e){if(1&t&&(m.Wb(0,"mat-option",24),m.Wb(1,"div",67),m.Wb(2,"small",101),m.Gc(3),m.jc(4,"uppercase"),m.Vb(),m.Wb(5,"small",102),m.Wb(6,"span",103),m.Gc(7,"Precio"),m.Vb(),m.Gc(8),m.Vb(),m.Vb(),m.Vb()),2&t){var o=e.$implicit;m.oc("value",o),m.Cb(3),m.Hc(m.kc(4,3,o.nombre)),m.Cb(5),m.Ic(" ",o.precio,"")}}function Hn(t,e){if(1&t&&m.Rb(0,"mat-icon",87),2&t){var o=m.ic(2);m.oc("icIcon",o.icSearch)}}function Xn(t,e){if(1&t){var o=m.Xb();m.Wb(0,"mat-icon",88),m.ec("click",(function(){m.wc(o);var t=m.ic().index;return m.ic().ventaForm.get("ventadet").controls[t].controls.producto.setValue("")})),m.Vb()}if(2&t){var a=m.ic(2);m.oc("icIcon",a.icClose)}}function $n(t,e){1&t&&(m.Wb(0,"mat-error"),m.Gc(1," Requerido! "),m.Vb())}function Un(t,e){1&t&&(m.Wb(0,"mat-error"),m.Gc(1," Requerido "),m.Vb())}function Kn(t,e){if(1&t&&(m.Wb(0,"mat-error"),m.Gc(1),m.Vb()),2&t){var o=m.ic().index,a=m.ic();m.Cb(1),m.Ic(" M\xednimo ",a.ventaForm.get("ventadet").controls[o].controls.cantidad.errors.min.min," ")}}function Jn(t,e){1&t&&(m.Wb(0,"mat-error"),m.Gc(1," Requerido! "),m.Vb())}function Yn(t,e){1&t&&(m.Wb(0,"mat-error"),m.Gc(1," Requerido! "),m.Vb())}function Zn(t,e){if(1&t){var o=m.Xb();m.Wb(0,"tr",91),m.Wb(1,"td"),m.Wb(2,"mat-form-field",92),m.Rb(3,"input",93),m.Wb(4,"mat-autocomplete",49,94),m.ec("optionSelected",(function(t){m.wc(o);var a=e.index;return m.ic().autocompletadoProductoSelected(t.option.value,a)})),m.Ec(6,zn,9,5,"mat-option",25),m.jc(7,"async"),m.Vb(),m.Ec(8,Hn,1,1,"mat-icon",36),m.Ec(9,Xn,1,1,"mat-icon",37),m.Ec(10,$n,2,0,"mat-error",10),m.Vb(),m.Vb(),m.Wb(11,"td"),m.Wb(12,"mat-form-field",95),m.Rb(13,"input",96),m.Ec(14,Un,2,0,"mat-error",10),m.Ec(15,Kn,2,1,"mat-error",10),m.Vb(),m.Vb(),m.Wb(16,"td"),m.Wb(17,"mat-form-field",95),m.Rb(18,"input",97),m.Ec(19,Jn,2,0,"mat-error",10),m.Vb(),m.Vb(),m.Wb(20,"td"),m.Wb(21,"mat-form-field",95),m.Rb(22,"input",98),m.Ec(23,Yn,2,0,"mat-error",10),m.Vb(),m.Vb(),m.Wb(24,"td"),m.Wb(25,"button",99),m.ec("click",(function(){m.wc(o);var t=e.$implicit,a=e.index;return m.ic().modalItem(t,a)})),m.Rb(26,"mat-icon",19),m.Vb(),m.Wb(27,"button",100),m.ec("click",(function(){m.wc(o);var t=e.index;return m.ic().deleteItem(t)})),m.Rb(28,"mat-icon",19),m.Vb(),m.Vb(),m.Vb()}if(2&t){var a=e.index,n=m.uc(5),i=m.ic();m.oc("formGroupName",a),m.Cb(3),m.oc("matAutocomplete",n),m.Cb(1),m.oc("displayWith",i.displayProductoFn),m.Cb(2),m.oc("ngForOf",m.kc(7,14,i.filteredProductos[a])),m.Cb(2),m.oc("ngIf",!i.ventaForm.get("ventadet").controls[a].controls.producto.value),m.Cb(1),m.oc("ngIf",i.ventaForm.get("ventadet").controls[a].controls.producto.value),m.Cb(1),m.oc("ngIf",i.ventaForm.get("ventadet").controls[a].controls.producto.hasError("required")),m.Cb(4),m.oc("ngIf",i.ventaForm.get("ventadet").controls[a].controls.cantidad.hasError("required")),m.Cb(1),m.oc("ngIf",i.ventaForm.get("ventadet").controls[a].controls.cantidad.hasError("min")),m.Cb(4),m.oc("ngIf",i.ventaForm.get("ventadet").controls[a].controls.preciounit.hasError("required")),m.Cb(3),m.oc("readonly",!0),m.Cb(1),m.oc("ngIf",i.ventaForm.get("ventadet").controls[a].controls.total.hasError("required")),m.Cb(3),m.oc("icIcon",i.icEdit),m.Cb(2),m.oc("icIcon",i.icDeleteSweep)}}function ti(t,e){1&t&&(m.Wb(0,"tr"),m.Wb(1,"td",104),m.Wb(2,"div",105),m.Gc(3,"No hay registros."),m.Vb(),m.Vb(),m.Vb())}function ei(t,e){if(1&t){var o=m.Xb();m.Wb(0,"mat-grid-tile"),m.Wb(1,"mat-card",106),m.ec("click",(function(){m.wc(o);var t=e.$implicit;return m.ic().selected(t)})),m.Wb(2,"mat-card-content"),m.Gc(3),m.Vb(),m.Wb(4,"mat-card-actions"),m.Wb(5,"button",107),m.Gc(6),m.Vb(),m.Vb(),m.Vb(),m.Vb()}if(2&t){var a=e.$implicit;m.Cb(1),m.oc("matRippleCentered",!0),m.Cb(2),m.Ic(" ",a.nombre," "),m.Cb(3),m.Hc(a.precio)}}var oi,ai=((oi=function(){function t(e,o,a,n,i,r,l,u,s){_classCallCheck(this,t),this.activatedRoute=e,this._matDialog=o,this.snackBar=a,this._entidadService=n,this._ventaService=i,this._documentoserieService=r,this._productoService=l,this._utils=u,this._datainicial=s,this.pipeDate=new w.e("es-Pe"),this.comprobantes=[],this.producto=new c.e(""),this.comprobantenc=this._datainicial.comprobantenc,this.tiponc=this._datainicial.tiponc,this.monedas=this._datainicial.monedas,this.impuestos=this._datainicial.impuestos,this.searchResult={data:[],to:null,total:null},this.isLoadingSearch=!1,this.productos=[],this.filteredProductos=[],this.submitted=!1,this.icSearch=Ce.a,this.icAdd=We.a,this.icEdit=P.a,this.icDelete=we.a,this.icClose=x.a,this.icSettings=on.a,this.icInsertDriveFile=X.a,this.icArrowBack=nn.a,this.icSend=rn.a,this.icSave=un.a,this.icPrint=V.a,this.icMoreVert=z.a,this.icDeleteSweep=Da.a}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.ventaForm=this.createForm(),this.activatedRoute.params.subscribe((function(e){if(console.log("activatedRoute",e),e.comprobante)switch(e.comprobante.toUpperCase()){case"FACTURA":t.iddocumentofiscalDefault=1;break;case"BOLETADEVENTA":t.iddocumentofiscalDefault=2;break;case"NOTADECREDITO":t.iddocumentofiscalDefault=13;break;case"NOTADEDEBITO":t.iddocumentofiscalDefault=10}t.filteredOptions=t.producto.valueChanges.pipe(Object(la.a)(""),Object(ua.a)((function(t){return"string"==typeof t?t:t.nombre})),Object(ua.a)((function(e){return e?t._filterProductos(e):t.productos.slice()}))),e.venta&&t._ventaService.show(e.venta,{conRecurso:"ventadet.producto, cliente, ventapago"}).subscribe((function(e){t.ventaForm.get("cliente").setValue({identidad:e.data.cliente.identidad,numerodoc:e.data.cliente.numerodoc,entidad:e.data.cliente.entidad,sexo:e.data.cliente.sexo}),t.ventaForm.get("idventa").setValue(e.data.idventa),t.ventaForm.get("idsede").setValue(e.data.idsede),t.ventaForm.get("condicionpago").setValue(e.data.condicionpago),t.ventaForm.get("observacion").setValue(e.data.observacion),t.ventaForm.get("fechavencimiento").setValue(e.data.fechavencimiento),t.ventaForm.get("operacion").setValue(e.data.operacion),t.ventaForm.get("placavehiculo").setValue(e.data.placavehiculo),t.ventaForm.get("ordencompra").setValue(e.data.ordencompra),t.ventaForm.get("guiaremitente").setValue(e.data.guiaremitente),t.ventaForm.get("guiatransportista").setValue(e.data.guiatransportista),t.ventaForm.get("pdfformato").setValue(e.data.pdfformato),t.ventaForm.get("moneda").setValue(e.data.moneda),t.ventaForm.get("tipocambio").setValue(parseFloat(e.data.tipocambio)),t.ventaForm.get("detraccion").setValue("1"===e.data.detraccion),t.ventaForm.get("selvaproducto").setValue("1"===e.data.selvaproducto),t.ventaForm.get("selvaservicio").setValue("1"===e.data.selvaservicio),t.ventaForm.get("pagado").setValue(parseFloat(e.data.pagado)),t.ventaForm.get("vuelto").setValue(parseFloat(e.data.vuelto)),13===t.iddocumentofiscalDefault&&(t.ventaForm.get("tiponc").setValue(1),t.ventaForm.get("documentonc").setValue(e.data.iddocumentofiscal),t.ventaForm.get("serienc").setValue(e.data.serie),t.ventaForm.get("numeronc").setValue(e.data.numero)),e.data.ventadet.forEach((function(e){var o=t._utils.calculoLinea(e.idimpuesto,parseFloat(e.preciounit),e.cantidad,parseFloat(e.descuento)),a={producto:{idproducto:e.producto.idproducto,codigo:e.producto.codigo,nombre:e.producto.nombre,precio:e.producto.precio,unidadmedida:e.producto.unidadmedida,codigosunat:e.producto.codigosunat,idimpuesto:e.idimpuesto},descripcion:e.descripcion,idimpuesto:e.idimpuesto,cantidad:e.cantidad,valorunit:o.valorunit,descuento:parseFloat(e.descuento),valorventa:o.subtotal,montototalimpuestos:o.montototalimpuestos,preciounit:parseFloat(e.preciounit),total:o.total};t.addItem(a)})),e.data.ventapago.forEach((function(e){var o=new c.h({idmediopago:new c.e(e.idmediopago),importe:new c.e(e.importe),nota:new c.e(e.nota)});t.ventapago.push(o)}))}),(function(t){console.log(t)}));var o=null;t.comprobantes.forEach((function(e){e.iddocumentofiscal===t.iddocumentofiscalDefault&&(o=e)})),console.log("itemSelected",o),o&&t.ventaForm.get("comprobante").setValue(o)})),this.ventaForm.get("ventadet").valueChanges.subscribe((function(e){e.forEach((function(e,o){if("object"==typeof e.producto){console.log("(1) valueChanges "+o,e);var a=e.preciounit||null,n=e.cantidad||null,i=e.descuento||null,c=t._utils.calculoLinea(e.idimpuesto||null,a,n,i);t.ventadet.at(o).get("cantidad").setValue(n,{emitEvent:!1}),t.ventadet.at(o).get("preciounit").setValue(a,{emitEvent:!1}),t.ventadet.at(o).get("valorunit").setValue(c.valorunit,{emitEvent:!1}),t.ventadet.at(o).get("descuento").setValue(i,{emitEvent:!1}),t.ventadet.at(o).get("gravada").setValue(c.subtotal,{emitEvent:!1}),t.ventadet.at(o).get("montototalimpuestos").setValue(c.montototalimpuestos,{emitEvent:!1}),t.ventadet.at(o).get("total").setValue(c.total,{emitEvent:!1}),t.calcularTotales()}"string"==typeof e.producto&&(console.log("(2) valueChanges "+o),t.ventadet.at(o).get("cantidad").setValue("",{emitEvent:!1}),t.ventadet.at(o).get("cantidad").setValidators(null),t.ventadet.at(o).get("cantidad").disable({emitEvent:!1}),t.ventadet.at(o).get("cantidad").updateValueAndValidity({emitEvent:!1}),t.ventadet.at(o).get("preciounit").setValue("",{emitEvent:!1}),t.ventadet.at(o).get("preciounit").setValidators(null),t.ventadet.at(o).get("preciounit").disable({emitEvent:!1}),t.ventadet.at(o).get("preciounit").updateValueAndValidity({emitEvent:!1}),t.ventadet.at(o).get("valorunit").setValue("",{emitEvent:!1}),t.ventadet.at(o).get("descuento").setValue("",{emitEvent:!1}),t.ventadet.at(o).get("valorventa").setValue("",{emitEvent:!1}),t.ventadet.at(o).get("montototalimpuestos").setValue("",{emitEvent:!1}),t.ventadet.at(o).get("total").setValue("",{emitEvent:!1}),t.ventadet.at(o).get("total").setValidators(null),t.ventadet.at(o).get("total").disable({emitEvent:!1}),t.ventadet.at(o).get("total").updateValueAndValidity({emitEvent:!1}),t.calcularTotales())}))})),this.ventaForm.controls.cliente.valueChanges.pipe(Object(r.a)(300),Object(l.a)((function(){return t.isLoadingSearch=!0})),Object(u.a)((function(e){if("object"==typeof e?(console.log("data =>",e),t.ventaForm.get("idcliente").setValue(e.identidad),t.ventaForm.get("cpecorreo").setValue(e.email),t.ventaForm.get("clientenombre").setValue(e.entidad),t.ventaForm.get("clientedoc").setValue(e.clientedoc),t.ventaForm.get("clientenumerodoc").setValue(e.numerodoc),t.ventaForm.get("clientedireccion").setValue(e.direccion)):(t.ventaForm.get("idcliente").setValue(null),t.ventaForm.get("cpecorreo").setValue(null),t.ventaForm.get("clientenombre").setValue(null),t.ventaForm.get("clientedoc").setValue(null),t.ventaForm.get("clientenumerodoc").setValue(null),t.ventaForm.get("clientedireccion").setValue(null)),e&&"string"==typeof e){var o={idempresa:t._entidadService.usuario.idempresa,page:1,pageSize:10,orderName:"entidad",orderSort:"asc"};return parseFloat(e)>0?o.likeNumerodoc=e:o.likeEntidad=e,t._entidadService.index(o).pipe(Object(s.a)((function(){return t.isLoadingSearch=!1})))}return t.isLoadingSearch=!1,[]}))).subscribe((function(e){t.searchResult.to=e.to,t.searchResult.total=e.total,t.searchResult.data=[],e.data.forEach((function(e){t.searchResult.data.push({identidad:e.identidad,entidad:e.entidad,numerodoc:e.numerodoc,sexo:e.sexo,direccion:e.direccion,email:e.email,clientedoc:e.iddocumento})}))})),this.ventaForm.controls.comprobante.valueChanges.subscribe((function(e){console.log("comprobante Subscribe",e),t.ventaForm.get("tiponc").setValue(null),t.ventaForm.get("documentonc").setValue(null),t.ventaForm.get("serienc").setValue(null),t.ventaForm.get("numeronc").setValue(null),e&&e.iddocumentofiscal?(t.ventaForm.get("iddocumentofiscal").setValue(e.iddocumentofiscal),t.ventaForm.get("serie").setValue(e.serie),t.ventaForm.get("numero").setValue(e.numero),13===e.iddocumentofiscal&&t.ventaForm.get("tiponc").setValue(1)):(t.ventaForm.get("iddocumentofiscal").setValue(null),t.ventaForm.get("serie").setValue(null),t.ventaForm.get("numero").setValue(null))})),this.ventaForm.controls.cargo.valueChanges.subscribe((function(e){t.calcularTotales()})),this.ventaForm.controls.descuentoporcentaje.valueChanges.subscribe((function(e){t.calcularTotales()})),this.indexDocumentoseries(),this.indexProductos()}},{key:"resetForm",value:function(){var t=this,e=null;this.comprobantes.forEach((function(o){o.iddocumentofiscal===t.iddocumentofiscalDefault&&(e=o)}));for(var o=1,a=[];o<=this.ventadet.value.length;)a.push({idimpuesto:1}),o++;var n={comprobante:e,idsede:this._entidadService.sedeDefault||null,iddocumentofiscal:e?e.iddocumentofiscal:null,serie:e?e.serie:null,numero:e?e.numero:null,fechaemision:new Date,fechavencimiento:new Date,idestadodocumento:27,operacion:1,moneda:"PEN",detraccion:!1,selvaproducto:!1,selvaservicio:!1,pdfformato:"A4",ventadet:a,tiponc:e&&13===e.iddocumentofiscal?1:null};this.ventaForm.reset(n,{emitEvent:!1})}},{key:"createForm",value:function(){return new c.h({idventa:new c.e(null),comprobante:new c.e(null,[c.v.required]),idsede:new c.e(this._entidadService.sedeDefault||null),iddocumentofiscal:new c.e(null),serie:new c.e(null),numero:new c.e(null),idcliente:new c.e(null),fechaemision:new c.e(new Date,[c.v.required]),fechavencimiento:new c.e(new Date,[c.v.required]),idestadodocumento:new c.e(27,[c.v.required]),cliente:new c.e(null,[c.v.required]),cpecorreo:new c.e(null),clientenombre:new c.e(null),clientedoc:new c.e(null),clientenumerodoc:new c.e(null),clientedireccion:new c.e(null),operacion:new c.e(1,[c.v.required]),moneda:new c.e("PEN",[c.v.required]),tipocambio:new c.e(null),detraccion:new c.e(!1),selvaproducto:new c.e(!1),selvaservicio:new c.e(!1),placavehiculo:new c.e(null),ordencompra:new c.e(null),guiaremitente:new c.e(null),guiatransportista:new c.e(null),exonerada:new c.e(null),inafecta:new c.e(null),gratuita:new c.e(null),gravada:new c.e(null,[c.v.required]),valorimpuesto:new c.e(null,[c.v.required]),total:new c.e(null,[c.v.required]),pagado:new c.e(null),vuelto:new c.e(null),condicionpago:new c.e(null),pdfformato:new c.e("A4"),observacion:new c.e(null),ventadet:new c.c([]),ventapago:new c.c([]),tiponc:new c.e(null),documentonc:new c.e(null),serienc:new c.e(null),numeronc:new c.e(null),descuentoporcentaje:new c.e(null,[c.v.min(0)]),descuentoglobal:new c.e(null),descuentoitem:new c.e(null),descuentototal:new c.e(null),cargo:new c.e(null,[c.v.min(0)])})}},{key:"calcularTotales",value:function(){console.log("calcularTotales()");var t=0,e=0,o=0,a=0,n=0,i=0,c=0,r=0,l=0,u=this.ventaForm.get("cargo").value,s=this.ventaForm.get("descuentoporcentaje").value;if(sa.c);else{this.ventadet.value.forEach((function(a){a.total&&(console.log("element",a),c+=a.descuento,1===a.idimpuesto&&(i+=a.total),-1!==[2,3,4,5,6,7,10,11,12,13,14,15].indexOf(a.idimpuesto)&&(o+=a.total),8===a.idimpuesto&&(t+=a.total),9===a.idimpuesto&&(e+=a.total))})),r=c,s>0&&(l=i*(s/100)-c,t-=t*(s/100),e-=e*(s/100),i-=i*(s/100));var d=this._utils.calculoLinea(1,i,1);a=d.subtotal,n=d.montototalimpuestos,i=d.total+t+e+u,console.log("total",i)}this.ventaForm.get("descuentoglobal").setValue(l),this.ventaForm.get("exonerada").setValue(t),this.ventaForm.get("inafecta").setValue(e),this.ventaForm.get("gratuita").setValue(o),this.ventaForm.get("descuentoitem").setValue(c),this.ventaForm.get("descuentototal").setValue(r),this.ventaForm.get("gravada").setValue(a),this.ventaForm.get("valorimpuesto").setValue(n),this.ventaForm.get("total").setValue(i)}},{key:"autocompletadoProducto",value:function(t){var e=this;this.filteredProductos[t]=this.ventadet.at(t).get("producto").valueChanges.pipe(Object(la.a)(""),Object(ua.a)((function(t){return"string"==typeof(t=null===t?"":t)?t:t.nombre})),Object(ua.a)((function(t){return t?e._filterProductos(t):e.productos.slice()})))}},{key:"_filterProductos",value:function(t){var e=t.toLowerCase();return this.productos.filter((function(t){return 0===t.nombre.toLowerCase().indexOf(e)}))}},{key:"autocompletadoProductoSelected",value:function(t,e){var o=0;if(this.ventadet.value.forEach((function(e){e.producto&&e.producto.idproducto===t.idproducto&&(console.log("item",e),o+=1)})),o>1)this.ventadet.at(e).get("producto").setValue(""),this.snackBar.open("".concat(t.nombre," ya esta a\xf1adido."),"Cerrar",{duration:4e3,panelClass:["error-dialog"]});else{var a=this._utils.calculoLinea(t.idimpuesto,parseFloat(t.precio),1);this.ventadet.at(e).get("idimpuesto").setValue(t.idimpuesto,{emitEvent:!1}),this.ventadet.at(e).get("cantidad").setValue(1,{emitEvent:!1}),this.ventadet.at(e).get("valorunit").setValue(a.valorunit,{emitEvent:!1}),this.ventadet.at(e).get("valorventa").setValue(a.subtotal,{emitEvent:!1}),this.ventadet.at(e).get("montototalimpuestos").setValue(a.montototalimpuestos,{emitEvent:!1}),this.ventadet.at(e).get("preciounit").setValue(parseFloat(t.precio),{emitEvent:!1}),this.ventadet.at(e).get("total").setValue(a.total,{emitEvent:!1}),this.enabledItem(e),this.calcularTotales()}}},{key:"enabledItem",value:function(t){this.ventadet.at(t).get("cantidad").setValidators([c.v.required,c.v.min(1)]),this.ventadet.at(t).get("cantidad").enable({emitEvent:!1}),this.ventadet.at(t).get("cantidad").updateValueAndValidity({emitEvent:!1}),this.ventadet.at(t).get("preciounit").setValidators([c.v.required]),this.ventadet.at(t).get("preciounit").enable({emitEvent:!1}),this.ventadet.at(t).get("preciounit").updateValueAndValidity({emitEvent:!1}),this.ventadet.at(t).get("descuento").enable({emitEvent:!1}),this.ventadet.at(t).get("descuento").updateValueAndValidity({emitEvent:!1}),this.ventadet.at(t).get("total").setValidators([c.v.required]),this.ventadet.at(t).get("total").enable({emitEvent:!1}),this.ventadet.at(t).get("total").updateValueAndValidity({emitEvent:!1})}},{key:"autocompletadoClienteSelected",value:function(t){console.log("autocompletadoClienteSelected()")}},{key:"addItem",value:function(t){var e=this,o=!1;if(this.ventadet.value.forEach((function(e){t&&e.producto&&e.producto.idproducto===t.producto.idproducto&&(o=!0)})),o)return this.snackBar.open("".concat(t.producto.nombre," ya esta a\xf1adido."),"Cerrar",{duration:4e3,panelClass:["error-dialog"]}),!1;for(var a=-1,n=0;n<this.ventadet.value.length;n++)if("string"==typeof this.ventadet.value[n].producto){a=n;break}if(-1!==a&&void 0!==t)console.log("addItem() [update]"),this.ventadet.at(a).get("producto").setValue(t?t.producto:""),this.ventadet.at(a).get("descripcion").setValue(t?t.descripcion:"",{emitEvent:!1}),this.ventadet.at(a).get("cantidad").setValue(t?t.cantidad:"",{emitEvent:!1}),this.ventadet.at(a).get("valorunit").setValue(t?t.valorunit:"",{emitEvent:!1}),this.ventadet.at(a).get("descuento").setValue(t?t.descuento:"",{emitEvent:!1}),this.ventadet.at(a).get("valorventa").setValue(t?t.valorventa:"",{emitEvent:!1}),this.ventadet.at(a).get("idimpuesto").setValue(t?t.idimpuesto:1,{emitEvent:!1}),this.ventadet.at(a).get("montototalimpuestos").setValue(t?t.montototalimpuestos:"",{emitEvent:!1}),this.ventadet.at(a).get("preciounit").setValue(t?t.preciounit:"",{emitEvent:!1}),this.ventadet.at(a).get("total").setValue(t?t.total:"",{emitEvent:!1}),this.enabledItem(a),this.calcularTotales(),t&&this.snackBar.open("".concat(t.producto.nombre," a\xf1adido."),"Cerrar",{duration:4e3});else{console.log("addItem() [new]",t);var i=!t,r=new c.h({producto:new c.e(t?t.producto:null),descripcion:new c.e(t?t.descripcion:null),cantidad:new c.e({value:t?t.cantidad:null,disabled:i}),valorunit:new c.e(t?t.valorunit:null),descuento:new c.e(t?t.descuento:null),valorventa:new c.e(t?t.valorventa:null),idimpuesto:new c.e(t?t.idimpuesto:null),montototalimpuestos:new c.e(t?t.montototalimpuestos:null),preciounit:new c.e({value:t?t.preciounit:null,disabled:i}),total:new c.e({value:t?t.total:null,disabled:i})});this.ventadet.push(r),this.autocompletadoProducto(this.ventadet.length-1),t&&this.snackBar.open("".concat(t.producto.nombre," a\xf1adido."),"Cerrar",{duration:4e3}),setTimeout((function(){e.ventadet.at(e.ventadet.length-1).get("producto").updateValueAndValidity()}),100)}}},{key:"deleteItem",value:function(t){console.log("Remove",t),this.ventadet.removeAt(t),this.filteredProductos.splice(t,1),this.calcularTotales()}},{key:"displaySearchEntidad",value:function(t){return t?t.entidad:null}},{key:"displayProductoFn",value:function(t){return t?t.nombre:void 0}},{key:"newEntidad",value:function(){var t=this,e=null;"string"==typeof this.ventaForm.get("cliente").value&&/^[0-9]+$/.exec(this.ventaForm.get("cliente").value.trim())&&(e=this.ventaForm.get("cliente").value.trim()),this._matDialog.open(Za.a,{panelClass:"contacto-form-dialog",data:{action:"new",dialogTitle:"Nuevo cliente",tipo:"cliente",numerodoc:e},autoFocus:!1}).afterClosed().subscribe((function(e){if(e){var o={identidad:e.identidad,numerodoc:e.numerodoc,entidad:e.entidad,sexo:e.sexo};t.searchResult.data.push(o),t.searchResult.to+=1,t.searchResult.total+=1,t.ventaForm.get("cliente").setValue(o),t.ventaForm.get("cliente").updateValueAndValidity()}}))}},{key:"newProducto",value:function(){var t=this;this._matDialog.open(tn.a,{panelClass:"item-form-dialog",data:{action:"new",dialogTitle:"Nuevo producto"},autoFocus:!1}).afterClosed().subscribe((function(e){e&&(console.log("response",e),t.productos.push({idproducto:e.idproducto,codigo:e.codigo,nombre:e.nombre,precio:e.valorventa,unidadmedida:e.unidadmedida,codigosunat:e.codigosunat,idimpuesto:e.idimpuesto}),t.producto.updateValueAndValidity())}))}},{key:"modalGeneral",value:function(){var t=this;this._matDialog.open(va,{panelClass:"ventasgeneral-form-dialog",data:{venta:this.ventaForm.getRawValue()},autoFocus:!1}).afterClosed().subscribe((function(e){e&&(t.ventaForm.get("fechavencimiento").setValue(e.fechavencimiento),t.ventaForm.get("operacion").setValue(e.operacion),t.ventaForm.get("placavehiculo").setValue(e.placavehiculo),t.ventaForm.get("ordencompra").setValue(e.ordencompra),t.ventaForm.get("guiaremitente").setValue(e.guiaremitente),t.ventaForm.get("guiatransportista").setValue(e.guiatransportista),t.ventaForm.get("tipocambio").setValue(e.tipocambio),t.ventaForm.get("pdfformato").setValue(e.pdfformato),t.ventaForm.get("detraccion").setValue(e.detraccion),t.ventaForm.get("selvaproducto").setValue(e.selvaproducto),t.ventaForm.get("selvaservicio").setValue(e.selvaservicio))}))}},{key:"modalNotacredito",value:function(){var t=this;this._matDialog.open(Ya,{panelClass:"ventasnotacredito-form-dialog",data:{venta:this.ventaForm.getRawValue()},autoFocus:!1}).afterClosed().subscribe((function(e){if(e){t.ventaForm.get("tiponc").setValue(e.tiponc),t.ventaForm.get("documentonc").setValue(e.documentonc),t.ventaForm.get("serienc").setValue(e.serienc),t.ventaForm.get("numeronc").setValue(e.numeronc);var o=null;t.comprobantes.forEach((function(t){13===t.iddocumentofiscal&&t.serie===e.serienc&&(o=t)})),"0"===e.serienc.substr(0,1)&&t.comprobantes.forEach((function(t){var a=1===e.documentonc?"F":"B";13===t.iddocumentofiscal&&t.serie.substr(0,1)===a&&(o=t)})),o&&t.ventaForm.get("comprobante").setValue(o,{emitEvent:!1})}}))}},{key:"modalGuia",value:function(){this._matDialog.open(ga,{panelClass:"ventasguia-form-dialog",data:{venta:this.ventaForm},autoFocus:!1}).afterClosed().subscribe((function(t){t&&console.log("response",t)}))}},{key:"modalFormato",value:function(){this._matDialog.open(ha,{panelClass:"ventasformato-form-dialog",data:{venta:this.ventaForm},autoFocus:!1}).afterClosed().subscribe((function(t){t&&console.log("response",t)}))}},{key:"modalItem",value:function(t,e){var o=this;this._matDialog.open(Ra,{panelClass:"ventasitem-form-dialog",data:{item:t.getRawValue(),productos:this.productos,impuestos:this.impuestos},autoFocus:!1}).afterClosed().subscribe((function(a){if(a){var n=!1;o.ventadet.value.forEach((function(e){e.producto&&e.producto.idproducto===a.producto.idproducto&&a.producto.idproducto!==t.get("producto").value.idproducto&&(n=!0)})),n?o.snackBar.open("".concat(a.producto.nombre," ya esta a\xf1adido."),"Cerrar",{duration:4e3,panelClass:["error-dialog"]}):(o.ventadet.at(e).get("idimpuesto").setValue(a.idimpuesto,{emitEvent:!1}),o.ventadet.at(e).get("producto").setValue(a.producto,{emitEvent:!1}),o.ventadet.at(e).get("descripcion").setValue(a.descripcion,{emitEvent:!1}),o.ventadet.at(e).get("cantidad").setValue(a.cantidad,{emitEvent:!1}),o.ventadet.at(e).get("preciounit").setValue(a.preciounit,{emitEvent:!1}),o.ventadet.at(e).get("valorunit").setValue(a.valorunit,{emitEvent:!1}),o.ventadet.at(e).get("descuento").setValue(a.descuento,{emitEvent:!1}),o.ventadet.at(e).get("valorventa").setValue(a.valorventa,{emitEvent:!1}),o.ventadet.at(e).get("montototalimpuestos").setValue(a.montototalimpuestos,{emitEvent:!1}),o.ventadet.at(e).get("total").setValue(a.total,{emitEvent:!1}),setTimeout((function(){t.get("producto").updateValueAndValidity()}),100),console.log("response",a),o.enabledItem(e),o.calcularTotales())}}))}},{key:"modalMediopago",value:function(){var t=this;this.ventaForm.get("idcliente").value?this._matDialog.open(Ma,{panelClass:"ventasmediopago-form-dialog",data:{venta:this.ventaForm.getRawValue()},autoFocus:!1}).afterClosed().subscribe((function(e){if(e){for(;t.ventapago.value.length>0;)t.ventapago.removeAt(0);e.mediopago.forEach((function(e){var o=new c.h({idmediopago:new c.e(e.idmediopago),importe:new c.e(e.importe),nota:new c.e(e.nota)});t.ventapago.push(o)})),t.ventaForm.get("pagado").setValue(e.pagado),t.ventaForm.get("vuelto").setValue(e.vuelto),t.save()}})):this.snackBar.open("Ingrese cliente","Cerrar",{panelClass:["error-dialog"]})}},{key:"selected",value:function(t){var e=this._utils.calculoLinea(t.idimpuesto,parseFloat(t.precio),1),o={producto:{idproducto:t.idproducto,codigo:t.codigo,nombre:t.nombre,precio:t.precio,unidadmedida:t.unidadmedida,codigosunat:t.codigosunat,idimpuesto:t.idimpuesto},descripcion:null,idimpuesto:t.idimpuesto,cantidad:1,valorunit:e.valorunit,descuento:null,valorventa:e.valorventa,montototalimpuestos:e.montototalimpuestos,preciounit:parseFloat(t.precio),total:e.total};this.addItem(o)}},{key:"optionProductoSelected",value:function(t){var e=this._utils.calculoLinea(t.idimpuesto,parseFloat(t.precio),1),o={producto:{idproducto:t.idproducto,codigo:t.codigo,nombre:t.nombre,precio:t.precio,unidadmedida:t.unidadmedida,codigosunat:t.codigosunat,idimpuesto:t.idimpuesto},descripcion:null,idimpuesto:t.idimpuesto,cantidad:1,valorunit:e.valorunit,descuento:null,valorventa:e.subtotal,montototalimpuestos:e.montototalimpuestos,preciounit:parseFloat(t.precio),total:e.total};this.producto.setValue(""),this.addItem(o)}},{key:"indexEntidades",value:function(){var t=this;if(0!==this.ventaForm.controls.clientenumerodoc.value.trim().length){var e={idempresa:this._entidadService.usuario.idempresa,numerodoc:this.ventaForm.controls.clientenumerodoc.value};this.ventaForm.controls.cliente.setValue("",{emitEvent:!1}),this._entidadService.index(e).subscribe((function(e){1===e.data.length&&t.ventaForm.controls.cliente.setValue({identidad:e.data[0].identidad,entidad:e.data[0].entidad},{emitEvent:!1})}))}}},{key:"indexDocumentoseries",value:function(){var t=this;this._documentoserieService.index({idsede:this._entidadService.sedeDefault,conRecurso:"documentofiscal",orderName:"iddocumentofiscal",orderSort:"asc"}).subscribe((function(e){e.data.forEach((function(e){t.comprobantes.push({iddocumentofiscal:e.iddocumentofiscal,documentofiscal:{nombre:e.documentofiscal.nombre},serie:e.serie,numero:e.numero})}));var o=null;t.comprobantes.forEach((function(e){e.iddocumentofiscal===t.iddocumentofiscalDefault&&(o=e)})),o&&t.ventaForm.get("comprobante").setValue(o)}))}},{key:"indexProductos",value:function(){var t=this;this._productoService.index({idempresa:this._entidadService.usuario.idempresa,orderName:"nombre",orderSort:"asc",ventaind:2}).subscribe((function(e){var o=[];e.data.forEach((function(t){o.push({idproducto:t.idproducto,codigo:t.codigo,nombre:t.nombre,precio:t.valorventa,unidadmedida:t.unidadmedida,codigosunat:t.codigosunat,idimpuesto:t.idimpuesto})})),t.productos=o,t.producto.updateValueAndValidity(),0===t.ventadet.value.length&&(t.addItem(),t.addItem(),t.addItem())}))}},{key:"save",value:function(){var t=this,e={};e=this.ventaForm.getRawValue();var o=[];e.ventadet.forEach((function(t){t.producto&&t.producto.idproducto&&(t.idproducto=t.producto.idproducto,t.nombre=t.producto.nombre,t.codigo=t.producto.codigo,t.unidadmedida=t.producto.unidadmedida,t.codigosunat=t.producto.codigosunat,o.push(t))})),console.log("ventadet",o),e.ventadet=o,e.fechaemision=this.pipeDate.transform(e.fechaemision,"yyyy-MM-dd"),e.fechavencimiento=this.pipeDate.transform(e.fechavencimiento,"yyyy-MM-dd"),e.detraccion=e.detraccion?"1":"0",e.selvaproducto=e.selvaproducto?"1":"0",e.selvaservicio=e.selvaservicio?"1":"0",this.snackBar.open("Procesando venta..."),console.log("PARAM: ",e),this._ventaService.create(e).subscribe((function(o){var a;switch(t.indexDocumentoseries(),e.iddocumentofiscal){case 1:a="Factura";break;case 2:a="Boleta de venta";break;case 10:a="Nota de d\xe9bito";break;case 13:a="Nota de cr\xe9dito"}t.resetForm(),t.submitted=!1,t.snackBar.open("".concat(a," ").concat(e.serie," - ").concat(e.numero," emitido."),"Cerrar")}),(function(e){var o=t._utils.convertError(e);t.submitted=!1,t.snackBar.open(o,"Cerrar",{panelClass:["error-dialog"]})}))}},{key:"ventadet",get:function(){return this.ventaForm.get("ventadet")}},{key:"ventapago",get:function(){return this.ventaForm.get("ventapago")}}]),t}()).\u0275fac=function(t){return new(t||oi)(m.Qb(i.a),m.Qb(b.b),m.Qb(Z.b),m.Qb(tt.a),m.Qb(p.a),m.Qb(sn.a),m.Qb(dn.a),m.Qb(Y.a),m.Qb(ce.a))},oi.\u0275cmp=m.Kb({type:oi,selectors:[["vex-ventas-form"]],decls:225,vars:94,consts:[["id","ventas-form",3,"formGroup","ngSubmit"],[1,"content"],["fxLayout","column","fxLayout.gt-xs","row"],["fxFlex","60"],[1,"cardcustom"],["color","primary"],["fxLayoutAlign","space-between center"],["fxLayout","row","fxLayoutAlign","center center"],["mat-icon-button","","type","button","matTooltip","Volver a comprobantes",3,"routerLink"],[3,"icIcon"],[4,"ngIf"],["mat-raised-button","","type","submit","fxHide","","fxShow.gt-xs","",1,"mr-1"],["mat-icon-button","","type","submit","fxShow","","fxHide.gt-xs","",3,"disabled"],["mat-raised-button","","type","button",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","","type","submit",3,"disabled"],["mat-menu-item",""],["fxLayoutAlign","center center"],["mat-button","","type","button",3,"click"],["size","18px",3,"icIcon"],["fxLayout","column"],["fxLayout","row","fxLayout.lt-sm","column","fxLayoutGap","16px","fxLayoutGap.lt-sm","0"],["appearance","standard","fxFlex","40"],["formControlName","comprobante"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["appearance","standard","fxFlex","30"],["matInput","","name","start","formControlName","fechaemision",3,"matDatepicker"],["matSuffix","",3,"for"],["fechaDatePicker",""],["formControlName","moneda"],["fxLayout","column","fxLayout.gt-xs","row","fxLayoutAlign","center center",4,"ngIf"],["appearance","standard","fxFlex","85"],["matInput","","formControlName","cliente",3,"matAutocomplete"],["autoActiveFirstOption","","panelWidth","600px",3,"displayWith","optionSelected"],["autoCliente","matAutocomplete"],["matSuffix","",3,"icIcon",4,"ngIf"],["matSuffix","","class","cursor-pointer",3,"icIcon","click",4,"ngIf"],["fxFlex","15"],["mat-flat-button","","color","primary","type","button",3,"click"],["appearance","standard","fxFlex","30",3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["matInput","","name","clientenumerodoc","formControlName","clientenumerodoc",3,"readonly","keyup.enter"],["appearance","standard","fxFlex","70"],["matInput","","formControlName","cpecorreo"],["appearance","standard"],["matInput","","formControlName","clientedireccion"],["matInput","",3,"matAutocomplete","formControl"],["panelWidth","600px","autoActiveFirstOption","",3,"displayWith","optionSelected"],["autoProducto","matAutocomplete"],["formArrayName","ventadet"],[2,"width","50%"],[2,"width","12%"],[1,"text-center",2,"width","14%"],["mat-icon-button","","color","accent","type","button","matTooltip","Agregar linea",3,"click"],[3,"formGroupName",4,"ngFor","ngForOf"],["fxLayout","column","fxFlex","60"],["appearance","outline"],["matInput","","formControlName","condicionpago"],["matInput","","formControlName","observacion"],["fxFlex","40"],["fxFlex","70",1,"text-right"],["fxFlex","30",1,"text-right"],["matInput","","type","number","formControlName","descuentoporcentaje",2,"border","1px solid #CCC"],["matInput","","type","number","formControlName","cargo",2,"border","1px solid #CCC"],["fxFlex","70",1,"text-right","font-weight-600"],["fxLayout","row","fxLayoutAlign","space-between center"],["mat-icon-button","","type","button"],["cols","3"],[4,"ngFor","ngForOf"],["fxFlex","70"],["fxFlex","30"],["fxLayout","column","fxLayout.gt-xs","row","fxLayoutAlign","center center"],["type","button","mat-flat-button","","color","accent",3,"click"],["diameter","50"],["fxLayout","row","fxLayoutAlign","space-between center",3,"value","ngSwitch",4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","start center"],["fxLayout","row","fxLayoutAlign","space-between center",3,"value","ngSwitch"],["fxFlex","",1,"borde"],[1,"align-middle","mr-4","shadow-6","h-6","inline-block",3,"src"],[1,"body-1"],["fxFlex","",1,"text-right","borde"],["class","caption text-secondary ml-4",4,"ngSwitchCase"],["class","caption text-secondary ml-4",4,"ngSwitchDefault"],[1,"ml-1"],[1,"caption","text-secondary","ml-4"],["matSuffix","",3,"icIcon"],["matSuffix","",1,"cursor-pointer",3,"icIcon","click"],["fxFlex","75"],["fxFlex","10"],[3,"formGroupName"],["appearance","standard",1,"w-full"],["matInput","","placeholder","Ingrese producto","formControlName","producto",3,"matAutocomplete"],["auto","matAutocomplete"],["appearance","standard",2,"width","70px"],["matInput","","type","number","formControlName","cantidad"],["matInput","","type","number","formControlName","preciounit"],["matInput","","type","number","formControlName","total",1,"text-right",3,"readonly"],["type","button","mat-icon-button","","color","accent","matTooltip","Editar linea",3,"click"],["type","button","mat-icon-button","","color","warn","matTooltip","Eliminar linea",3,"click"],["fxFlex","80",1,"borde"],["fxFlex","20",1,"text-right","borde"],[1,"caption","text-secondary","mr-1"],["colspan","8",1,"text-center"],[1,"p-16"],["fxFlex","","matRipple","",1,"mr-sm-8","cursor-pointer",3,"matRippleCentered","click"],["mat-button","","type","button"]],template:function(t,e){if(1&t&&(m.Wb(0,"form",0),m.ec("ngSubmit",(function(){return e.modalMediopago()})),m.Wb(1,"div",1),m.Wb(2,"div",2),m.Wb(3,"div",3),m.Wb(4,"mat-card",4),m.Wb(5,"mat-card-header"),m.Wb(6,"mat-toolbar",5),m.Wb(7,"mat-toolbar-row",6),m.Wb(8,"div",7),m.Wb(9,"button",8),m.Wb(10,"mat-icon",9),m.Gc(11,"arrow_back"),m.Vb(),m.Vb(),m.Ec(12,pn,2,4,"span",10),m.Vb(),m.Wb(13,"div"),m.Wb(14,"button",11),m.Rb(15,"mat-icon",9),m.Gc(16," GENERAR "),m.Vb(),m.Wb(17,"button",12),m.Rb(18,"mat-icon",9),m.Vb(),m.Wb(19,"button",13),m.Rb(20,"mat-icon",9),m.Vb(),m.Wb(21,"mat-menu",null,14),m.Wb(23,"button",15),m.Rb(24,"mat-icon",9),m.Wb(25,"span"),m.Gc(26,"Emitir e imprimir"),m.Vb(),m.Vb(),m.Wb(27,"button",15),m.Rb(28,"mat-icon",9),m.Wb(29,"span"),m.Gc(30,"Vista previa"),m.Vb(),m.Vb(),m.Wb(31,"button",16),m.Rb(32,"mat-icon",9),m.Wb(33,"span"),m.Gc(34,"Guardar como borrador"),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Wb(35,"mat-toolbar-row",17),m.Wb(36,"button",18),m.ec("click",(function(){return e.modalGeneral()})),m.Rb(37,"mat-icon",19),m.Gc(38," GENERAL "),m.Vb(),m.Wb(39,"button",18),m.ec("click",(function(){return e.modalGuia()})),m.Rb(40,"mat-icon",19),m.Gc(41," GU\xcdA REMISI\xd3N "),m.Vb(),m.Wb(42,"button",18),m.ec("click",(function(){return e.modalGuia()})),m.Rb(43,"mat-icon",19),m.Gc(44," COTIZACI\xd3N "),m.Vb(),m.Wb(45,"button",18),m.ec("click",(function(){return e.resetForm()})),m.Rb(46,"mat-icon",19),m.Gc(47," NOTA DE SALIDA "),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Wb(48,"mat-card-content",20),m.Wb(49,"div",21),m.Wb(50,"mat-form-field",22),m.Wb(51,"mat-label"),m.Gc(52,"Comprobante"),m.Vb(),m.Wb(53,"mat-select",23),m.Wb(54,"mat-option",24),m.Gc(55,"Seleccione"),m.Vb(),m.Ec(56,fn,6,4,"mat-option",25),m.Vb(),m.Ec(57,vn,2,0,"mat-error",10),m.Vb(),m.Wb(58,"mat-form-field",26),m.Wb(59,"mat-label"),m.Gc(60,"Fecha emisi\xf3n"),m.Vb(),m.Rb(61,"input",27),m.Rb(62,"mat-datepicker-toggle",28),m.Rb(63,"mat-datepicker",null,29),m.Ec(65,gn,2,0,"mat-error",10),m.Vb(),m.Wb(66,"mat-form-field",26),m.Wb(67,"mat-label"),m.Gc(68,"Moneda"),m.Vb(),m.Wb(69,"mat-select",30),m.Wb(70,"mat-option",24),m.Gc(71,"Seleccione"),m.Vb(),m.Ec(72,hn,2,2,"mat-option",25),m.Vb(),m.Ec(73,Vn,2,0,"mat-error",10),m.Vb(),m.Vb(),m.Ec(74,yn,7,3,"div",31),m.Wb(75,"div",21),m.Wb(76,"mat-form-field",32),m.Wb(77,"mat-label"),m.Gc(78,"Clientex"),m.Vb(),m.Rb(79,"input",33),m.Wb(80,"mat-autocomplete",34,35),m.ec("optionSelected",(function(t){return e.autocompletadoClienteSelected(t.option.value)})),m.Ec(82,wn,2,0,"mat-option",10),m.Ec(83,_n,5,3,"ng-container",10),m.Vb(),m.Ec(84,Ln,1,1,"mat-icon",36),m.Ec(85,Dn,1,1,"mat-icon",37),m.Ec(86,An,2,0,"mat-error",10),m.Vb(),m.Wb(87,"div",38),m.Wb(88,"button",39),m.ec("click",(function(){return e.newEntidad()})),m.Gc(89," NUEVO "),m.Vb(),m.Vb(),m.Vb(),m.Wb(90,"div",21),m.Wb(91,"mat-form-field",40),m.Ec(92,Nn,2,0,"mat-label",41),m.Ec(93,Tn,2,0,"mat-label",41),m.Ec(94,On,2,0,"mat-label",41),m.Ec(95,Pn,2,0,"mat-label",41),m.Ec(96,jn,2,0,"mat-label",41),m.Ec(97,qn,2,0,"mat-label",42),m.Wb(98,"input",43),m.ec("keyup.enter",(function(){return e.indexEntidades()})),m.Vb(),m.Vb(),m.Wb(99,"mat-form-field",44),m.Wb(100,"mat-label"),m.Gc(101,"Correo"),m.Vb(),m.Rb(102,"input",45),m.Vb(),m.Vb(),m.Wb(103,"mat-form-field",46),m.Wb(104,"mat-label"),m.Gc(105,"Direcci\xf3n"),m.Vb(),m.Rb(106,"input",47),m.Vb(),m.Wb(107,"div",21),m.Wb(108,"mat-form-field",32),m.Wb(109,"mat-label"),m.Gc(110,"Producto"),m.Vb(),m.Rb(111,"input",48),m.Wb(112,"mat-autocomplete",49,50),m.ec("optionSelected",(function(t){return e.optionProductoSelected(t.option.value)})),m.Ec(114,Mn,9,6,"mat-option",25),m.jc(115,"async"),m.Vb(),m.Ec(116,Qn,1,1,"mat-icon",36),m.Ec(117,Bn,1,1,"mat-icon",37),m.Vb(),m.Wb(118,"div",38),m.Wb(119,"button",39),m.ec("click",(function(){return e.newProducto()})),m.Gc(120," NUEVO "),m.Vb(),m.Vb(),m.Vb(),m.Wb(121,"table",51),m.Wb(122,"thead"),m.Wb(123,"tr"),m.Wb(124,"th",52),m.Gc(125,"Nombre"),m.Vb(),m.Wb(126,"th",53),m.Gc(127,"Cantidad"),m.Vb(),m.Wb(128,"th",53),m.Gc(129,"P.Unit."),m.Vb(),m.Wb(130,"th",53),m.Gc(131,"Total"),m.Vb(),m.Wb(132,"th",54),m.Wb(133,"button",55),m.ec("click",(function(){return e.addItem()})),m.Rb(134,"mat-icon",9),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Wb(135,"tbody"),m.Ec(136,Zn,29,16,"tr",56),m.Ec(137,ti,4,0,"tr",10),m.Vb(),m.Vb(),m.Wb(138,"div",21),m.Wb(139,"div",57),m.Wb(140,"mat-form-field",58),m.Wb(141,"mat-label"),m.Gc(142,"Condiciones de pago"),m.Vb(),m.Rb(143,"textarea",59),m.Vb(),m.Wb(144,"mat-form-field",58),m.Wb(145,"mat-label"),m.Gc(146,"Observaciones"),m.Vb(),m.Rb(147,"textarea",60),m.Vb(),m.Vb(),m.Wb(148,"div",61),m.Wb(149,"fieldset"),m.Wb(150,"div",2),m.Wb(151,"div",62),m.Gc(152," % Descuento global "),m.Vb(),m.Wb(153,"div",63),m.Rb(154,"input",64),m.Vb(),m.Vb(),m.Wb(155,"div",2),m.Wb(156,"div",62),m.Gc(157," Descuento global (-) S/ "),m.Vb(),m.Wb(158,"div",63),m.Gc(159),m.jc(160,"number"),m.Vb(),m.Vb(),m.Wb(161,"div",2),m.Wb(162,"div",62),m.Gc(163," Descuento por \xedtem (-) S/ "),m.Vb(),m.Wb(164,"div",63),m.Gc(165),m.jc(166,"number"),m.Vb(),m.Vb(),m.Wb(167,"div",2),m.Wb(168,"div",62),m.Gc(169," Descuento total (-) S/ "),m.Vb(),m.Wb(170,"div",63),m.Gc(171),m.jc(172,"number"),m.Vb(),m.Vb(),m.Wb(173,"div",2),m.Wb(174,"div",62),m.Gc(175," Exonerada S/ "),m.Vb(),m.Wb(176,"div",63),m.Gc(177),m.jc(178,"number"),m.Vb(),m.Vb(),m.Wb(179,"div",2),m.Wb(180,"div",62),m.Gc(181," Inafecta S/ "),m.Vb(),m.Wb(182,"div",63),m.Gc(183),m.jc(184,"number"),m.Vb(),m.Vb(),m.Wb(185,"div",2),m.Wb(186,"div",62),m.Gc(187," Gravada S/ "),m.Vb(),m.Wb(188,"div",63),m.Gc(189),m.jc(190,"number"),m.Vb(),m.Vb(),m.Wb(191,"div",2),m.Wb(192,"div",62),m.Gc(193," IGV S/ "),m.Vb(),m.Wb(194,"div",63),m.Gc(195),m.jc(196,"number"),m.Vb(),m.Vb(),m.Wb(197,"div",2),m.Wb(198,"div",62),m.Gc(199," Gratuita S/ "),m.Vb(),m.Wb(200,"div",63),m.Gc(201),m.jc(202,"number"),m.Vb(),m.Vb(),m.Wb(203,"div",2),m.Wb(204,"div",62),m.Gc(205," Otros cargos S/ "),m.Vb(),m.Wb(206,"div",63),m.Rb(207,"input",65),m.Vb(),m.Vb(),m.Wb(208,"div",2),m.Wb(209,"div",66),m.Gc(210," Total S/ "),m.Vb(),m.Wb(211,"div",63),m.Gc(212),m.jc(213,"number"),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Wb(214,"div",61),m.Wb(215,"div",67),m.Wb(216,"h3"),m.Gc(217,"Productos destacados"),m.Vb(),m.Wb(218,"button",68),m.Rb(219,"mat-icon",9),m.Vb(),m.Vb(),m.Wb(220,"pre"),m.Gc(221),m.jc(222,"json"),m.Vb(),m.Wb(223,"mat-grid-list",69),m.Ec(224,ei,7,3,"mat-grid-tile",70),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Vb()),2&t){var o=m.uc(22),a=m.uc(64),n=m.uc(81),i=m.uc(113);m.oc("formGroup",e.ventaForm),m.Cb(9),m.oc("routerLink","/ventas"),m.Cb(1),m.oc("icIcon",e.icArrowBack),m.Cb(2),m.oc("ngIf",e.ventaForm.get("comprobante").value),m.Cb(3),m.oc("icIcon",e.icSend),m.Cb(2),m.oc("disabled",!e.ventaForm.valid||e.submitted),m.Cb(1),m.oc("icIcon",e.icSave),m.Cb(1),m.oc("matMenuTriggerFor",o),m.Cb(1),m.oc("icIcon",e.icMoreVert),m.Cb(3),m.oc("disabled",!e.ventaForm.valid||e.submitted),m.Cb(1),m.oc("icIcon",e.icPrint),m.Cb(3),m.oc("disabled",!e.ventaForm.valid||e.submitted),m.Cb(1),m.oc("icIcon",e.icPrint),m.Cb(4),m.oc("icIcon",e.icInsertDriveFile),m.Cb(5),m.oc("icIcon",e.icSettings),m.Cb(3),m.oc("icIcon",e.icInsertDriveFile),m.Cb(3),m.oc("icIcon",e.icInsertDriveFile),m.Cb(3),m.oc("icIcon",e.icInsertDriveFile),m.Cb(8),m.oc("value",null),m.Cb(2),m.oc("ngForOf",e.comprobantes),m.Cb(1),m.oc("ngIf",e.ventaForm.get("comprobante").hasError("required")),m.Cb(4),m.oc("matDatepicker",a),m.Cb(1),m.oc("for",a),m.Cb(3),m.oc("ngIf",e.ventaForm.get("fechaemision").hasError("required")),m.Cb(5),m.oc("value",null),m.Cb(2),m.oc("ngForOf",e.monedas),m.Cb(1),m.oc("ngIf",e.ventaForm.get("moneda").hasError("required")),m.Cb(1),m.oc("ngIf",e.ventaForm.get("comprobante").value&&13===e.ventaForm.get("comprobante").value.iddocumentofiscal),m.Cb(5),m.oc("matAutocomplete",n),m.Cb(1),m.oc("displayWith",e.displaySearchEntidad),m.Cb(2),m.oc("ngIf",e.isLoadingSearch),m.Cb(1),m.oc("ngIf",!e.isLoadingSearch),m.Cb(1),m.oc("ngIf",!e.ventaForm.get("cliente").value),m.Cb(1),m.oc("ngIf",e.ventaForm.get("cliente").value),m.Cb(1),m.oc("ngIf",e.ventaForm.get("cliente").hasError("required")),m.Cb(5),m.oc("ngSwitch",e.ventaForm.get("clientedoc").value),m.Cb(1),m.oc("ngSwitchCase",1),m.Cb(1),m.oc("ngSwitchCase",2),m.Cb(1),m.oc("ngSwitchCase",3),m.Cb(1),m.oc("ngSwitchCase",4),m.Cb(1),m.oc("ngSwitchCase",5),m.Cb(2),m.oc("readonly",!0),m.Cb(13),m.oc("matAutocomplete",i)("formControl",e.producto),m.Cb(1),m.oc("displayWith",e.displayProductoFn),m.Cb(2),m.oc("ngForOf",m.kc(115,63,e.filteredOptions)),m.Cb(2),m.oc("ngIf",!e.producto.value),m.Cb(1),m.oc("ngIf",e.producto.value),m.Cb(17),m.oc("icIcon",e.icAdd),m.Cb(2),m.oc("ngForOf",e.ventaForm.get("ventadet").controls),m.Cb(1),m.oc("ngIf",0===e.ventadet.controls.length),m.Cb(22),m.Ic(" ",m.lc(160,65,e.ventaForm.get("descuentoglobal").value,"1.2-2")," "),m.Cb(6),m.Ic(" ",m.lc(166,68,e.ventaForm.get("descuentoitem").value,"1.2-2")," "),m.Cb(6),m.Ic(" ",m.lc(172,71,e.ventaForm.get("descuentototal").value,"1.2-2")," "),m.Cb(6),m.Ic(" ",m.lc(178,74,e.ventaForm.get("exonerada").value,"1.2-2")," "),m.Cb(6),m.Ic(" ",m.lc(184,77,e.ventaForm.get("inafecta").value,"1.2-2")," "),m.Cb(6),m.Ic(" ",m.lc(190,80,e.ventaForm.get("gravada").value,"1.2-2")," "),m.Cb(6),m.Ic(" ",m.lc(196,83,e.ventaForm.get("valorimpuesto").value,"1.2-2")," "),m.Cb(6),m.Ic(" ",m.lc(202,86,e.ventaForm.get("gratuita").value,"1.2-2")," "),m.Cb(11),m.Ic(" ",m.lc(213,89,e.ventaForm.get("total").value,"1.2-2")," "),m.Cb(7),m.oc("icIcon",e.icSettings),m.Cb(2),m.Ic("          ",m.kc(222,92,e.ventaForm.value)," \n        "),m.Cb(3),m.oc("ngForOf",e.productos)}},directives:[c.w,c.q,c.i,I.c,I.a,bn.a,bn.d,ot.a,ot.c,I.b,E.b,G.a,i.g,k.a,R.a,w.p,He.b,et.c,et.d,et.a,bn.c,I.d,re.d,re.h,Ae.a,c.p,c.g,Ne.n,w.o,le.b,c.b,Ue.b,Ue.d,re.j,Ue.a,$e.c,$e.a,w.r,w.s,w.t,c.f,c.d,c.s,mn.a,re.c,Ye.b,c.j,mn.c,Ne.s,bn.b],pipes:[w.b,w.f,w.h,Ze.a,w.x],styles:["#ventas-form .content{padding:24px}#ventas-form .content fieldset{border:1px solid #ccc;border-radius:8px;padding:8px}#ventas-form .content fieldset legend{padding:0 8px}#ventas-form .cardcustom mat-card-header{margin:-16px -16px 0}#ventas-form .cardcustom mat-card-header mat-toolbar{border-radius:4px 4px 0 0}#ventas-form .cardcustom .mat-card-header-text{margin:0}#ventas-form .mat-select-panel mat-option.mat-option{height:unset;border:1px solid red}#ventas-form .mat-option-text.mat-option-text{white-space:normal;border:1px solid red}#ventas-form .borde{border:1px solid #000!important}"],encapsulation:2}),oi),ni=o("iTUp"),ii=o("cc8n"),ci=o("YioD"),ri=o("iWjc"),li=o("7lCJ"),ui=o("J0XA"),si=o("We1G"),di=o.n(si),bi=o("6qmq"),mi=o.n(bi),pi=o("kYjG");function fi(t,e){1&t&&(m.Wb(0,"span"),m.Gc(1,"comprobante electr\xf3nico"),m.Vb())}function vi(t,e){if(1&t&&(m.Wb(0,"span"),m.Gc(1),m.Vb()),2&t){var o=m.ic();m.Cb(1),m.Ic(" Nueva ",o.comprobante.value.documentofiscal.nombre," ")}}function gi(t,e){if(1&t&&(m.Wb(0,"mat-option",75),m.Wb(1,"div",76),m.Wb(2,"span",77),m.Gc(3),m.Vb(),m.Wb(4,"span",78),m.Gc(5),m.Vb(),m.Vb(),m.Vb()),2&t){var o=e.$implicit;m.oc("value",o),m.Cb(3),m.Ic("",o.documentofiscal.nombre," "),m.Cb(2),m.Jc("",o.serie," - ",o.numero,"")}}function hi(t,e){1&t&&(m.Wb(0,"mat-error"),m.Gc(1," Requerido! "),m.Vb())}function Vi(t,e){if(1&t&&(m.Wb(0,"mat-option",75),m.Gc(1),m.Vb()),2&t){var o=e.$implicit;m.oc("value",o.moneda),m.Cb(1),m.Ic(" ",o.nombre," ")}}function Ci(t,e){1&t&&(m.Wb(0,"mat-error"),m.Gc(1," Requerido! "),m.Vb())}function xi(t,e){1&t&&(m.Wb(0,"mat-error"),m.Gc(1," Requerido! "),m.Vb())}function Wi(t,e){if(1&t&&(m.Wb(0,"mat-option",75),m.Gc(1),m.Vb()),2&t){var o=e.$implicit;m.oc("value",o.operacion),m.Cb(1),m.Ic(" ",o.nombre," ")}}function yi(t,e){1&t&&(m.Wb(0,"mat-error"),m.Gc(1," Requerido! "),m.Vb())}function wi(t,e){1&t&&(m.Wb(0,"span"),m.Gc(1," Comprobante a emitir Nota de cr\xe9dito "),m.Vb())}function Fi(t,e){1&t&&(m.Wb(0,"span"),m.Gc(1," Comprobante a emitir Nota de d\xe9bito "),m.Vb())}function Ii(t,e){1&t&&(m.Wb(0,"span"),m.Gc(1,' "Factura '),m.Vb())}function Ei(t,e){1&t&&(m.Wb(0,"span"),m.Gc(1,' "Boleta de venta '),m.Vb())}function Gi(t,e){if(1&t&&(m.Wb(0,"span"),m.Gc(1),m.Vb()),2&t){var o=m.ic(2);m.Cb(1),m.Jc(" ",o.ventaForm.get("serienc").value," - ",o.ventaForm.get("numeronc").value,'" ')}}function ki(t,e){if(1&t){var o=m.Xb();m.Wb(0,"div",12),m.Wb(1,"button",79),m.ec("click",(function(){return m.wc(o),m.ic().modalNotacredito()})),m.Ec(2,wi,2,0,"span",6),m.Ec(3,Fi,2,0,"span",6),m.Ec(4,Ii,2,0,"span",6),m.Ec(5,Ei,2,0,"span",6),m.Ec(6,Gi,2,2,"span",6),m.Vb(),m.Vb()}if(2&t){var a=m.ic();m.Cb(2),m.oc("ngIf",13===a.comprobante.value.iddocumentofiscal),m.Cb(1),m.oc("ngIf",10===a.comprobante.value.iddocumentofiscal),m.Cb(1),m.oc("ngIf",1===a.ventaForm.get("documentonc").value),m.Cb(1),m.oc("ngIf",2===a.ventaForm.get("documentonc").value),m.Cb(1),m.oc("ngIf",a.ventaForm.get("documentonc").value)}}function Ri(t,e){1&t&&(m.Wb(0,"mat-option",80),m.Rb(1,"mat-spinner",81),m.Vb())}function Si(t,e){if(1&t&&m.Rb(0,"ic-icon",93),2&t){var o=m.ic(3);m.oc("icIcon",o.icAccountCircle)}}function _i(t,e){if(1&t&&m.Rb(0,"ic-icon",93),2&t){var o=m.ic(3);m.oc("icIcon",o.icDomain)}}function Li(t,e){1&t&&(m.Wb(0,"small",94),m.Gc(1,"DNI"),m.Vb())}function Di(t,e){1&t&&(m.Wb(0,"small",94),m.Gc(1,"RUC"),m.Vb())}function Ai(t,e){1&t&&(m.Wb(0,"small",94),m.Gc(1,"C.Ext."),m.Vb())}function Ni(t,e){1&t&&(m.Wb(0,"small",94),m.Gc(1,"Pasap."),m.Vb())}function Ti(t,e){1&t&&(m.Wb(0,"small",94),m.Gc(1,"Sin D."),m.Vb())}function Oi(t,e){1&t&&(m.Wb(0,"small",94),m.Gc(1,"Identificaci\xf3n"),m.Vb())}var Pi=function(){return[1,3,4,5,6,7]};function ji(t,e){if(1&t&&(m.Wb(0,"mat-option",85),m.Wb(1,"div",86),m.Wb(2,"div",87),m.Ec(3,Si,1,1,"ic-icon",88),m.Ec(4,_i,1,1,"ic-icon",88),m.Vb(),m.Wb(5,"div",89),m.Wb(6,"small"),m.Gc(7),m.Vb(),m.Wb(8,"div",86),m.Ec(9,Li,2,0,"small",90),m.Ec(10,Di,2,0,"small",90),m.Ec(11,Ai,2,0,"small",90),m.Ec(12,Ni,2,0,"small",90),m.Ec(13,Ti,2,0,"small",90),m.Ec(14,Oi,2,0,"small",91),m.Wb(15,"small",92),m.Gc(16),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Vb()),2&t){var o=e.$implicit;m.oc("value",o)("ngSwitch",o.iddocumento),m.Cb(3),m.oc("ngIf",-1!==m.pc(11,Pi).indexOf(o.iddocumento)),m.Cb(1),m.oc("ngIf",2===o.iddocumento),m.Cb(3),m.Hc(o.entidad),m.Cb(2),m.oc("ngSwitchCase",1),m.Cb(1),m.oc("ngSwitchCase",2),m.Cb(1),m.oc("ngSwitchCase",3),m.Cb(1),m.oc("ngSwitchCase",4),m.Cb(1),m.oc("ngSwitchCase",5),m.Cb(3),m.Hc(o.numerodoc)}}function qi(t,e){if(1&t&&(m.Ub(0),m.Ec(1,ji,17,12,"mat-option",82),m.Wb(2,"div",83),m.Wb(3,"small",84),m.Gc(4),m.Vb(),m.Vb(),m.Tb()),2&t){var o=m.ic();m.Cb(1),m.oc("ngForOf",o.searchResult.data),m.Cb(3),m.Jc("Mostrando ",o.searchResult.to," de ",o.searchResult.total," resultados.")}}function Mi(t,e){if(1&t&&m.Rb(0,"mat-icon",95),2&t){var o=m.ic();m.oc("icIcon",o.icSearch)}}function Qi(t,e){if(1&t){var o=m.Xb();m.Wb(0,"mat-icon",96),m.ec("click",(function(){return m.wc(o),m.ic().cliente.setValue("")})),m.Vb()}if(2&t){var a=m.ic();m.oc("icIcon",a.icClose)}}function Bi(t,e){1&t&&(m.Wb(0,"mat-error"),m.Gc(1," Requerido "),m.Vb())}function zi(t,e){1&t&&(m.Wb(0,"mat-label"),m.Gc(1,"DNI"),m.Vb())}function Hi(t,e){1&t&&(m.Wb(0,"mat-label"),m.Gc(1,"RUC"),m.Vb())}function Xi(t,e){1&t&&(m.Wb(0,"mat-label"),m.Gc(1,"C.Extranjeria"),m.Vb())}function $i(t,e){1&t&&(m.Wb(0,"mat-label"),m.Gc(1,"Pasaporte"),m.Vb())}function Ui(t,e){1&t&&(m.Wb(0,"mat-label"),m.Gc(1,"Sin Documento"),m.Vb())}function Ki(t,e){1&t&&(m.Wb(0,"mat-label"),m.Gc(1,"DNI / RUC / Otros"),m.Vb())}function Ji(t,e){if(1&t&&m.Rb(0,"mat-icon",95),2&t){var o=m.ic();m.oc("icIcon",o.icSearch)}}function Yi(t,e){if(1&t){var o=m.Xb();m.Wb(0,"mat-icon",96),m.ec("click",(function(){m.wc(o);var t=m.ic();return t.ventaForm.get("clientenumerodoc").setValue(""),t.cliente.setValue("")})),m.Vb()}if(2&t){var a=m.ic();m.oc("icIcon",a.icClose)}}function Zi(t,e){if(1&t&&(m.Wb(0,"mat-label"),m.Gc(1),m.Vb()),2&t){var o=m.ic().$implicit;m.Cb(1),m.Hc(o.get("producto").value.codigo)}}function tc(t,e){1&t&&(m.Wb(0,"mat-option",80),m.Rb(1,"mat-spinner",81),m.Vb())}function ec(t,e){if(1&t&&(m.Wb(0,"mat-option",75),m.Wb(1,"div",87),m.Wb(2,"small"),m.Gc(3),m.Vb(),m.Wb(4,"div",86),m.Wb(5,"small",94),m.Gc(6,"Precio"),m.Vb(),m.Wb(7,"small",92),m.Gc(8),m.Vb(),m.Vb(),m.Vb(),m.Vb()),2&t){var o=e.$implicit;m.oc("value",o),m.Cb(3),m.Hc(o.nombre),m.Cb(5),m.Hc(o.precio)}}function oc(t,e){if(1&t&&(m.Ub(0),m.Ec(1,ec,9,3,"mat-option",16),m.Tb()),2&t){var o=m.ic().$implicit;m.Cb(1),m.oc("ngForOf",o.get("datalist").value)}}function ac(t,e){if(1&t&&m.Rb(0,"mat-icon",95),2&t){var o=m.ic(2);m.oc("icIcon",o.icSearch)}}function nc(t,e){if(1&t){var o=m.Xb();m.Wb(0,"mat-icon",96),m.ec("click",(function(){return m.wc(o),m.ic().$implicit.get("producto").setValue("")})),m.Vb()}if(2&t){var a=m.ic(2);m.oc("icIcon",a.icClose)}}function ic(t,e){if(1&t&&(m.Wb(0,"mat-option",75),m.Gc(1),m.Vb()),2&t){var o=e.$implicit;m.oc("value",o.idimpuesto),m.Cb(1),m.Ic(" ",o.nombre," ")}}function cc(t,e){if(1&t&&(m.Wb(0,"div",114),m.Wb(1,"div",73),m.Wb(2,"button",115),m.ec("click",(function(){return(0,e.close)()})),m.Rb(3,"mat-icon",8),m.Vb(),m.Vb(),m.Wb(4,"div",12),m.Wb(5,"div",116),m.Rb(6,"mat-slide-toggle",117),m.Vb(),m.Wb(7,"mat-form-field",118),m.Wb(8,"mat-label"),m.Gc(9,"Impuesto a bolsa pl\xe1stica"),m.Vb(),m.Rb(10,"input",119),m.Vb(),m.Vb(),m.Wb(11,"mat-form-field",120),m.Wb(12,"mat-label"),m.Gc(13,"Descuento (Aplica al Sub total)"),m.Vb(),m.Rb(14,"input",121),m.Vb(),m.Wb(15,"mat-form-field",120),m.Wb(16,"mat-label"),m.Gc(17,"IGV de \xedtem"),m.Vb(),m.Rb(18,"input",122),m.Vb(),m.Vb()),2&t){var o=m.ic(2);m.Cb(3),m.oc("icIcon",o.icClose)}}function rc(t,e){if(1&t){var o=m.Xb();m.Wb(0,"div",97),m.Wb(1,"mat-form-field",98),m.Ec(2,Zi,2,1,"mat-label",6),m.Rb(3,"input",99),m.Wb(4,"mat-autocomplete",32,100),m.ec("optionSelected",(function(){m.wc(o);var t=e.$implicit;return m.ic().autocompletadoProductoSelected(t)})),m.Ec(6,tc,2,0,"mat-option",34),m.Ec(7,oc,2,1,"ng-container",6),m.Vb(),m.Ec(8,ac,1,1,"mat-icon",35),m.Ec(9,nc,1,1,"mat-icon",36),m.Vb(),m.Wb(10,"mat-form-field",101),m.Rb(11,"input",102),m.Vb(),m.Wb(12,"mat-form-field",103),m.Rb(13,"input",104),m.Vb(),m.Wb(14,"mat-form-field",103),m.Wb(15,"mat-select",105),m.Ec(16,ic,2,2,"mat-option",16),m.Vb(),m.Vb(),m.Wb(17,"mat-form-field",103),m.Rb(18,"input",106),m.Vb(),m.Wb(19,"mat-form-field",103),m.Rb(20,"input",107),m.Vb(),m.Wb(21,"mat-form-field",103),m.Rb(22,"input",108),m.Vb(),m.Wb(23,"div",109,110),m.Wb(25,"button",111),m.ec("click",(function(){m.wc(o);var t=e.index;return m.ic().deleteItem(t)})),m.Rb(26,"mat-icon",8),m.Vb(),m.Wb(27,"button",112),m.ec("click",(function(){m.wc(o);var t=e.$implicit,a=m.uc(30),n=m.uc(24);return m.ic().openAddList(t,a,n)})),m.Rb(28,"mat-icon",8),m.Vb(),m.Ec(29,cc,19,1,"ng-template",null,113,m.Fc),m.Vb(),m.Vb()}if(2&t){var a=e.$implicit,n=e.index,i=m.uc(5),c=m.ic();m.oc("formGroupName",n),m.Cb(2),m.oc("ngIf",a.get("producto").value),m.Cb(1),m.oc("matAutocomplete",i),m.Cb(1),m.oc("displayWith",c.displayProductoFn),m.Cb(2),m.oc("ngIf",a.get("datalistloading").value),m.Cb(1),m.oc("ngIf",!a.get("datalistloading").value),m.Cb(1),m.oc("ngIf",!a.get("producto").value),m.Cb(1),m.oc("ngIf",a.get("producto").value),m.Cb(7),m.oc("ngForOf",c.impuestos),m.Cb(10),m.oc("icIcon",c.icDelete),m.Cb(2),m.oc("icIcon",c.icEdit)}}function lc(t,e){if(1&t){var o=m.Xb();m.Wb(0,"div",123),m.Wb(1,"button",124),m.ec("click",(function(){return m.wc(o),m.ic().addItem()})),m.Rb(2,"mat-icon",8),m.Vb(),m.Vb()}if(2&t){var a=m.ic();m.Cb(2),m.oc("icIcon",a.icAdd)}}function uc(t,e){if(1&t&&(m.Wb(0,"div",65),m.Wb(1,"div",125),m.Gc(2," Descuento total (-) S/ "),m.Vb(),m.Wb(3,"div",126),m.Gc(4),m.jc(5,"number"),m.Vb(),m.Vb()),2&t){var o=m.ic();m.Cb(4),m.Ic(" ",m.lc(5,1,o.ventaForm.get("descuentototal").value,"1.2-2")," ")}}function sc(t,e){if(1&t&&(m.Wb(0,"div",65),m.Wb(1,"div",66),m.Gc(2," Exonerada S/ "),m.Vb(),m.Wb(3,"div",67),m.Gc(4),m.jc(5,"number"),m.Vb(),m.Vb()),2&t){var o=m.ic();m.Cb(4),m.Ic(" ",m.lc(5,1,o.ventaForm.get("exonerada").value,"1.2-2")," ")}}function dc(t,e){if(1&t&&(m.Wb(0,"div",65),m.Wb(1,"div",66),m.Gc(2," Inafecta S/ "),m.Vb(),m.Wb(3,"div",67),m.Gc(4),m.jc(5,"number"),m.Vb(),m.Vb()),2&t){var o=m.ic();m.Cb(4),m.Ic(" ",m.lc(5,1,o.ventaForm.get("inafecta").value,"1.2-2")," ")}}function bc(t,e){if(1&t&&(m.Wb(0,"div",65),m.Wb(1,"div",66),m.Gc(2," Gratuita S/ "),m.Vb(),m.Wb(3,"div",67),m.Gc(4),m.jc(5,"number"),m.Vb(),m.Vb()),2&t){var o=m.ic();m.Cb(4),m.Ic(" ",m.lc(5,1,o.ventaForm.get("gratuita").value,"1.2-2")," ")}}function mc(t,e){if(1&t&&(m.Wb(0,"div",65),m.Wb(1,"div",66),m.Gc(2," ICBPER "),m.Vb(),m.Wb(3,"div",67),m.Gc(4),m.jc(5,"number"),m.Vb(),m.Vb()),2&t){var o=m.ic();m.Cb(4),m.Ic(" ",m.lc(5,1,o.ventaForm.get("totalimpuestobolsa").value,"1.2-2")," ")}}var pc,fc,vc=((pc=function(){function t(e,o,a,n,i,r,l,u,s,d){_classCallCheck(this,t),this.activatedRoute=e,this._matDialog=o,this.snackBar=a,this._entidadService=n,this._ventaService=i,this._documentoserieService=r,this._productoService=l,this._utils=u,this._datainicial=s,this.popover=d,this.submitted=!1,this.paramRoute=null,this.ventaNcNd=null,this.pipeDate=new w.e("es-Pe"),this.comprobante=new c.e(null,[c.v.required]),this.comprobantes=[],this.cliente=new c.e(null,[c.v.required]),this.searchResult={data:[],to:null,total:null},this.isLoadingSearch=!1,this.tiponc=this._datainicial.tiponc,this.monedas=this._datainicial.monedas,this.impuestos=this._datainicial.impuestos,this.operaciones=this._datainicial.operaciones,this.comprobantenc=this._datainicial.comprobantenc,this.icAdd=We.a,this.icEdit=P.a,this.icSend=rn.a,this.icSave=un.a,this.icPrint=V.a,this.icClose=x.a,this.icSearch=Ce.a,this.icDelete=we.a,this.icDomain=di.a,this.icMoreVert=z.a,this.icSettings=on.a,this.icArrowBack=nn.a,this.icAccountCircle=mi.a,this.icInsertDriveFile=X.a,this.leyenda={exonerada:!1,inafecta:!1,gratuita:!1,icpber:!1},this.settings=this._entidadService.settings,this.ventaForm=this.createForm()}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.settings.mediopago&&this.ventaForm.addControl("ventapago",new c.c([],[c.v.required])),this.activatedRoute.params.subscribe((function(e){if(t.resetForm(),t.paramRoute=e,t.paramRoute.comprobante)switch(t.paramRoute.comprobante.toUpperCase()){case"FACTURA":t.comprobantedefault=1;break;case"BOLETADEVENTA":t.comprobantedefault=2;break;case"NOTADECREDITO":t.comprobantedefault=13;break;case"NOTADEDEBITO":t.comprobantedefault=10}var o=null;t.comprobantes.forEach((function(e){e.iddocumentofiscal===t.comprobantedefault&&(o=e)})),console.log("itemSelected",o),o&&t.comprobante.setValue(o),t.paramRoute.venta&&t.show()})),this.cliente.valueChanges.pipe(Object(r.a)(300),Object(l.a)((function(){return t.isLoadingSearch=!0})),Object(u.a)((function(e){if("string"==typeof e&&(t.ventaForm.get("idcliente").setValue(null),t.ventaForm.get("cpecorreo").setValue(null),t.ventaForm.get("clientenombre").setValue(null),t.ventaForm.get("clientedoc").setValue(null),t.ventaForm.get("clientenumerodoc").setValue(null,{emitEvent:!1}),t.ventaForm.get("clientedireccion").setValue(null)),"string"==typeof e&&e){console.log("get API CLIENTE");var o={idempresa:t._entidadService.usuario.idempresa,page:1,pageSize:10,orderName:"entidad",orderSort:"asc"};return parseFloat(e)>0?o.likeNumerodoc=e:o.likeEntidad=e,t._entidadService.index(o).pipe(Object(s.a)((function(){return t.isLoadingSearch=!1})))}return t.isLoadingSearch=!1,[]}))).subscribe((function(e){t.searchResult=e})),this.comprobante.valueChanges.subscribe((function(e){e&&e.iddocumentofiscal?(console.log("---\x3e",e.iddocumentofiscal,e.serie),t.ventaForm.get("iddocumentofiscal").setValue(e.iddocumentofiscal),t.ventaForm.get("serie").setValue(e.serie),t.ventaForm.get("numero").setValue(e.numero),13===e.iddocumentofiscal||10===e.iddocumentofiscal?(t.ventaForm.get("tiponc").setValue(1),t.ventaNcNd&&t.ventaNcNd.serie===e.serie?(t.ventaForm.get("documentonc").setValue(t.ventaNcNd.iddocumentofiscal),t.ventaForm.get("serienc").setValue(t.ventaNcNd.serie),t.ventaForm.get("numeronc").setValue(t.ventaNcNd.numero)):(t.ventaForm.get("documentonc").setValue(null),t.ventaForm.get("serienc").setValue(null),t.ventaForm.get("numeronc").setValue(null))):(t.ventaForm.get("tiponc").setValue(null),t.ventaForm.get("documentonc").setValue(null),t.ventaForm.get("serienc").setValue(null),t.ventaForm.get("numeronc").setValue(null))):(console.log("-vacio->"),t.ventaForm.get("iddocumentofiscal").setValue(null),t.ventaForm.get("serie").setValue(null),t.ventaForm.get("numero").setValue(null),t.ventaForm.get("tiponc").setValue(null),t.ventaForm.get("documentonc").setValue(null),t.ventaForm.get("serienc").setValue(null),t.ventaForm.get("numeronc").setValue(null))})),this.ventaForm.get("ventadet").valueChanges.subscribe((function(e){var o=!1,a=!1,n=!1,i=!1;e.forEach((function(t,e){switch(t.idimpuesto){case 8:o=!0;break;case 9:a=!0;break;case 2:n=!0}t.bolsa&&(i=!0)})),t.leyenda={exonerada:o,inafecta:a,gratuita:n,icpber:i}})),this.ventaForm.get("clientenumerodoc").valueChanges.pipe(Object(r.a)(300),Object(u.a)((function(e){if("string"!=typeof e||8!==e.length&&11!==e.length)return[];var o={page:1,pageSize:10,orderName:"entidad",orderSort:"asc"};return o.numerodoc=e,t._entidadService.index(o)}))).subscribe((function(e){if(e.data.length){var o=e.data[0];t.ventaForm.get("idcliente").setValue(o.identidad),t.ventaForm.get("cpecorreo").setValue(o.email),t.ventaForm.get("clientenombre").setValue(o.entidad),t.ventaForm.get("clientedoc").setValue(o.iddocumento),t.ventaForm.get("clientenumerodoc").setValue(o.numerodoc,{emitEvent:!1}),t.ventaForm.get("clientedireccion").setValue(o.direccion),t.cliente.setValue(o,{emitEvent:!1}),t.searchResult=e}})),this.ventaForm.get("cargo").valueChanges.subscribe((function(e){e=t._utils.redondearValor(e,2),t.ventaForm.get("cargo").setValue(e,{emitEvent:!1}),t.calcularTotales()})),this.ventaForm.get("descuentoporcentaje").valueChanges.subscribe((function(e){e=t._utils.redondearValor(e,2),t.ventaForm.get("descuentoporcentaje").setValue(e,{emitEvent:!1}),t.calcularTotales()})),this.indexDocumentoseries(),this.paramRoute.venta||(this.addItem(),this.addItem(),this.addItem())}},{key:"show",value:function(){var t=this;this._ventaService.show(this.paramRoute.venta,{conRecurso:"ventadet.producto,cliente,ventapago"}).subscribe((function(e){t.inicializarCliente(e.data),t.inicializarVenta(e.data)}),(function(t){console.log(t)}))}},{key:"createForm",value:function(){return new c.h({idsede:new c.e(this._entidadService.sedeDefault||null),iddocumentofiscal:new c.e(null),serie:new c.e(null),numero:new c.e(null),idcliente:new c.e(null),fechaemision:new c.e(new Date,[c.v.required]),fechavencimiento:new c.e(new Date),idestadodocumento:new c.e(27,[c.v.required]),cpecorreo:new c.e(null),clientenombre:new c.e(null),clientedoc:new c.e(null),clientenumerodoc:new c.e(null),clientedireccion:new c.e(null),operacion:new c.e(1,[c.v.required]),moneda:new c.e("PEN",[c.v.required]),tipocambio:new c.e(null),detraccion:new c.e(!1),selvaproducto:new c.e(!1),selvaservicio:new c.e(!1),placavehiculo:new c.e(null),ordencompra:new c.e(null),guiaremitente:new c.e(null),guiatransportista:new c.e(null),exonerada:new c.e(null),inafecta:new c.e(null),gratuita:new c.e(null),gravada:new c.e(null,[c.v.required]),valorimpuesto:new c.e(null,[c.v.required]),total:new c.e(null,[c.v.required]),pagado:new c.e(null),vuelto:new c.e(null),condicionpago:new c.e(null),pdfformato:new c.e("A4"),observacion:new c.e(null),ventadet:new c.c([],[c.v.required]),tiponc:new c.e(null),documentonc:new c.e(null),serienc:new c.e(null),numeronc:new c.e(null),descuentoporcentaje:new c.e(null,[c.v.min(0)]),descuentoglobal:new c.e(null),descuentoitem:new c.e(null),descuentototal:new c.e(null),cargo:new c.e(null,[c.v.min(0)]),totalimpuestobolsa:new c.e(null)})}},{key:"inicializarCliente",value:function(t){var e={identidad:t.cliente.identidad,email:t.cliente.email,entidad:t.cliente.entidad,iddocumento:t.cliente.iddocumento,numerodoc:t.cliente.numerodoc,direccion:t.cliente.direccion};this.cliente.setValue(e),this.cliente.updateValueAndValidity(),this.autocompletadoClienteSelected(e),this.searchResult.data.push(e),this.searchResult.to+=1,this.searchResult.total+=1}},{key:"inicializarVenta",value:function(t){var e=this;console.log("PRIMERO inicializarVenta()"),this.ventaNcNd=t,this.ventaForm.get("idsede").setValue(t.idsede),this.ventaForm.get("operacion").setValue(t.operacion),this.ventaForm.get("pdfformato").setValue(t.pdfformato),this.ventaForm.get("moneda").setValue(t.moneda),this.ventaForm.get("selvaproducto").setValue("1"===t.selvaproducto),this.ventaForm.get("selvaservicio").setValue("1"===t.selvaservicio),13!==this.comprobantedefault&&10!==this.comprobantedefault||(this.ventaForm.get("tiponc").setValue(1),this.ventaForm.get("documentonc").setValue(t.iddocumentofiscal),this.ventaForm.get("serienc").setValue(t.serie),this.ventaForm.get("numeronc").setValue(t.numero)),t.ventadet.forEach((function(t){var o={idproducto:t.producto.idproducto,codigo:t.producto.codigo,nombre:t.producto.nombre,precio:parseFloat(t.preciounit),unidadmedida:t.producto.unidadmedida,codigosunat:t.producto.codigosunat,idimpuesto:t.idimpuesto,stock:null},a={producto:o,descripcion:t.descripcion,idimpuesto:t.idimpuesto,cantidad:parseFloat(t.cantidad),valorunit:parseFloat(t.valorunit),descuento:parseFloat(t.descuento),valorventa:parseFloat(t.valorventa),impuestobolsa:parseFloat(t.impuestobolsa),montototalimpuestos:parseFloat(t.montototalimpuestos),preciounit:parseFloat(t.preciounit),total:parseFloat(t.total),bolsa:parseFloat(t.impuestobolsa)>0,datalist:[new c.e(o)]};e.addItem(a)})),this.calcularTotales();var o=null;this.comprobantes.forEach((function(t){t.iddocumentofiscal===e.comprobantedefault&&e.ventaNcNd&&t.serie===e.ventaNcNd.serie&&(o=t)})),o&&this.comprobante.setValue(o)}},{key:"calcularTotales",value:function(){console.log("calcularTotales()");var t,e,o=0,a=0,n=0,i=0,c=0,r=0,l=0,u=0,s=this.ventaForm.get("cargo").value||0,d=this.ventaForm.get("descuentoporcentaje").value;if(this.ventadet.getRawValue().forEach((function(t){null!==t.total&&(c+=t.descuento,l+=t.impuestobolsa||0,1===t.idimpuesto&&(o+=t.valorventa,u+=t.montototalimpuestos),8===t.idimpuesto&&(a+=t.total),9===t.idimpuesto&&(n+=t.total),2===t.idimpuesto&&(i+=t.total))})),d>0){var b;r=(o+a+n)*(b=d/100),r=this._utils.redondearValor(r,2),a-=a*b,a=this._utils.redondearValor(a,2),n-=n*b,n=this._utils.redondearValor(n,2);var m=o+u;m-=m*b;var p=(m=this._utils.redondearValor(m,2))/1.18,f=.18*p;o=this._utils.redondearValor(p,2),u=this._utils.redondearValor(f,2)}t=this._utils.redondearValor(c+r,2),e=this._utils.redondearValor(o+u+a+n+s+l,2),this.ventaForm.get("descuentoglobal").setValue(r),this.ventaForm.get("exonerada").setValue(a),this.ventaForm.get("inafecta").setValue(n),this.ventaForm.get("gratuita").setValue(i),this.ventaForm.get("gravada").setValue(o),this.ventaForm.get("descuentoitem").setValue(c),this.ventaForm.get("descuentototal").setValue(t),this.ventaForm.get("valorimpuesto").setValue(u),this.ventaForm.get("totalimpuestobolsa").setValue(l),this.ventaForm.get("total").setValue(e)}},{key:"autocompletadoProductoSelected",value:function(t){var e=t.value,o=e.cantidad||1,a=this._utils.calculoLinea(e.producto.idimpuesto||1,e.producto.precio||0,o,e.descuento||null);this.setImpuesto(t,a),this.setImpuestoBolsa(t,o,e.bolsa)}},{key:"autocompletadoClienteSelected",value:function(t){t&&(this.ventaForm.get("idcliente").setValue(t.identidad),this.ventaForm.get("cpecorreo").setValue(t.email),this.ventaForm.get("clientenombre").setValue(t.entidad),this.ventaForm.get("clientedoc").setValue(t.iddocumento),this.ventaForm.get("clientenumerodoc").setValue(t.numerodoc,{emitEvent:!1}),this.ventaForm.get("clientedireccion").setValue(t.direccion))}},{key:"addItem",value:function(t,e){var o=this,a=new c.h({producto:new c.e(t?t.producto:null),descripcion:new c.e(t?t.descripcion:null),cantidad:new c.e(t?t.cantidad:null),valorunit:new c.e(t?t.valorunit:null),descuento:new c.e(t?t.descuento:null),valorventa:new c.e({value:t?t.valorventa:null,disabled:!0}),impuestobolsa:new c.e({value:t?t.impuestobolsa:null,disabled:!0}),idimpuesto:new c.e(t?t.idimpuesto:1),montototalimpuestos:new c.e({value:t?t.montototalimpuestos:null,disabled:!0}),preciounit:new c.e(t?t.preciounit:null),total:new c.e(t?t.total:null),bolsa:new c.e(!!t&&t.bolsa),datalist:new c.c(t?t.datalist:[]),datalistloading:new c.e(!1)});a.get("idimpuesto").valueChanges.subscribe((function(e){(t=a.value).idimpuesto=e;var n=o._utils.calculoLinea(t.idimpuesto,t.preciounit,t.cantidad,t.descuento||null);o.setImpuesto(a,n)})),a.get("preciounit").valueChanges.subscribe((function(e){(t=a.value).preciounit=e;var n=o._utils.calculoLinea(t.idimpuesto,t.preciounit,t.cantidad,t.descuento||null);o.setImpuesto(a,n)})),a.get("cantidad").valueChanges.subscribe((function(e){(t=a.value).cantidad=e;var n=o._utils.calculoLinea(t.idimpuesto,t.preciounit,t.cantidad,t.descuento||null);o.setImpuesto(a,n),o.setImpuestoBolsa(a,t.cantidad,t.bolsa)})),a.get("descuento").valueChanges.subscribe((function(e){(t=a.value).descuento=e;var n=o._utils.calculoLinea(t.idimpuesto,t.preciounit,t.cantidad,t.descuento||null);o.setImpuesto(a,n)})),a.get("total").valueChanges.subscribe((function(e){(t=a.value).total=e;var n=o._utils.calculoLineaT(t.idimpuesto,t.total,t.cantidad,t.descuento||null);o.setImpuesto(a,n)})),a.get("bolsa").valueChanges.subscribe((function(e){o.setImpuestoBolsa(a,(t=a.value).cantidad,e)})),a.get("producto").valueChanges.pipe(Object(r.a)(300),Object(u.a)((function(t){if(t&&"string"==typeof t){a.get("datalistloading").setValue(!0);var e={page:1,pageSize:10,orderName:"nombre",orderSort:"asc"};return e.likeNombre=t,o._productoService.index(e)}return a.get("datalistloading").setValue(!1),[]}))).subscribe((function(t){a.get("datalistloading").setValue(!1),a.get("datalist").clear(),t.data.forEach((function(t){a.get("datalist").push(new c.e({idproducto:t.idproducto,codigo:t.codigo,nombre:t.nombre,precio:t.valorventa,unidadmedida:t.unidadmedida,codigosunat:t.codigosunat,idimpuesto:t.idimpuesto,stock:t.stock}))}))})),void 0===e?this.ventadet.push(a):this.ventadet.setControl(e,a),this.calcularTotales()}},{key:"setImpuesto",value:function(t,e){t.get("cantidad").setValue(e.cantidad,{emitEvent:!1}),t.get("idimpuesto").setValue(e.idimpuesto,{emitEvent:!1}),t.get("preciounit").setValue(e.preciounit,{emitEvent:!1}),t.get("valorunit").setValue(e.valorunit,{emitEvent:!1}),t.get("descuento").setValue(e.descuento,{emitEvent:!1}),t.get("valorventa").setValue(e.subtotal,{emitEvent:!1}),t.get("montototalimpuestos").setValue(e.montototalimpuestos,{emitEvent:!1}),t.get("total").setValue(e.total,{emitEvent:!1}),this.calcularTotales()}},{key:"setImpuestoBolsa",value:function(t,e,o){if(o){var a=this._utils.redondearValor(.2*(e=e||0),3);t.get("impuestobolsa").setValue(a,{emitEvent:!1})}else t.get("impuestobolsa").setValue(null,{emitEvent:!1});this.calcularTotales()}},{key:"deleteItem",value:function(t){this.ventadet.removeAt(t),this.calcularTotales()}},{key:"displaySearchEntidad",value:function(t){return t?t.entidad:null}},{key:"displayProductoFn",value:function(t){return t?t.nombre:void 0}},{key:"newEntidad",value:function(){var t=this,e=null;"string"==typeof this.cliente.value&&/^[0-9]+$/.exec(this.cliente.value.trim())&&(e=this.cliente.value.trim()),this._matDialog.open(Za.a,{panelClass:"contacto-form-dialog",data:{action:"new",dialogTitle:"Nuevo cliente",tipo:"cliente",numerodoc:e},autoFocus:!1}).afterClosed().subscribe((function(e){if(e){var o={identidad:e.identidad,email:e.email,entidad:e.entidad,iddocumento:e.iddocumento,numerodoc:e.numerodoc,direccion:e.direccion};t.cliente.setValue(o),t.cliente.updateValueAndValidity(),t.autocompletadoClienteSelected(o),t.searchResult.data.push(o),t.searchResult.to+=1,t.searchResult.total+=1}}))}},{key:"newProducto",value:function(){var t=this;this._matDialog.open(tn.a,{panelClass:"item-form-dialog",data:{action:"new",dialogTitle:"Nuevo producto"},autoFocus:!1}).afterClosed().subscribe((function(e){if(e){var o,a,n=_createForOfIteratorHelper(t.ventadet.value.entries());try{for(n.s();!(a=n.n()).done;){var i=_slicedToArray(a.value,2),r=i[0],l=i[1];if(!l.producto||!l.producto.idproducto){o=r;break}}}catch(b){n.e(b)}finally{n.f()}var u={idproducto:e.idproducto,codigo:e.codigo,nombre:e.nombre,precio:e.valorventa,unidadmedida:e.unidadmedida,codigosunat:e.codigosunat,idimpuesto:e.idimpuesto,stock:null},s=t._utils.calculoLinea(e.idimpuesto,e.valorventa,1),d={producto:u,descripcion:null,idimpuesto:e.idimpuesto,cantidad:1,valorunit:s.valorunit,descuento:s.descuento,valorventa:s.subtotal,montototalimpuestos:s.montototalimpuestos,preciounit:s.preciounit,total:s.total,bolsa:s.impuestobolsa>0,datalist:[new c.e(u)]};t.addItem(d,o)}}))}},{key:"modalGeneral",value:function(){var t=this;this._matDialog.open(va,{panelClass:"ventasgeneral-form-dialog",data:{venta:this.ventaForm.getRawValue()},autoFocus:!1}).afterClosed().subscribe((function(e){e&&(t.ventaForm.get("fechavencimiento").setValue(e.fechavencimiento),t.ventaForm.get("operacion").setValue(e.operacion),t.ventaForm.get("placavehiculo").setValue(e.placavehiculo),t.ventaForm.get("ordencompra").setValue(e.ordencompra),t.ventaForm.get("guiaremitente").setValue(e.guiaremitente),t.ventaForm.get("guiatransportista").setValue(e.guiatransportista),t.ventaForm.get("tipocambio").setValue(e.tipocambio),t.ventaForm.get("pdfformato").setValue(e.pdfformato),t.ventaForm.get("detraccion").setValue(e.detraccion),t.ventaForm.get("selvaproducto").setValue(e.selvaproducto),t.ventaForm.get("selvaservicio").setValue(e.selvaservicio))}))}},{key:"modalNotacredito",value:function(){var t=this;this._matDialog.open(Ya,{panelClass:"ventasnotacredito-form-dialog",data:this.ventaForm.getRawValue(),autoFocus:!1}).afterClosed().subscribe((function(e){if(e){t.ventaForm.get("tiponc").setValue(e.tiponc),t.ventaForm.get("documentonc").setValue(e.documentonc),t.ventaForm.get("serienc").setValue(e.serienc),t.ventaForm.get("numeronc").setValue(e.numeronc);var o=null;t.comprobantes.forEach((function(t){13!==t.iddocumentofiscal&&10!==t.iddocumentofiscal||t.serie!==e.serienc||(o=t)})),"0"===e.serienc.substr(0,1)&&t.comprobantes.forEach((function(t){var a=1===e.documentonc?"F":"B";13!==t.iddocumentofiscal&&10!==t.iddocumentofiscal||t.serie.substr(0,1)!==a||(o=t)})),o&&t.comprobante.setValue(o,{emitEvent:!1})}}))}},{key:"modalGuia",value:function(){this._matDialog.open(ga,{panelClass:"ventasguia-form-dialog",data:{venta:this.ventaForm},autoFocus:!1}).afterClosed().subscribe((function(t){}))}},{key:"modalFormato",value:function(){this._matDialog.open(ha,{panelClass:"ventasformato-form-dialog",data:{venta:this.ventaForm},autoFocus:!1}).afterClosed().subscribe((function(t){}))}},{key:"modalItem",value:function(t,e){var o=this;this._matDialog.open(Ra,{panelClass:"ventasitem-form-dialog",data:{item:t.getRawValue(),impuestos:this.impuestos},autoFocus:!1}).afterClosed().subscribe((function(a){if(a){var n=!1;o.ventadet.value.forEach((function(e){e.producto&&e.producto.idproducto===a.producto.idproducto&&a.producto.idproducto!==t.get("producto").value.idproducto&&(n=!0)})),n?o.snackBar.open("".concat(a.producto.nombre," ya esta a\xf1adido."),"Cerrar",{duration:4e3,panelClass:["error-dialog"]}):(o.ventadet.at(e).get("idimpuesto").setValue(a.idimpuesto,{emitEvent:!1}),o.ventadet.at(e).get("producto").setValue(a.producto,{emitEvent:!1}),o.ventadet.at(e).get("descripcion").setValue(a.descripcion,{emitEvent:!1}),o.ventadet.at(e).get("cantidad").setValue(a.cantidad,{emitEvent:!1}),o.ventadet.at(e).get("preciounit").setValue(a.preciounit,{emitEvent:!1}),o.ventadet.at(e).get("valorunit").setValue(a.valorunit,{emitEvent:!1}),o.ventadet.at(e).get("descuento").setValue(a.descuento,{emitEvent:!1}),o.ventadet.at(e).get("valorventa").setValue(a.valorventa,{emitEvent:!1}),o.ventadet.at(e).get("montototalimpuestos").setValue(a.montototalimpuestos,{emitEvent:!1}),o.ventadet.at(e).get("total").setValue(a.total,{emitEvent:!1}),setTimeout((function(){t.get("producto").updateValueAndValidity()}),100),o.calcularTotales())}}))}},{key:"indexDocumentoseries",value:function(){var t=this;this._documentoserieService.index({idsede:this._entidadService.sedeDefault,conRecurso:"documentofiscal",orderName:"iddocumentofiscal",orderSort:"asc"}).subscribe((function(e){console.log("PRIMERO indexDocumentoseries()"),e.data.forEach((function(e){t.comprobantes.push({iddocumentofiscal:e.iddocumentofiscal,documentofiscal:{nombre:e.documentofiscal.nombre},serie:e.serie,numero:e.numero})}));var o=null;t.comprobantes.forEach((function(e){t.paramRoute.venta?e.iddocumentofiscal===t.comprobantedefault&&t.ventaNcNd&&e.serie===t.ventaNcNd.serie&&(o=e):e.iddocumentofiscal===t.comprobantedefault&&(o=e)})),o&&(console.log("indexDocumentoseries",!t.paramRoute.venta),t.comprobante.setValue(o))}))}},{key:"modalMediopago",value:function(){var t=this;this._matDialog.open(Ma,{panelClass:"ventasmediopago-form-dialog",data:{venta:this.ventaForm.getRawValue()},autoFocus:!1}).afterClosed().subscribe((function(e){if(e){for(;t.ventapago.value.length>0;)t.ventapago.removeAt(0);e.mediopago.forEach((function(e){var o=new c.h({idmediopago:new c.e(e.idmediopago),importe:new c.e(e.importe),nota:new c.e(e.nota)});t.ventapago.push(o)})),t.ventaForm.get("pagado").setValue(e.pagado),t.ventaForm.get("vuelto").setValue(e.vuelto),t.save()}}))}},{key:"emitir",value:function(){var t;if((t=this.ventaForm.getRawValue()).idcliente){var e=!0;t.ventadet.forEach((function(t){t.producto&&t.producto.idproducto&&(e=!1)})),e?this.snackBar.open("Ingrese producto para la venta","Cerrar",{panelClass:["error-dialog"]}):this.settings.mediopago?this.modalMediopago():this.save()}else this.snackBar.open("Ingrese cliente","Cerrar",{panelClass:["error-dialog"]})}},{key:"resetCliente",value:function(){this.resetForm()}},{key:"save",value:function(){var t,e=this;t=this.ventaForm.getRawValue();var o=[];t.ventadet.forEach((function(t){t.producto&&t.producto.idproducto&&o.push({cantidad:t.cantidad,codigo:t.producto.codigo,codigosunat:t.producto.codigosunat,descripcion:t.descripcion,descuento:t.descuento,idimpuesto:t.idimpuesto,idproducto:t.producto.idproducto,impuestobolsa:t.impuestobolsa,montototalimpuestos:t.montototalimpuestos,nombre:t.producto.nombre,preciounit:t.preciounit,total:t.total,unidadmedida:t.producto.unidadmedida,valorunit:t.valorunit,valorventa:t.valorventa})})),t.ventadet=o,t.fechaemision=this.pipeDate.transform(t.fechaemision,"yyyy-MM-dd"),t.fechavencimiento=t.fechavencimiento?this.pipeDate.transform(t.fechavencimiento,"yyyy-MM-dd"):null,t.detraccion=t.detraccion?"1":"0",t.selvaproducto=t.selvaproducto?"1":"0",t.selvaservicio=t.selvaservicio?"1":"0",this.snackBar.open("Procesando venta..."),this.submitted=!0,this._ventaService.create(t).subscribe((function(t){var o;switch(e.indexDocumentoseries(),t.iddocumentofiscal){case 1:o="Factura";break;case 2:o="Boleta de venta";break;case 10:o="Nota de d\xe9bito";break;case 13:o="Nota de cr\xe9dito"}e.resetForm(),e.submitted=!1,e.showVenta(t,"COMPROBANTE"),e.snackBar.open("".concat(o," ").concat(t.serie," - ").concat(t.numero," emitido."),"Cerrar")}),(function(t){var o=e._utils.convertError(t);e.submitted=!1,e.snackBar.open(o,"Cerrar",{panelClass:["error-dialog"]})}))}},{key:"resetForm",value:function(){var t=this,e=null;this.comprobantes.forEach((function(o){o.iddocumentofiscal===t.comprobantedefault&&(e=o)})),this.comprobante.reset(e,{emitEvent:!1}),this.cliente.reset(null,{emitEvent:!1}),this.ventaForm.get("ventadet").controls.forEach((function(t){for(;0!==t.controls.datalist.length;)t.controls.datalist.removeAt(0)}));for(var o=1,a=[];o<=this.ventadet.value.length;)a.push({producto:null,descripcion:null,cantidad:null,valorunit:null,descuento:null,valorventa:null,impuestobolsa:null,idimpuesto:1,montototalimpuestos:null,preciounit:null,total:null,bolsa:!1,datalist:[],datalistloading:!1}),o++;var n={comprobante:e,idsede:this._entidadService.sedeDefault||null,iddocumentofiscal:e?e.iddocumentofiscal:null,serie:e?e.serie:null,numero:e?e.numero:null,fechaemision:new Date,fechavencimiento:new Date,idestadodocumento:27,operacion:1,moneda:"PEN",detraccion:!1,selvaproducto:!1,selvaservicio:!1,pdfformato:"A4",ventadet:a,tiponc:e&&13===e.iddocumentofiscal?1:null};this.settings.mediopago&&(n.ventapago=[]),this.ventaForm.reset(n,{emitEvent:!1}),this.leyenda={exonerada:!1,inafecta:!1,gratuita:!1,icpber:!1}}},{key:"openAddList",value:function(t,e,o){this.popover.open({content:e,origin:o,position:[{originX:"start",originY:"bottom",overlayX:"center",overlayY:"top"},{originX:"center",originY:"bottom",overlayX:"center",overlayY:"top"}]})}},{key:"showVenta",value:function(t,e){var o=this;this._matDialog.open(ee,{panelClass:"venta-show-dialog",data:{idventa:t.idventa,pestana:e,botones:{canu:!1,rpdf:!1,nvent:!0,edit:!1,anu:!0,mail:!0,nc:!1,nd:!1,gr:!1}},autoFocus:!1,disableClose:!0}).afterClosed().subscribe((function(e){e&&("anular"===e&&o.anularVenta(t),"correo"===e&&o.correoVenta(t))}))}},{key:"anularVenta",value:function(t){this._matDialog.open(be,{panelClass:"ventasanular-form-dialog",data:{venta:t},autoFocus:!1}).afterClosed().subscribe((function(t){}))}},{key:"correoVenta",value:function(t){this._matDialog.open(he,{panelClass:"ventascorreo-form-dialog",data:{venta:t},autoFocus:!1}).afterClosed().subscribe((function(t){}))}},{key:"ventadet",get:function(){return this.ventaForm.get("ventadet")}},{key:"ventapago",get:function(){return this.ventaForm.get("ventapago")}}]),t}()).\u0275fac=function(t){return new(t||pc)(m.Qb(i.a),m.Qb(b.b),m.Qb(Z.b),m.Qb(tt.a),m.Qb(p.a),m.Qb(sn.a),m.Qb(dn.a),m.Qb(Y.a),m.Qb(ce.a),m.Qb(pi.a))},pc.\u0275cmp=m.Kb({type:pc,selectors:[["vex-ventas-emitir"]],decls:193,vars:65,consts:[["id","ventas-emitir",3,"formGroup","ngSubmit"],["color","primary"],["fxLayoutAlign","space-between center",1,"container"],["fxLayout","row","fxLayoutAlign","center center"],["mat-icon-button","","type","button","matTooltip","Volver",3,"routerLink"],[3,"icIcon"],[4,"ngIf"],["mat-button","","type","button",3,"click"],["size","18px",3,"icIcon"],["mat-raised-button","","type","submit","fxHide","","fxShow.gt-xs","",1,"mr-1",3,"disabled"],["mat-icon-button","","type","submit","fxShow","","fxHide.gt-xs","",3,"disabled"],[1,"content","container"],["fxLayout","row","fxLayout.lt-sm","column","fxLayoutGap","16px","fxLayoutGap.lt-sm","0"],["fxFlex","50"],["appearance","standard","floatLabel","always","fxFlex","66",1,"vex-flex-form-field"],[3,"formControl"],[3,"value",4,"ngFor","ngForOf"],["appearance","standard","floatLabel","always","fxFlex","auto",1,"vex-flex-form-field"],["formControlName","moneda"],["appearance","standard","floatLabel","always","fxFlex","33",1,"vex-flex-form-field"],["matInput","","name","start","formControlName","fechaemision",3,"matDatepicker"],["matSuffix","",3,"for"],["fechaDatePicker",""],["matInput","","name","start","formControlName","fechavencimiento",3,"matDatepicker"],["fechaDatePickerVence",""],["appearance","standard","floatLabel","always","fxFlex","34",1,"vex-flex-form-field"],["formControlName","operacion"],["matInput","","formControlName","guiaremitente"],["matInput","","formControlName","ordencompra"],["fxLayout","row","fxLayout.lt-sm","column","fxLayoutGap","16px","fxLayoutGap.lt-sm","0",4,"ngIf"],["fxLayout","row","fxLayoutGap","8px","fxFlex","100"],["matInput","",3,"matAutocomplete","formControl"],["autoActiveFirstOption","",3,"displayWith","optionSelected"],["autoCliente","matAutocomplete"],["class","p-3","value","",4,"ngIf"],["matSuffix","",3,"icIcon",4,"ngIf"],["matSuffix","","class","cursor-pointer",3,"icIcon","click",4,"ngIf"],["fxFlex","none"],["type","button","mat-mini-fab","","color","primary","matTooltip","Nuevo cliente",3,"click"],["appearance","standard","floatLabel","always","fxFlex","35",3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["matInput","","name","clientenumerodoc","formControlName","clientenumerodoc"],["appearance","standard","floatLabel","always","fxFlex","65"],["matInput","","formControlName","cpecorreo"],["appearance","standard","floatLabel","always","fxFlex","100"],["matInput","","formControlName","clientedireccion"],["fxFlex","auto",1,"mt-4"],["formArrayName","ventadet"],["fxLayout","row","fxLayoutAlign","start center","fxLayout.lt-sm","column","fxLayoutAlign.lt-sm","start stretch","fxLayoutGap","8px","fxLayoutGap.lt-sm","0"],["fxFlex","43"],["fxFlex","12"],["fxFlex","7"],["fxFlex","10","fxLayout","row","fxLayoutAlign","center center"],["type","button","mat-icon-button","","matTooltip","Agregar linea",1,"w-8","h-8","leading-none","flex","items-center","justify-center","ml-1","hover:bg-hover",3,"click"],["fxLayout","row","fxLayoutAlign","start center","fxLayout.lt-sm","column","fxLayoutAlign.lt-sm","start stretch","fxLayoutGap","8px","fxLayoutGap.lt-sm","0",3,"formGroupName",4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","center center","class","mt-4",4,"ngIf"],["fxLayout","row","fxLayout.lt-sm","column","fxLayoutGap","16px","fxLayoutGap.lt-sm","0",1,"mt-4"],["fxLayout","column","fxLayoutAlign","space-between","fxFlex","50",1,"borde"],["fxLayout","column","fxLayoutAlign","start start",1,"borde"],["fxLayout","row","fxLayout.lt-sm","column","fxLayoutGap","16px","fxLayoutGap.lt-sm","0",1,"borde"],["appearance","standard","floatLabel","always","fxFlex","auto",1,"vex-dense-form-field"],["matInput","","formControlName","condicionpago"],["matInput","","formControlName","observacion"],["fxFlex","50",1,"borde"],["fxLayout","column","fxLayout.gt-xs","row"],["fxFlex","80",1,"text-right"],["fxFlex","20",1,"text-right"],["matInput","","type","number","formControlName","descuentoporcentaje",2,"border-bottom","1px solid #CCC","width","80px"],["fxLayout","column","fxLayout.gt-xs","row",1,"mt-1"],["matInput","","type","number","formControlName","cargo",2,"border-bottom","1px solid #CCC","width","80px"],["fxLayout","column","fxLayout.gt-xs","row",4,"ngIf"],["fxFlex","80",1,"text-right","font-weight-600"],["fxLayout","row","fxLayoutAlign","end center"],["mat-raised-button","","color","primary","type","submit",1,"w-full",3,"disabled"],[3,"value"],["fxLayout","row","fxLayoutAlign","space-between center"],["fxFlex","70"],["fxFlex","30"],["type","button","mat-flat-button","","color","accent",3,"click"],["value","",1,"p-3"],["diameter","25"],[3,"value","ngSwitch",4,"ngFor","ngForOf"],["fxLayout","row"],[1,"p-3"],[3,"value","ngSwitch"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","8px"],["fxLayout","column","fxLayoutAlign","center start"],["size","24px",3,"icIcon",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center stretch"],["class","text-secondary inline-block",4,"ngSwitchCase"],["class","text-secondary inline-block",4,"ngSwitchDefault"],[1,"text-secondary"],["size","24px",3,"icIcon"],[1,"text-secondary","inline-block"],["matSuffix","",3,"icIcon"],["matSuffix","",1,"cursor-pointer",3,"icIcon","click"],["fxLayout","row","fxLayoutAlign","start center","fxLayout.lt-sm","column","fxLayoutAlign.lt-sm","start stretch","fxLayoutGap","8px","fxLayoutGap.lt-sm","0",3,"formGroupName"],["appearance","standard","floatLabel","always","fxFlex","43",1,"vex-flex-form-field"],["matInput","","formControlName","producto","placeholder","Buscar",3,"matAutocomplete"],["auto","matAutocomplete"],["appearance","standard","floatLabel","always","fxFlex","12",1,"vex-flex-form-field"],["matInput","","formControlName","descripcion"],["appearance","standard","floatLabel","always","fxFlex","7",1,"vex-flex-form-field"],["matInput","","type","number","formControlName","cantidad"],["formControlName","idimpuesto"],["matInput","","type","number","formControlName","preciounit"],["matInput","","type","number","formControlName","valorventa"],["matInput","","type","number","formControlName","total",1,"text-right"],["fxLayout","row","fxLayoutAlign","center center","fxFlex","10"],["addListOriginRef",""],["type","button","mat-icon-button","","matTooltip","Eliminar",1,"w-8","h-8","leading-none","flex","items-center","justify-center","hover:bg-hover",3,"click"],["type","button","mat-icon-button","","matTooltip","Editar",1,"w-8","h-8","leading-none","flex","items-center","justify-center","ml-1","hover:bg-hover",3,"click"],["addListTemplate",""],["fxLayout","column",1,"card","px-4","pt-3","pb-2"],["mat-icon-button","","type","button",1,"text-secondary","w-8","h-8","leading-none",3,"click"],["fxFlex","auto","fxLayout","row","fxLayoutAlign","center start"],["formControlName","bolsa","labelPosition","after"],["appearance","standard","floatLabel","always","fxFlex","80"],["matInput","","type","number","formControlName","impuestobolsa"],["appearance","standard","floatLabel","always"],["matInput","","type","number","formControlName","descuento"],["matInput","","type","number","formControlName","montototalimpuestos"],["fxLayout","row","fxLayoutAlign","center center",1,"mt-4"],["mat-stroked-button","","matTooltip","Agregar linea",1,"w-full",3,"click"],["fxFlex","70",1,"text-right"],["fxFlex","30",1,"text-right"]],template:function(t,e){if(1&t&&(m.Wb(0,"form",0),m.ec("ngSubmit",(function(){return e.emitir()})),m.Wb(1,"mat-toolbar",1),m.Wb(2,"mat-toolbar-row",2),m.Wb(3,"div",3),m.Wb(4,"button",4),m.Rb(5,"mat-icon",5),m.Vb(),m.Ec(6,fi,2,0,"span",6),m.Ec(7,vi,2,1,"span",6),m.Vb(),m.Wb(8,"div"),m.Wb(9,"button",7),m.ec("click",(function(){return e.modalGeneral()})),m.Rb(10,"mat-icon",8),m.Gc(11," GENERAL "),m.Vb(),m.Wb(12,"button",7),m.ec("click",(function(){return e.resetCliente()})),m.Gc(13," RESET CLIENTE "),m.Vb(),m.Wb(14,"button",9),m.Rb(15,"mat-icon",5),m.Gc(16," EMITIR "),m.Vb(),m.Wb(17,"button",10),m.Rb(18,"mat-icon",5),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Wb(19,"div",11),m.Wb(20,"div",12),m.Wb(21,"mat-card",13),m.Wb(22,"mat-card-content"),m.Wb(23,"div",12),m.Wb(24,"mat-form-field",14),m.Wb(25,"mat-label"),m.Gc(26,"Comprobante"),m.Vb(),m.Wb(27,"mat-select",15),m.Ec(28,gi,6,4,"mat-option",16),m.Vb(),m.Ec(29,hi,2,0,"mat-error",6),m.Vb(),m.Wb(30,"mat-form-field",17),m.Wb(31,"mat-label"),m.Gc(32,"Moneda"),m.Vb(),m.Wb(33,"mat-select",18),m.Ec(34,Vi,2,2,"mat-option",16),m.Vb(),m.Ec(35,Ci,2,0,"mat-error",6),m.Vb(),m.Vb(),m.Wb(36,"div",12),m.Wb(37,"mat-form-field",19),m.Wb(38,"mat-label"),m.Gc(39,"Fecha emisi\xf3n"),m.Vb(),m.Rb(40,"input",20),m.Rb(41,"mat-datepicker-toggle",21),m.Rb(42,"mat-datepicker",null,22),m.Ec(44,xi,2,0,"mat-error",6),m.Vb(),m.Wb(45,"mat-form-field",19),m.Wb(46,"mat-label"),m.Gc(47,"Fecha vencimiento"),m.Vb(),m.Rb(48,"input",23),m.Rb(49,"mat-datepicker-toggle",21),m.Rb(50,"mat-datepicker",null,24),m.Vb(),m.Wb(52,"mat-form-field",25),m.Wb(53,"mat-label"),m.Gc(54,"Operaci\xf3n"),m.Vb(),m.Wb(55,"mat-select",26),m.Ec(56,Wi,2,2,"mat-option",16),m.Vb(),m.Ec(57,yi,2,0,"mat-error",6),m.Vb(),m.Vb(),m.Wb(58,"div",12),m.Wb(59,"mat-form-field",17),m.Wb(60,"mat-label"),m.Gc(61,"Gu\xeda de remisi\xf3n"),m.Vb(),m.Rb(62,"input",27),m.Vb(),m.Wb(63,"mat-form-field",17),m.Wb(64,"mat-label"),m.Gc(65,"Orden de compra"),m.Vb(),m.Rb(66,"input",28),m.Vb(),m.Vb(),m.Ec(67,ki,7,5,"div",29),m.Vb(),m.Vb(),m.Wb(68,"mat-card",13),m.Wb(69,"mat-card-content"),m.Wb(70,"div",12),m.Wb(71,"div",30),m.Wb(72,"mat-form-field",17),m.Wb(73,"mat-label"),m.Gc(74,"Cliente"),m.Vb(),m.Rb(75,"input",31),m.Wb(76,"mat-autocomplete",32,33),m.ec("optionSelected",(function(t){return e.autocompletadoClienteSelected(t.option.value)})),m.Ec(78,Ri,2,0,"mat-option",34),m.Ec(79,qi,5,3,"ng-container",6),m.Vb(),m.Ec(80,Mi,1,1,"mat-icon",35),m.Ec(81,Qi,1,1,"mat-icon",36),m.Ec(82,Bi,2,0,"mat-error",6),m.Vb(),m.Wb(83,"div",37),m.Wb(84,"button",38),m.ec("click",(function(){return e.newEntidad()})),m.Rb(85,"mat-icon",5),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Wb(86,"div",12),m.Wb(87,"mat-form-field",39),m.Ec(88,zi,2,0,"mat-label",40),m.Ec(89,Hi,2,0,"mat-label",40),m.Ec(90,Xi,2,0,"mat-label",40),m.Ec(91,$i,2,0,"mat-label",40),m.Ec(92,Ui,2,0,"mat-label",40),m.Ec(93,Ki,2,0,"mat-label",41),m.Rb(94,"input",42),m.Ec(95,Ji,1,1,"mat-icon",35),m.Ec(96,Yi,1,1,"mat-icon",36),m.Vb(),m.Wb(97,"mat-form-field",43),m.Wb(98,"mat-label"),m.Gc(99,"Correo"),m.Vb(),m.Rb(100,"input",44),m.Vb(),m.Vb(),m.Wb(101,"div",12),m.Wb(102,"mat-form-field",45),m.Wb(103,"mat-label"),m.Gc(104,"Direcci\xf3n"),m.Vb(),m.Rb(105,"input",46),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Wb(106,"div",12),m.Wb(107,"mat-card",47),m.Wb(108,"mat-card-content"),m.Wb(109,"div",48),m.Wb(110,"div",49),m.Wb(111,"div",50),m.Gc(112,"Producto - servicio"),m.Vb(),m.Wb(113,"div",51),m.Gc(114,"Detalle adicional"),m.Vb(),m.Wb(115,"div",52),m.Gc(116,"Cantidad"),m.Vb(),m.Wb(117,"div",52),m.Gc(118,"Tipo Igv"),m.Vb(),m.Wb(119,"div",52),m.Gc(120,"P. Unit."),m.Vb(),m.Wb(121,"div",52),m.Gc(122,"Sub total"),m.Vb(),m.Wb(123,"div",52),m.Gc(124,"Total"),m.Vb(),m.Wb(125,"div",53),m.Wb(126,"button",54),m.ec("click",(function(){return e.addItem()})),m.Rb(127,"mat-icon",8),m.Vb(),m.Vb(),m.Vb(),m.Ec(128,rc,31,11,"div",55),m.Ec(129,lc,3,1,"div",56),m.Vb(),m.Wb(130,"div",57),m.Wb(131,"div",58),m.Wb(132,"div",59),m.Wb(133,"button",7),m.ec("click",(function(){return e.newProducto()})),m.Gc(134,"Nuevo producto "),m.Vb(),m.Vb(),m.Wb(135,"div",60),m.Wb(136,"mat-form-field",61),m.Wb(137,"mat-label"),m.Gc(138,"Condiciones de pago"),m.Vb(),m.Rb(139,"input",62),m.Vb(),m.Wb(140,"mat-form-field",61),m.Wb(141,"mat-label"),m.Gc(142,"Observaciones"),m.Vb(),m.Rb(143,"input",63),m.Vb(),m.Vb(),m.Vb(),m.Wb(144,"div",64),m.Wb(145,"div"),m.Wb(146,"div",65),m.Wb(147,"div",66),m.Gc(148," Descuento global "),m.Wb(149,"strong"),m.Gc(150,"%"),m.Vb(),m.Vb(),m.Wb(151,"div",67),m.Rb(152,"input",68),m.Vb(),m.Vb(),m.Wb(153,"div",69),m.Wb(154,"div",66),m.Gc(155," Otros cargos S/ "),m.Vb(),m.Wb(156,"div",67),m.Rb(157,"input",70),m.Vb(),m.Vb(),m.Ec(158,uc,6,4,"div",71),m.Ec(159,sc,6,4,"div",71),m.Ec(160,dc,6,4,"div",71),m.Ec(161,bc,6,4,"div",71),m.Wb(162,"div",65),m.Wb(163,"div",66),m.Gc(164," Gravada S/ "),m.Vb(),m.Wb(165,"div",67),m.Gc(166),m.jc(167,"number"),m.Vb(),m.Vb(),m.Wb(168,"div",65),m.Wb(169,"div",66),m.Gc(170," IGV S/ "),m.Vb(),m.Wb(171,"div",67),m.Gc(172),m.jc(173,"number"),m.Vb(),m.Vb(),m.Ec(174,mc,6,4,"div",71),m.Wb(175,"div",65),m.Wb(176,"div",72),m.Wb(177,"strong"),m.Gc(178,"Total S/"),m.Vb(),m.Vb(),m.Wb(179,"div",67),m.Wb(180,"strong"),m.Gc(181),m.jc(182,"number"),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Wb(183,"mat-card-actions",73),m.Wb(184,"button",74),m.Rb(185,"mat-icon",5),m.Gc(186," EMITIR "),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Wb(187,"div",12),m.Wb(188,"mat-card",47),m.Wb(189,"mat-card-content"),m.Wb(190,"pre"),m.Gc(191),m.jc(192,"json"),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Vb()),2&t){var o=m.uc(43),a=m.uc(51),n=m.uc(77);m.oc("formGroup",e.ventaForm),m.Cb(4),m.oc("routerLink","/ventas"),m.Cb(1),m.oc("icIcon",e.icArrowBack),m.Cb(1),m.oc("ngIf",!e.comprobante.value),m.Cb(1),m.oc("ngIf",e.comprobante.value),m.Cb(3),m.oc("icIcon",e.icSettings),m.Cb(4),m.oc("disabled",e.submitted),m.Cb(1),m.oc("icIcon",e.icSend),m.Cb(2),m.oc("disabled",e.submitted),m.Cb(1),m.oc("icIcon",e.icSave),m.Cb(9),m.oc("formControl",e.comprobante),m.Cb(1),m.oc("ngForOf",e.comprobantes),m.Cb(1),m.oc("ngIf",e.comprobante.hasError("required")),m.Cb(5),m.oc("ngForOf",e.monedas),m.Cb(1),m.oc("ngIf",e.ventaForm.get("moneda").hasError("required")),m.Cb(5),m.oc("matDatepicker",o),m.Cb(1),m.oc("for",o),m.Cb(3),m.oc("ngIf",e.ventaForm.get("fechaemision").hasError("required")),m.Cb(4),m.oc("matDatepicker",a),m.Cb(1),m.oc("for",a),m.Cb(7),m.oc("ngForOf",e.operaciones),m.Cb(1),m.oc("ngIf",e.ventaForm.get("operacion").hasError("required")),m.Cb(10),m.oc("ngIf",e.comprobante.value&&(13===e.comprobante.value.iddocumentofiscal||10===e.comprobante.value.iddocumentofiscal)),m.Cb(8),m.oc("matAutocomplete",n)("formControl",e.cliente),m.Cb(1),m.oc("displayWith",e.displaySearchEntidad),m.Cb(2),m.oc("ngIf",e.isLoadingSearch),m.Cb(1),m.oc("ngIf",!e.isLoadingSearch),m.Cb(1),m.oc("ngIf",!e.cliente.value),m.Cb(1),m.oc("ngIf",e.cliente.value),m.Cb(1),m.oc("ngIf",e.cliente.hasError("required")),m.Cb(3),m.oc("icIcon",e.icAdd),m.Cb(2),m.oc("ngSwitch",e.ventaForm.get("clientedoc").value),m.Cb(1),m.oc("ngSwitchCase",1),m.Cb(1),m.oc("ngSwitchCase",2),m.Cb(1),m.oc("ngSwitchCase",3),m.Cb(1),m.oc("ngSwitchCase",4),m.Cb(1),m.oc("ngSwitchCase",5),m.Cb(3),m.oc("ngIf",!e.ventaForm.get("clientenumerodoc").value),m.Cb(1),m.oc("ngIf",e.ventaForm.get("clientenumerodoc").value),m.Cb(31),m.oc("icIcon",e.icAdd),m.Cb(1),m.oc("ngForOf",e.ventadet.controls),m.Cb(1),m.oc("ngIf",e.ventaForm.get("ventadet").hasError("required")),m.Cb(29),m.oc("ngIf",e.ventaForm.get("descuentototal").value>0),m.Cb(1),m.oc("ngIf",e.leyenda.exonerada),m.Cb(1),m.oc("ngIf",e.leyenda.inafecta),m.Cb(1),m.oc("ngIf",e.leyenda.gratuita),m.Cb(5),m.Ic(" ",m.lc(167,54,e.ventaForm.get("gravada").value,"1.2-2")," "),m.Cb(6),m.Ic(" ",m.lc(173,57,e.ventaForm.get("valorimpuesto").value,"1.2-2")," "),m.Cb(2),m.oc("ngIf",e.leyenda.icpber),m.Cb(7),m.Hc(m.lc(182,60,e.ventaForm.get("total").value,"1.2-2")),m.Cb(3),m.oc("disabled",e.submitted),m.Cb(1),m.oc("icIcon",e.icSend),m.Cb(6),m.Ic("            ",m.kc(192,63,e.ventaForm.value)," \n          ")}},directives:[c.w,c.q,c.i,ot.a,ot.c,I.b,I.c,E.b,G.a,i.g,k.a,R.a,w.p,He.b,I.d,bn.a,I.a,bn.c,re.d,re.h,Ae.a,c.p,c.f,w.o,c.g,le.b,c.b,Ue.b,Ue.d,re.j,Ue.a,$e.c,$e.a,w.r,w.s,w.t,c.d,c.s,bn.b,Ne.n,re.c,Ye.b,c.j,da.a],pipes:[w.f,w.h],styles:["#ventas-emitir .content{padding:24px}#ventas-emitir .content fieldset{border:1px solid #ccc;border-radius:8px;padding:8px}#ventas-emitir .content fieldset legend{padding:0 8px}#ventas-emitir .mat-select-panel mat-option.mat-option{height:unset;border:1px solid red}#ventas-emitir .mat-option-text.mat-option-text{white-space:normal;border:1px solid red}.mat-autocomplete-panel .mat-option{line-height:18px;padding:6px 8px}"],encapsulation:2}),pc),gc=[{path:"",component:ra},{path:"nuevo",component:ai},{path:"nuevo/:comprobante",component:ai},{path:"emitir",component:vc},{path:"emitir/:comprobante",component:vc}],hc=((fc=function t(){_classCallCheck(this,t)}).\u0275mod=m.Ob({type:fc}),fc.\u0275inj=m.Nb({factory:function(t){return new(t||fc)},imports:[[i.j.forChild(gc),ni.a,ii.a,ci.a,ri.a,li.a,ui.a]]}),fc)},rwX0:function(t,e){e.__esModule=!0,e.default={body:'<circle cx="9" cy="8.5" opacity=".3" r="1.5" fill="currentColor"/><path opacity=".3" d="M4.34 17h9.32c-.84-.58-2.87-1.25-4.66-1.25s-3.82.67-4.66 1.25z" fill="currentColor"/><path d="M9 12c1.93 0 3.5-1.57 3.5-3.5S10.93 5 9 5S5.5 6.57 5.5 8.5S7.07 12 9 12zm0-5c.83 0 1.5.67 1.5 1.5S9.83 10 9 10s-1.5-.67-1.5-1.5S8.17 7 9 7zm0 6.75c-2.34 0-7 1.17-7 3.5V19h14v-1.75c0-2.33-4.66-3.5-7-3.5zM4.34 17c.84-.58 2.87-1.25 4.66-1.25s3.82.67 4.66 1.25H4.34zm11.7-3.19c1.16.84 1.96 1.96 1.96 3.44V19h4v-1.75c0-2.02-3.5-3.17-5.96-3.44zM15 12c1.93 0 3.5-1.57 3.5-3.5S16.93 5 15 5c-.54 0-1.04.13-1.5.35c.63.89 1 1.98 1 3.15s-.37 2.26-1 3.15c.46.22.96.35 1.5.35z" fill="currentColor"/>',width:24,height:24}}}]);