(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"+Chm":function(t,e){e.__esModule=!0,e.default={body:'<path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2s-2 .9-2 2s.9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2s2-.9 2-2s-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2s2-.9 2-2s-.9-2-2-2z" fill="currentColor"/>',width:24,height:24}},"6JgD":function(t,e,o){"use strict";o.d(e,"a",(function(){return n}));var i=o("fXoL"),a=o("bv9b");let n=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Kb({type:t,selectors:[["vex-loading"]],decls:1,vars:1,consts:[[3,"mode"]],template:function(t,e){1&t&&i.Rb(0,"mat-progress-bar",0),2&t&&i.oc("mode","indeterminate")},directives:[a.a],styles:[".mat-progress-bar{width:100%}"],encapsulation:2}),t})()},"7lCJ":function(t,e,o){"use strict";o.d(e,"a",(function(){return n}));var i=o("ofXK"),a=o("fXoL");let n=(()=>{class t{}return t.\u0275mod=a.Ob({type:t}),t.\u0275inj=a.Nb({factory:function(e){return new(e||t)},imports:[[i.c]]}),t})()},C0s9:function(t,e,o){"use strict";o.d(e,"a",(function(){return a}));var i=o("fXoL");let a=(()=>{class t{constructor(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=i.Lb({type:t,selectors:[["","vexPageLayoutContent",""],["vex-page-layout-content"]],hostAttrs:[1,"vex-page-layout-content"]}),t})()},GPUG:function(t,e,o){"use strict";o.d(e,"a",(function(){return s}));var i=o("tk/3"),a=o("IRgW"),n=(o("XNiG"),o("lJxs")),c=(o("0np6"),o("fXoL")),r=o("17qS");let s=(()=>{class t extends a.a{constructor(t,e){super(),this.http=t,this._subirArchivoService=e,console.log("ProductoService listo!")}index(t){return this.getQuery("productos",t)}show(t,e){return this.getQuery(`productos/${t}`,e)}create(t){return this.postQuery("productos",t).pipe(Object(n.a)(t=>t))}update(t,e){return this.putQuery(`productos/${t}`,e).pipe(Object(n.a)(t=>t))}delete(t,e){return this.deleteQuery(`productos/${t}`,e).pipe(Object(n.a)(t=>t.data))}updateImg(t,e){return this._subirArchivoService.subirArchivo(e,"/productos/subirimagen/"+t)}exportExcel(t){return this.postDownload("productos/export/excel",t)}exportTemplateExcel(){return this.postDownload("productos/plantilla/excel")}}return t.\u0275fac=function(e){return new(e||t)(c.ac(i.b),c.ac(r.a))},t.\u0275prov=c.Mb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},J0XA:function(t,e,o){"use strict";o.d(e,"a",(function(){return l}));var i=o("ofXK"),a=o("tyNb"),n=o("NFeN"),c=o("YUcS"),r=o("VX/1"),s=o("fXoL");let l=(()=>{class t{}return t.\u0275mod=s.Ob({type:t}),t.\u0275inj=s.Nb({factory:function(e){return new(e||t)},imports:[[i.c,a.j,n.b,c.a,r.b]]}),t})()},MzEE:function(t,e){e.__esModule=!0,e.default={body:'<path opacity=".3" d="M19.21 12.04l-1.53-.11l-.3-1.5A5.484 5.484 0 0 0 12 6C9.94 6 8.08 7.14 7.12 8.96l-.5.95l-1.07.11A3.99 3.99 0 0 0 2 14c0 2.21 1.79 4 4 4h13c1.65 0 3-1.35 3-3c0-1.55-1.22-2.86-2.79-2.96zM12 17l-4-4h2.55v-3h2.91v3H16l-4 4z" fill="currentColor"/><path d="M19.35 10.04A7.49 7.49 0 0 0 12 4C9.11 4 6.6 5.64 5.35 8.04A5.994 5.994 0 0 0 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5c0-2.64-2.05-4.78-4.65-4.96zM19 18H6c-2.21 0-4-1.79-4-4c0-2.05 1.53-3.76 3.56-3.97l1.07-.11l.5-.95A5.469 5.469 0 0 1 12 6c2.62 0 4.88 1.86 5.39 4.43l.3 1.5l1.53.11A2.98 2.98 0 0 1 22 15c0 1.65-1.35 3-3 3zm-5.55-8h-2.9v3H8l4 4l4-4h-2.55z" fill="currentColor"/>',width:24,height:24}},Quno:function(t,e,o){"use strict";o.r(e),o.d(e,"MasivoModule",(function(){return qo}));var i=o("tyNb"),a=o("sF+I"),n=o.n(a),c=o("7wwx"),r=o.n(c),s=o("pN9m"),l=o.n(s),d=o("e3EN"),u=o.n(d),b=o("5mnX"),m=o.n(b),f=o("uQ9D"),p=o.n(f),h=o("+tDV"),g=o.n(h),v=o("a84l"),x=o.n(v),V=o("yHIK"),y=o.n(V),C=o("Fck7"),w=o.n(C),W=o("MzEE"),I=o.n(W),E=o("We1G"),F=o.n(E),G=o("wrPX"),L=o.n(G),S=o("WT4w"),R=o.n(S),D=o("+Chm"),M=o.n(D),A=o("pI64"),k=o.n(A),_=o("0np6"),T=o("0IaG"),O=o("fXoL"),N=o("TgOq"),j=o("IRgW"),z=o("lJxs"),P=o("tk/3"),q=o("YMqD");let H=(()=>{class t extends j.a{constructor(t,e){super(),this.http=t,this._utils=e,console.log("MasivoService listo!")}index(t){return this.getQuery("masivos",t).pipe(Object(z.a)(t=>(t.data.forEach(t=>{t.fechaemision=this._utils.convertDate(t.fechaemision),t.fechavencimiento&&(t.fechavencimiento=this._utils.convertDate(t.fechavencimiento))}),t)))}show(t,e){return this.getQuery(`masivos/${t}`,e).pipe(Object(z.a)(t=>(t.data.fechaemision=this._utils.convertDate(t.data.fechaemision),t.data)))}create(t){return this.postQuery("masivos",t).pipe(Object(z.a)(t=>t))}anular(t,e){return this.postQuery(`masivos/anular/${t}`,e).pipe(Object(z.a)(t=>t.data))}}return t.\u0275fac=function(e){return new(e||t)(O.ac(P.b),O.ac(q.a))},t.\u0275prov=O.Mb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Q=o("ofXK"),U=o("6JgD"),X=o("XiUz"),$=o("/t3+"),B=o("bTqV"),K=o("Qu3c"),J=o("NFeN"),Y=o("VX/1"),Z=o("zpSk"),tt=o("znSr"),et=o("STbY");function ot(t,e){1&t&&O.Rb(0,"vex-loading")}function it(t,e){if(1&t&&(O.Wb(0,"button",32),O.Rb(1,"mat-icon",6),O.Vb()),2&t){O.ic();const t=O.uc(63),e=O.ic();O.oc("matMenuTriggerFor",t),O.Cb(1),O.oc("icIcon",e.icMoreVert)}}function at(t,e){if(1&t&&(O.Wb(0,"tr"),O.Wb(1,"td",33),O.Gc(2),O.jc(3,"number"),O.Vb(),O.Wb(4,"td",34),O.Gc(5),O.Vb(),O.Vb()),2&t){const t=e.$implicit;O.Cb(2),O.Ic(" ",O.lc(3,3,t.cantidad,"1.0-0")," "),O.Cb(3),O.Jc(" ",t.nombre," ",t.descripcion," ")}}function nt(t,e){if(1&t){const t=O.Xb();O.Wb(0,"div",35),O.Wb(1,"button",36),O.ec("click",(function(){O.wc(t);const e=O.ic(2);return e.downloadFile(e.masivo.xml)})),O.Rb(2,"ic-icon",37),O.Wb(3,"span"),O.Gc(4,"Descargar"),O.Vb(),O.Vb(),O.Wb(5,"button",38),O.ec("click",(function(){O.wc(t);const e=O.ic(2);return e.downloadFile(e.masivo.pdf)})),O.Rb(6,"ic-icon",37),O.Wb(7,"span"),O.Gc(8,"Imprimir"),O.Vb(),O.Vb(),O.Vb()}if(2&t){const t=O.ic(2);O.Cb(2),O.oc("icon",t.icCloudDownload),O.Cb(4),O.oc("icon",t.icPrint)}}function ct(t,e){1&t&&(O.Wb(0,"div",35),O.Wb(1,"p",39),O.Gc(2,"COMPROBANTES SE ENCUENTRAN ANULADOS"),O.Vb(),O.Vb())}function rt(t,e){if(1&t){const t=O.Xb();O.Wb(0,"button",43),O.ec("click",(function(){O.wc(t);const e=O.ic().$implicit;return O.ic(2).printPdf(e.pdf)})),O.Rb(1,"mat-icon",44),O.Vb()}if(2&t){const t=O.ic(3);O.Cb(1),O.oc("icIcon",t.icPrint)}}function st(t,e){if(1&t&&(O.Wb(0,"tr"),O.Wb(1,"td"),O.Gc(2),O.Vb(),O.Wb(3,"td"),O.Gc(4),O.Vb(),O.Wb(5,"td"),O.Gc(6),O.Vb(),O.Wb(7,"td",40),O.Gc(8),O.Vb(),O.Wb(9,"td",41),O.Ec(10,rt,2,1,"button",42),O.Vb(),O.Vb()),2&t){const t=e.$implicit,o=O.ic(2);O.Cb(2),O.Hc(t.docnegocio.nombre),O.Cb(2),O.Hc(t.serie),O.Cb(2),O.Hc(t.numero),O.Cb(2),O.Ic("S/ ",t.total,""),O.Cb(2),O.oc("ngIf",27===o.masivo.idestadodocumento)}}function lt(t,e){if(1&t){const t=O.Xb();O.Wb(0,"div"),O.Wb(1,"div",1),O.Wb(2,"mat-toolbar",2),O.Wb(3,"h2",3),O.Gc(4,"Ventas"),O.Vb(),O.Ec(5,it,2,2,"button",4),O.Wb(6,"button",5),O.Rb(7,"mat-icon",6),O.Vb(),O.Vb(),O.Vb(),O.Wb(8,"mat-dialog-content",7),O.Wb(9,"div",8),O.Wb(10,"div",9),O.Wb(11,"div",10),O.Wb(12,"div",11),O.Rb(13,"ic-icon",12),O.Vb(),O.Wb(14,"div"),O.Wb(15,"p",13),O.Gc(16),O.Vb(),O.Wb(17,"p",14),O.Gc(18,"Local"),O.Vb(),O.Vb(),O.Vb(),O.Wb(19,"div",10),O.Wb(20,"div",11),O.Rb(21,"ic-icon",12),O.Vb(),O.Wb(22,"div"),O.Wb(23,"p",13),O.Gc(24),O.jc(25,"date"),O.Vb(),O.Wb(26,"p",14),O.Gc(27,"Fecha emisi\xf3n"),O.Vb(),O.Vb(),O.Vb(),O.Wb(28,"div",10),O.Wb(29,"div",11),O.Rb(30,"ic-icon",12),O.Vb(),O.Wb(31,"div"),O.Wb(32,"p",13),O.Gc(33),O.Vb(),O.Wb(34,"p",14),O.Gc(35,"Comprobantes"),O.Vb(),O.Vb(),O.Vb(),O.Wb(36,"div",10),O.Wb(37,"table",15),O.Wb(38,"tbody"),O.Ec(39,at,6,6,"tr",16),O.Vb(),O.Vb(),O.Vb(),O.Vb(),O.Wb(40,"div",17),O.Ec(41,nt,9,2,"div",18),O.Ec(42,ct,3,0,"div",18),O.Vb(),O.Vb(),O.Wb(43,"fieldset",19),O.Wb(44,"div",20),O.Wb(45,"table",15),O.Wb(46,"thead"),O.Wb(47,"tr"),O.Wb(48,"th",21),O.Gc(49,"COMPROBANTE"),O.Vb(),O.Wb(50,"th",22),O.Gc(51,"SERIE"),O.Vb(),O.Wb(52,"th",22),O.Gc(53,"NUMERO"),O.Vb(),O.Wb(54,"th",23),O.Gc(55,"TOTAL"),O.Vb(),O.Rb(56,"th",24),O.Vb(),O.Vb(),O.Wb(57,"tbody"),O.Ec(58,st,11,5,"tr",16),O.Vb(),O.Vb(),O.Vb(),O.Vb(),O.Vb(),O.Wb(59,"mat-dialog-actions",25),O.Wb(60,"button",26),O.Gc(61," CERRAR "),O.Vb(),O.Vb(),O.Wb(62,"mat-menu",27,28),O.Wb(64,"button",29),O.ec("click",(function(){return O.wc(t),O.ic().matDialogRef.close("anular")})),O.Rb(65,"mat-icon",30),O.Gc(66," Anular "),O.Vb(),O.Wb(67,"a",31),O.Rb(68,"mat-icon",6),O.Gc(69," PDF "),O.Vb(),O.Vb(),O.Vb()}if(2&t){const t=O.ic();O.Cb(5),O.oc("ngIf",27===t.masivo.idestadodocumento),O.Cb(2),O.oc("icIcon",t.icClose),O.Cb(6),O.oc("icon",t.icDomain),O.Cb(3),O.Hc(t.masivo.sede.nombre),O.Cb(5),O.oc("icon",t.icToday),O.Cb(3),O.Hc(O.lc(25,15,t.masivo.fechaemision,"EEEE, d MMMM y")),O.Cb(6),O.oc("icon",t.icInsertDriveFile),O.Cb(3),O.Hc(t.masivo.cantidad),O.Cb(6),O.oc("ngForOf",t.masivo.masivodet),O.Cb(2),O.oc("ngIf",27===t.masivo.idestadodocumento),O.Cb(1),O.oc("ngIf",28===t.masivo.idestadodocumento),O.Cb(16),O.oc("ngForOf",t.masivo.ventas),O.Cb(7),O.oc("icIcon",t.icBlock),O.Cb(2),O.oc("href",t.URL_PDF+t.masivo.pdf,O.zc),O.Cb(1),O.oc("icIcon",t.icCallMade)}}let dt=(()=>{class t{constructor(t,e,o,i){this.data=t,this.matDialogRef=e,this._ventaService=o,this._masivoService=i,this.URL_PDF=_.b+"/pdf-masivo/",this.icEdit=l.a,this.icBlock=x.a,this.icClose=m.a,this.icPrint=y.a,this.icToday=L.a,this.icDomain=F.a,this.icDelete=u.a,this.icMoreVert=M.a,this.icCallMade=k.a,this.icCloudDownload=I.a,this.icInsertDriveFile=R.a}ngOnInit(){this.show()}show(){this.loading=!0,this._masivoService.show(this.data.id,{conRecurso:"sede,masivodet,ventas.docnegocio"}).subscribe(t=>{this.masivo=t,this.masivo.ventas.forEach(t=>{t.pdf=this.urlPdf(t.pdf)}),this.loading=!1},t=>{this.loading=!1})}downloadFile(t){}printPdf(t){const e=this.urlPdf(t);this._ventaService.downloadProxy(e).subscribe(t=>{const e=new Blob([t],{type:"application/pdf"}),o=URL.createObjectURL(e),i=document.createElement("iframe");i.style.display="none",i.src=o,document.body.appendChild(i),i.contentWindow.print()},t=>{})}urlPdf(t){let e="";if(t){const o=t.split("/").reverse()[0],i=t.split("/").reverse()[1];-1===t.indexOf("www.pse.pe")&&(e="/apiifact/public/"+i+"/"+o),-1!==t.indexOf("www.pse.pe")&&(e="/"+i+"/"+o)}return e}}return t.\u0275fac=function(e){return new(e||t)(O.Qb(T.a),O.Qb(T.g),O.Qb(N.a),O.Qb(H))},t.\u0275cmp=O.Kb({type:t,selectors:[["vex-masivo-show"]],decls:2,vars:2,consts:[[4,"ngIf"],["mat-dialog-title","","fxLayout","column"],["color","primary","fxLayout","row","fxLayoutAlign","start center"],["fxFlex","auto",1,"headline","m-0"],["class","text-secondary","mat-icon-button","","type","button","matTooltip","M\xe1s acciones",3,"matMenuTriggerFor",4,"ngIf"],["mat-dialog-close","","mat-icon-button","","type","button","matTooltip","Cerrar",1,"text-secondary"],[3,"icIcon"],["fxLayout","column"],["fxLayout","row","fxLayout.lt-sm","column","fxLayoutGap","16px","fxLayoutGap.lt-sm","0"],["gdColumns","1fr 1fr","gdColumns.xs","1fr","gdGap","16px","fxFlex","65",1,"px-gutter"],["fxLayout","row","fxLayoutAlign","start center"],[1,"w-10","h-10","rounded-full","bg-gray-50","text-dark","ltr:mr-3","rtl:ml-3","flex","items-center","justify-center"],["size","20px",3,"icon"],[1,"m-0","body-1"],[1,"m-0","caption","text-hint"],[1,"table-hover"],[4,"ngFor","ngForOf"],["fxLayout","column","fxFlex","35"],["fxLayout","row","fxLayout.xs","column","fxLayoutAlign","center center","fxLayoutAlign.xs","center stretch","fxLayoutGap","6px",4,"ngIf"],[1,"mt-4"],[1,"loading-container"],[1,"text-left",2,"width","45%"],[1,"text-left",2,"width","15%"],["fxHide.xs","",1,"text-left",2,"width","15%"],[2,"width","10%"],["align","end"],["mat-button","","mat-dialog-close","","aria-label","CERRAR"],["xPosition","before","yPosition","below"],["settingsMenu","matMenu"],["mat-menu-item","",3,"click"],["color","warn",3,"icIcon"],["mat-menu-item","","target","_blank",3,"href"],["mat-icon-button","","type","button","matTooltip","M\xe1s acciones",1,"text-secondary",3,"matMenuTriggerFor"],[1,"text-center","b-1"],[1,"b-1"],["fxLayout","row","fxLayout.xs","column","fxLayoutAlign","center center","fxLayoutAlign.xs","center stretch","fxLayoutGap","6px"],["mat-raised-button","","type","button","color","accent","matTooltip","Todo",1,"rounded-full",3,"click"],["inline","true","size","24px",1,"ltr:-ml-1","rtl:-mr-1","ltr:mr-2","rtl:ml-2",3,"icon"],["mat-raised-button","","type","button","color","primary","matTooltip","Todo",1,"rounded-full",3,"click"],[1,"text-red-500","text-center"],["fxHide.xs",""],[1,"text-center"],["mat-icon-button","","matTooltip","Imprimir","class","w-8 h-8 leading-none flex items-center justify-center hover:bg-hover",3,"click",4,"ngIf"],["mat-icon-button","","matTooltip","Imprimir",1,"w-8","h-8","leading-none","flex","items-center","justify-center","hover:bg-hover",3,"click"],["size","18px",3,"icIcon"]],template:function(t,e){1&t&&(O.Ec(0,ot,1,0,"vex-loading",0),O.Ec(1,lt,70,18,"div",0)),2&t&&(O.oc("ngIf",e.loading),O.Cb(1),O.oc("ngIf",!e.loading))},directives:[Q.p,U.a,T.h,X.c,$.a,X.b,X.a,B.b,T.d,K.a,J.a,Y.a,T.e,X.d,Z.d,Z.b,Q.o,tt.b,T.c,et.d,et.a,et.c],pipes:[Q.e,Q.f],styles:["@media (min-width:960px){.masivo-show-dialog{width:800px}}.masivo-show-dialog .mat-dialog-container{padding:0;margin:0}.masivo-show-dialog .mat-dialog-content{padding:0 16px;margin:0}.masivo-show-dialog .mat-dialog-actions{padding:16px 24px;margin:0}.masivo-show-dialog fieldset{border:1px solid #ccc;border-radius:8px;line-height:24px;padding:8px}.masivo-show-dialog fieldset legend{padding:0 8px}.masivo-show-dialog .table-hover{border-collapse:collapse;width:100%}.masivo-show-dialog .table-hover tr:nth-child(2n){background-color:#f5f5f5}"],encapsulation:2}),t})();var ut=o("3Pt+"),bt=o("hF2C"),mt=o.n(bt),ft=o("Kj3r"),pt=o("eIep"),ht=o("vkgz"),gt=o("nYR2"),vt=o("6qmq"),xt=o.n(vt),Vt=o("yCEk"),yt=o("eUUZ"),Ct=o("f0Cb"),wt=o("kmnG"),Wt=o("qFsG"),It=o("iadO"),Et=o("d3UM"),Ft=o("/1cH"),Gt=o("1jcm"),Lt=o("FKr1"),St=o("Xa2L");function Rt(t,e){if(1&t&&(O.Wb(0,"mat-option",39),O.Gc(1),O.Vb()),2&t){const t=e.$implicit;O.oc("value",t.moneda),O.Cb(1),O.Ic(" ",t.nombre," ")}}function Dt(t,e){1&t&&(O.Wb(0,"mat-error"),O.Gc(1," Requerido! "),O.Vb())}function Mt(t,e){1&t&&(O.Wb(0,"span"),O.Gc(1,"DNI"),O.Vb())}function At(t,e){1&t&&(O.Wb(0,"span"),O.Gc(1,"RUC"),O.Vb())}function kt(t,e){1&t&&(O.Wb(0,"span"),O.Gc(1,"C.Extranjeria"),O.Vb())}function _t(t,e){1&t&&(O.Wb(0,"span"),O.Gc(1,"Pasaporte"),O.Vb())}function Tt(t,e){1&t&&(O.Wb(0,"span"),O.Gc(1,"Sin Documento"),O.Vb())}function Ot(t,e){1&t&&(O.Wb(0,"span"),O.Gc(1,"Cliente"),O.Vb())}function Nt(t,e){1&t&&(O.Wb(0,"mat-option",40),O.Rb(1,"mat-spinner",41),O.Vb())}function jt(t,e){if(1&t&&O.Rb(0,"ic-icon",53),2&t){const t=O.ic(3);O.oc("icIcon",t.icAccountCircle)}}function zt(t,e){if(1&t&&O.Rb(0,"ic-icon",53),2&t){const t=O.ic(3);O.oc("icIcon",t.icDomain)}}function Pt(t,e){1&t&&(O.Wb(0,"small",54),O.Gc(1,"DNI"),O.Vb())}function qt(t,e){1&t&&(O.Wb(0,"small",54),O.Gc(1,"RUC"),O.Vb())}function Ht(t,e){1&t&&(O.Wb(0,"small",54),O.Gc(1,"C.Ext."),O.Vb())}function Qt(t,e){1&t&&(O.Wb(0,"small",54),O.Gc(1,"Pasap."),O.Vb())}function Ut(t,e){1&t&&(O.Wb(0,"small",54),O.Gc(1,"Sin D."),O.Vb())}function Xt(t,e){1&t&&(O.Wb(0,"small",54),O.Gc(1,"Identificaci\xf3n"),O.Vb())}const $t=function(){return[1,3,4,5,6,7]};function Bt(t,e){if(1&t&&(O.Wb(0,"mat-option",45),O.Wb(1,"div",46),O.Wb(2,"div",47),O.Ec(3,jt,1,1,"ic-icon",48),O.Ec(4,zt,1,1,"ic-icon",48),O.Vb(),O.Wb(5,"div",49),O.Wb(6,"small"),O.Gc(7),O.Vb(),O.Wb(8,"div",46),O.Ec(9,Pt,2,0,"small",50),O.Ec(10,qt,2,0,"small",50),O.Ec(11,Ht,2,0,"small",50),O.Ec(12,Qt,2,0,"small",50),O.Ec(13,Ut,2,0,"small",50),O.Ec(14,Xt,2,0,"small",51),O.Wb(15,"small",52),O.Gc(16),O.Vb(),O.Vb(),O.Vb(),O.Vb(),O.Vb()),2&t){const t=e.$implicit;O.oc("value",t)("ngSwitch",t.iddocumento),O.Cb(3),O.oc("ngIf",-1!==O.pc(11,$t).indexOf(t.iddocumento)),O.Cb(1),O.oc("ngIf",2===t.iddocumento),O.Cb(3),O.Hc(t.entidad),O.Cb(2),O.oc("ngSwitchCase",1),O.Cb(1),O.oc("ngSwitchCase",2),O.Cb(1),O.oc("ngSwitchCase",3),O.Cb(1),O.oc("ngSwitchCase",4),O.Cb(1),O.oc("ngSwitchCase",5),O.Cb(3),O.Hc(t.numerodoc)}}function Kt(t,e){if(1&t&&(O.Ub(0),O.Ec(1,Bt,17,12,"mat-option",42),O.Wb(2,"div",43),O.Wb(3,"small",44),O.Gc(4),O.Vb(),O.Vb(),O.Tb()),2&t){const t=O.ic();O.Cb(1),O.oc("ngForOf",t.searchResult.data),O.Cb(3),O.Jc("Mostrando ",t.searchResult.to," de ",t.searchResult.total," resultados.")}}function Jt(t,e){if(1&t&&O.Rb(0,"mat-icon",55),2&t){const t=O.ic();O.oc("icIcon",t.icSearch)}}function Yt(t,e){if(1&t){const t=O.Xb();O.Wb(0,"mat-icon",56),O.ec("click",(function(){return O.wc(t),O.ic().cliente.setValue("")})),O.Vb()}if(2&t){const t=O.ic();O.oc("icIcon",t.icClose)}}function Zt(t,e){if(1&t&&(O.Wb(0,"mat-option",39),O.Gc(1),O.Vb()),2&t){const t=e.$implicit;O.oc("value",t.operacion),O.Cb(1),O.Ic(" ",t.nombre," ")}}function te(t,e){if(1&t&&(O.Wb(0,"mat-option",39),O.Gc(1),O.Vb()),2&t){const t=e.$implicit;O.oc("value",t.id),O.Cb(1),O.Ic(" ",t.nombre," ")}}let ee=(()=>{class t{constructor(t,e,o,i){this._data=t,this.matDialogRef=e,this._entidadService=o,this._datainicial=i,this.cliente=new ut.e,this.searchResult={data:[],to:null,total:null},this.isLoadingSearch=!1,this.monedas=this._datainicial.monedas,this.formatos=this._datainicial.formatos,this.operaciones=this._datainicial.operaciones,this.icClose=m.a,this.icSearch=n.a,this.icDomain=F.a,this.icAccountCircle=xt.a,this._data=this._data.venta}ngOnInit(){this._data.idcliente&&this.cliente.setValue({identidad:this._data.idcliente,entidad:this._data.clientenombre}),this.generalForm=this.createForm(),this.cliente.valueChanges.pipe(Object(ft.a)(300),Object(ht.a)(()=>this.isLoadingSearch=!0),Object(pt.a)(t=>{if(console.log("cliente valueChanges",t),"string"==typeof t&&(this.generalForm.get("idcliente").setValue(null),this.generalForm.get("clientenombre").setValue(null),this.generalForm.get("clientedoc").setValue(null),this.generalForm.get("clientenumerodoc").setValue(null,{emitEvent:!1}),this.generalForm.get("clientedireccion").setValue(null)),"string"==typeof t&&t){console.log("get API CLIENTE");const e={idempresa:this._entidadService.usuario.idempresa,page:1,pageSize:10,orderName:"entidad",orderSort:"asc"};return parseFloat(t)>0?e.likeNumerodoc=t:e.likeEntidad=t,this._entidadService.index(e).pipe(Object(gt.a)(()=>this.isLoadingSearch=!1))}return this.isLoadingSearch=!1,[]})).subscribe(t=>{this.searchResult=t})}createForm(){return new ut.h({fechaemision:new ut.e(this._data.fechaemision,[ut.v.required]),fechavencimiento:new ut.e(this._data.fechavencimiento),moneda:new ut.e(this._data.moneda),tipocambio:new ut.e(this._data.tipocambio),operacion:new ut.e(this._data.operacion,[ut.v.required]),pdfformato:new ut.e(this._data.pdfformato,[ut.v.required]),condicionpago:new ut.e(this._data.condicionpago),observacion:new ut.e(this._data.observacion),detraccion:new ut.e(this._data.detraccion),selvaproducto:new ut.e(this._data.selvaproducto),selvaservicio:new ut.e(this._data.selvaservicio),idcliente:new ut.e(this._data.idcliente),clientenombre:new ut.e(this._data.clientenombre),clientedoc:new ut.e(this._data.clientedoc),clientenumerodoc:new ut.e(this._data.clientenumerodoc),clientedireccion:new ut.e(this._data.clientedireccion)})}save(){let t={};t=this.generalForm.getRawValue(),this.matDialogRef.close(t)}displaySearchEntidad(t){return t?t.entidad:null}autocompletadoClienteSelected(t){t&&(console.log("Selected",t),this.generalForm.get("idcliente").setValue(t.identidad),this.generalForm.get("clientenombre").setValue(t.entidad),this.generalForm.get("clientedoc").setValue(t.iddocumento),this.generalForm.get("clientenumerodoc").setValue(t.numerodoc),this.generalForm.get("clientedireccion").setValue(t.direccion))}}return t.\u0275fac=function(e){return new(e||t)(O.Qb(T.a),O.Qb(T.g),O.Qb(Vt.a),O.Qb(yt.a))},t.\u0275cmp=O.Kb({type:t,selectors:[["vex-masivo-general"]],decls:79,vars:23,consts:[[3,"formGroup","ngSubmit"],["fxLayout","row","fxLayoutAlign","start center","mat-dialog-title",""],["fxFlex","auto",1,"headline","m-0"],["mat-dialog-close","","mat-icon-button","","type","button",1,"text-secondary"],[3,"icIcon"],[1,"-mx-6","text-border"],["fxLayout","column"],["fxLayout","row","fxLayout.lt-sm","column","fxLayoutGap","16px","fxLayoutGap.lt-sm","0"],["appearance","standard","floatLabel","always","fxFlex","50"],["matInput","","name","start","formControlName","fechavencimiento",3,"matDatepicker"],["matSuffix","",3,"for"],["fechaDatePickerVence",""],["fxLayout","row","fxLayoutGap","8px","fxFlex","50"],["appearance","standard","floatLabel","always","fxFlex","auto",1,"vex-flex-form-field"],["formControlName","moneda"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["fxFlex","60"],["matInput","","type","number","formControlName","tipocambio"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"ml-1"],["matInput","",3,"matAutocomplete","formControl"],["autoActiveFirstOption","",3,"displayWith","optionSelected"],["autoCliente","matAutocomplete"],["class","p-3","value","",4,"ngIf"],["matSuffix","",3,"icIcon",4,"ngIf"],["matSuffix","","class","cursor-pointer",3,"icIcon","click",4,"ngIf"],["formControlName","operacion","required",""],["formControlName","pdfformato","required",""],["matInput","","formControlName","condicionpago"],["matInput","","formControlName","observacion"],["formControlName","detraccion"],["formControlName","selvaproducto"],["formControlName","selvaservicio"],["align","end"],["mat-button","","mat-dialog-close","","type","button"],["color","primary","mat-raised-button","","type","submit",3,"disabled"],[3,"value"],["value","",1,"p-3"],["diameter","25"],[3,"value","ngSwitch",4,"ngFor","ngForOf"],["fxLayout","row"],[1,"p-3"],[3,"value","ngSwitch"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","8px"],["fxLayout","column","fxLayoutAlign","center start"],["size","24px",3,"icIcon",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center stretch"],["class","text-secondary inline-block",4,"ngSwitchCase"],["class","text-secondary inline-block",4,"ngSwitchDefault"],[1,"text-secondary"],["size","24px",3,"icIcon"],[1,"text-secondary","inline-block"],["matSuffix","",3,"icIcon"],["matSuffix","",1,"cursor-pointer",3,"icIcon","click"]],template:function(t,e){if(1&t&&(O.Wb(0,"form",0),O.ec("ngSubmit",(function(){return e.save()})),O.Wb(1,"div",1),O.Wb(2,"h2",2),O.Gc(3,"Datos generales"),O.Vb(),O.Wb(4,"button",3),O.Rb(5,"mat-icon",4),O.Vb(),O.Vb(),O.Rb(6,"mat-divider",5),O.Wb(7,"mat-dialog-content",6),O.Wb(8,"div",7),O.Wb(9,"mat-form-field",8),O.Wb(10,"mat-label"),O.Gc(11,"Fecha vencimiento"),O.Vb(),O.Rb(12,"input",9),O.Rb(13,"mat-datepicker-toggle",10),O.Rb(14,"mat-datepicker",null,11),O.Vb(),O.Wb(16,"div",12),O.Wb(17,"mat-form-field",13),O.Wb(18,"mat-label"),O.Gc(19,"Moneda"),O.Vb(),O.Wb(20,"mat-select",14),O.Ec(21,Rt,2,2,"mat-option",15),O.Vb(),O.Ec(22,Dt,2,0,"mat-error",16),O.Vb(),O.Wb(23,"div",17),O.Wb(24,"mat-form-field",13),O.Wb(25,"mat-label"),O.Gc(26,"Tipo de cambio"),O.Vb(),O.Rb(27,"input",18),O.Vb(),O.Vb(),O.Vb(),O.Vb(),O.Wb(28,"div",7),O.Wb(29,"mat-form-field",13),O.Wb(30,"mat-label",19),O.Ec(31,Mt,2,0,"span",20),O.Ec(32,At,2,0,"span",20),O.Ec(33,kt,2,0,"span",20),O.Ec(34,_t,2,0,"span",20),O.Ec(35,Tt,2,0,"span",20),O.Ec(36,Ot,2,0,"span",21),O.Wb(37,"i",22),O.Gc(38),O.Vb(),O.Vb(),O.Rb(39,"input",23),O.Wb(40,"mat-autocomplete",24,25),O.ec("optionSelected",(function(t){return e.autocompletadoClienteSelected(t.option.value)})),O.Ec(42,Nt,2,0,"mat-option",26),O.Ec(43,Kt,5,3,"ng-container",16),O.Vb(),O.Ec(44,Jt,1,1,"mat-icon",27),O.Ec(45,Yt,1,1,"mat-icon",28),O.Vb(),O.Vb(),O.Wb(46,"div",7),O.Wb(47,"mat-form-field",8),O.Wb(48,"mat-label"),O.Gc(49,"Tipo de operaci\xf3n"),O.Vb(),O.Wb(50,"mat-select",29),O.Ec(51,Zt,2,2,"mat-option",15),O.Vb(),O.Vb(),O.Wb(52,"mat-form-field",8),O.Wb(53,"mat-label"),O.Gc(54,"Formato impresi\xf3n"),O.Vb(),O.Wb(55,"mat-select",30),O.Ec(56,te,2,2,"mat-option",15),O.Vb(),O.Vb(),O.Vb(),O.Wb(57,"div",7),O.Wb(58,"mat-form-field",8),O.Wb(59,"mat-label"),O.Gc(60,"Condiciones de pago"),O.Vb(),O.Rb(61,"input",31),O.Vb(),O.Wb(62,"mat-form-field",8),O.Wb(63,"mat-label"),O.Gc(64,"Observaciones"),O.Vb(),O.Rb(65,"input",32),O.Vb(),O.Vb(),O.Wb(66,"fieldset"),O.Wb(67,"div",6),O.Wb(68,"mat-slide-toggle",33),O.Gc(69," Comprobante sujeto a detracci\xf3n? "),O.Vb(),O.Wb(70,"mat-slide-toggle",34),O.Gc(71," Bienes regi\xf3n selva? "),O.Vb(),O.Wb(72,"mat-slide-toggle",35),O.Gc(73," Servicios regi\xf3n selva? "),O.Vb(),O.Vb(),O.Vb(),O.Vb(),O.Wb(74,"mat-dialog-actions",36),O.Wb(75,"button",37),O.Gc(76,"CERRAR"),O.Vb(),O.Wb(77,"button",38),O.Gc(78,"ACEPTAR"),O.Vb(),O.Vb(),O.Vb()),2&t){const t=O.uc(15),o=O.uc(41);O.oc("formGroup",e.generalForm),O.Cb(5),O.oc("icIcon",e.icClose),O.Cb(7),O.oc("matDatepicker",t),O.Cb(1),O.oc("for",t),O.Cb(8),O.oc("ngForOf",e.monedas),O.Cb(1),O.oc("ngIf",e.generalForm.get("moneda").hasError("required")),O.Cb(8),O.oc("ngSwitch",e.generalForm.get("clientedoc").value),O.Cb(1),O.oc("ngSwitchCase",1),O.Cb(1),O.oc("ngSwitchCase",2),O.Cb(1),O.oc("ngSwitchCase",3),O.Cb(1),O.oc("ngSwitchCase",4),O.Cb(1),O.oc("ngSwitchCase",5),O.Cb(3),O.Hc(e.generalForm.get("clientenumerodoc").value),O.Cb(1),O.oc("matAutocomplete",o)("formControl",e.cliente),O.Cb(1),O.oc("displayWith",e.displaySearchEntidad),O.Cb(2),O.oc("ngIf",e.isLoadingSearch),O.Cb(1),O.oc("ngIf",!e.isLoadingSearch),O.Cb(1),O.oc("ngIf",!e.cliente.value),O.Cb(1),O.oc("ngIf",e.cliente.value),O.Cb(6),O.oc("ngForOf",e.operaciones),O.Cb(5),O.oc("ngForOf",e.formatos),O.Cb(21),O.oc("disabled",e.generalForm.invalid)}},directives:[ut.w,ut.q,ut.i,X.c,X.b,T.h,X.a,B.b,T.d,J.a,Y.a,Ct.a,T.e,X.d,wt.d,wt.h,Wt.b,ut.b,It.b,ut.p,ut.g,It.d,wt.j,It.a,Et.a,Q.o,Q.p,ut.s,Q.r,Q.s,Q.t,Ft.c,ut.f,Ft.a,ut.u,Gt.a,T.c,Lt.n,wt.c,St.b],styles:["@media (min-width:960px){.masivogeneral-form-dialog{width:480px}}.masivogeneral-form-dialog fieldset{border:1px solid #ccc;border-radius:8px;padding:8px}.masivogeneral-form-dialog fieldset legend{padding:0 8px}"],encapsulation:2}),t})();var oe=o("dNgK"),ie=o("dVfw"),ae=o("GPUG"),ne=o("kYjG");function ce(t,e){if(1&t&&(O.Ub(0),O.Rb(1,"span",2),O.Tb()),2&t){const t=O.ic();O.Cb(1),O.oc("innerHTML",t.i.text,O.xc)}}function re(t,e){1&t&&O.Sb(0)}const se=function(t){return{$implicit:t}};var le=function(t){return t[t.ing=0]="ing",t[t.pause=1]="pause",t[t.stop=2]="stop",t[t.done=3]="done",t}({});let de=(()=>{let t=class{constructor(t){this.ngZone=t,this.fns=[],this.commands=[],this.ing=!1}start(){!0!==this.ing&&(this.ing=!0,this.nextTime=+new Date,this.ngZone.runOutsideAngular(()=>{this.process()}))}process(){for(;this.commands.length;)this.commands.shift()();let t=+new Date-this.nextTime;const e=1+Math.floor(t/100);t=100-t%100,this.nextTime+=100*e;for(let o=0,i=this.fns.length;o<i;o+=2){let t=this.fns[o+1];if(0===t)this.fns[o](e);else{t+=2*e-1;const i=Math.floor(t/20);i>0&&this.fns[o](i),this.fns[o+1]=t%20+1}}this.ing&&setTimeout(()=>this.process(),t)}add(t,e){return this.commands.push(()=>{this.fns.push(t),this.fns.push(1e3===e?1:0),this.ing=!0}),this}remove(t){return this.commands.push(()=>{const e=this.fns.indexOf(t);-1!==e&&this.fns.splice(e,2),this.ing=this.fns.length>0}),this}};return t.\u0275fac=function(e){return new(e||t)(O.ac(O.A))},t.\u0275prov=O.Mb({token:t,factory:t.\u0275fac}),t})(),ue=(()=>{let t=class{constructor(t){this.locale=t,this.demand=!1,this.leftTime=0,this.format="HH:mm:ss",this.timezone="+0000",this.formatDate=({date:t,formatStr:e,timezone:o})=>Object(Q.z)(new Date(t),e,this.locale,o||this.timezone||"+0000")}};return t.\u0275fac=function(e){return new(e||t)(O.ac(O.v))},t.\u0275prov=Object(O.Mb)({factory:function(){return new t(Object(O.ac)(O.v))},token:t,providedIn:"root"}),t})(),be=(()=>{let t=class{constructor(t,e,o,i,a){this.locale=t,this.timer=e,this.defCog=o,this.cdr=i,this.ngZone=a,this.frequency=1e3,this._notify={},this.status=le.ing,this.isDestroy=!1,this.i={},this.left=0,this.event=new O.o}begin(){this.status=le.ing,this.callEvent("start")}restart(){this.status!==le.stop&&this.destroy(),this.init(),this.callEvent("restart")}stop(){this.status!==le.stop&&(this.status=le.stop,this.destroy(),this.callEvent("stop"))}pause(){this.status!==le.stop&&this.status!==le.pause&&(this.status=le.pause,this.callEvent("pause"))}resume(){this.status!==le.stop&&this.status===le.pause&&(this.status=le.ing,this.callEvent("resume"))}callEvent(t){this.event.emit({action:t,left:this.left,status:this.status,text:this.i.text})}init(){const{locale:t,defCog:e}=this,o=this.config=Object.assign(Object.assign(Object.assign({},new ue(t)),e),this.config),i=this.frequency=~o.format.indexOf("S")?100:1e3;this.status=o.demand?le.pause:le.ing,this.getLeft();const a=this.reflow;this.reflow=(t=0,e=!1)=>a.apply(this,[t,e]),Array.isArray(o.notify)&&o.notify.forEach(t=>{if(t<1)throw new Error("The notify config must be a positive integer.");t*=1e3,this._notify[t-=t%i]=!0}),this.timer.add(this.reflow,i).start(),this.reflow(0,!0)}destroy(){return this.timer.remove(this.reflow),this}reflow(t=0,e=!1){if(this.isDestroy)return;const{status:o,config:i,_notify:a}=this;if(!e&&o!==le.ing)return;const n=this.left=this.left-this.frequency*t;this.i={value:n,text:i.formatDate({date:n,formatStr:i.format,timezone:i.timezone})},"function"==typeof i.prettyText&&(this.i.text=i.prettyText(this.i.text)),this.cdr.detectChanges(),(0===i.notify||a[n])&&this.ngZone.run(()=>{this.callEvent("notify")}),n<1&&this.ngZone.run(()=>{this.status=le.done,this.callEvent("done"),this.destroy()})}getLeft(){const{config:t,frequency:e}=this;let o=1e3*t.leftTime;const i=t.stopTime;!o&&i&&(o=i-(new Date).getTime()),this.left=o-o%e}ngOnInit(){this.init(),this.config.demand||this.begin()}ngOnDestroy(){this.isDestroy=!0,this.destroy()}ngOnChanges(t){t.config.firstChange||this.restart()}};return t.\u0275fac=function(e){return new(e||t)(O.Qb(O.v),O.Qb(de),O.Qb(ue),O.Qb(O.h),O.Qb(O.A))},t.\u0275cmp=O.Kb({type:t,selectors:[["countdown"]],hostVars:2,hostBindings:function(t,e){2&t&&O.Gb("count-down",!0)},inputs:{config:"config",render:"render"},outputs:{event:"event"},features:[O.Ab],decls:2,vars:5,consts:[[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"innerHTML"]],template:function(t,e){1&t&&(O.Ec(0,ce,2,1,"ng-container",0),O.Ec(1,re,1,0,"ng-container",1)),2&t&&(O.oc("ngIf",!e.render),O.Cb(1),O.oc("ngTemplateOutlet",e.render)("ngTemplateOutletContext",O.qc(3,se,e.i)))},directives:[Q.p,Q.u],encapsulation:2,changeDetection:0}),t})(),me=(()=>{let t=class{};return t.\u0275mod=O.Ob({type:t}),t.\u0275inj=O.Nb({factory:function(e){return new(e||t)},providers:[de],imports:[[Q.c]]}),t})();const fe=["cantidad"];function pe(t,e){1&t&&O.Rb(0,"vex-loading")}function he(t,e){if(1&t&&(O.Wb(0,"div",49),O.Wb(1,"div",50),O.Wb(2,"div",51),O.Rb(3,"mat-spinner"),O.Vb(),O.Wb(4,"div",52),O.Rb(5,"countdown",53),O.Vb(),O.Vb(),O.Vb()),2&t){const t=O.ic(2);O.Cb(5),O.oc("config",t.countdown)}}function ge(t,e){if(1&t&&(O.Wb(0,"mat-option",54),O.Gc(1),O.Vb()),2&t){const t=e.$implicit;O.oc("value",t.idsede),O.Cb(1),O.Ic(" ",t.nombre," ")}}function ve(t,e){1&t&&(O.Wb(0,"mat-error"),O.Gc(1," Requerido! "),O.Vb())}function xe(t,e){if(1&t&&(O.Wb(0,"mat-option",54),O.Wb(1,"div",55),O.Wb(2,"span",56),O.Gc(3),O.Vb(),O.Wb(4,"span",57),O.Gc(5),O.Vb(),O.Vb(),O.Vb()),2&t){const t=e.$implicit;O.oc("value",t),O.Cb(3),O.Ic("",t.documentofiscal.nombre," "),O.Cb(2),O.Hc(t.serie)}}function Ve(t,e){1&t&&(O.Wb(0,"mat-error"),O.Gc(1," Requerido! "),O.Vb())}function ye(t,e){1&t&&(O.Wb(0,"mat-error"),O.Gc(1," Requerido! "),O.Vb())}function Ce(t,e){1&t&&(O.Wb(0,"mat-error"),O.Gc(1," Es requerido "),O.Vb())}function we(t,e){if(1&t&&(O.Wb(0,"mat-label"),O.Gc(1),O.Vb()),2&t){const t=O.ic().$implicit;O.Cb(1),O.Hc(t.get("producto").value.codigo)}}function We(t,e){1&t&&(O.Wb(0,"mat-option",79),O.Rb(1,"mat-spinner",80),O.Vb())}function Ie(t,e){if(1&t&&(O.Wb(0,"mat-option",54),O.Wb(1,"div",81),O.Wb(2,"small"),O.Gc(3),O.Vb(),O.Wb(4,"div",82),O.Wb(5,"small",83),O.Gc(6,"Precio"),O.Vb(),O.Wb(7,"small",84),O.Gc(8),O.Vb(),O.Vb(),O.Vb(),O.Vb()),2&t){const t=e.$implicit;O.oc("value",t),O.Cb(3),O.Hc(t.nombre),O.Cb(5),O.Hc(t.precio)}}function Ee(t,e){if(1&t&&(O.Ub(0),O.Ec(1,Ie,9,3,"mat-option",16),O.Tb()),2&t){const t=O.ic().$implicit;O.Cb(1),O.oc("ngForOf",t.get("datalist").value)}}function Fe(t,e){if(1&t&&O.Rb(0,"mat-icon",85),2&t){const t=O.ic(3);O.oc("icIcon",t.icSearch)}}function Ge(t,e){if(1&t){const t=O.Xb();O.Wb(0,"mat-icon",86),O.ec("click",(function(){O.wc(t);const e=O.ic().index;return O.ic(2).categoriaForm.get("masivodet").controls[e].controls.producto.setValue("")})),O.Vb()}if(2&t){const t=O.ic(3);O.oc("icIcon",t.icClose)}}function Le(t,e){1&t&&(O.Wb(0,"mat-error"),O.Gc(1," Requerido! "),O.Vb())}function Se(t,e){1&t&&(O.Wb(0,"mat-error"),O.Gc(1," Requerido "),O.Vb())}function Re(t,e){if(1&t&&(O.Wb(0,"mat-error"),O.Gc(1),O.Vb()),2&t){const t=O.ic().index,e=O.ic(2);O.Cb(1),O.Ic(" M\xednimo ",e.categoriaForm.get("masivodet").controls[t].controls.cantidad.errors.min.min," ")}}function De(t,e){if(1&t&&(O.Wb(0,"mat-option",54),O.Gc(1),O.Vb()),2&t){const t=e.$implicit;O.oc("value",t.idimpuesto),O.Cb(1),O.Ic(" ",t.nombre," ")}}function Me(t,e){1&t&&(O.Wb(0,"mat-error"),O.Gc(1," Requerido! "),O.Vb())}function Ae(t,e){1&t&&(O.Wb(0,"mat-error"),O.Gc(1," Requerido! "),O.Vb())}function ke(t,e){1&t&&(O.Wb(0,"mat-error"),O.Gc(1," Requerido! "),O.Vb())}function _e(t,e){if(1&t&&(O.Wb(0,"div",87),O.Wb(1,"div",88),O.Wb(2,"button",89),O.ec("click",(function(){return(0,e.close)()})),O.Rb(3,"mat-icon",8),O.Vb(),O.Vb(),O.Wb(4,"div",12),O.Wb(5,"div",90),O.Rb(6,"mat-slide-toggle",91),O.Vb(),O.Wb(7,"mat-form-field",92),O.Wb(8,"mat-label"),O.Gc(9,"Impuesto a bolsa pl\xe1stica"),O.Vb(),O.Rb(10,"input",93),O.Vb(),O.Vb(),O.Wb(11,"mat-form-field",94),O.Wb(12,"mat-label"),O.Gc(13,"Descuento (Aplica al Sub total)"),O.Vb(),O.Rb(14,"input",95),O.Vb(),O.Wb(15,"mat-form-field",94),O.Wb(16,"mat-label"),O.Gc(17,"IGV de \xedtem"),O.Vb(),O.Rb(18,"input",96),O.Vb(),O.Vb()),2&t){const t=O.ic(3);O.Cb(3),O.oc("icIcon",t.icClose)}}function Te(t,e){if(1&t){const t=O.Xb();O.Wb(0,"div",58),O.Wb(1,"mat-form-field",59),O.Ec(2,we,2,1,"mat-label",0),O.Rb(3,"input",60),O.Wb(4,"mat-autocomplete",61,62),O.ec("optionSelected",(function(){O.wc(t);const o=e.$implicit;return O.ic(2).autocompletadoProductoSelected(o)})),O.Ec(6,We,2,0,"mat-option",63),O.Ec(7,Ee,2,1,"ng-container",0),O.Vb(),O.Ec(8,Fe,1,1,"mat-icon",64),O.Ec(9,Ge,1,1,"mat-icon",65),O.Ec(10,Le,2,0,"mat-error",0),O.Vb(),O.Wb(11,"mat-form-field",66),O.Rb(12,"input",67),O.Vb(),O.Wb(13,"mat-form-field",68),O.Rb(14,"input",69),O.Ec(15,Se,2,0,"mat-error",0),O.Ec(16,Re,2,1,"mat-error",0),O.Vb(),O.Wb(17,"mat-form-field",68),O.Wb(18,"mat-select",70),O.Ec(19,De,2,2,"mat-option",16),O.Vb(),O.Ec(20,Me,2,0,"mat-error",0),O.Vb(),O.Wb(21,"mat-form-field",68),O.Rb(22,"input",71),O.Ec(23,Ae,2,0,"mat-error",0),O.Vb(),O.Wb(24,"mat-form-field",68),O.Rb(25,"input",72),O.Vb(),O.Wb(26,"mat-form-field",68),O.Rb(27,"input",73),O.Ec(28,ke,2,0,"mat-error",0),O.Vb(),O.Wb(29,"div",74,75),O.Wb(31,"button",76),O.ec("click",(function(){O.wc(t);const o=e.index;return O.ic(2).deleteItem(o)})),O.Rb(32,"mat-icon",8),O.Vb(),O.Wb(33,"button",77),O.ec("click",(function(){O.wc(t);const o=e.$implicit,i=O.uc(36),a=O.uc(30);return O.ic(2).openAddList(o,i,a)})),O.Rb(34,"mat-icon",8),O.Vb(),O.Ec(35,_e,19,1,"ng-template",null,78,O.Fc),O.Vb(),O.Vb()}if(2&t){const t=e.$implicit,o=e.index,i=O.uc(5),a=O.ic(2);O.oc("formGroupName",o),O.Cb(2),O.oc("ngIf",t.get("producto").value),O.Cb(1),O.oc("matAutocomplete",i),O.Cb(1),O.oc("displayWith",a.displayProductoFn),O.Cb(2),O.oc("ngIf",t.get("datalistloading").value),O.Cb(1),O.oc("ngIf",!t.get("datalistloading").value),O.Cb(1),O.oc("ngIf",!a.categoriaForm.get("masivodet").controls[o].controls.producto.value),O.Cb(1),O.oc("ngIf",a.categoriaForm.get("masivodet").controls[o].controls.producto.value),O.Cb(1),O.oc("ngIf",a.categoriaForm.get("masivodet").controls[o].controls.producto.hasError("required")),O.Cb(5),O.oc("ngIf",a.categoriaForm.get("masivodet").controls[o].controls.cantidad.hasError("required")),O.Cb(1),O.oc("ngIf",a.categoriaForm.get("masivodet").controls[o].controls.cantidad.hasError("min")),O.Cb(3),O.oc("ngForOf",a.impuestos),O.Cb(1),O.oc("ngIf",a.categoriaForm.get("masivodet").controls[o].controls.idimpuesto.hasError("required")),O.Cb(3),O.oc("ngIf",a.categoriaForm.get("masivodet").controls[o].controls.preciounit.hasError("required")),O.Cb(5),O.oc("ngIf",a.categoriaForm.get("masivodet").controls[o].controls.total.hasError("required")),O.Cb(4),O.oc("icIcon",a.icDelete),O.Cb(2),O.oc("icIcon",a.icEdit)}}function Oe(t,e){if(1&t){const t=O.Xb();O.Wb(0,"div",97),O.Wb(1,"button",98),O.ec("click",(function(){return O.wc(t),O.ic(2).addItem()})),O.Rb(2,"mat-icon",8),O.Vb(),O.Vb()}if(2&t){const t=O.ic(2);O.Cb(2),O.oc("icIcon",t.icAdd)}}function Ne(t,e){if(1&t&&(O.Wb(0,"div",38),O.Wb(1,"div",39),O.Gc(2," Descuento total (-) S/ "),O.Vb(),O.Wb(3,"div",40),O.Gc(4),O.jc(5,"number"),O.Vb(),O.Vb()),2&t){const t=O.ic(2);O.Cb(4),O.Ic(" ",O.lc(5,1,t.categoriaForm.get("descuentototal").value,"1.2-2")," ")}}function je(t,e){if(1&t&&(O.Wb(0,"div",38),O.Wb(1,"div",39),O.Gc(2," Exonerada S/ "),O.Vb(),O.Wb(3,"div",40),O.Gc(4),O.jc(5,"number"),O.Vb(),O.Vb()),2&t){const t=O.ic(2);O.Cb(4),O.Ic(" ",O.lc(5,1,t.categoriaForm.get("exonerada").value,"1.2-2")," ")}}function ze(t,e){if(1&t&&(O.Wb(0,"div",38),O.Wb(1,"div",39),O.Gc(2," Inafecta S/ "),O.Vb(),O.Wb(3,"div",40),O.Gc(4),O.jc(5,"number"),O.Vb(),O.Vb()),2&t){const t=O.ic(2);O.Cb(4),O.Ic(" ",O.lc(5,1,t.categoriaForm.get("inafecta").value,"1.2-2")," ")}}function Pe(t,e){if(1&t&&(O.Wb(0,"div",38),O.Wb(1,"div",39),O.Gc(2," Gratuita S/ "),O.Vb(),O.Wb(3,"div",40),O.Gc(4),O.jc(5,"number"),O.Vb(),O.Vb()),2&t){const t=O.ic(2);O.Cb(4),O.Ic(" ",O.lc(5,1,t.categoriaForm.get("gratuita").value,"1.2-2")," ")}}function qe(t,e){if(1&t&&(O.Wb(0,"div",38),O.Wb(1,"div",39),O.Gc(2," ICBPER "),O.Vb(),O.Wb(3,"div",40),O.Gc(4),O.jc(5,"number"),O.Vb(),O.Vb()),2&t){const t=O.ic(2);O.Cb(4),O.Ic(" ",O.lc(5,1,t.categoriaForm.get("totalimpuestobolsa").value,"1.2-2")," ")}}function He(t,e){if(1&t){const t=O.Xb();O.Wb(0,"form",2),O.ec("ngSubmit",(function(){return O.wc(t),O.ic().save()})),O.Ec(1,he,6,1,"div",3),O.Wb(2,"div",4),O.Wb(3,"mat-toolbar",5),O.Wb(4,"h2",6),O.Gc(5,"Emitir comprobante"),O.Vb(),O.Wb(6,"button",7),O.ec("click",(function(){return O.wc(t),O.ic().modalGeneral()})),O.Rb(7,"mat-icon",8),O.Gc(8," GENERAL "),O.Vb(),O.Wb(9,"button",9),O.Rb(10,"mat-icon",10),O.Vb(),O.Vb(),O.Vb(),O.Wb(11,"mat-dialog-content",11),O.Wb(12,"div",12),O.Wb(13,"fieldset",13),O.Wb(14,"div",12),O.Wb(15,"mat-form-field",14),O.Wb(16,"mat-label"),O.Gc(17,"Local"),O.Vb(),O.Wb(18,"mat-select",15),O.Ec(19,ge,2,2,"mat-option",16),O.Vb(),O.Ec(20,ve,2,0,"mat-error",0),O.Vb(),O.Wb(21,"mat-form-field",14),O.Wb(22,"mat-label"),O.Gc(23,"Comprobante"),O.Vb(),O.Wb(24,"mat-select",17),O.Ec(25,xe,6,3,"mat-option",16),O.Vb(),O.Ec(26,Ve,2,0,"mat-error",0),O.Vb(),O.Vb(),O.Vb(),O.Wb(27,"fieldset",13),O.Wb(28,"div",12),O.Wb(29,"mat-form-field",18),O.Wb(30,"mat-label"),O.Gc(31,"Fecha emisi\xf3n"),O.Vb(),O.Rb(32,"input",19),O.Rb(33,"mat-datepicker-toggle",20),O.Rb(34,"mat-datepicker",null,21),O.Ec(36,ye,2,0,"mat-error",0),O.Vb(),O.Wb(37,"mat-form-field",22),O.Wb(38,"mat-label"),O.Gc(39,"Cantidad de comprobantes a emitir"),O.Vb(),O.Rb(40,"input",23,24),O.Ec(42,Ce,2,0,"mat-error",0),O.Vb(),O.Vb(),O.Vb(),O.Vb(),O.Wb(43,"fieldset",25),O.Wb(44,"div",26),O.Wb(45,"div",27),O.Wb(46,"div",28),O.Gc(47,"Producto - servicio"),O.Vb(),O.Wb(48,"div",29),O.Gc(49,"Detalle"),O.Vb(),O.Wb(50,"div",30),O.Gc(51,"Cantidad"),O.Vb(),O.Wb(52,"div",30),O.Gc(53,"Impuesto"),O.Vb(),O.Wb(54,"div",30),O.Gc(55,"P.Unit."),O.Vb(),O.Wb(56,"div",30),O.Gc(57,"Sub total"),O.Vb(),O.Wb(58,"div",30),O.Gc(59,"Total"),O.Vb(),O.Wb(60,"div",31),O.Wb(61,"button",32),O.ec("click",(function(){return O.wc(t),O.ic().addItem()})),O.Rb(62,"mat-icon",8),O.Vb(),O.Vb(),O.Vb(),O.Ec(63,Te,37,17,"div",33),O.Ec(64,Oe,3,1,"div",34),O.Vb(),O.Wb(65,"div",35),O.Rb(66,"div",36),O.Wb(67,"div",37),O.Wb(68,"div",38),O.Wb(69,"div",39),O.Gc(70," Descuento global "),O.Wb(71,"strong"),O.Gc(72,"%"),O.Vb(),O.Vb(),O.Wb(73,"div",40),O.Rb(74,"input",41),O.Vb(),O.Vb(),O.Wb(75,"div",42),O.Wb(76,"div",39),O.Gc(77," Otros cargos S/ "),O.Vb(),O.Wb(78,"div",40),O.Rb(79,"input",43),O.Vb(),O.Vb(),O.Ec(80,Ne,6,4,"div",44),O.Ec(81,je,6,4,"div",44),O.Ec(82,ze,6,4,"div",44),O.Ec(83,Pe,6,4,"div",44),O.Wb(84,"div",38),O.Wb(85,"div",39),O.Gc(86," Gravada S/ "),O.Vb(),O.Wb(87,"div",40),O.Gc(88),O.jc(89,"number"),O.Vb(),O.Vb(),O.Wb(90,"div",38),O.Wb(91,"div",39),O.Gc(92," IGV S/ "),O.Vb(),O.Wb(93,"div",40),O.Gc(94),O.jc(95,"number"),O.Vb(),O.Vb(),O.Ec(96,qe,6,4,"div",44),O.Wb(97,"div",38),O.Wb(98,"div",45),O.Wb(99,"strong"),O.Gc(100,"Total S/"),O.Vb(),O.Vb(),O.Wb(101,"div",40),O.Wb(102,"strong"),O.Gc(103),O.jc(104,"number"),O.Vb(),O.Vb(),O.Vb(),O.Vb(),O.Vb(),O.Vb(),O.Vb(),O.Wb(105,"mat-dialog-actions",46),O.Wb(106,"button",47),O.Gc(107,"CERRAR"),O.Vb(),O.Wb(108,"button",48),O.Gc(109,"EMITIR"),O.Vb(),O.Vb(),O.Vb()}if(2&t){const t=O.uc(35),e=O.ic();O.oc("formGroup",e.categoriaForm),O.Cb(1),O.oc("ngIf",e.submitted),O.Cb(6),O.oc("icIcon",e.icSettings),O.Cb(3),O.oc("icIcon",e.icClose),O.Cb(8),O.oc("formControl",e.sede),O.Cb(1),O.oc("ngForOf",e.sedes),O.Cb(1),O.oc("ngIf",e.sede.hasError("required")),O.Cb(4),O.oc("formControl",e.comprobante),O.Cb(1),O.oc("ngForOf",e.comprobantes),O.Cb(1),O.oc("ngIf",e.comprobante.hasError("required")),O.Cb(6),O.oc("matDatepicker",t),O.Cb(1),O.oc("for",t),O.Cb(3),O.oc("ngIf",e.categoriaForm.get("fechaemision").hasError("required")),O.Cb(6),O.oc("ngIf",e.categoriaForm.get("cantidad").hasError("required")),O.Cb(20),O.oc("icIcon",e.icAdd),O.Cb(1),O.oc("ngForOf",e.categoriaForm.get("masivodet").controls),O.Cb(1),O.oc("ngIf",e.categoriaForm.get("masivodet").hasError("required")),O.Cb(16),O.oc("ngIf",e.categoriaForm.get("descuentototal").value>0),O.Cb(1),O.oc("ngIf",e.leyenda.exonerada),O.Cb(1),O.oc("ngIf",e.leyenda.inafecta),O.Cb(1),O.oc("ngIf",e.leyenda.gratuita),O.Cb(5),O.Ic(" ",O.lc(89,26,e.categoriaForm.get("gravada").value,"1.2-2")," "),O.Cb(6),O.Ic(" ",O.lc(95,29,e.categoriaForm.get("valorimpuesto").value,"1.2-2")," "),O.Cb(2),O.oc("ngIf",e.leyenda.icpber),O.Cb(7),O.Hc(O.lc(104,32,e.categoriaForm.get("total").value,"1.2-2")),O.Cb(5),O.oc("disabled",e.categoriaForm.invalid||e.submitted)}}let Qe=(()=>{class t{constructor(t,e,o,i,a,c,s,d,b,f,p){this._data=t,this.matDialogRef=e,this.snackBar=o,this._matDialog=i,this._masivoService=a,this._entidadService=c,this._documentoserieService=s,this._productoService=d,this._datainicial=b,this._utils=f,this.popover=p,this.submitted=!1,this.loading=!1,this.loadMasivo=!1,this.countdown={leftTime:0},this.pipeDate=new Q.e("es-Pe"),this.sedes=[],this.sede=new ut.e(null,[ut.v.required]),this.comprobante=new ut.e(null,[ut.v.required]),this.comprobantes=[],this.cliente=new ut.e(null,[ut.v.required]),this.isLoadingSearch=!1,this.searchResult={data:null,to:null,total:null},this.clienteDefault={idcliente:356,clientenombre:"VARIOS",clientedoc:5,clientenumerodoc:"-",clientedireccion:null},this.tiponc=this._datainicial.tiponc,this.monedas=this._datainicial.monedas,this.impuestos=this._datainicial.impuestos,this.icAdd=r.a,this.icEdit=l.a,this.icClose=m.a,this.icSearch=n.a,this.icDelete=u.a,this.icSettings=mt.a,this.icCallMade=k.a,this.leyenda={exonerada:!1,inafecta:!1,gratuita:!1,icpber:!1},this.sedes=this._entidadService.sedes,this.sede.setValue(this._data.sedeDefault)}ngOnInit(){this.categoriaForm=this.createForm(),this.categoriaForm.get("masivodet").valueChanges.subscribe(t=>{let e=!1,o=!1,i=!1,a=!1;t.forEach((t,n)=>{switch(t.idimpuesto){case 8:e=!0;break;case 9:o=!0;break;case 2:i=!0}t.bolsa&&(a=!0)}),this.leyenda={exonerada:e,inafecta:o,gratuita:i,icpber:a}}),this.sede.valueChanges.subscribe(t=>{this.categoriaForm.get("idsede").setValue(t||null),this.comprobante.setValue(null),this.indexDocumentoseries()}),this.comprobante.valueChanges.subscribe(t=>{this.categoriaForm.get("iddocumentofiscal").setValue(t?t.iddocumentofiscal:null),this.categoriaForm.get("serie").setValue(t?t.serie:null)}),this.categoriaForm.controls.cargo.valueChanges.subscribe(t=>{t=this._utils.redondearValor(t,2),this.categoriaForm.get("cargo").setValue(t,{emitEvent:!1}),this.calcularTotales()}),this.categoriaForm.controls.descuentoporcentaje.valueChanges.subscribe(t=>{t=this._utils.redondearValor(t,2),this.categoriaForm.get("descuentoporcentaje").setValue(t,{emitEvent:!1}),this.calcularTotales()}),this.indexDocumentoseries(),this.addItem(),this.addItem(),this.addItem(),setTimeout(()=>{this.cantidadElement.nativeElement.focus()},0)}createForm(){return new ut.h({id:new ut.e(null),idsede:new ut.e(this._data.sedeDefault),iddocumentofiscal:new ut.e(null,[ut.v.required]),serie:new ut.e(null,[ut.v.required]),idcliente:new ut.e(this.clienteDefault.idcliente),fechaemision:new ut.e(new Date,[ut.v.required]),idestadodocumento:new ut.e(27),cantidad:new ut.e(null,[ut.v.min(1),ut.v.max(500)]),exonerada:new ut.e(null),inafecta:new ut.e(null),gratuita:new ut.e(null),gravada:new ut.e(null,[ut.v.required]),descuentoporcentaje:new ut.e(null,[ut.v.min(0)]),descuentoglobal:new ut.e(null),descuentoitem:new ut.e(null),descuentototal:new ut.e(null),valorimpuesto:new ut.e(null,[ut.v.required]),cargo:new ut.e(null,[ut.v.min(0)]),totalimpuestobolsa:new ut.e(null),total:new ut.e(null,[ut.v.required]),clientenombre:new ut.e(this.clienteDefault.clientenombre),clientedoc:new ut.e(this.clienteDefault.clientedoc),clientenumerodoc:new ut.e(this.clienteDefault.clientenumerodoc),clientedireccion:new ut.e(this.clienteDefault.clientedireccion),operacion:new ut.e(1),moneda:new ut.e("PEN"),tipocambio:new ut.e(null),fechavencimiento:new ut.e(null),detraccion:new ut.e(!1),selvaproducto:new ut.e(!1),selvaservicio:new ut.e(!1),condicionpago:new ut.e(null),observacion:new ut.e(null),pdfformato:new ut.e("TICKET"),masivodet:new ut.c([],[ut.v.required])})}indexDocumentoseries(){const t={idsede:this.sede.value,conRecurso:"documentofiscal",orderName:"iddocumentofiscal",orderSort:"asc"};this.comprobantes=[],this._documentoserieService.index(t).subscribe(t=>{t.data.forEach(t=>{1!==t.iddocumentofiscal&&2!==t.iddocumentofiscal||this.comprobantes.push({iddocumentofiscal:t.iddocumentofiscal,documentofiscal:{nombre:t.documentofiscal.nombre},serie:t.serie,numero:t.numero})});let e=null;this.comprobantes.forEach(t=>{2===t.iddocumentofiscal&&(e=t)}),!e&&this.comprobantes.length>0&&(e=this.comprobantes[0]),e&&this.comprobante.setValue(e)})}get ventadet(){return this.categoriaForm.get("masivodet")}autocompletadoProductoSelected(t){const e=t.value,o=e.cantidad||1,i=this._utils.calculoLinea(e.producto.idimpuesto||1,e.producto.precio||0,o,e.descuento||null);this.setImpuesto(t,i),this.setImpuestoBolsa(t,o,e.bolsa)}addItem(t){const e=new ut.h({producto:new ut.e(t?t.producto:null),descripcion:new ut.e(t?t.descripcion:null),cantidad:new ut.e(t?t.cantidad:null),valorunit:new ut.e(t?t.valorunit:null),descuento:new ut.e(t?t.descuento:null),valorventa:new ut.e({value:t?t.valorventa:null,disabled:!0}),impuestobolsa:new ut.e({value:t?t.impuestobolsa:null,disabled:!0}),idimpuesto:new ut.e(t?t.idimpuesto:1),montototalimpuestos:new ut.e({value:t?t.montototalimpuestos:null,disabled:!0}),preciounit:new ut.e(t?t.preciounit:null),total:new ut.e(t?t.total:null),bolsa:new ut.e(!!t&&t.bolsa),datalist:new ut.c([]),datalistloading:new ut.e(!1)});e.controls.cantidad.valueChanges.subscribe(o=>{(t=e.value).cantidad=o;const i=this._utils.calculoLinea(t.idimpuesto,t.preciounit,t.cantidad,t.descuento||null);this.setImpuesto(e,i),this.setImpuestoBolsa(e,t.cantidad,t.bolsa)}),e.controls.idimpuesto.valueChanges.subscribe(o=>{(t=e.value).idimpuesto=o;const i=this._utils.calculoLinea(t.idimpuesto,t.preciounit,t.cantidad,t.descuento||null);this.setImpuesto(e,i)}),e.controls.preciounit.valueChanges.subscribe(o=>{(t=e.value).preciounit=o;const i=this._utils.calculoLinea(t.idimpuesto,t.preciounit,t.cantidad,t.descuento||null);this.setImpuesto(e,i)}),e.controls.total.valueChanges.subscribe(o=>{(t=e.value).total=o;const i=this._utils.calculoLineaT(t.idimpuesto,t.total,t.cantidad,t.descuento||null);this.setImpuesto(e,i)}),e.controls.descuento.valueChanges.subscribe(o=>{(t=e.value).descuento=o;const i=this._utils.calculoLinea(t.idimpuesto,t.preciounit,t.cantidad,t.descuento||null);this.setImpuesto(e,i)}),e.controls.bolsa.valueChanges.subscribe(o=>{this.setImpuestoBolsa(e,(t=e.value).cantidad,o)}),e.controls.producto.valueChanges.pipe(Object(ft.a)(300),Object(pt.a)(t=>{if(t&&"string"==typeof t){e.controls.datalistloading.setValue(!0);const o={page:1,pageSize:10,orderName:"nombre",orderSort:"asc"};return o.likeNombre=t,this._productoService.index(o)}return e.controls.datalistloading.setValue(!1),[]})).subscribe(t=>{for(e.controls.datalistloading.setValue(!1);0!==e.controls.datalist.length;)e.controls.datalist.removeAt(0);t.data.forEach(t=>{e.controls.datalist.push(new ut.e({idproducto:t.idproducto,codigo:t.codigo,nombre:t.nombre,precio:t.valorventa,unidadmedida:t.unidadmedida,codigosunat:t.codigosunat,idimpuesto:t.idimpuesto,stock:t.stock}))})}),this.ventadet.push(e)}setImpuesto(t,e){t.get("cantidad").setValue(e.cantidad,{emitEvent:!1}),t.get("idimpuesto").setValue(e.idimpuesto,{emitEvent:!1}),t.get("preciounit").setValue(e.preciounit,{emitEvent:!1}),t.get("valorunit").setValue(e.valorunit,{emitEvent:!1}),t.get("descuento").setValue(e.descuento,{emitEvent:!1}),t.get("valorventa").setValue(e.subtotal,{emitEvent:!1}),t.get("montototalimpuestos").setValue(e.montototalimpuestos,{emitEvent:!1}),t.get("total").setValue(e.total,{emitEvent:!1}),this.calcularTotales()}setImpuestoBolsa(t,e,o){if(o){const o=this._utils.redondearValor(.2*(e=e||0),3);t.get("impuestobolsa").setValue(o,{emitEvent:!1})}else t.get("impuestobolsa").setValue(null,{emitEvent:!1});this.calcularTotales()}deleteItem(t){this.ventadet.removeAt(t),this.calcularTotales()}displayProductoFn(t){return t?t.nombre:void 0}modalGeneral(){this._matDialog.open(ee,{panelClass:"masivogeneral-form-dialog",data:{venta:this.categoriaForm.getRawValue()},disableClose:!0}).afterClosed().subscribe(t=>{t&&(console.log("response",t),this.categoriaForm.get("fechaemision").setValue(t.fechaemision),this.categoriaForm.get("fechavencimiento").setValue(t.fechavencimiento),this.categoriaForm.get("moneda").setValue(t.moneda),this.categoriaForm.get("tipocambio").setValue(t.tipocambio),this.categoriaForm.get("operacion").setValue(t.operacion),this.categoriaForm.get("pdfformato").setValue(t.pdfformato),this.categoriaForm.get("condicionpago").setValue(t.condicionpago),this.categoriaForm.get("observacion").setValue(t.observacion),this.categoriaForm.get("detraccion").setValue(t.detraccion),this.categoriaForm.get("selvaproducto").setValue(t.selvaproducto),this.categoriaForm.get("selvaservicio").setValue(t.selvaservicio),this.categoriaForm.get("idcliente").setValue(t.idcliente),this.categoriaForm.get("clientenombre").setValue(t.clientenombre),this.categoriaForm.get("clientedoc").setValue(t.clientedoc),this.categoriaForm.get("clientenumerodoc").setValue(t.clientenumerodoc),this.categoriaForm.get("clientedireccion").setValue(t.clientedireccion))})}calcularTotales(){console.log("calcularTotales()");let t=0,e=0,o=0,i=0,a=0,n=0,c=0,r=0,s=0,l=0;const d=this.categoriaForm.get("cargo").value||0,u=this.categoriaForm.get("descuentoporcentaje").value;if(this.ventadet.getRawValue().forEach(n=>{null!==n.total&&(a+=n.descuento,r+=n.impuestobolsa||0,1===n.idimpuesto&&(t+=n.valorventa,s+=n.montototalimpuestos),8===n.idimpuesto&&(e+=n.total),9===n.idimpuesto&&(o+=n.total),2===n.idimpuesto&&(i+=n.total))}),u>0){let i,a;if(a="porcentaje","porcentaje"===a&&(i=u/100,console.log("valorDscto",i)),"valor"===a){let a=this._utils.redondearValor(t+s+e+o,2);a=0===a?1:a,i=u/a,console.log("valorDscto",i)}c=(t+e+o)*i,c=this._utils.redondearValor(c,2),e-=e*i,e=this._utils.redondearValor(e,2),o-=o*i,o=this._utils.redondearValor(o,2);let n=t+s;n-=n*i,n=this._utils.redondearValor(n,2);const r=n/1.18,l=.18*r;t=this._utils.redondearValor(r,2),s=this._utils.redondearValor(l,2)}n=this._utils.redondearValor(a+c,2),l=this._utils.redondearValor(t+s+e+o+d+r,2),console.log(t,s,e,o,d,r),console.log("total",l),this.categoriaForm.get("descuentoglobal").setValue(c),this.categoriaForm.get("exonerada").setValue(e),this.categoriaForm.get("inafecta").setValue(o),this.categoriaForm.get("gratuita").setValue(i),this.categoriaForm.get("gravada").setValue(t),this.categoriaForm.get("descuentoitem").setValue(a),this.categoriaForm.get("descuentototal").setValue(n),this.categoriaForm.get("valorimpuesto").setValue(s),this.categoriaForm.get("totalimpuestobolsa").setValue(r),this.categoriaForm.get("total").setValue(l)}save(){let t;if(t=this.categoriaForm.getRawValue(),!t.idcliente)return void this.snackBar.open("Ingrese cliente","Cerrar",{panelClass:["error-dialog"]});let e=!0;if(t.masivodet.forEach(t=>{t.producto&&t.producto.idproducto&&(e=!1)}),e)return void this.snackBar.open("Ingrese producto para la venta","Cerrar",{panelClass:["error-dialog"]});const o=[];t.masivodet.forEach(t=>{t.producto&&t.producto.idproducto&&o.push({cantidad:t.cantidad,codigo:t.producto.codigo,codigosunat:t.producto.codigosunat,descripcion:t.descripcion,descuento:t.descuento,idimpuesto:t.idimpuesto,idproducto:t.producto.idproducto,impuestobolsa:t.impuestobolsa,montototalimpuestos:t.montototalimpuestos,nombre:t.producto.nombre,preciounit:t.preciounit,total:t.total,unidadmedida:t.producto.unidadmedida,valorunit:t.valorunit,valorventa:t.valorventa})}),t.masivodet=o,t.fechaemision=this.pipeDate.transform(t.fechaemision,"yyyy-MM-dd"),t.fechavencimiento=t.fechavencimiento?this.pipeDate.transform(t.fechavencimiento,"yyyy-MM-dd"):null,t.detraccion=t.detraccion?"1":"0",t.selvaproducto=t.selvaproducto?"1":"0",t.selvaservicio=t.selvaservicio?"1":"0",this.submitted=!0;const i=this._utils.redondearValor(.3*t.cantidad,0);this.countdown={leftTime:i},console.log("segundos",i),this._masivoService.create(t).subscribe(t=>{this.snackBar.open("Ventas por lote emitidos.","Cerrar"),this.matDialogRef.close(t.data)},t=>{const e=this._utils.convertError(t);this.submitted=!1,this.snackBar.open(e,"Cerrar",{panelClass:["error-dialog"]})})}openAddList(t,e,o){this.popover.open({content:e,origin:o,position:[{originX:"start",originY:"bottom",overlayX:"center",overlayY:"top"},{originX:"center",originY:"bottom",overlayX:"center",overlayY:"top"}]})}}return t.\u0275fac=function(e){return new(e||t)(O.Qb(T.a),O.Qb(T.g),O.Qb(oe.b),O.Qb(T.b),O.Qb(H),O.Qb(Vt.a),O.Qb(ie.a),O.Qb(ae.a),O.Qb(yt.a),O.Qb(q.a),O.Qb(ne.a))},t.\u0275cmp=O.Kb({type:t,selectors:[["vex-masivo-form"]],viewQuery:function(t,e){var o;1&t&&O.Nc(fe,!0),2&t&&O.tc(o=O.fc())&&(e.cantidadElement=o.first)},decls:2,vars:2,consts:[[4,"ngIf"],["class","loading-container",3,"formGroup","ngSubmit",4,"ngIf"],[1,"loading-container",3,"formGroup","ngSubmit"],["class","loading-shade",4,"ngIf"],["mat-dialog-title","","fxLayout","column"],["color","primary","fxLayout","row","fxLayoutAlign","start center"],["fxFlex","auto",1,"headline","m-0"],["mat-button","","type","button",3,"click"],["size","18px",3,"icIcon"],["mat-dialog-close","","mat-icon-button","","type","button",1,"text-secondary"],[3,"icIcon"],["fxLayout","column"],["fxLayout","row","fxLayout.lt-sm","column","fxLayoutGap","16px","fxLayoutGap.lt-sm","0"],["fxLayout","column","fxFlex","50"],["appearance","standard","floatLabel","always","fxFlex","auto"],[3,"formControl"],[3,"value",4,"ngFor","ngForOf"],["required","",3,"formControl"],["appearance","standard","floatLabel","always","fxFlex","50"],["matInput","","name","start","formControlName","fechaemision",3,"matDatepicker"],["matSuffix","",3,"for"],["fechaDatePicker",""],["appearance","standard","floatLabel","always","fxFlex","50","hintLabel","M\xe1ximo 500 comprobantes"],["matInput","","type","number","formControlName","cantidad","maxlength","3","required",""],["cantidad",""],["fxLayout","column",1,"mt-4"],["fxLayout","column","formArrayName","masivodet"],["fxLayout","row","fxLayoutAlign","start center","fxLayout.lt-sm","column","fxLayoutAlign.lt-sm","start stretch","fxLayoutGap","8px","fxLayoutGap.lt-sm","0"],["fxFlex","43"],["fxFlex","12"],["fxFlex","7"],["fxFlex","10","fxLayout","row","fxLayoutAlign","center center"],["type","button","mat-icon-button","","matTooltip","Agregar linea",1,"w-8","h-8","leading-none","flex","items-center","justify-center","ml-1","hover:bg-hover",3,"click"],["fxLayout","row","fxLayoutAlign","start center","fxLayout.lt-sm","column","fxLayoutAlign.lt-sm","start stretch","fxLayoutGap","8px","fxLayoutGap.lt-sm","0",3,"formGroupName",4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","center center","class","mt-4",4,"ngIf"],["fxLayout","row","fxLayout.lt-sm","column","fxLayoutGap","16px","fxLayoutGap.lt-sm","0",1,"mt-4"],["fxLayout","column","fxLayoutAlign","space-between","fxFlex","50"],["fxFlex","50"],["fxLayout","column","fxLayout.gt-xs","row"],["fxFlex","70",1,"text-right"],["fxFlex","30",1,"text-right"],["matInput","","type","number","formControlName","descuentoporcentaje",2,"border-bottom","1px solid #CCC","width","80px"],["fxLayout","column","fxLayout.gt-xs","row",1,"mt-1"],["matInput","","type","number","formControlName","cargo",2,"border-bottom","1px solid #CCC","width","80px"],["fxLayout","column","fxLayout.gt-xs","row",4,"ngIf"],["fxFlex","70",1,"text-right","font-weight-600"],["align","end"],["mat-button","","mat-dialog-close","","type","button"],["mat-raised-button","","type","submit","color","primary",3,"disabled"],[1,"loading-shade"],["fxLayout","column",1,"p-4",2,"background","#FFFFFF"],["fxLayout","row","fxLayoutAlign","center center"],[1,"text-center","pt-4"],[3,"config"],[3,"value"],["fxLayout","row","fxLayoutAlign","space-between center"],["fxFlex","70"],["fxFlex","30"],["fxLayout","row","fxLayoutAlign","start center","fxLayout.lt-sm","column","fxLayoutAlign.lt-sm","start stretch","fxLayoutGap","8px","fxLayoutGap.lt-sm","0",3,"formGroupName"],["appearance","standard","floatLabel","always","fxFlex","43",1,"vex-flex-form-field"],["matInput","","formControlName","producto","placeholder","Buscar",3,"matAutocomplete"],["autoActiveFirstOption","",3,"displayWith","optionSelected"],["auto","matAutocomplete"],["class","p-3","value","",4,"ngIf"],["matSuffix","",3,"icIcon",4,"ngIf"],["matSuffix","","class","cursor-pointer",3,"icIcon","click",4,"ngIf"],["appearance","standard","floatLabel","always","fxFlex","12",1,"vex-flex-form-field"],["matInput","","formControlName","descripcion"],["appearance","standard","floatLabel","always","fxFlex","7",1,"vex-flex-form-field"],["matInput","","type","number","formControlName","cantidad"],["formControlName","idimpuesto"],["matInput","","type","number","formControlName","preciounit"],["matInput","","type","number","formControlName","valorventa"],["matInput","","type","number","formControlName","total",1,"text-right"],["fxLayout","row","fxLayoutAlign","center center","fxFlex","10"],["addListOriginRef",""],["type","button","mat-icon-button","","matTooltip","Eliminar",1,"w-8","h-8","leading-none","flex","items-center","justify-center","hover:bg-hover",3,"click"],["type","button","mat-icon-button","","matTooltip","Editar",1,"w-8","h-8","leading-none","flex","items-center","justify-center","ml-1","hover:bg-hover",3,"click"],["addListTemplate",""],["value","",1,"p-3"],["diameter","25"],["fxLayout","column","fxLayoutAlign","center start"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","8px"],[1,"text-secondary","inline-block"],[1,"text-secondary"],["matSuffix","",3,"icIcon"],["matSuffix","",1,"cursor-pointer",3,"icIcon","click"],["fxLayout","column",1,"card","px-4","pt-3","pb-2"],["fxLayout","row","fxLayoutAlign","end center"],["mat-icon-button","","type","button",1,"text-secondary","w-8","h-8","leading-none",3,"click"],["fxFlex","auto","fxLayout","row","fxLayoutAlign","center start"],["formControlName","bolsa","labelPosition","after"],["appearance","standard","floatLabel","always","fxFlex","80"],["matInput","","type","number","formControlName","impuestobolsa"],["appearance","standard","floatLabel","always"],["matInput","","type","number","formControlName","descuento"],["matInput","","type","number","formControlName","montototalimpuestos"],["fxLayout","row","fxLayoutAlign","center center",1,"mt-4"],["mat-stroked-button","","matTooltip","Agregar linea",1,"w-full",3,"click"]],template:function(t,e){1&t&&(O.Ec(0,pe,1,0,"vex-loading",0),O.Ec(1,He,110,35,"form",1)),2&t&&(O.oc("ngIf",e.loading),O.Cb(1),O.oc("ngIf",!e.loading))},directives:[Q.p,U.a,ut.w,ut.q,ut.i,T.h,X.c,$.a,X.b,X.a,B.b,J.a,Y.a,T.d,T.e,X.d,wt.d,wt.h,Et.a,ut.p,ut.f,Q.o,ut.u,Wt.b,ut.b,It.b,ut.g,It.d,wt.j,It.a,ut.s,ut.l,ut.d,K.a,T.c,St.b,be,Lt.n,wt.c,ut.j,Ft.c,Ft.a,Gt.a],pipes:[Q.f],styles:["@media (min-width:960px){.masivo-form-dialog{width:900px}}.masivo-form-dialog .mat-dialog-container{padding:0;margin:0}.masivo-form-dialog .mat-dialog-content{padding:0 16px;margin:0}.masivo-form-dialog .mat-dialog-actions{padding:16px 24px;margin:0}.masivo-form-dialog fieldset{border:1px solid #ccc;border-radius:8px;padding:8px}.masivo-form-dialog fieldset legend{font-weight:500;padding:0 8px}.masivo-form-dialog .loading-container{position:relative}.masivo-form-dialog .loading-shade{position:absolute;top:0;left:0;bottom:0;right:0;background:rgba(0,0,0,.5);z-index:1;display:flex;align-items:center;justify-content:center}.mat-autocomplete-panel .mat-option{line-height:18px;padding:6px 8px}.mat-autocomplete-panel .bordeblue{border:1px solid #00f!important}.mat-autocomplete-panel .bordeblack{border:1px solid #000!important}"],encapsulation:2}),t})();var Ue=o("6p83"),Xe=o("+0xr"),$e=o("ZuBe"),Be=o("uwSD"),Ke=o("C0s9"),Je=o("Dh3D"),Ye=o("M9IT"),Ze=o("bv9b");const to=["pagMasivo"],eo=["sortMasivo"];function oo(t,e){if(1&t&&(O.Wb(0,"mat-option",47),O.Gc(1),O.Vb()),2&t){const t=e.$implicit;O.oc("value",t.idsede),O.Cb(1),O.Ic(" ",t.nombre," ")}}function io(t,e){1&t&&(O.Wb(0,"div",48),O.Rb(1,"mat-spinner"),O.Vb())}function ao(t,e){1&t&&(O.Wb(0,"th",49),O.Gc(1,"LOCAL"),O.Vb())}function no(t,e){if(1&t&&(O.Wb(0,"td",50),O.Wb(1,"div"),O.Gc(2),O.Vb(),O.Wb(3,"small"),O.Gc(4),O.jc(5,"date"),O.Vb(),O.Vb()),2&t){const t=e.$implicit;O.Cb(2),O.Hc(t.sede.nombre),O.Cb(2),O.Hc(O.lc(5,2,t.fechaemision,"EEEE, d MMMM"))}}function co(t,e){1&t&&(O.Wb(0,"th",49),O.Gc(1,"F.EMISI\xd3N"),O.Vb())}function ro(t,e){if(1&t&&(O.Wb(0,"td",50),O.Gc(1),O.jc(2,"date"),O.Vb()),2&t){const t=e.$implicit;O.Cb(1),O.Ic(" ",O.lc(2,1,t.fechaemision,"dd/MM/y")," ")}}function so(t,e){1&t&&(O.Wb(0,"th",49),O.Gc(1,"COMPROBANTE"),O.Vb())}function lo(t,e){if(1&t&&(O.Wb(0,"td",50),O.Gc(1),O.Vb()),2&t){const t=e.$implicit;O.Cb(1),O.Ic(" ",t.docnegocio.nombre,"")}}function uo(t,e){if(1&t&&(O.Wb(0,"td",50),O.Gc(1),O.Vb()),2&t){const t=e.$implicit;O.Cb(1),O.Ic(" ",t.serie,"")}}function bo(t,e){1&t&&(O.Wb(0,"th",49),O.Gc(1,"SERIE"),O.Vb())}function mo(t,e){if(1&t&&(O.Wb(0,"td",50),O.Gc(1),O.Vb()),2&t){const t=e.$implicit;O.Cb(1),O.Ic(" ",t.serie,"")}}function fo(t,e){1&t&&(O.Wb(0,"th",49),O.Gc(1,"N\xdaMERO"),O.Vb())}function po(t,e){if(1&t&&(O.Wb(0,"td",51),O.Gc(1),O.Wb(2,"small"),O.Gc(3,"al"),O.Vb(),O.Gc(4),O.Vb()),2&t){const t=e.$implicit;O.Cb(1),O.Ic(" ",t.numerodel," "),O.Cb(3),O.Ic(" ",t.numeroal,"")}}function ho(t,e){1&t&&(O.Wb(0,"th",49),O.Gc(1,"AL"),O.Vb())}function go(t,e){if(1&t&&(O.Wb(0,"td",50),O.Gc(1),O.Vb()),2&t){const t=e.$implicit;O.Cb(1),O.Ic(" ",t.numeroal,"")}}function vo(t,e){1&t&&(O.Wb(0,"th",49),O.Gc(1,"PROGRESO"),O.Vb())}function xo(t,e){if(1&t&&(O.Wb(0,"td",50),O.Rb(1,"mat-progress-bar",52),O.Gc(2),O.Vb()),2&t){const t=e.$implicit;O.Cb(1),O.oc("mode","determinate")("value",t.progressbar),O.Cb(1),O.Jc(" ",t.progreso," de ",t.cantidad," ")}}function Vo(t,e){1&t&&(O.Wb(0,"th",53),O.Gc(1,"DETALLE"),O.Vb())}function yo(t,e){if(1&t&&(O.Wb(0,"tr"),O.Wb(1,"td",56),O.Gc(2),O.jc(3,"number"),O.Vb(),O.Wb(4,"td",57),O.Gc(5),O.Vb(),O.Wb(6,"td",58),O.Gc(7),O.Vb(),O.Vb()),2&t){const t=e.$implicit;O.Cb(2),O.Hc(O.lc(3,4,t.cantidad,"1.0-0")),O.Cb(3),O.Jc("",t.nombre," ",t.descripcion,""),O.Cb(2),O.Ic("S/ ",t.total,"")}}function Co(t,e){if(1&t&&(O.Wb(0,"td"),O.Wb(1,"fieldset"),O.Wb(2,"table",54),O.Wb(3,"tbody"),O.Ec(4,yo,8,7,"tr",55),O.Vb(),O.Vb(),O.Vb(),O.Vb()),2&t){const t=e.$implicit;O.Cb(4),O.oc("ngForOf",t.masivodet)}}function wo(t,e){1&t&&(O.Wb(0,"th",49),O.Gc(1,"CANTIDAD"),O.Vb())}function Wo(t,e){if(1&t&&(O.Wb(0,"td",51),O.Gc(1),O.Vb()),2&t){const t=e.$implicit;O.Cb(1),O.Ic(" ",t.cantidad," ")}}function Io(t,e){1&t&&O.Rb(0,"th",49)}function Eo(t,e){if(1&t){const t=O.Xb();O.Wb(0,"div",61),O.Wb(1,"button",62),O.ec("click",(function(e){O.wc(t);const o=O.ic().$implicit,i=O.ic();return e.stopPropagation(),i.printPdf(o.pdf)})),O.Rb(2,"mat-icon",63),O.Vb(),O.Wb(3,"button",64),O.ec("click",(function(e){O.wc(t);const o=O.ic().$implicit,i=O.ic();return e.stopPropagation(),i.printPdf(o.pdf)})),O.Rb(4,"mat-icon",63),O.Vb(),O.Vb()}if(2&t){const t=O.ic(2);O.Cb(2),O.oc("icIcon",t.icCloudDownload),O.Cb(2),O.oc("icIcon",t.icPrint)}}function Fo(t,e){1&t&&(O.Wb(0,"div",61),O.Wb(1,"p",65),O.Gc(2,"ANULADO"),O.Vb(),O.Vb())}function Go(t,e){if(1&t&&(O.Wb(0,"td",59),O.Ec(1,Eo,5,2,"div",60),O.Ec(2,Fo,3,0,"div",60),O.Vb()),2&t){const t=e.$implicit;O.Cb(1),O.oc("ngIf",27===t.idestadodocumento),O.Cb(1),O.oc("ngIf",28===t.idestadodocumento)}}function Lo(t,e){1&t&&(O.Wb(0,"mat-footer-cell"),O.Gc(1," No hay registros. "),O.Vb())}function So(t,e){1&t&&O.Rb(0,"tr",66)}function Ro(t,e){if(1&t){const t=O.Xb();O.Wb(0,"tr",67),O.ec("click",(function(){O.wc(t);const o=e.$implicit;return O.ic().showMasivo(o)})),O.Vb()}}const Do=function(t){return{hide:t}};function Mo(t,e){if(1&t&&O.Rb(0,"tr",68),2&t){const t=O.ic();O.oc("ngClass",O.qc(1,Do,t.rLengthMasivo>0||t.loadMasivo))}}const Ao=function(){return["empty"]};let ko=(()=>{class t{constructor(t,e,o,i,a){this._matDialog=t,this._masivoService=e,this._entidadService=o,this._utils=i,this.snackBar=a,this.dcMasivo=["acciones","sede","fechaemision","iddocumentofiscal","serie","cantidad","detalle"],this.dsMasivo=new Xe.o,this.loadMasivo=!0,this.rLengthMasivo=0,this.pSizeMasivo=50,this.pSizeOptMasivo=[10,20,50],this.pipeDate=new Q.e("es-Pe"),this.sedes=[],this.sede=new ut.e,this.fechaemisionFrom=new ut.e,this.fechaemisionTo=new ut.e,this.icAdd=r.a,this.icEdit=l.a,this.icClose=m.a,this.icCheck=g.a,this.icBlock=x.a,this.icPrint=y.a,this.icDelete=u.a,this.icSearch=n.a,this.icVisibility=p.a,this.icPictureAsPdf=w.a,this.icCloudDownload=I.a,this.sedes=this._entidadService.sedes,this.sede.setValue("")}ngOnInit(){this.sede.valueChanges.subscribe(t=>{console.log("sede",t),this.index()}),this.fechaemisionFrom.valueChanges.subscribe(t=>{this.index()}),this.fechaemisionTo.valueChanges.subscribe(t=>{this.index()}),this.sortMasivo.sortChange.subscribe(()=>{this.pagMasivo.pageIndex=0,this.index()}),this.pagMasivo.page.subscribe(()=>{this.index()}),this.index()}index(t){t&&(this.pagMasivo.pageIndex=0);const e={page:this.pagMasivo.pageSize?this.pagMasivo.pageIndex+1:1,pageSize:this.pagMasivo.pageSize?this.pagMasivo.pageSize:this.pSizeMasivo,orderName:this.sortMasivo.active?this.sortMasivo.active:"id",orderSort:this.sortMasivo.direction?this.sortMasivo.direction:"desc",conRecurso:"docnegocio,sede,masivodet"};this.sede.value&&(e.idsede=this.sede.value),this.fechaemisionFrom.value&&(e.fechaemisionFrom=this.pipeDate.transform(this.fechaemisionFrom.value,"yyyy-MM-dd")),this.fechaemisionTo.value&&(e.fechaemisionTo=this.pipeDate.transform(this.fechaemisionTo.value,"yyyy-MM-dd")),this.loadMasivo=!0,this._masivoService.index(e).subscribe(t=>{t.data.forEach(t=>{t.progressbar=100*t.progreso/t.cantidad}),this.loadMasivo=!1,this.dsMasivo.data=t.data,this.rLengthMasivo=t.total},t=>{})}newMasivo(){this._matDialog.open(Qe,{panelClass:"masivo-form-dialog",data:{sedeDefault:this.sede.value?this.sede.value:this._entidadService.sedeDefault},autoFocus:!1,disableClose:!0}).afterClosed().subscribe(t=>{t&&(this.sede.value&&this.sede.value!==t.idsede&&this.sede.setValue(t.idsede,{emitEvent:!1}),this.showMasivo(t),this.index())})}anularMasivo(t){const e=this._matDialog.open(Ue.a,{panelClass:"confirmacion-dialog",disableClose:!1});e.componentInstance.confirmMessage=`\xbfEstas seguro de anular los ${t.cantidad} comprobantes?`,e.componentInstance.textButton="ANULAR",e.afterClosed().subscribe(e=>{e&&(this.snackBar.open("Procesando...","Cerrar"),this._masivoService.anular(t.id).subscribe(e=>{this.snackBar.open(`${e.cantidad} comprobantes anulados.`,"Cerrar"),this.index(),this.showMasivo(t)},t=>{const e=this._utils.convertError(t);this.snackBar.open(e,"Cerrar",{panelClass:["error-dialog"]})}))})}showMasivo(t){this._matDialog.open(dt,{panelClass:"masivo-show-dialog",data:{id:t.id},autoFocus:!1,disableClose:!0}).afterClosed().subscribe(e=>{e&&("anular"===e&&this.anularMasivo(t),"refresh"===e&&this.index(!0))})}displaySearchMasivo(t){return t?t.nombre:null}printPdf(t){}}return t.\u0275fac=function(e){return new(e||t)(O.Qb(T.b),O.Qb(H),O.Qb(Vt.a),O.Qb(q.a),O.Qb(oe.b))},t.\u0275cmp=O.Kb({type:t,selectors:[["vex-masivo"]],viewQuery:function(t,e){var o;1&t&&(O.Cc(to,!0),O.Cc(eo,!0)),2&t&&(O.tc(o=O.fc())&&(e.pagMasivo=o.first),O.tc(o=O.fc())&&(e.sortMasivo=o.first))},decls:73,vars:19,consts:[["fxLayout","column","fxLayoutAlign","center start",1,"pb-16"],[1,"w-full","flex","flex-col","sm:flex-row","justify-between","px-gutter"],[1,"title","mt-0","mb-1",3,"click"],["mat-raised-button","","type","button","fxHide","","fxShow.gt-xs","",3,"click"],[3,"icIcon"],["mat-icon-button","","type","button","fxShow","","fxHide.gt-xs","",3,"click"],[1,"-mt-6","px-gutter"],[1,"card","overflow-auto","-mt-16"],["fxLayout","row","fxLayoutAlign","start center",1,"bg-app-bar","px-6","h-16","border-b","sticky","left-0"],["fxFlex","25","fxFlex.lt-md","auto","fxLayout","row","fxLayoutAlign","start center",1,"bg-card","rounded-full","border","px-4"],[1,"px-4","py-3","border-0","outline-none","bg-transparent",3,"formControl"],["value",""],[3,"value",4,"ngFor","ngForOf"],["fxFlex",""],["fxFlex","290px","fxFlex.lt-md","auto","fxHide.xs","","fxLayout","row","fxLayoutAlign","start center",1,"bg-card","rounded-full","border","px-4"],["matInput","","placeholder","Desde","name","fechaemisionFrom",1,"px-4","py-3","border-0","outline-none","w-full","bg-transparent",3,"formControl","matDatepicker"],["matSuffix","",3,"for"],["fechaFromDatePicker",""],["matInput","","placeholder","Hasta","name","fechaemisionTo",3,"formControl","matDatepicker"],["fechaToDatePicker",""],[1,"loading-container"],["class","loading-shade",4,"ngIf"],["mat-table","","matSort","","matSortActive","id","matSortDisableClear","","matSortDirection","desc",1,"w-full",3,"dataSource"],["table","","sortMasivo","matSort"],["matColumnDef","sede"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cel","",4,"matCellDef"],["matColumnDef","fechaemision"],["matColumnDef","iddocumentofiscal"],["matColumnDef","serie"],["matColumnDef","numerodel"],["mat-cel","","class","text-center",4,"matCellDef"],["matColumnDef","numeroal"],["matColumnDef","progreso"],["matColumnDef","detalle"],["mat-header-cell","","class","text-center",4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","cantidad"],["matColumnDef","acciones"],["mat-cell","",4,"matCellDef"],["matColumnDef","empty"],[4,"matFooterCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","hover:bg-hover trans-ease-out cursor-pointer","mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",3,"ngClass",4,"matFooterRowDef"],[3,"length","pageSizeOptions","pageSize"],["pagMasivo",""],[3,"value"],[1,"loading-shade"],["mat-header-cell",""],["mat-cel",""],["mat-cel","",1,"text-center"],["color","accent",3,"mode","value"],["mat-header-cell","",1,"text-center"],[1,"table-hover"],[4,"ngFor","ngForOf"],[1,"text-center",2,"width","40px"],[2,"width","200px"],[1,"text-center"],["mat-cell",""],["fxLayout","row","fxLayoutAlign","center center",4,"ngIf"],["fxLayout","row","fxLayoutAlign","center center"],["type","button","mat-icon-button","","matTooltip","Descargar",1,"w-8","h-8","leading-none","flex","items-center","justify-center","hover:bg-hover",3,"click"],["size","18px",3,"icIcon"],["type","button","mat-icon-button","","matTooltip","Imprimir",1,"w-8","h-8","leading-none","flex","items-center","justify-center","ml-1","hover:bg-hover",3,"click"],[1,"text-red-500","text-center"],["mat-header-row",""],["mat-row","",1,"hover:bg-hover","trans-ease-out","cursor-pointer",3,"click"],["mat-footer-row","",3,"ngClass"]],template:function(t,e){if(1&t&&(O.Wb(0,"vex-page-layout"),O.Wb(1,"vex-page-layout-header",0),O.Wb(2,"div",1),O.Wb(3,"div"),O.Wb(4,"h1",2),O.ec("click",(function(){return e.index(!0)})),O.Gc(5,"Ventas por lote"),O.Vb(),O.Vb(),O.Wb(6,"div"),O.Wb(7,"button",3),O.ec("click",(function(){return e.newMasivo()})),O.Rb(8,"mat-icon",4),O.Gc(9," Nuevo "),O.Vb(),O.Wb(10,"button",5),O.ec("click",(function(){return e.newMasivo()})),O.Rb(11,"mat-icon",4),O.Vb(),O.Vb(),O.Vb(),O.Vb(),O.Wb(12,"vex-page-layout-content",6),O.Wb(13,"div",7),O.Wb(14,"div",8),O.Wb(15,"div",9),O.Wb(16,"mat-select",10),O.Wb(17,"mat-option",11),O.Gc(18,"Todos"),O.Vb(),O.Ec(19,oo,2,2,"mat-option",12),O.Vb(),O.Vb(),O.Rb(20,"span",13),O.Wb(21,"div",14),O.Rb(22,"input",15),O.Rb(23,"mat-datepicker-toggle",16),O.Rb(24,"mat-datepicker",null,17),O.Rb(26,"input",18),O.Rb(27,"mat-datepicker-toggle",16),O.Rb(28,"mat-datepicker",null,19),O.Vb(),O.Vb(),O.Wb(30,"div",20),O.Ec(31,io,2,0,"div",21),O.Wb(32,"table",22,23),O.Ub(35,24),O.Ec(36,ao,2,0,"th",25),O.Ec(37,no,6,5,"td",26),O.Tb(),O.Ub(38,27),O.Ec(39,co,2,0,"th",25),O.Ec(40,ro,3,4,"td",26),O.Tb(),O.Ub(41,28),O.Ec(42,so,2,0,"th",25),O.Ec(43,lo,2,1,"td",26),O.Tb(),O.Ec(44,uo,2,1,"td",26),O.Ub(45,29),O.Ec(46,bo,2,0,"th",25),O.Ec(47,mo,2,1,"td",26),O.Tb(),O.Ub(48,30),O.Ec(49,fo,2,0,"th",25),O.Ec(50,po,5,2,"td",31),O.Tb(),O.Ub(51,32),O.Ec(52,ho,2,0,"th",25),O.Ec(53,go,2,1,"td",26),O.Tb(),O.Ub(54,33),O.Ec(55,vo,2,0,"th",25),O.Ec(56,xo,3,4,"td",26),O.Tb(),O.Ub(57,34),O.Ec(58,Vo,2,0,"th",35),O.Ec(59,Co,5,1,"td",36),O.Tb(),O.Ub(60,37),O.Ec(61,wo,2,0,"th",25),O.Ec(62,Wo,2,1,"td",31),O.Tb(),O.Ub(63,38),O.Ec(64,Io,1,0,"th",25),O.Ec(65,Go,3,2,"td",39),O.Tb(),O.Ub(66,40),O.Ec(67,Lo,2,0,"mat-footer-cell",41),O.Tb(),O.Ec(68,So,1,0,"tr",42),O.Ec(69,Ro,1,0,"tr",43),O.Ec(70,Mo,1,3,"tr",44),O.Vb(),O.Rb(71,"mat-paginator",45,46),O.Vb(),O.Vb(),O.Vb(),O.Vb()),2&t){const t=O.uc(25),o=O.uc(29);O.Cb(8),O.oc("icIcon",e.icAdd),O.Cb(3),O.oc("icIcon",e.icAdd),O.Cb(5),O.oc("formControl",e.sede),O.Cb(3),O.oc("ngForOf",e.sedes),O.Cb(3),O.oc("formControl",e.fechaemisionFrom)("matDatepicker",t),O.Cb(1),O.oc("for",t),O.Cb(3),O.oc("formControl",e.fechaemisionTo)("matDatepicker",o),O.Cb(1),O.oc("for",o),O.Cb(4),O.oc("ngIf",e.loadMasivo),O.Cb(1),O.oc("dataSource",e.dsMasivo),O.Cb(36),O.oc("matHeaderRowDef",e.dcMasivo),O.Cb(1),O.oc("matRowDefColumns",e.dcMasivo),O.Cb(1),O.oc("matFooterRowDef",O.pc(18,Ao)),O.Cb(1),O.oc("length",e.rLengthMasivo)("pageSizeOptions",e.pSizeOptMasivo)("pageSize",e.pSizeMasivo)}},directives:[$e.a,Be.a,X.c,X.b,B.b,tt.b,J.a,Y.a,Ke.a,X.a,Et.a,ut.p,ut.f,Lt.n,Q.o,Wt.b,ut.b,It.b,It.d,wt.j,It.a,Q.p,Xe.n,Je.a,Xe.c,Xe.i,Xe.b,Xe.e,Xe.k,Xe.m,Xe.g,Ye.a,St.b,Xe.h,Ze.a,Xe.a,K.a,Xe.d,Xe.j,Xe.l,Xe.f,Q.m,tt.a],pipes:[Q.e,Q.f],styles:["vex-masivo .loading-container{position:relative}vex-masivo .loading-shade{position:absolute;top:0;left:0;bottom:56px;right:0;background:rgba(0,0,0,.15);z-index:1;display:flex;align-items:center;justify-content:center}vex-masivo .hide{display:none}vex-masivo .label{border-radius:var(--border-radius);font:var(--font-caption);height:32px;line-height:32px;margin-top:var(--padding-12);margin-left:var(--padding-8);min-width:32px;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}vex-masivo .label:last-of-type{padding:0}vex-masivo fieldset{border:1px solid #ccc;border-radius:8px;line-height:24px;padding:8px}vex-masivo fieldset legend{padding:0 8px}vex-masivo .table-hover{border-collapse:collapse;width:100%}"],encapsulation:2}),t})();var _o=o("iWjc"),To=o("iTUp"),Oo=o("cc8n"),No=o("YioD"),jo=o("7lCJ"),zo=o("J0XA");const Po=[{path:"**",component:ko}];let qo=(()=>{class t{}return t.\u0275mod=O.Ob({type:t}),t.\u0275inj=O.Nb({factory:function(e){return new(e||t)},imports:[[i.j.forChild(Po),_o.a,To.a,Oo.a,No.a,jo.a,zo.a,me]]}),t})()},YioD:function(t,e,o){"use strict";o.d(e,"a",(function(){return s}));var i=o("ofXK"),a=o("cc8n"),n=o("iWjc"),c=o("iTUp"),r=o("fXoL");let s=(()=>{class t{}return t.\u0275mod=r.Ob({type:t}),t.\u0275inj=r.Nb({factory:function(e){return new(e||t)},imports:[[i.c,a.a,c.a,n.a]]}),t})()},ZuBe:function(t,e,o){"use strict";o.d(e,"a",(function(){return n}));var i=o("fXoL");const a=["*"];let n=(()=>{class t{constructor(){this.mode="simple"}get isCard(){return"card"===this.mode}get isSimple(){return"simple"===this.mode}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Kb({type:t,selectors:[["vex-page-layout"]],hostAttrs:[1,"vex-page-layout"],hostVars:4,hostBindings:function(t,e){2&t&&i.Gb("vex-page-layout-card",e.isCard)("vex-page-layout-simple",e.isSimple)},inputs:{mode:"mode"},ngContentSelectors:a,decls:1,vars:0,template:function(t,e){1&t&&(i.nc(),i.mc(0))},styles:[".vex-page-layout{display:block}.vex-page-layout-simple .vex-page-layout-content{padding-bottom:var(--padding-gutter);padding-top:var(--padding-gutter)}.vex-page-layout-card{padding-bottom:var(--padding)}.vex-page-layout-card .vex-page-layout-header{margin-bottom:calc(var(--page-layout-toolbar-height)*-1);padding-bottom:var(--page-layout-toolbar-height)}.vex-page-layout-card .vex-page-layout-content>*>.mat-tab-group .mat-tab-label,.vex-page-layout-card .vex-page-layout-content>.mat-tab-group .mat-tab-label{height:var(--page-layout-toolbar-height)}.vex-page-layout-card .vex-page-layout-content>*>.mat-tab-group .mat-tab-label.mat-tab-label-active,.vex-page-layout-card .vex-page-layout-content>.mat-tab-group .mat-tab-label.mat-tab-label-active{opacity:1}.vex-page-layout-header{align-items:center;background-color:rgb(var(--color-primary));color:rgb(var(--color-primary-contrast));box-sizing:content-box!important;display:flex;flex-direction:row;height:calc(var(--page-layout-header-height) - var(--page-layout-toolbar-height));padding-left:var(--padding);padding-right:var(--padding);place-content:center flex-start}.vex-page-layout-header .vex-breadcrumb{color:rgb(var(--color-primary-contrast));opacity:.5}.vex-page-layout-header .vex-breadcrumb:hover{color:rgb(var(--color-primary-contrast));opacity:1}.vex-page-layout-content{box-sizing:border-box;display:block;padding-left:var(--padding-gutter);padding-right:var(--padding-gutter)}"],encapsulation:2}),t})()},e3EN:function(t,e){e.__esModule=!0,e.default={body:'<path opacity=".3" d="M8 9h8v10H8z" fill="currentColor"/><path d="M15.5 4l-1-1h-5l-1 1H5v2h14V4zM6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM8 9h8v10H8V9z" fill="currentColor"/>',width:24,height:24}},eUUZ:function(t,e,o){"use strict";o.d(e,"a",(function(){return a}));var i=o("fXoL");let a=(()=>{class t{constructor(){this.mediosdepago=[{idmediopago:1,nombre:"Efectivo"},{idmediopago:2,nombre:"Tarjeta d\xe9bito"},{idmediopago:3,nombre:"Tarjeta cr\xe9dito"},{idmediopago:4,nombre:"Dep\xf3sito"},{idmediopago:5,nombre:"Giro"},{idmediopago:6,nombre:"Cup\xf3n"},{idmediopago:7,nombre:"Otros"}],this.operaciones=[{operacion:1,nombre:"Venta interna"}],this.formatos=[{id:"A4",nombre:"A4"},{id:"A5",nombre:"A5"},{id:"TICKET",nombre:"Ticket"}],this.comprobantenc=[{iddocumentofiscal:1,nombre:"Factura"},{iddocumentofiscal:2,nombre:"Boleta de venta"}],this.tiponc=[{id:1,nombre:"Anulaci\xf3n de la operaci\xf3n"},{id:2,nombre:"Anulaci\xf3n por error en el Ruc"},{id:3,nombre:"Correcci\xf3n por error en la descripci\xf3n"},{id:4,nombre:"Descuento global"},{id:5,nombre:"Descuento por \xedtem"},{id:6,nombre:"Devoluci\xf3n total"},{id:7,nombre:"Devoluci\xf3n por \xedtem"},{id:8,nombre:"Bonificaci\xf3n"},{id:9,nombre:"Disminuci\xf3n en el valor"}],this.tipond=[{id:1,nombre:"Intereses por mora"},{id:2,nombre:"Aumento de valor"},{id:3,nombre:"Penalidades"}],this.monedas=[{moneda:"PEN",nombre:"S/"},{moneda:"USD",nombre:"$"},{moneda:"EUR",nombre:"\u20ac"}],this.documentos=[{iddocumento:1,nombre:"DNI"},{iddocumento:2,nombre:"RUC"},{iddocumento:4,nombre:"C.E."},{iddocumento:3,nombre:"PASAPORTE"},{iddocumento:5,nombre:"VARIOS - VENTAS MENORES A S/.700.00"},{iddocumento:6,nombre:"NO DOMICILIADO"},{iddocumento:7,nombre:"C\xc9DULA DIPLOM\xc1TICA"}],this.impuestos=[{idimpuesto:1,nombre:"Igv"},{idimpuesto:8,nombre:"Exonerado"},{idimpuesto:9,nombre:"Inafecto"},{idimpuesto:2,nombre:"Gratuita"}]}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=i.Mb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},iWjc:function(t,e,o){"use strict";o.d(e,"a",(function(){return s}));var i=o("3Pt+"),a=o("ofXK"),n=o("VX/1"),c=o("cc8n"),r=o("fXoL");let s=(()=>{class t{}return t.\u0275mod=r.Ob({type:t}),t.\u0275inj=r.Nb({factory:function(e){return new(e||t)},imports:[[c.a,i.k,i.t,a.c,n.b],i.k,i.t,a.c,n.b]}),t})()},pN9m:function(t,e){e.__esModule=!0,e.default={body:'<path opacity=".3" d="M5 18.08V19h.92l9.06-9.06l-.92-.92z" fill="currentColor"/><path d="M20.71 7.04a.996.996 0 0 0 0-1.41l-2.34-2.34c-.2-.2-.45-.29-.71-.29s-.51.1-.7.29l-1.83 1.83l3.75 3.75l1.83-1.83zM3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM5.92 19H5v-.92l9.06-9.06l.92.92L5.92 19z" fill="currentColor"/>',width:24,height:24}},uQ9D:function(t,e){e.__esModule=!0,e.default={body:'<path opacity=".3" d="M12 6a9.77 9.77 0 0 0-8.82 5.5C4.83 14.87 8.21 17 12 17s7.17-2.13 8.82-5.5A9.77 9.77 0 0 0 12 6zm0 10c-2.48 0-4.5-2.02-4.5-4.5S9.52 7 12 7s4.5 2.02 4.5 4.5S14.48 16 12 16z" fill="currentColor"/><path d="M12 4C7 4 2.73 7.11 1 11.5C2.73 15.89 7 19 12 19s9.27-3.11 11-7.5C21.27 7.11 17 4 12 4zm0 13a9.77 9.77 0 0 1-8.82-5.5C4.83 8.13 8.21 6 12 6s7.17 2.13 8.82 5.5A9.77 9.77 0 0 1 12 17zm0-10c-2.48 0-4.5 2.02-4.5 4.5S9.52 16 12 16s4.5-2.02 4.5-4.5S14.48 7 12 7zm0 7a2.5 2.5 0 0 1 0-5a2.5 2.5 0 0 1 0 5z" fill="currentColor"/>',width:24,height:24}},uwSD:function(t,e,o){"use strict";o.d(e,"a",(function(){return a}));var i=o("fXoL");let a=(()=>{class t{constructor(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=i.Lb({type:t,selectors:[["","vexPageLayoutHeader",""],["vex-page-layout-header"]],hostAttrs:[1,"vex-page-layout-header"]}),t})()},wrPX:function(t,e){e.__esModule=!0,e.default={body:'<path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V9h14v10zm0-12H5V5h14v2zm-7 4H7v5h5v-5z" fill="currentColor"/><path opacity=".3" d="M5 5h14v2H5z" fill="currentColor"/>',width:24,height:24}}}]);